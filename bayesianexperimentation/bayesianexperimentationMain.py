# -*- coding: utf-8 -*-
'''
Script that generates and analyzes a synthetic set of PMS data. These data differ from the data used in the paper but
capture the important elements of what is presented in the paper.
Inference generation requires use of the logistigate package, available at https://logistigate.readthedocs.io/en/main/.
Running the generateSyntheticData() function generates Figures 2, 3, and 4, as well as the interval widths for Tables
1 and 2, that are analagous to the items produced using the de-identified data.
'''

from logistigate.logistigate import utilities as util # Pull from the submodule "develop" branch
from logistigate.logistigate import methods
from logistigate.logistigate import lg
import numpy as np
from numpy.random import choice
import scipy.special as sps
import scipy.stats as spstat
import matplotlib
import matplotlib.pyplot as plt
import random
import pickle
import time
import math
from math import comb

def balancedesign(N,ntilde):
    '''
    Uses matrix of original batch (N) and next batch (ntilde) to return a balanced design where the target is an even
    number of tests from each (TN,SN) arc for the total tests done
    '''
    n = np.sum(N)
    r,c = N.shape
    D = np.repeat(1/(r*c),r*c)*(n+ntilde)
    D.shape = (r,c)
    D = D - N
    D[D < 0] = 0.
    D = D/np.sum(D)

    return D

def roundDesignLow(D,n):
    '''
    Takes a proposed design, D, and number of new tests, n, to produce an integer tests array by removing tests from
    design traces with the highest number of tests or adding tests to traces with the lowest number of tests.
    '''
    roundMat = np.round(n*D)
    if np.sum(roundMat) > n: # Too many tests; remove from highest represented traces
        roundMat = roundMat.flatten()
        sortinds = np.argsort(-roundMat,axis=None).tolist()
        for removeInd in range(int(np.sum(roundMat)-n)):
            roundMat[sortinds[removeInd]] += -1
        if D.ndim == 2:
            roundMat = roundMat.reshape(D.shape[0],D.shape[1])
    elif np.sum(roundMat) < n: # Too few tests; add to lowest represented traces
        roundMat = roundMat.flatten()
        sortinds = np.argsort(roundMat, axis=None).tolist()
        for addind in range(int(n-np.sum(roundMat))):
            roundMat[sortinds[addind]] += 1
        if D.ndim == 2:
            roundMat = roundMat.reshape(D.shape[0],D.shape[1])
    return roundMat

def roundDesignHigh(D,n):
    '''
    Takes a proposed design, D, and number of new tests, n, to produce an integer tests array by removing tests from
    design traces with the lowest number of tests or adding tests to traces with the highest number of tests.
    '''
    roundMat = np.round(n*D)
    if np.sum(roundMat) > n: # Too many tests; remove from lowest represented traces
        roundMat = roundMat.flatten()
        sortinds = np.argsort(roundMat,axis=None).tolist()
        for removeInd in range(int(np.sum(roundMat)-n)):
            roundMat[sortinds[removeInd]] += -1
        if D.ndim == 2:
            roundMat = roundMat.reshape(D.shape[0],D.shape[1])
    elif np.sum(roundMat) < n: # Too few tests; add to highest represented traces
        roundMat = roundMat.flatten()
        sortinds = np.argsort(-roundMat, axis=None).tolist()
        for addind in range(int(n-np.sum(roundMat))):
            roundMat[sortinds[addind]] += 1
        if D.ndim == 2:
            roundMat = roundMat.reshape(D.shape[0],D.shape[1])
    return roundMat

def plotLossVecs(lveclist, lvecnames=[], type='CI', CIalpha = 0.05,legendlabel=[],
                 plottitle='Confidence Intervals for Loss Averages', plotlim=[]):
    '''
    Takes a list of loss vectors and produces either a series of histograms or a single plot marking average confidence
    intervals
    lveclist: list of lists
    type: 'CI' (default) or 'hist'
    CIalpha: alpha for confidence intervals
    '''
    numvecs = len(lveclist)
    # Make dummy names if none entered
    if lvecnames==[]: #empty
        for ind in range(numvecs):
            lvecnames.append('Design '+str(ind+1))
    numDups = 1
    orignamelen = len(lvecnames)
    if orignamelen<len(lveclist): # We have multiple entries per design
        numDups = int(len(lveclist)/len(lvecnames))
        lvecnames = numDups*lvecnames
    # For color palette
    from matplotlib.pyplot import cm

    # Make designated plot type
    if type=='CI':
        lossavgs = []
        lossint_hi = []
        lossint_lo = []
        for lvec in lveclist:
            currN = len(lvec)
            curravg = np.average(lvec)
            lossavgs.append(curravg)
            std = np.std(lvec)
            z = spstat.norm.ppf(1 - (CIalpha / 2))
            intval = z * (std) / np.sqrt(currN)
            lossint_hi.append(curravg + intval)
            lossint_lo.append(curravg - intval)

        # Plot intervals for loss averages
        if lossavgs[0]>0: # We have losses
            xaxislab = 'Loss'
            limmin = 0
            limmax = max(lossint_hi)*1.1
        elif lossavgs[0]<0: # We have utilities
            xaxislab = 'Utility'
            limmin = min(lossint_lo)*1.1
            limmax = 0
        fig, ax = plt.subplots(figsize=(7,7))
        #color = iter(cm.rainbow(np.linspace(0, 1, numvecs/numDups)))
        #for ind in range(numvecs):

        if plotlim==[]:
            plt.xlim([limmin,limmax])
        else:
            plt.xlim(plotlim)
        for ind in range(numvecs):
            if np.mod(ind,orignamelen)==0:
                color = iter(cm.rainbow(np.linspace(0, 1, int(numvecs / numDups))))
            currcolor = next(color)
            if ind<orignamelen:

                plt.plot(lossavgs[ind], lvecnames[ind], 'D', color=currcolor, markersize=6)
            elif ind>=orignamelen and ind<2*orignamelen:
                plt.plot(lossavgs[ind], lvecnames[ind], 'v', color=currcolor, markersize=8)
            elif ind>=2*orignamelen and ind<3*orignamelen:
                plt.plot(lossavgs[ind], lvecnames[ind], 'o', color=currcolor, markersize=6)
            else:
                plt.plot(lossavgs[ind], lvecnames[ind], '^', color=currcolor, markersize=8)
            line = ax.add_line(matplotlib.lines.Line2D(
                 (lossint_hi[ind], lossint_lo[ind]),(lvecnames[ind], lvecnames[ind])))
            line.set(color=currcolor)
            anno_args = {'ha': 'center', 'va': 'center', 'size': 12, 'color': currcolor }
            _ = ax.annotate("|", xy=(lossint_hi[ind], lvecnames[ind]), **anno_args)
            _ = ax.annotate("|", xy=(lossint_lo[ind], lvecnames[ind]), **anno_args)
            #plt.plot((lvecnames[ind], lvecnames[ind]), (lossint_hi[ind], lossint_lo[ind]), '_-',
             #        color=next(color), alpha=0.7, linewidth=3)
        plt.ylabel('Design Name', fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
        plt.xlabel(xaxislab, fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
        for label in (ax.get_xticklabels() + ax.get_yticklabels()):
            label.set_fontname('Times New Roman')
            label.set_fontsize(12)
        #plt.xticks(rotation=90)
        plt.title(plottitle,fontdict={'fontsize':16,'fontname':'Trebuchet MS'})
        if orignamelen<numvecs: # Add a legend if multiple utilities associated with each design
            import matplotlib.lines as mlines
            diamond = mlines.Line2D([], [], color='black', marker='D', linestyle='None', markersize=8, label=legendlabel[0])
            downtriangle = mlines.Line2D([], [], color='black', marker='v', linestyle='None', markersize=10, label=legendlabel[1])
            if numDups>=3:
                circle = mlines.Line2D([], [], color='black', marker='o', linestyle='None', markersize=8, label=legendlabel[2])
                if numDups>=4:
                    uptriangle = mlines.Line2D([], [], color='black', marker='^', linestyle='None', markersize=10, label=legendlabel[3])
                    plt.legend(handles=[diamond, downtriangle, circle,uptriangle])
                else:
                    plt.legend(handles=[diamond, downtriangle, circle])
            else:
                plt.legend(handles=[diamond, downtriangle],loc='lower right')
        fig.tight_layout()
        plt.show()
        plt.close()
    # HISTOGRAMS
    elif type=='hist':
        maxval = max([max(lveclist[i]) for i in range(numvecs)])
        maxbinnum = max([len(lveclist[i]) for i in range(numvecs)])/5
        bins = np.linspace(0.0, maxval*1.1, 100)
        fig, axs = plt.subplots(numvecs, figsize=(5, 10))
        plt.rcParams["figure.autolayout"] = True
        color = iter(cm.rainbow(np.linspace(0, 1, len(lveclist))))
        for ind in range(numvecs):
            axs[ind].hist(lveclist[ind],bins, alpha=0.5, color=next(color),label=lvecnames[ind])
            axs[ind].set_title(lvecnames[ind])
            axs[ind].set_ylim([0,maxbinnum])
        fig.suptitle(plottitle,fontsize=16)
        fig.tight_layout()
        plt.show()
        plt.close()

    return

def marginalshannoninfo(datadict):
    '''
    Takes a PMS data set and returns a matrix of the Shannon information obtained from a marginal test along each trace;
    for tracked data only
    '''
    tnNum, snNum = datadict['N'].shape
    s, r = datadict['diagSens'], datadict['diagSpec']
    postSamps = datadict['postSamples']

    shannonMat = np.zeros(shape=(tnNum, snNum))

    for samp in postSamps: # Iterate through each posterior sample
        for tnInd in range(tnNum):
            tnRate = samp[tnInd + snNum]
            for snInd in range(snNum):
                snRate = samp[snInd]
                consolRate = tnRate + (1-tnRate)*snRate
                detectRate = s*consolRate+(1-r)*(1-consolRate)
                infobit = detectRate*np.log(detectRate) + (1-detectRate)*np.log(detectRate)
                shannonMat[tnInd,snInd] += infobit

    shannonMat=shannonMat/len(postSamps)
    return shannonMat

def risk_parabolic(SFPratevec, paramDict={'threshold': 0.5}):
    '''Parabolic risk term for vector of SFP rates. Threshold is the top of the parabola. '''
    riskvec = np.empty((len(SFPratevec)))
    for ind in range(len(SFPratevec)):
        currRate = SFPratevec[ind]
        if paramDict['threshold'] <= 0.5:
            currRisk = (currRate+2*(0.5-paramDict['threshold']))*(1-currRate)
        else:
            currRisk = currRate * (1 - currRate - 2*(0.5-paramDict['threshold']))
        riskvec[ind] = currRisk
    return riskvec

def risk_check(SFPratevec, paramDict={'threshold': 0.5, 'slope': 0.5}):
    '''Check risk term, which has minus 'slope' to the right of 'threshold' and (1-'slope') to the left of threshold'''
    riskvec = np.empty((len(SFPratevec)))
    for i in range(len(SFPratevec)):
        riskvec[i] = (1 - SFPratevec[i]*(paramDict['slope']-(1-paramDict['threshold']/SFPratevec[i]
                      if SFPratevec[i]<paramDict['threshold'] else 0)))
    return riskvec

def score_diff(est, targ, paramDict):
    '''
    Returns the difference between vectors est and targ underEstWt, the weight of underestimation error relative to
    overestimation error.
    paramDict requires keys: underEstWt
    '''
    scorevec = np.empty((len(targ)))
    for i in range(len(targ)):
        scorevec[i] = (paramDict['underEstWt']*max(targ[i] - est[i], 0) + max(est[i]-targ[i],0))
    return scorevec

def score_class(est, targ, paramDict):
    '''
    Returns the difference between classification of vectors est and targ using threshold, based on underEstWt,
    the weight of underestimation error relative to overestimation error.
    paramDict requires keys: threshold, underEstWt
    '''
    scorevec = np.empty((len(targ)))
    for i in range(len(targ)):
        estClass = np.array([1 if est[i] >= paramDict['threshold'] else 0 for i in range(len(est))])
        targClass = np.array([1 if targ[i] >= paramDict['threshold'] else 0 for i in range(len(targ))])
        scorevec[i] = (paramDict['underEstWt']*max(targClass[i] - estClass[i], 0) + max(estClass[i]-targClass[i],0))
    return scorevec

def score_check(est, targ, paramDict):
    '''
    Returns a check difference between vectors est and targ using slope, which can be used to weigh underestimation and
    overestimation differently. Slopes less than 0.5 mean underestimation causes a higher loss than overestimation.
    paramDict requires keys: slope
    '''
    scorevec = np.empty((len(targ)))
    for i in range(len(targ)):
        scorevec[i] = (est[i]-targ[i])*(paramDict['slope']- (1 if est[i]<targ[i] else 0))
    return scorevec

def bayesEst(samps, scoredict):
    '''
    Returns the Bayes estimate for a set of SFP rates based on the type of score and parameters used
    scoredict: must have key 'name' and other necessary keys for calculating the associated Bayes estimate
    '''
    scorename = scoredict['name']
    if scorename == 'AbsDiff':
        underEstWt = scoredict['underEstWt']
        est = np.quantile(samps,underEstWt/(1+underEstWt), axis=0)
    elif scorename == 'Check':
        slope = scoredict['slope']
        est = np.quantile(samps,1-slope, axis=0)
    elif scorename == 'Class':
        underEstWt = scoredict['underEstWt']
        critVal = np.quantile(samps, underEstWt / (1 + underEstWt), axis=0)
        classlst = [1 if critVal[i]>=scoredict['threshold'] else 0 for i in range(len(samps[0]))]
        est = np.array(classlst)
    else:
        print('Not a valid score name')

    return est

def bayesEstAdapt(samps, wts, scoredict, printUpdate=True):
    '''
    Returns the Bayes estimate for a set of SFP rates, adjusted for weighting of samples, based on the type of score
        and parameters used
    scoredict: must have key 'name' and other necessary keys for calculating the associated Bayes estimate
    '''
    # First identify the quantile we need
    scorename = scoredict['name']
    if scorename == 'AbsDiff':
        underEstWt = scoredict['underEstWt']
        q = underEstWt/(1+underEstWt)
    elif scorename == 'Check':
        slope = scoredict['slope']
        q = 1-slope
    elif scorename == 'Class':
        underEstWt = scoredict['underEstWt']
        q = underEstWt / (1 + underEstWt)
    else:
        print('Not a valid score name')
    # Establish the weight-sum target
    wtTarg = q * np.sum(wts)
    #Initialize return vector
    est = np.empty(shape=(len(samps[0])))
    # Iterate through each node's distribution of SFP rates, sorting the weights accordingly
    for gind in range(len(samps[0])):
        if printUpdate==True:
            print('start '+str(gind)+': '+str(round(time.time())))
        currRates = samps[:,gind]
        sortRatesWts = [(y, x) for y, x in sorted(zip(currRates, wts))]
        sortRates = [x[0] for x in sortRatesWts]
        sortWts = [x[1] for x in sortRatesWts]
        #sortWtsSum = [np.sum(sortWts[:i+1]) for i in range(len(sortWts))]
        #critInd = np.argmax(sortWtsSum>=wtTarg)
        critInd = np.argmax(np.cumsum(sortWts)>=wtTarg)
        est[gind] = sortRates[critInd]
        if printUpdate==True:
            print('end ' + str(gind) + ': ' + str(round(time.time())))

    return est

def loss_pms(est, targ, score, scoreDict, risk, riskDict, market):
    '''
    Loss/utility function tailored for PMS.
    score, risk: score and risk functions with associated parameter dictionaries scoreDict, riskDict,
        that return vectors
    market: vector of market weights
    '''
    currloss = 0. # Initialize the loss/utility
    scorevec = score(est, targ, scoreDict)
    riskvec = risk(targ, riskDict)
    for i in range(len(targ)):
        currloss += scorevec[i] * riskvec[i] * market[i]
    return currloss

def loss_pms2(est, targ, paramDict):
    '''
    Loss/utility function tailored for PMS.
    score, risk: score and risk functions with associated parameter dictionaries scoreDict, riskDict
    market: market weights
    '''
    currloss = 0.
    epsTarg = 0.5 - paramDict['rateTarget']
    if len(paramDict['nodeWtVec'])==0: #
        nodeWtVec = [1. for i in range(len(est))]
    for i in range(len(est)):
        scoreterm = (paramDict['underEstWt']*max(targ[i] - est[i], 0) + max(est[i]-targ[i],0))
        if paramDict['checkloss']==False:
            if epsTarg < 0:
                wtterm = targ[i]*(1-targ[i]-2*epsTarg)
            else:
                wtterm = (targ[i]+2*epsTarg)*(1-targ[i])
        else:
            wtterm = 1 - targ[i]*(paramDict['checkslope']-(1-paramDict['rateTarget']/targ[i] if targ[i]<paramDict['rateTarget'] else 0))
        currloss += scoreterm * wtterm * nodeWtVec[i]
    return currloss

def showRiskVals():
    '''Generate a figure showcasing how the risk changes with different parameter choices'''
    x = np.linspace(0.001,0.999,1000)
    t = 0.3 # Our target
    y1 = (x+2*(0.5-t))*(1-x)
    tauvec = [0.05,0.2,0.4,0.6,0.95]
    fig, ax = plt.subplots(figsize=(8, 7))
    for tau in tauvec:
        newy = [1 - x[i]*(tau-(1-(t/x[i]) if x[i]<t else 0)) for i in range(len(x))]
        plt.plot(x,newy)
    plt.plot(x,y1)
    import matplotlib.ticker as mtick
    ax.xaxis.set_major_formatter(mtick.PercentFormatter(1.0))
    plt.title('Values for Parabolic and selected Check risk terms\n$l=30\%$',fontdict={'fontsize':16,'fontname':'Trebuchet MS'})
    plt.ylabel('Risk term value', fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
    plt.xlabel('SFP rate', fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
    plt.text(0.84, 0.97,'Check, $m=0.05$',fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    plt.text(0.84, 0.84, 'Check, $m=0.2$',fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    plt.text(0.84, 0.675, 'Check, $m=0.4$', fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    plt.text(0.84, 0.50, 'Check, $m=0.6$', fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    plt.text(0.84, 0.21, 'Check, $m=0.95$', fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    plt.text(0.00, 0.47, 'Parabolic', fontdict={'fontsize': 12, 'fontname': 'Trebuchet MS'})
    fig.tight_layout()
    plt.show()
    plt.close()

    return

def showScoreVals():
    '''Generate a figure showcasing how the score changes with different parameter choices'''
    gEst = np.linspace(0.001,0.999,50) #gamma_hat
    gStar = 0.4 # gamma_star
    tauvec = [0.05,0.25,0.9] # For check score
    vvec = [0.5,1.2] # For absolute difference and classification scores
    tvec = [0.2]
    fig, ax = plt.subplots(figsize=(8, 7))
    for tau in tauvec: # Check scores
        newy = [(gStar-gEst[i])*(tau-(1 if gEst[i]<gStar else 0)) for i in range(len(gEst))]
        plt.plot(gEst,newy,':')
    for v in vvec: # Absolute difference scores
        newy = [-1*(max(gEst[i]-gStar,0)+v*max(gStar-gEst[i],0)) for i in range(len(gEst))]
        plt.plot(gEst,newy,'-')
        for t in tvec:
            classEst = [1 if gEst[i]>=t else 0 for i in range(len(gEst))]
            classStar = 1 if gStar >= t else 0
            newy = [-1*(max(classEst[i]-classStar,0)+v*max(classStar-classEst[i],0)) for i in range(len(gEst))]
            plt.plot(gEst,newy,'<',)
    import matplotlib.ticker as mtick
    plt.ylim([-1.3,0.1])
    ax.xaxis.set_major_formatter(mtick.PercentFormatter(1.0))
    plt.title('Values for selected score terms\n$\gamma^\star=40\%$',fontdict={'fontsize':16,'fontname':'Trebuchet MS'})
    plt.ylabel('Score term value', fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
    plt.xlabel('SFP rate estimate', fontdict={'fontsize': 14, 'fontname': 'Trebuchet MS'})
    plt.text(0.16, -0.55,'Class., $l=20\%$, $v=0.5$',fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0.16, -1.17, 'Class., $l=20\%$, $v=1.2$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0.80, -0.07, 'Check, $m=0.05$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0.8, -0.2, 'Check, $m=0.25$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0.81, -0.36, 'Check, $m=0.9$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0., -0.1, 'Abs. Diff., $v=0.5$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    plt.text(0.13, -0.37, 'Abs. Diff., $v=1.2$', fontdict={'fontsize': 10, 'fontname': 'Trebuchet MS'})
    fig.tight_layout()
    plt.show()
    plt.close()

    return

def utilityOverIncreasingData():
    '''Generate a figure showing the change in utility as n increases'''

    return

def writeObjToPickle(obj, objname='pickleObject'):
    '''HOW TO WRITE PRIOR DRAWS TO A PICKLE OBJECT TO BE LOADED LATER'''
    import pickle
    import os
    outputFilePath = os.getcwd()
    outputFileName = os.path.join(outputFilePath, objname)
    pickle.dump(obj, open(outputFileName, 'wb'))
    return

def getDesignUtility(priordatadict, lossdict, designlist, numtests, omeganum, designnames=[],
                     type=['trace'], priordraws=[], randinds=[], roundAlg=roundDesignLow, method='MCMC',
                     printUpdate=True, numpostdraws=0):
    '''
    Produces a list of loss vectors for entered design choices under a given data set and specified loss. Each loss
        vector contains omeganum Monte Carlo integration iterations
    Designed for use with plotLossVecs() to plot Bayesian risk associated with each design.
    priordatadict: dictionary capturing all prior data. should have posterior draws from initial data set already
    included, with keys identical to those provided by logistigate functions
    lossdict: parameter dictionary to pass to lossfunc
    estdecision: list for how to form a decision from the posterior samples; one of ['mean'], ['median'], or
        ['mode', t], where t is the assignment threshold for designating the classification estimate
    designlist: list of sampling probability vectors along all test nodes or traces
    designnames: list of names for the designs
    numtests: how many samples will be obtained under each design
    omeganum: number of prior draws to use for calculating the Bayesian risk
    type: list for the type of sample collection described in each design; one of ['trace'] (collect along SN-TN trace) or
        ['test node', Qest] (collect along test nodes, along with the estimate of the sourcing probability matrix)
    priordraws: set of prior draws to use for synchronized data collection in different designs
    randinds: the indices with which to iterate through priordraws for all omeganum loops
    method: one of 'MCMC', 'MCMCexpec', 'weights' or 'approx'; 'MCMC' completes full MCMC sampling for generating
        posterior probabilities, 'approx' approximates the posterior probabilities, 'weights' uses a weighting
        equivalence scheme
    '''
    # Initiate the list to return
    lossveclist = []
    # Retrieve prior draws if empty
    if len(priordraws)==0:
        priordraws = priordatadict['postSamples']
    if len(randinds)==0:
        randinds = [i for i in range(omeganum)]
    if len(designnames)==0:
        for i in range(len(designlist)):
            designnames.append('Design '+str(i))
    if numpostdraws == 0:
        numpostdraws = priordatadict['numPostSamples']
    # Get key supply-chain elements from priordatadict
    (numTN, numSN) = priordatadict['N'].shape
    Q = priordatadict['transMat'] #May be empty
    s, r = priordatadict['diagSens'], priordatadict['diagSpec']

    # Loop through each design and generate omeganum loss realizations
    for designind, design in enumerate(designlist):
        currlossvec = []
        # Initialize samples to be drawn from traces, per the design
        sampMat = roundAlg(design, numtests)

        if method == 'MCMC':
            for omega in range(omeganum):
                TNsamps = sampMat.copy()
                # Grab a draw from the prior
                currpriordraw = priordraws[randinds[omega]]  # [SN rates, TN rates]

                # Initialize Ntilde and Ytilde
                Ntilde = np.zeros(shape=priordatadict['N'].shape)
                Ytilde = Ntilde.copy()
                while np.sum(TNsamps) > 0.:
                    # Go to first non-empty row of TN samps
                    i, j = 0, 0
                    while np.sum(TNsamps[i]) == 0:
                        i += 1
                    if type[0] == 'trace':
                        # Go to first non-empty column of this row
                        while TNsamps[i][j] == 0:
                            j += 1
                        TNsamps[i][j] -= 1
                    if type[0] == 'test node':
                        # Pick a supply node according to Qest
                        j = choice([i for i in range(numSN)], p=type[1][i] / np.sum(type[1][i]).tolist())
                        TNsamps[i] -= 1
                    # Generate test result
                    currTNrate = currpriordraw[numSN + i]
                    currSNrate = currpriordraw[j]
                    currrealrate = currTNrate + (1 - currTNrate) * currSNrate  # z_star for this sample
                    currposrate = s * currrealrate + (1 - r) * (1 - currrealrate)  # z for this sample
                    result = np.random.binomial(1, p=currposrate)
                    Ntilde[i, j] += 1
                    Ytilde[i, j] += result
                # We have a new set of data d_tilde
                Nomega = priordatadict['N'] + Ntilde
                Yomega = priordatadict['Y'] + Ytilde

                postdatadict = priordatadict.copy()
                postdatadict['N'] = Nomega
                postdatadict['Y'] = Yomega

                # Writes over previous MCMC draws
                postdatadict.update({'numPostSamples':numpostdraws})
                postdatadict = methods.GeneratePostSamples(postdatadict)

                # Get the Bayes estimate
                currEst = bayesEst(postdatadict['postSamples'], lossdict['scoreDict'])

                sumloss = 0
                for currsampind, currsamp in enumerate(postdatadict['postSamples']):
                    currloss = loss_pms(currEst, currsamp, lossdict['scoreFunc'], lossdict['scoreDict'],
                                        lossdict['riskFunc'], lossdict['riskDict'], lossdict['marketVec'])
                    sumloss += currloss
                avgloss = sumloss / len(postdatadict['postSamples'])

                # Append to loss storage vector
                currlossvec.append(avgloss)
                if printUpdate==True:
                    print(designnames[designind] + ', ' + 'omega ' + str(omega) + ' complete')

            lossveclist.append(currlossvec)  # Add the loss vector for this design
        # END IF FOR MCMC

        elif method == 'MCMCexpect':
            for omega in range(omeganum):
                # Grab a draw from the prior
                currpriordraw = priordraws[randinds[omega]]  # [SN rates, TN rates]

                # Initialize Ntilde and Ytilde
                Ntilde = sampMat.copy()
                Ytilde = np.zeros(shape=priordatadict['N'].shape)

                for currTN in range(numTN):
                    for currSN in range(numSN):
                        currzProb = zProbTr(currTN,currSN,numSN,currpriordraw,priordatadict['diagSens'],priordatadict['diagSpec'])
                        if type[0] == 'trace':
                            currTerm = sampMat[currTN][currSN]*currzProb
                        elif type[0] == 'test node':
                            currTerm = sampMat[currTN]*type[1][currTN][currSN]*currzProb
                        Ytilde[currTN][currSN] = currTerm

                # We have a new set of data d_tilde
                Nomega = priordatadict['N'] + Ntilde
                Yomega = priordatadict['Y'] + Ytilde

                postdatadict = priordatadict.copy()
                postdatadict['N'] = Nomega
                postdatadict['Y'] = Yomega

                # Writes over previous MCMC draws
                postdatadict.update({'numPostSamples':numpostdraws})
                postdatadict = methods.GeneratePostSamples(postdatadict)

                # Get the Bayes estimate
                currEst = bayesEst(postdatadict['postSamples'], lossdict['scoreDict'])

                sumloss = 0
                for currsampind, currsamp in enumerate(postdatadict['postSamples']):
                    currloss = loss_pms(currEst, currsamp, lossdict['scoreFunc'], lossdict['scoreDict'],
                                        lossdict['riskFunc'], lossdict['riskDict'], lossdict['marketVec'])
                    sumloss += currloss
                avgloss = sumloss / len(postdatadict['postSamples'])

                # Append to loss storage vector
                currlossvec.append(avgloss)
                if printUpdate==True:
                    print(designnames[designind] + ', ' + 'omega ' + str(omega) + ' complete')

            lossveclist.append(currlossvec)  # Add the loss vector for this design
        # END ELIF FOR MCMCEXPECT

        elif method == 'weights': # Weight each prior draw by the likelihood of a new data set
            wts = []
            for currpriordraw in priordraws:
                TNsamps = sampMat.copy()
                # Initialize Ntilde and Ytilde
                Ntilde = np.zeros(shape=priordatadict['N'].shape)
                Ytilde = Ntilde.copy()
                while np.sum(TNsamps) > 0.: # Generate new data set
                    # Go to first non-empty row of TN samps
                    i, j = 0, 0
                    while np.sum(TNsamps[i]) == 0:
                        i += 1
                    if type[0] == 'trace':
                        # Go to first non-empty column of this row
                        while TNsamps[i][j] == 0:
                            j += 1
                        TNsamps[i][j] -= 1
                    if type[0] == 'test node':
                        # Pick a supply node according to Qest
                        j = choice([i for i in range(numSN)], p=type[1][i] / np.sum(type[1][i]).tolist())
                        TNsamps[i] -= 1
                    # Generate test result
                    currTNrate = currpriordraw[numSN + i]
                    currSNrate = currpriordraw[j]
                    currrealrate = currTNrate + (1 - currTNrate) * currSNrate  # z_star for this sample
                    currposrate = s * currrealrate + (1 - r) * (1 - currrealrate)  # z for this sample
                    result = np.random.binomial(1, p=currposrate)
                    Ntilde[i, j] += 1
                    Ytilde[i, j] += result

                # Use new data to get a weight for the current prior draw
                currwt = 1.
                for currTN in range(numTN):
                    for currSN in range(numSN):
                        currz = zProbTr(currTN,currSN,numSN,currpriordraw,sens=s,spec=r)
                        currn, curry = int(Ntilde[currTN,currSN]), int(Ytilde[currTN,currSN])
                        term1 = (currz**curry) * ((1-currz)**(currn-Ytilde[currTN,currSN])) * comb(currn, curry)
                        term2 = np.exp(methods.Tracked_LogPost(sps.logit(currpriordraw),priordatadict['N'],priordatadict['Y'],
                                                        priordatadict['diagSens'],priordatadict['diagSpec'],
                                                        priordatadict['prior']))

                        currwt = currwt * (term1 * term2)

                wts.append(currwt)

            # Normalize weights; this permits comparison among different methods
            wtsnorm = [wts[i] / np.sum(wts) for i in range(len(wts))]
            # Obtain Bayes estimate
            currest = bayesEstAdapt(priordraws,wtsnorm,lossdict['scoreDict'],printUpdate=False)
            # Sum the weighted loss under each prior draw
            sumloss = 0
            for currsampind, currsamp in enumerate(priordraws):
                currloss = loss_pms(currest,currsamp, lossdict['scoreFunc'], lossdict['scoreDict'],
                                    lossdict['riskFunc'], lossdict['riskDict'], lossdict['marketVec'])
                sumloss += currloss * wtsnorm[currsampind]
            lossveclist.append(sumloss)  # Add the loss vector for this design
            if printUpdate == True:
                print(designnames[designind] + ' complete')
        # END ELIF FOR WEIGHTS

        elif method == 'weights2': # Weight each prior draw by the likelihood of a new data set
            ###### ONLY ONE TRACE ALLOWED ######
            TNsamps = sampMat.copy()
            TNind,SNind = 0,0
            while np.sum(TNsamps[TNind]) == 0:
                TNind += 1
            while np.sum(TNsamps[:,SNind]) == 0:
                SNind += 1
            Ntilde = np.zeros(shape=priordatadict['N'].shape)
            Ntilde[TNind,SNind] += numtests
            sumloss = 0
            for dtilde in range(numtests+1):
                wts = []
                Ytilde = np.zeros(shape=priordatadict['N'].shape)
                Ytilde[TNind,SNind] += dtilde
                for currpriordraw in priordraws:
                    # Use new data to get a weight for the current prior draw
                    currz = zProbTr(TNind,SNind,numSN,currpriordraw,sens=s,spec=r)
                    currwt = (currz**dtilde) * ((1-currz)**(numtests-dtilde)) * comb(numtests, dtilde)
                    wts.append(currwt)

                # Obtain Bayes estimate
                currest = bayesEstAdapt(priordraws,wts,lossdict['scoreDict'],printUpdate=False)
                # Sum the weighted loss under each prior draw
                for currsampind, currsamp in enumerate(priordraws):
                    currloss = loss_pms(currest,currsamp, lossdict['scoreFunc'], lossdict['scoreDict'],
                                        lossdict['riskFunc'], lossdict['riskDict'], lossdict['marketVec'])
                    sumloss += currloss * wts[currsampind]
            lossveclist.append(sumloss / len(priordraws))  # Add the loss vector for this design
            if printUpdate == True:
                print(designnames[designind] + ' complete')
        # END ELIF FOR WEIGHTS2

        elif method == 'approx': # We are using approximation; use expected value of data
            # todo: REST OF SECTION NEEDS TO BE ADAPTED FOR UNTRACKED
            postDensWts = []  # Initialize our weights for each vector of SFP rates
            for currdraw in priordatadict['postSamples']: #Iterate through each prior draw
                '''
                currWt = 0
                for currTN in range(numTN):
                    for currSN in range(numSN):
                        currzProb = zProbTr(currTN,currSN,numSN,currdraw,priordatadict['diagSens'],priordatadict['diagSpec'])
                        currzTerm = np.log(currzProb)*currzProb + np.log(1-currzProb)*(1-currzProb)
                        if type[0] == 'trace':
                            currTerm = sampMat[currTN][currSN]*currzTerm
                        elif type[0] == 'test node':
                            currTerm = sampMat[currTN]*type[1][currTN][currSN]*currzTerm
                        currWt += currTerm
                postDensWts.append(np.exp(currWt))  # Want the likelihood; currWt signifies the log-likelihood
                '''
                '''
                currWt = 1
                for currTN in range(numTN):
                    for currSN in range(numSN):
                        currzProb = zProbTr(currTN, currSN, numSN, currdraw, priordatadict['diagSens'],
                                            priordatadict['diagSpec'])
                        currzTerm = (currzProb**currzProb)*((1-currzProb)**(1-currzProb))
                        if type[0] == 'trace':
                            currTerm =  currzTerm**(sampMat[currTN][currSN])
                        elif type[0] == 'test node':
                            currTerm =  currzTerm**(sampMat[currTN] * type[1][currTN][currSN])
                        currWt = currWt*currTerm
                '''
                currWt = 1
                for currTN in range(numTN):
                    for currSN in range(numSN):
                        currzProb = zProbTr(currTN, currSN, numSN, currdraw, priordatadict['diagSens'],
                                            priordatadict['diagSpec'])
                        if type[0] == 'trace':
                            currN = sampMat[currTN][currSN]
                            currY = currzProb * currN
                        elif type[0] == 'test node':
                            roundRow = roundAlg(type[1][currTN],sampMat[currTN])
                            currN = roundRow[currSN]
                            currY = currzProb * currN
                        currYflr, currYceil = math.floor(currY), math.ceil(currY)
                        yRem = currY - currYflr
                        flrTerm = (currzProb ** currYflr) * ((1 - currzProb) ** (currN - currYflr)) * comb(int(currN), currYflr)
                        ceilTerm = (currzProb ** currYceil) * ((1 - currzProb) ** (currN - currYceil)) * comb(int(currN), currYceil)
                        currTerm = (1-yRem) * flrTerm + (yRem) * ceilTerm
                        currWt = currWt * currTerm

                postDensWts.append((currWt)) # Want the likelihood

            # Nomralize the weights to sum to the number of prior draws
            postWtsSum = np.sum(postDensWts)
            postDensWts = [postDensWts[i]*len(priordatadict['postSamples'])/postWtsSum for i in range(len(postDensWts))]
            # Get the Bayes estimate
            currEst = bayesEstAdapt(priordatadict['postSamples'], postDensWts, lossdict['scoreDict'],printUpdate=printUpdate)
            #currEst = bayesEst(priordatadict['postSamples'], lossdict['scoreDict'])
            # Now average the loss across prior draws
            sumloss = 0
            for currdrawind, currdraw in enumerate(priordatadict['postSamples']):
                currloss = postDensWts[currdrawind] * loss_pms(currEst, currdraw, lossdict['scoreFunc'],
                                                               lossdict['scoreDict'], lossdict['riskFunc'],
                                                               lossdict['riskDict'], lossdict['marketVec'])
                sumloss += currloss
            avgloss = sumloss/len(priordatadict['postSamples'])
            lossveclist.append(avgloss)
            if printUpdate==True:
                print(designnames[designind] + ' complete')
        # END ELIF FOR APPROXIMATION
    # END FOR FOR DESIGNS

    return lossveclist

def zProbTr(tnInd, snInd, snNum, gammaVec, sens=1., spec=1.):
    '''Provides consolidated SFP probability for the entered TN, SN indices; gammaVec should start with SN rates'''
    zStar = gammaVec[snNum+tnInd]+(1-gammaVec[snNum+tnInd])*gammaVec[snInd]
    return sens*zStar+(1-spec)*zStar

def testApproximation():
    numTN, numSN = 3, 2
    # Designate testing accuracy
    s, r = 1., 1.
    # Designate the true SFP rates
    trueSFPrates = [0.5, 0.05, 0.1, 0.08, 0.02]

    # Generate a supply chain
    exampleDict = util.generateRandDataDict(numImp=numSN, numOut=numTN, diagSens=s, diagSpec=r, numSamples=0,
                                            dataType='Tracked', randSeed=86, trueRates=trueSFPrates)
    exampleDict[
        'diagSens'] = s  # bug from older version of logistigate that doesn't affect the data but reports s,r=0.9,0.99
    exampleDict['diagSpec'] = r
    # Update dictionary with needed summary vectors
    exampleDict = util.GetVectorForms(exampleDict)
    # Populate N and Y with numbers from paper example
    exampleDict['N'] = np.array([[6, 11], [12, 6], [2, 13]])
    exampleDict['Y'] = np.array([[3, 0], [6, 0], [0, 0]])
    # Add a prior
    exampleDict['prior'] = methods.prior_normal()
    # MCMC settings
    exampleDict['MCMCdict'] = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    exampleDict['importerNum'] = numSN
    exampleDict['outletNum'] = numTN

    # Generate posterior draws
    numdraws = 200000
    exampleDict['numPostSamples'] = numdraws
    exampleDict = methods.GeneratePostSamples(exampleDict)

    '''
    # How many unique draws?
    draws1 = exampleDict['postSamples'].copy()
    exampleDict = methods.GeneratePostSamples(exampleDict)
    draws2 = exampleDict['postSamples'].copy()
    combDraws = np.concatenate((draws1,draws2),axis=0)
    combDrawsUnique = np.unique(combDraws,axis=0)
    len(np.unique(draws1,axis=0))
    len(combDrawsUnique)
    #if len(uniqueDraws)<numdraws: # Conduct more MCMC sampling
    #    newDrawNum = round((numdraws-len(uniqueDraws))*(numdraws/len(uniqueDraws))*1.1)
    #    exampleDict['numPostSamples'] = newDrawNum
    #    exampleDict = methods.GeneratePostSamples(exampleDict)
    # Look again
    #nextDraws = np.unique(exampleDict['postSamples'],axis=0)
    #combDraws = np.concatenate((uniqueDraws,nextDraws),axis=0)
    '''

    # Specify the design
    design = np.array([[0., 0.], [1., 0.], [0., 0.]])

    # Specify the score, risk, market
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design]
    designNames = ['Design 1']
    numtests = 20
    omeganum = 200
    #random.seed(35)
    randinds = random.sample(range(numdraws), omeganum)

    # MCMC
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'], randinds=randinds,numpostdraws=1000)
    print(lossveclist)
    # MCMCexpect
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'], randinds=randinds, method='MCMCexpect',
                                   numpostdraws=1000)
    print(lossveclist)
    # APPROXIMATION
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'], method='approx', printUpdate=False)
    print(lossveclist)
    # WEIGHTS
    for nextn in [5, 10, 15, 20, 25]:
        lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=nextn,
                                   omeganum=omeganum, type=['trace'], method='weights2', printUpdate=False)
        print(lossveclist)






    '''
    # MCMC; numdraws = 1000; omeganum=200, design = design = np.array([[0., 0.], [1., 0.], [0., 0.]])
    # numtests = 0
    lossveclist= [[0.16133017650379533, 0.16035294394907038, 0.1595924662032086, 0.15487830752617793, 0.15650447660787442, 0.15794549467836672, 0.15917288800908097, 0.15834339189737032, 0.15493891974935164, 0.15932141084511853, 0.14518335631454887, 0.15928931278081013, 0.16089537842948348, 0.1695358287264035, 0.17429801319872945, 0.1649763540898995, 0.165626882220875, 0.16089808644869735, 0.1540820532342465, 0.16789816247916398, 0.16138967077311822, 0.16604933602773692, 0.15132286916730903, 0.16433498460548043, 0.1548912271335561, 0.1622247918129544, 0.1670930133645804, 0.15843298354703372, 0.16554671684985706, 0.16869287937739286, 0.16383735818357528, 0.1601698963552796, 0.16553211936245854, 0.1670322307188803, 0.15588599516567084, 0.16570287109150553, 0.1542286367329047, 0.15401544574931406, 0.16334519033571923, 0.16456642842354008, 0.15950392251085885, 0.15877604797395653, 0.1575090347172811, 0.16442085707423137, 0.15600988208722238, 0.16143365840699972, 0.1725031804954956, 0.1548227752874847, 0.15432543190194115, 0.15290411414469304, 0.1625801006923724, 0.15463613819683625, 0.15561204047004454, 0.16034331083329412, 0.16261595034868942, 0.15881294536875173, 0.15558186245080063, 0.1662634390944614, 0.15966790729510807, 0.1519194986845735, 0.16555319604390706, 0.16064199628148199, 0.15487437683214933, 0.15639219447856684, 0.15742991151562524, 0.1661917424997767, 0.15738755939071625, 0.1594045037631456, 0.1719244412818409, 0.16268463407298475, 0.15067488875094834, 0.16020858604961546, 0.1592092411768965, 0.16319829137149008, 0.14573169806031924, 0.1665271959712879, 0.1622476156780807, 0.1649281610281695, 0.16433807296406988, 0.17385406009343038, 0.15453527907254289, 0.16886009018006176, 0.15826188626709292, 0.15664594696469547, 0.16601974368588895, 0.15865293334082356, 0.1557177489183188, 0.14944152746955677, 0.1671752602689376, 0.1610647418390835, 0.1610231928629766, 0.17018978467209805, 0.1638743465282651, 0.1556226178730051, 0.15329101886420485, 0.1591885181950829, 0.16600502283371354, 0.1605672769296792, 0.1575689242639313, 0.16212376255736535, 0.15779354119999683, 0.15993998306841162, 0.15808469033416367, 0.17065255451604908, 0.17203137814649103, 0.16313677581796568, 0.1481915257446885, 0.15624521180709855, 0.16092626752254352, 0.1638024703069324, 0.1510903326718172, 0.15922918180490878, 0.15670635651763457, 0.15481609853695277, 0.15669606724229013, 0.16031991456522512, 0.16088660040143754, 0.16385320710770648, 0.16796160852603736, 0.15459568233873106, 0.1621003077819244, 0.16338172884227875, 0.15671720996231078, 0.1567704653898434, 0.17214732743600758, 0.1691274701453852, 0.1680922656705758, 0.16124480503465366, 0.1584916283792435, 0.16156811503153465, 0.16291600504006074, 0.16221966025654508, 0.16825141534065627, 0.16061561719332765, 0.15875113752365289, 0.1562863670532987, 0.16407261247061478, 0.15176119846758998, 0.16821109499654527, 0.1631305082825532, 0.15996883083774774, 0.16961224284542958, 0.16241966667430655, 0.15070891143348633, 0.15697122060165575, 0.16283571728226173, 0.16249925959486367, 0.15536053790635976, 0.16343033084216146, 0.16998574401357167, 0.1612078365642256, 0.1601739613849356, 0.1588154545106319, 0.1585312223706728, 0.1588294512575155, 0.15967376527466817, 0.16707822575275227, 0.1690830241089197, 0.16044046643450197, 0.1688400518825839, 0.16105387652034195, 0.1632952392558217, 0.16579846628641964, 0.1539571135451126, 0.16796617527983237, 0.15716959592255395, 0.15587355281977683, 0.1534427052411982, 0.15410402035521967, 0.16749609528849954, 0.15547111101288763, 0.15159449803528477, 0.15623792670569955, 0.1547549044554394, 0.15791768346033594, 0.15813903640418397, 0.15823132340446167, 0.1548611982116423, 0.152098155028846, 0.15697310032703501, 0.16612284104409034, 0.16547233470663072, 0.17609506785479667, 0.15830730547763994, 0.16761277811845013, 0.1589530354532047, 0.14981105441307604, 0.1583311813159989, 0.16725862784816542, 0.15511606794270974, 0.1574082682980217, 0.15516593658459538, 0.1605584261856954, 0.1594909920477787, 0.17171756145962197, 0.15978283121255415, 0.15759668019446804, 0.16427578699030096, 0.15879074753830333, 0.15605348792721047]]
    [0.1597614327786745, 0.1613232845995245]
    
    # numtests = 5
    lossveclist = [[0.16040451705744033, 0.15031121945729578, 0.15972071154058132, 0.15736804661824655, 0.1576188661477262, 0.15495285232598813, 0.1509323016699268, 0.14942876163075636, 0.1535630231472643, 0.15169698325223488, 0.15144371246652447, 0.1645409228565071, 0.1555039516566019, 0.15279244386045554, 0.1550162928548847, 0.16115375010661348, 0.15933951489319723, 0.15387171352176404, 0.15152500639277547, 0.1617533964735161, 0.14043732226453995, 0.16070328779816553, 0.15675473068482282, 0.1563746548477993, 0.15121158272870427, 0.1617000882791677, 0.15773665717537738, 0.1534982568200604, 0.15162530148421857, 0.1479363335232301, 0.157682195476292, 0.14842543537277636, 0.16407308473285248, 0.1572656015470402, 0.1550631073361681, 0.1591075357706297, 0.15339062756379962, 0.1598497698685347, 0.15670980642316495, 0.15829786616947075, 0.16375144767993255, 0.15237576693713925, 0.15548888787761886, 0.15608945044919387, 0.1557164475888886, 0.15506973501748614, 0.14735649584995225, 0.15945736851468514, 0.16091994101248222, 0.16027234645688207, 0.16204078223117765, 0.15585999575211484, 0.15393295485740838, 0.1585270866792063, 0.15208260829316278, 0.1536974637146511, 0.153255173737287, 0.14806391133485491, 0.15683398268339596, 0.14579543285053226, 0.159960745806332, 0.15803288666773715, 0.15503812476304915, 0.15135376598186293, 0.15645240637921504, 0.15677340507981102, 0.151681259461289, 0.15015147785005425, 0.16254394780963602, 0.15698766641778314, 0.14808009790756274, 0.16125797501730296, 0.1573160496953113, 0.1550396184470147, 0.14646551458097443, 0.1577506177715445, 0.15958275436438174, 0.1593843385957193, 0.1546936793779228, 0.1540406356617238, 0.15028392686047307, 0.15548274920107752, 0.14911633316913717, 0.14794852855180504, 0.15660665472310226, 0.14905340479012985, 0.14952199184076995, 0.15952922326331984, 0.14631301145426287, 0.15884776326876607, 0.15232868727049856, 0.15677009034603986, 0.1545063436261434, 0.15126124088326784, 0.15108226774976793, 0.15423398811938188, 0.15035268079944514, 0.15144850151271635, 0.15916067050472216, 0.16022372480291616, 0.15594473294352623, 0.1678923340270207, 0.1524234863290381, 0.14966658692993076, 0.15328248361424, 0.14829067683697442, 0.16226987867951645, 0.15318996645023572, 0.15849551966034292, 0.1563525988493093, 0.15414719830162116, 0.16077703048456296, 0.1636999551074953, 0.1530484739450913, 0.149568456124276, 0.14914594458079886, 0.15484876752303403, 0.1665527694667707, 0.15807700158749463, 0.1494596140910415, 0.15346740984665083, 0.16197217386009072, 0.15644842920138796, 0.1660532822644248, 0.16051312159675002, 0.15957350420203195, 0.14854114645467248, 0.15578145921228126, 0.15623943905391383, 0.1632891453206, 0.15228211375405157, 0.1679008544542775, 0.15092003536477183, 0.15296722903493593, 0.1557213105355211, 0.14816536977371209, 0.15977850185411482, 0.14757215250822447, 0.1596965275618382, 0.1572877862312714, 0.15538482953230762, 0.1531060636384303, 0.15713316808290695, 0.15071370903604916, 0.15391796597357973, 0.15649689751959808, 0.15729719065384415, 0.1586722776068459, 0.15655911472460793, 0.1650271151280421, 0.16321362229939954, 0.15478590872304118, 0.15858406585834076, 0.15637815256328588, 0.1584136806634129, 0.1566249582190673, 0.15778351378110356, 0.16244575436629413, 0.14550194278182252, 0.15166614896121455, 0.15234095845085732, 0.1506969686459515, 0.16269017321279902, 0.15246856291775582, 0.15516160518165947, 0.15914058892305438, 0.1593545466204265, 0.15779874992013257, 0.15786653064798642, 0.15812825128086472, 0.16687716507540526, 0.16441307860489293, 0.15423553485918962, 0.1582562049909437, 0.15453968299450493, 0.1576340249538876, 0.15609340704680763, 0.15929621290794344, 0.16192278051664213, 0.15962275335890277, 0.14876692024831872, 0.15359448983632656, 0.14859466859743525, 0.15384065539670522, 0.15743463716339265, 0.15479628447509863, 0.1595982744130878, 0.15883876092612717, 0.15709681506032505, 0.15894812668519462, 0.15718956306111156, 0.15764773730021459, 0.15680675875464223, 0.14511485380597788, 0.14879831377007516, 0.16262976827643333, 0.15313636258123056, 0.15955331415363108, 0.1520202334994558, 0.16009204782600603]]
    [0.15506736184284828, 0.15641337994076746]
    
    # numtests = 10
    lossveclist = [[0.14673825948185226, 0.15178433701332245, 0.1497370325324721, 0.15124081747639304, 0.1462326046157289, 0.14847561404495713, 0.1496673049550425, 0.16410348431275595, 0.1450604326857086, 0.1520017035356987, 0.15421832722842174, 0.14565085177992304, 0.1503889025206848, 0.15425757433693213, 0.15669199687702604, 0.15768006785797622, 0.1543122758798466, 0.15841927412358292, 0.15603383244122507, 0.16292667640092032, 0.14969584138705197, 0.13928596274269975, 0.14811605364333522, 0.15559826334890478, 0.15114753228231584, 0.15079635471979363, 0.16629541487289135, 0.14837555746549716, 0.15097870060592256, 0.1548098277020026, 0.13985952358608342, 0.16022269366764205, 0.15266344331525006, 0.15111863555045202, 0.15167137265481817, 0.1599720561166862, 0.14631539588138764, 0.1528624992955047, 0.16112641085614043, 0.14184095903761115, 0.1513631374666895, 0.14360758225932155, 0.1603451588018429, 0.14309239153388348, 0.14946286808112508, 0.15343161523264778, 0.15704008501977418, 0.15852072346217577, 0.15026692444377138, 0.16396867566665782, 0.1504906210317537, 0.1470999188237132, 0.15216023738387563, 0.15831814713825165, 0.14900269113630407, 0.15409899758000337, 0.1539348035565592, 0.15218899468847968, 0.15215136377073418, 0.1494491909888216, 0.14535223073900116, 0.14683770057231446, 0.151206655702801, 0.1461183107033704, 0.15392763367324797, 0.15014247964488378, 0.15438863427516347, 0.14936009382758156, 0.1610716968476948, 0.15235491263306683, 0.15798009182649722, 0.15686204930998685, 0.14489953266009026, 0.153296512547374, 0.15058428200231105, 0.14820972833679494, 0.15575136413846827, 0.14330412489722702, 0.1555202778094492, 0.1603366558278284, 0.15639814686391276, 0.14739935963855774, 0.15524021128803547, 0.14840808928018379, 0.15203822954335752, 0.14539016689890055, 0.15269354349713735, 0.15484945977662862, 0.15601094701854035, 0.1469904267308603, 0.14646579578010316, 0.15937697667731687, 0.16029436671399072, 0.16027619548122646, 0.1518478934967677, 0.14748060661155865, 0.14825438426276322, 0.15093683960134874, 0.15167724826397128, 0.1504765098710665, 0.13765887012754818, 0.15457811061945412, 0.1529553289416999, 0.1546273986713626, 0.15297555035135135, 0.15195860290695548, 0.14330152695134166, 0.1423078549993534, 0.1462138787734364, 0.15841381111159764, 0.15233335108761387, 0.14698202935053936, 0.14974203706900058, 0.1427480830466954, 0.14737807532123126, 0.16166694861650643, 0.14931072810046872, 0.1496253891790005, 0.14982307205579476, 0.15461833330550634, 0.1450022149193867, 0.15180082731880082, 0.15338573444985606, 0.14518127662141367, 0.1504536109602005, 0.14842652143045926, 0.14848299449139535, 0.1570498085652627, 0.16468780293262728, 0.15479890334360963, 0.1547543360342835, 0.1572630059565484, 0.1489099018113888, 0.15901068958331593, 0.1567904138543914, 0.15317665915748288, 0.1450176224333364, 0.15555632241739942, 0.15660816106839315, 0.15727283463354996, 0.15887720573952047, 0.1472505685949653, 0.15866903538721758, 0.15292724683366957, 0.15006588542121319, 0.1566011994452853, 0.1565840341951643, 0.1474313829676284, 0.15754521533885407, 0.1601171592913776, 0.14476130564578263, 0.15416335008685783, 0.15842935552560933, 0.14329400105848325, 0.1481173194355913, 0.15491392079243999, 0.15925294228738243, 0.1496022669401441, 0.15658123863370227, 0.1426675173400567, 0.15186483781648666, 0.15533425284164348, 0.1443753394203832, 0.16209518741894083, 0.14953170923381354, 0.15004618018240048, 0.15741738776560463, 0.15078939514473028, 0.14210167523177175, 0.1512685607413724, 0.14940933182386879, 0.1590451111163163, 0.14918508498448346, 0.14750300642285924, 0.1470894455223877, 0.15004235788626036, 0.15227124375446308, 0.16398104713338466, 0.14986203917712881, 0.14888308600956016, 0.14810555282926438, 0.15994364796761693, 0.15206247906576778, 0.14231566606861648, 0.15110354833818712, 0.14968244518295742, 0.1454354426879137, 0.15135864488718462, 0.1456829054533047, 0.15342052196378791, 0.14241513910501255, 0.15009935234622845, 0.14678131386651677, 0.14720793316121636, 0.14148274330834604, 0.15044491478780678, 0.15015360148451345, 0.15938788894179895, 0.1562892656431987, 0.15582625465578515]]
    [0.15108957430579725, 0.15261417246493894]
    
    # numtests = 15
    lossveclist = [[0.1452205806405535, 0.1436751024574084, 0.14473642152298782, 0.14210356107137717, 0.14346030655353448, 0.15016067348269968, 0.14722431105754646, 0.14369718736119225, 0.1455971576855333, 0.14208701480770572, 0.15418500365246446, 0.1563811432939331, 0.14870370346373987, 0.14891146573349764, 0.15173559821544982, 0.15567797609055278, 0.14767281684645076, 0.14085793123576756, 0.14212297724196066, 0.1473550845169293, 0.1513789412932941, 0.14783544286953215, 0.1456287217319883, 0.14729902994871147, 0.15023866597865096, 0.1465062436963691, 0.15198811313087263, 0.14358196962671643, 0.1460439454491272, 0.1396721316418116, 0.14803954019201068, 0.14112542642231057, 0.1507532531436912, 0.14648753987553215, 0.14343293472908464, 0.14728953778288892, 0.14900381875580623, 0.14655966356405029, 0.14266994371158429, 0.15366477320310667, 0.14397930972646739, 0.1541886053947848, 0.15949375148351594, 0.13519982259131444, 0.14451398996141637, 0.14563701189042302, 0.1410218795382595, 0.15094043823438663, 0.14451081753434974, 0.14710871689836932, 0.1398457129010194, 0.15169991061142293, 0.14967031290410676, 0.1543673186522482, 0.14143377394271933, 0.1408350397814133, 0.14623755535813182, 0.15058952776001303, 0.14441335032085148, 0.14884431673601053, 0.14998240696566073, 0.1424002513140289, 0.16387767903316802, 0.14516870764969528, 0.13919147062864842, 0.16080883593228598, 0.1474072688180918, 0.13982426906216688, 0.15957404448530224, 0.14314720293640473, 0.14876703077267833, 0.145196498181258, 0.15241115137012312, 0.1504081672651254, 0.1486967468570563, 0.14324822274980786, 0.1482641487723937, 0.15303496893616828, 0.1555331200907896, 0.15296543610454838, 0.1551860390534079, 0.14568494081079855, 0.1504116531073036, 0.14398321227152558, 0.15548538267079776, 0.14618816088792982, 0.14864475079029446, 0.14840759929310857, 0.15035653317807848, 0.1540870875641113, 0.14522558622939463, 0.14532617382859495, 0.15075132947551134, 0.1405918178197357, 0.15292877864888252, 0.13930405520013758, 0.14486608887122032, 0.14674703301389383, 0.1419779060423821, 0.15065117561409389, 0.13767397357261607, 0.14437746521491948, 0.14946311500507573, 0.14272831662626603, 0.14232316148516208, 0.151620845766245, 0.145001461085421, 0.14253631663934926, 0.1444634571893404, 0.14586532351348286, 0.1458251717498947, 0.1407370525762607, 0.1621599749324134, 0.15058020825431134, 0.15032882672574152, 0.15493501480127958, 0.1427589864363228, 0.14350341764331717, 0.14077581858102206, 0.1531688042117255, 0.14699053892297925, 0.13918923118060936, 0.15043653617469918, 0.1472512452689345, 0.14693289954716865, 0.14534737736456496, 0.15741918691107123, 0.1474849988748812, 0.1529923148045982, 0.14492303686667096, 0.15232912217599048, 0.14910235831932164, 0.14775038677097044, 0.14952411113157488, 0.14927920595294494, 0.1528363707617866, 0.14521298160430027, 0.14242936759578215, 0.1452376925546005, 0.14904807993777355, 0.14588014320801512, 0.14188885226041167, 0.15317679525588693, 0.14289637211715076, 0.1386279069345688, 0.1420661462679872, 0.1459175229897949, 0.15151681694239302, 0.14373231245079596, 0.14746026157118583, 0.15075976512703546, 0.1377699293792378, 0.14596620703669225, 0.160115625285284, 0.14559813057566595, 0.13406905281901899, 0.15541206053300066, 0.15707877675313664, 0.1450111985709152, 0.141606497413088, 0.1589770237308354, 0.15562463536588822, 0.1647384157003106, 0.16426713152107553, 0.14965153249179344, 0.14219548485409145, 0.14270858408570347, 0.1456735626413548, 0.14420127167460786, 0.14755392627403904, 0.1409811322716588, 0.1403337199494616, 0.1538023788687809, 0.1445042935514373, 0.14138097435925137, 0.13981271613955185, 0.1447434816267453, 0.1506443209465673, 0.14942713517457445, 0.1475376443201465, 0.15702858063945738, 0.14945836579102073, 0.14684687042851607, 0.1469421306308332, 0.14723413490663353, 0.143573888835764, 0.1501892497232245, 0.1385786797916607, 0.15411270462211837, 0.13812777710125917, 0.1489167482828953, 0.1467765084266721, 0.14178019389685867, 0.14728147066883923, 0.14765287321645423, 0.14151340651827243, 0.1451253653780937, 0.1482326287527276, 0.14435925097913682, 0.13745358492720766]]
    [0.1465841760151503, 0.14812630053969397]
    
    # numtests = 20
    lossveclist = [[0.14230394892810258, 0.13056564810528493, 0.14219914382655546, 0.14657644431629674, 0.1464494274696762, 0.1354846306177635, 0.1376244041434003, 0.1466929109224942, 0.1489783419050483, 0.14509148431525284, 0.14364381532434112, 0.15374136885696288, 0.13877002346600242, 0.14979563967206846, 0.14680903103722678, 0.13823772327164344, 0.14506723876505284, 0.16101095453681188, 0.1353298978374574, 0.14859025051313013, 0.14110769255629818, 0.1443847855565694, 0.14375683851884938, 0.15064563131049608, 0.13622529992330482, 0.1436745661108125, 0.14183121236533203, 0.14729318704186192, 0.14105213834232, 0.14427684145290667, 0.13923713617185815, 0.14608075460970157, 0.1483599150489303, 0.1562432680209362, 0.15077540768199987, 0.1475333949572004, 0.1592924342319322, 0.14281243511474023, 0.15429048496828057, 0.14812295006431836, 0.14507917374256815, 0.14266053898973036, 0.15138256685718177, 0.13807263115443316, 0.15768876459908374, 0.1481115279445833, 0.14058339194317898, 0.15087570767754677, 0.14441921997470325, 0.13777588415719957, 0.14793664500697287, 0.1477087053252295, 0.14994392127084585, 0.15705587983675856, 0.1387056715232942, 0.14812456079217723, 0.13857615455570568, 0.15390062084573328, 0.13814983862707272, 0.15302323372366225, 0.14865689898577744, 0.13967209897518482, 0.14278176872419476, 0.15059555250632897, 0.15081401634034539, 0.14282501791214755, 0.14164199840503905, 0.14067421699684665, 0.15434574922973002, 0.13739719213985485, 0.15474644428426879, 0.1471228865283066, 0.1476779281107017, 0.14824945381527782, 0.147478532078333, 0.14788436113113934, 0.15193778090327414, 0.13974799373858907, 0.14987120716621766, 0.1458925096814678, 0.15224828471962618, 0.154674198630451, 0.14368534617975165, 0.13899819269516053, 0.14412039983926536, 0.1474193556035782, 0.14372673606097783, 0.14518627368136336, 0.14064931854900534, 0.14907283254722534, 0.15979453682501665, 0.14057420941098878, 0.14795038028350432, 0.13643572479610555, 0.1381927502504615, 0.13204324493030975, 0.1483997688537371, 0.12940550576188314, 0.14868210830222967, 0.14852030032637362, 0.13655678274296104, 0.14994991975670016, 0.14525429702070486, 0.16134285126845374, 0.14570366427850406, 0.15453439623681908, 0.151281457660853, 0.15487166743548492, 0.14790900163503723, 0.1542427719315962, 0.14967134247468059, 0.1358823190161352, 0.13717296655371902, 0.14232229281288855, 0.1452023481327636, 0.1491819021545491, 0.1355971173085469, 0.14168207856447254, 0.14764898153213463, 0.14976887855542245, 0.14819204971673589, 0.13993904919592148, 0.14544022042809088, 0.15223376005540284, 0.1485213563130287, 0.1559787728444775, 0.14851864214828275, 0.14144558795346118, 0.14276347614992368, 0.14475503022572508, 0.1529220546254517, 0.14947247003530578, 0.15414405156135114, 0.1481369931585248, 0.15668329994071112, 0.14466842253388643, 0.12835690930068588, 0.14904141605868598, 0.14544797927152303, 0.14187326451692583, 0.1527336638293154, 0.13669903275681322, 0.14415960644574694, 0.1397097315530591, 0.14332283981843502, 0.14492643046229925, 0.14618667396809562, 0.15116736899266464, 0.14262786249292503, 0.15362668602692883, 0.14350047692968027, 0.1500449554523574, 0.15259010715785298, 0.14660284566555828, 0.1455450981883858, 0.13896209008319368, 0.15301467881491787, 0.14410132103031476, 0.14328646876594298, 0.14300586135329144, 0.15624694749866247, 0.14487585420199814, 0.15892036927954353, 0.1518417638882754, 0.1498768293805164, 0.13814061658249677, 0.14122713499692494, 0.15161769004588346, 0.1408284156852228, 0.1415733225317588, 0.15094699424736785, 0.14291589836880658, 0.13894200123717687, 0.14721028258178404, 0.15224101710199905, 0.14156781934720158, 0.15102552138462932, 0.152342768261288, 0.13299527742274628, 0.1459698097492642, 0.14814123185118228, 0.14377776104354625, 0.14460454147797158, 0.13377747532973036, 0.1430103949960004, 0.14107038870400926, 0.14956180894481805, 0.16407484169746414, 0.15365419701985172, 0.14585057285266856, 0.14372305714762496, 0.14776525285034625, 0.14945139943335933, 0.15595942953248204, 0.14259516125800273, 0.14897516626986268, 0.14060994208171793, 0.15131510893961678, 0.14570261514085628, 0.1514339758209857]]
    [0.14525831399887887, 0.14700181315518987]
    
    # numtests = 25
    lossveclist = [[0.13976481119172288, 0.1402721193916987, 0.15548591458956226, 0.1437571446348328, 0.13295950834951595, 0.1352892105009851, 0.14506942321269145, 0.1413483606166796, 0.14661319825032995, 0.14657395954122285, 0.14016620112027045, 0.13280757748547445, 0.14114737525233284, 0.15920372312049624, 0.13788851846595324, 0.14274390602689407, 0.13983006325055644, 0.14910677959636634, 0.13822060157050212, 0.1493989910601474, 0.13714763011443679, 0.14480913677141657, 0.14142599970827652, 0.14080482156111804, 0.1443381497882648, 0.14189754453353468, 0.15423285863918612, 0.1467878604821344, 0.14406080038093438, 0.13896729927557558, 0.13830976517659974, 0.14741165514032784, 0.14509408208270455, 0.1470568182320232, 0.14620391554920217, 0.1454127493093117, 0.14922159612877037, 0.14130832837299304, 0.14317081634310425, 0.14198742541383533, 0.13190953267636488, 0.14244385390278838, 0.14810072342539166, 0.13511240090035767, 0.14001447205799308, 0.14635569530136458, 0.14182961647144832, 0.13726203510348076, 0.14365633817314416, 0.13867543322405954, 0.15132424475388206, 0.14192040146065993, 0.14679781869760772, 0.14513110353950853, 0.14034186169846394, 0.14881396154955537, 0.1560713712678311, 0.13332312905129237, 0.14444647498567068, 0.14190294278629775, 0.14617291762392565, 0.13637430336456485, 0.15143778218276527, 0.14044548149830685, 0.14094467299037836, 0.1431124155267114, 0.1501424956903045, 0.1416253363321605, 0.14898226535433506, 0.1472812434527108, 0.14126655615067205, 0.1459111529255601, 0.14647858031838087, 0.1443543651653473, 0.15081392319686973, 0.1362780748437499, 0.14331992435378615, 0.15012959347277716, 0.13893905816910165, 0.1489161296063529, 0.13764273586098172, 0.1460776410253233, 0.15076771070685743, 0.1403061227138892, 0.13313460201515717, 0.13698290225144302, 0.1385277907078083, 0.13407867130533932, 0.1465255688464108, 0.13721740193707765, 0.14142668825634433, 0.15628084170881096, 0.1482598668911832, 0.14687544118617102, 0.14010032795106322, 0.1452532615550579, 0.1417532708281067, 0.13655869512182522, 0.1411303877604745, 0.14120371218953826, 0.1430384717963851, 0.15630992474477384, 0.13501775822167256, 0.14833473186382634, 0.13972901258754125, 0.1484182982562263, 0.15238078106668967, 0.13762759191247023, 0.14187832835621994, 0.14908824564154077, 0.14255439361532019, 0.14463152879575367, 0.14552721370007884, 0.1359182793828399, 0.14010693715816558, 0.151870482462486, 0.14525142543858857, 0.14129948495469058, 0.14183683795412047, 0.15520386034916062, 0.13959214217418592, 0.1473340137684806, 0.14244725472553318, 0.13728653008028985, 0.13364195193413345, 0.14459008288868566, 0.14339369054158954, 0.13364150800546523, 0.14582649874579548, 0.14026261813717472, 0.16340344430269718, 0.14342685807860922, 0.14066923957050484, 0.14203268267881103, 0.1466643045535809, 0.15182814113668164, 0.14859948491743477, 0.14553019740765405, 0.15108853254472185, 0.13845306835978116, 0.14003746082175128, 0.1467341774550569, 0.13416592650487305, 0.1371454980950849, 0.1498760584745087, 0.14168099255026517, 0.13396974191642355, 0.14337723878792388, 0.1368266599758664, 0.14896011331087092, 0.14660095815249008, 0.1358937008146437, 0.140884804934718, 0.14472144743263052, 0.14502351449757053, 0.14445776650157352, 0.14513288406424063, 0.13580427961036673, 0.1484502839343305, 0.14084125680631132, 0.15519856309522156, 0.1431661072525992, 0.15907982038244084, 0.14821308658080148, 0.14356698353465788, 0.15432839278651503, 0.1409236434902716, 0.14453518946074553, 0.14588053460669403, 0.13913169194343183, 0.14751389115797153, 0.13828621152923162, 0.14009943300198954, 0.1470758822512471, 0.14602365500701311, 0.13366888470994845, 0.1487820920963565, 0.1442479191117537, 0.13698504510064827, 0.1381018991876545, 0.15076103713747738, 0.14140413278506697, 0.14080346181090994, 0.15426292164407263, 0.1536733378033161, 0.1374854066083664, 0.1432104874720429, 0.14136606575187627, 0.15078619449612876, 0.1428640513747599, 0.14350786218933875, 0.15009661024463078, 0.13944128698477087, 0.15169726133570563, 0.1536859773600667, 0.1458554943649039, 0.13821941655326522, 0.14025682887821003, 0.13933813876984136, 0.1387590234041701]]
    [0.1428698188560852, 0.14447382599396227]
    
    lossvec_lo = [0.15506736184284828, 0.15108957430579725, 0.1465841760151503, 0.14525831399887887, 0.1428698188560852]
    lossvec_hi = [0.15641337994076746, 0.15261417246493894, 0.14812630053969397, 0.14700181315518987, 0.14447382599396227]
    
    # WEIGHTS; 10000 prior draws for [5, 10, 15, 20, 25] tests:
    wts10 = [0.15871820009453552,0.1549758143406811,0.15207878808947314,0.1497671277680296,0.14783182923356122]
        50000 prior draws:
    wts50 = [0.15634284977105467,0.15239093186022373,0.1493421799432922,0.14691131384181857,0.1449136946098867]
        200000 prior draws:
    wts200 = [0.1556824914607332,0.15169556728979305, 0.14862528766821606, 0.1461760931219823, 0.14416658451707415]
    
    
    mcmcexp_lo = [0.1597614327786745, 0.15506736184284828, 0.15108957430579725, 0.1465841760151503, 0.14525831399887887, 0.1428698188560852]
    mcmcexp_hi = [0.1613232845995245, 0.15641337994076746, 0.15261417246493894, 0.14812630053969397, 0.14700181315518987, 0.14447382599396227]   
        
    # APPROX
    draws100 = [0.17096251909888835, 0.1481330548574234, 0.17047962293359242, 0.14872547351078536, 0.16508938138428117, 0.17095537965185834]
    draws500 = [0.1559392360454287, 0.1668042649471653, 0.16052768465584893, 0.15512831345943953, 0.15885933686450435, 0.17063859384373134]
    draws1000 = [0.16580795389668573, 0.16096495008980835, 0.1575308603477801, 0.1674442559796281, 0.1618666724542025, 0.1599543024805722]
    draws20000 = [0.16133369499491293, 0.16293700812491485, 0.16247429157083842, 0.16243704169610776, 0.16133173435041395, 0.1614570356185007]
    draws50000 = [0.1616567234596208, 0.16274689841949058, 0.16209550283881458, 0.16107551608256937, 0.16182528680125305, 0.16274905516400429]
    draws100000 = [0.16139074493480943, 0.16264269307218213, 0.16185294103912018, 0.16182869617070925, 0.16194445731186236, 0.16211384616042754]
           
    # FOR GENERATING 95% INTERVAL ON LOSS
    CIalpha = 0.05
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist: # FOR INTERVAL ON MEAN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (mn-intval)
        hiperc = (mn+intval)
        print('['+str(loperc)+', '+str(hiperc)+']')   
    '''

    '''
    # MCMCexpect; design [[0.,0.],[1.,0.],[0.,0.]]
    # numtests = 0
    lossveclist = [[0.16358824693077756, 0.15716600956111187, 0.16258879273613197, 0.16398272260296284, 0.16122038843845127, 0.16397457627171752, 0.16062032376791985, 0.15751539835240647, 0.1706072331022544, 0.1518958884814964, 0.1647452151326761, 0.15829419371086134, 0.15885340085328703, 0.1621415405692401, 0.16286049917094025, 0.156625360683157, 0.16554424864204512, 0.16098448483272512, 0.15774425035214798, 0.16589066634004498, 0.15805750492369272, 0.15625470483610535, 0.16710454609683034, 0.16180033826685727, 0.1535613224645323, 0.16481252710372105, 0.15802306210655914, 0.15402900047845952, 0.1610199563172257, 0.16240009318239526, 0.16272502603474087, 0.16736542430447626, 0.1587667376303871, 0.16647563626755663, 0.15580679372898373, 0.15927400679126352, 0.16140681296894016, 0.16177447941010778, 0.1671920264682422, 0.16098151269319616, 0.16184744487177408, 0.15812234669265368, 0.16053496935737244, 0.16268110283831702, 0.15615257064833707, 0.15801881279019062, 0.15273009253420303, 0.1682266740112519, 0.17182022958341783, 0.16050001101745054, 0.1594101088125565, 0.15179666592195476, 0.1660715047775367, 0.1548403794552042, 0.16153382844956457, 0.1544349303045409, 0.15863297075595542, 0.1681405230001371, 0.16476962847216275, 0.16436125874300106, 0.16471945185862066, 0.15588257800134525, 0.15712125288344164, 0.1649332472602849, 0.15858359475214542, 0.16479044192017422, 0.16862329523502487, 0.16930755548142634, 0.1663570222085106, 0.16305120245756752, 0.15966699254170205, 0.16628388440920241, 0.15291389034337866, 0.15501155359570643, 0.15935503288275737, 0.1595379793153437, 0.15721192761549066, 0.1656629389257, 0.1527460456482088, 0.15667962840148203, 0.15823758106723662, 0.15577479937056954, 0.15513364672347751, 0.16073123967151434, 0.15754719288549257, 0.15933233822098505, 0.17062554605957922, 0.1651871733169388, 0.15611476683983816, 0.15999311423873605, 0.17498131457446597, 0.15705146657771674, 0.16280431843214518, 0.15470598608185163, 0.16332286527621165, 0.15510704946110224, 0.15720632735052564, 0.15076408341916772, 0.16364220887152106, 0.16052341438818832, 0.15462575954920524, 0.15845580483691618, 0.15315097091238689, 0.1662325986941184, 0.1685372526769466, 0.15783009992515892, 0.1574483369854052, 0.16071085281187425, 0.1666343989826186, 0.16074958394474648, 0.15011290343969275, 0.16626133432786958, 0.16157254203065957, 0.15031950698812566, 0.15823864134850696, 0.15549440194017963, 0.1567632740818112, 0.15544686267732039, 0.155128549222738, 0.1696074208238554, 0.15710187848368914, 0.16612956983273686, 0.15297201464836654, 0.15576196737052564, 0.15907065766314907, 0.15836870386406676, 0.16138179140196393, 0.16598538933515675, 0.1568876073982065, 0.15967422123579153, 0.16258753328366654, 0.16736357087301504, 0.15029445936462063, 0.16276125755551868, 0.15321238192304135, 0.16233985590331834, 0.15761648379463, 0.160125396749554, 0.17180659587264693, 0.15699820541311904, 0.160726046456122, 0.16550616938229468, 0.1669604943486604, 0.15839114598840126, 0.1673247799902561, 0.16205585672650347, 0.16062613088572156, 0.16504478212020407, 0.16598685839483215, 0.15865244942859325, 0.15606508284582493, 0.16786204750734568, 0.16066436968728123, 0.1634880600352853, 0.15906232643264231, 0.15894793873984384, 0.16931667659361394, 0.16123817919148367, 0.16731853100297062, 0.1585368120909304, 0.16419052464104342, 0.1513773497350315, 0.16936751003373135, 0.15674848623649001, 0.15841755470530944, 0.16050126701952894, 0.16067168728631995, 0.1659097310276372, 0.15922388693988118, 0.16058027345319673, 0.1558956164190545, 0.163506939607734, 0.15840937752488696, 0.1615527505340876, 0.15283465403220284, 0.15758362353381888, 0.1630237696803376, 0.1638157820665923, 0.16167612440802712, 0.16003892083685473, 0.1608514737427389, 0.16892324666188116, 0.166529743131962, 0.1634197690765498, 0.16233880632228212, 0.15818158210461683, 0.15998541043288522, 0.16559488707418696, 0.1666051970254832, 0.150793445838315, 0.16463108872558802, 0.16393595769360952, 0.16278678245750264, 0.16168880201321248, 0.1579010410853301, 0.1628194722465565, 0.16050581761027613, 0.15924474509245884, 0.17341039949459358, 0.17138569178940957]]
    [0.16021197670665502, 0.16158723848900422]
    
    # numtests = 10
    lossveclist = [[0.15936559311497797, 0.15281048483967188, 0.15301648750311905, 0.14819709403201303, 0.15143907753086086, 0.15768824190459624, 0.1487189382867142, 0.1608596365567052, 0.15018893114654477, 0.1561941020508966, 0.1423873845032744, 0.15228608427987478, 0.16420081293894578, 0.14622123643828563, 0.1545836652028223, 0.15534915313462697, 0.14229769372993897, 0.14374523365066869, 0.14811271210122764, 0.1585843191859007, 0.15574787327691267, 0.15573397256002663, 0.15298499555002018, 0.15676000885663927, 0.14883046784308218, 0.1469140714403702, 0.14632402439535774, 0.1475572273149342, 0.15041278841313366, 0.15532400894454573, 0.15442655471815858, 0.14728659008429304, 0.15086595826904228, 0.15110620787906953, 0.14290517448152895, 0.15018782449248266, 0.1484662627514497, 0.1544805167962645, 0.14841073957746448, 0.15611392442128538, 0.1496809584640426, 0.14873796297961286, 0.1524442501184391, 0.15075703391870315, 0.14485528150046492, 0.14661268350166387, 0.14541454518551405, 0.148366460603512, 0.15245754916571921, 0.1415742671953485, 0.14912449143530654, 0.15377306651867914, 0.15030520885903523, 0.1547963992596536, 0.1580817811374872, 0.15441272890833865, 0.15218074624218247, 0.14632806905028217, 0.1511177324756385, 0.15012191606448516, 0.14832041460696768, 0.15310614115225935, 0.14746907423171807, 0.15539405197617095, 0.15121201403332923, 0.14650836220672056, 0.1585197071026352, 0.1564646578868664, 0.14927895352776827, 0.15405069623043793, 0.1523857899595256, 0.1514405415054654, 0.1419975005935354, 0.15649335980468265, 0.15621951117971872, 0.14972595558114873, 0.15330290083133208, 0.16442529660918834, 0.1515239160825881, 0.15607753570490743, 0.14318988293510646, 0.1580934543925378, 0.1517482428939543, 0.15368249740596718, 0.14838000916237007, 0.14821414672433733, 0.14769571944809848, 0.15176681488120575, 0.15092061398227694, 0.1531521152074112, 0.153493458702281, 0.15099774943870795, 0.15375582759853074, 0.1407705039161778, 0.15684774814145916, 0.15283608043761251, 0.14976326792472722, 0.15066256389067217, 0.15069315411354828, 0.15225432865980149, 0.14154349250938297, 0.15772784314900407, 0.15385507832259135, 0.14858411348324777, 0.14136135857870502, 0.14777864909312377, 0.1549002000019437, 0.14239067351969767, 0.13740013961128036, 0.15259343975207457, 0.14751337544337895, 0.15253604411801389, 0.15402338970492493, 0.14619722267841215, 0.15406337272850174, 0.15071762626078503, 0.1595140944025438, 0.14461210407017788, 0.1548707427360153, 0.14141464358366496, 0.14156376057749637, 0.15184625121099693, 0.15254792499695166, 0.1484531762480302, 0.14647811641451805, 0.15334278097861404, 0.14240377015037914, 0.1489544203880496, 0.1514084774968838, 0.15473976975474338, 0.15700465146856146, 0.14508943991296896, 0.1547572001930277, 0.1466869926937184, 0.149192938559423, 0.1514525358873467, 0.1479620927397677, 0.15341153244150948, 0.1566628232751799, 0.1484444349850034, 0.1501043808871011, 0.14683290708718882, 0.14372647847577946, 0.16455504405045043, 0.1488936165500803, 0.15360547141630349, 0.15246357696223997, 0.151237951826925, 0.15125616584678914, 0.15469357369431688, 0.16103479209065727, 0.15010433354804975, 0.1596735992164866, 0.15184962806899102, 0.14929575119961264, 0.15539913886893, 0.160727637189083, 0.15484617694970285, 0.1422813908550581, 0.15011295280475387, 0.15216040317605362, 0.14554115791273026, 0.15181867420816303, 0.15505234430864054, 0.14497000078785272, 0.15662773314098258, 0.15248325913026473, 0.15578572458926584, 0.13876842900341846, 0.13910693612816777, 0.1666805537053591, 0.14335192158894314, 0.1521136203960297, 0.14604590781335836, 0.15005613506564697, 0.14756769152415436, 0.13832444656191864, 0.1460597480228831, 0.1492541519485563, 0.14682510645852373, 0.1439388457489174, 0.1478372289031657, 0.15344413554018718, 0.14965449731425992, 0.14305052084350087, 0.15750229131499022, 0.1630906945559717, 0.14313153334378287, 0.15970113434303485, 0.1546339841826926, 0.14580553338290123, 0.15101310404900511, 0.1427132910408688, 0.15099769685765468, 0.16610708866753096, 0.148702984546183, 0.16085118889525835, 0.1480508183781159, 0.1520854928151383, 0.14348025852573215]]
    [0.15016267023404384, 0.15167878274470148]
    
    # numtests = 15
    lossveclist = [[0.16410929196416632, 0.14465398990669023, 0.14168288970841486, 0.1485446478266021, 0.14794447659552384, 0.14696836111671946, 0.16265798656869632, 0.16465641022117916, 0.14712527710699175, 0.14253078860999163, 0.14160566985615478, 0.1397066451412966, 0.15586107793345946, 0.1414091184083943, 0.15077642869989158, 0.14646507207687426, 0.15163835079821422, 0.15301253395650544, 0.15087720727761408, 0.1415485569290662, 0.1506423908775248, 0.1418934687651676, 0.14538130325202894, 0.14880056474089437, 0.14872655367153087, 0.1470111309361693, 0.1491010175530016, 0.14903302120887177, 0.14444715807642816, 0.15313190335866284, 0.14768659876435106, 0.14485677957735107, 0.15183082486488125, 0.15099334965274747, 0.14940426180138644, 0.1472949073856396, 0.15013991780652594, 0.14461999884209478, 0.13888292845139716, 0.16298823422854225, 0.1507412950795776, 0.1446693390141012, 0.15416182169135334, 0.15035203656658092, 0.14544744776535515, 0.14648478038791626, 0.1520722159378607, 0.1475935560256991, 0.14592289179261092, 0.15169136007688827, 0.1442978316854447, 0.1401994148237808, 0.15267004371501813, 0.144523556832562, 0.14741538315226224, 0.1414640441165797, 0.1495324494649476, 0.14693898534404834, 0.15391198305435425, 0.13841027436075584, 0.14568533008450968, 0.1631364022599949, 0.15271312380006866, 0.14507836741867697, 0.15306663866221284, 0.15340149898046096, 0.14997484512486367, 0.1397077971213084, 0.15796218353143585, 0.14328048537987081, 0.14322833641725657, 0.14624496551586813, 0.14640959629536693, 0.1586290818659108, 0.14490099213741967, 0.14903918563399404, 0.14751335737715598, 0.1527803999643765, 0.15094753356767687, 0.14454937300983786, 0.15430405575621645, 0.14963783321531085, 0.14290212442182387, 0.15164482915150726, 0.13886106904684428, 0.1528069386744492, 0.1507068123552461, 0.14940689251910144, 0.14903207885861045, 0.14984190941913586, 0.13878745138655227, 0.13772347222656348, 0.15295204588122713, 0.1584496013974793, 0.15649283192553412, 0.14465626245672206, 0.14745385163792968, 0.14822591917577904, 0.1415162328488216, 0.1567886478885103, 0.15144687862155515, 0.14664384905683187, 0.149338975096502, 0.15289220164219677, 0.1498288292972931, 0.15475738305051123, 0.14449488001602767, 0.1447030359613033, 0.14207835247139314, 0.14942983792440076, 0.14110088761269954, 0.1508796807759093, 0.14899988134078337, 0.1473882059551492, 0.14535663204837843, 0.13838891055284852, 0.14184472367517634, 0.14600376528435655, 0.15321978636372702, 0.16124453833014213, 0.14482748222376876, 0.15123798518423534, 0.14225919696155984, 0.15474779956488588, 0.16056988873057973, 0.1481915010621652, 0.14929989126658239, 0.15151125489991105, 0.14572325186479626, 0.1507464709880059, 0.1569712737862299, 0.14574448322198905, 0.15224620719708395, 0.16085055280742472, 0.1510797201936358, 0.15338452008859038, 0.15431465789606846, 0.14853763183776741, 0.14586141766387412, 0.14633010770165436, 0.14112754890594356, 0.14848972577243355, 0.1494833746019399, 0.13956921989665352, 0.1488908110292435, 0.16531391243484778, 0.14725224794064748, 0.14777029016193075, 0.1455792872050659, 0.14877587991433144, 0.15613801126654242, 0.14853193517084504, 0.1529155135736609, 0.14681874306475126, 0.16271981187275994, 0.15329313185545385, 0.15075023884550692, 0.14601173228768494, 0.1489254891427093, 0.15053271216199193, 0.14743534578366652, 0.14578984406651796, 0.14330209455311876, 0.1449853695506467, 0.1385257491775937, 0.14815099493322495, 0.13875644755728114, 0.14323023471035906, 0.14272606405972124, 0.14103990096100774, 0.1486601915608013, 0.13536369061926284, 0.14691396412023858, 0.14601045248817943, 0.13251803891325742, 0.14399004048304226, 0.14963580292522077, 0.15350089660870953, 0.1446221378780701, 0.14742353031772457, 0.1544463450497568, 0.1435924367576897, 0.1381058957595342, 0.15068023011248743, 0.13905369914720533, 0.14697072439101788, 0.14769959423036544, 0.1600592223216871, 0.15285592850893048, 0.1486848496405545, 0.15187805638986973, 0.15532325641390962, 0.146492578503281, 0.14572331822611198, 0.14739764370508168, 0.15429828556481812, 0.15043997027561576, 0.14713474763647727, 0.14545479838023204, 0.1473839384163263]]
    [0.14764479788349866, 0.14924724829468644]
    
    # numtests = 20
    lossveclist = [[0.14063618027637526, 0.14497019384804757, 0.14992032538873004, 0.14956269848965678, 0.14555963833293273, 0.14313460022672747, 0.14831316788656554, 0.1413231105869208, 0.15364407323276316, 0.14908682227496342, 0.14193876318311074, 0.13983541749669945, 0.14730298561620692, 0.1463412705168321, 0.15984378588482195, 0.14314226856893483, 0.14054112115544065, 0.14593384429906206, 0.14563739428047248, 0.13670453733818566, 0.14366718665880396, 0.15360323192312658, 0.14022350117578244, 0.14517047550603643, 0.14701885648543345, 0.1465255444706719, 0.1463960590547243, 0.14326831879049615, 0.14446416685962404, 0.14058087864831342, 0.14058859159893153, 0.1461051186342304, 0.14001333128430668, 0.14424151661513288, 0.1520551223352466, 0.14539235695590236, 0.1462935349798536, 0.1412638309265921, 0.1551202222445731, 0.15416565420767242, 0.15264825710132268, 0.15168939484519467, 0.14964962274044855, 0.13890187220346675, 0.1475511373396609, 0.14658795827708057, 0.15625168783076862, 0.13938138195121202, 0.15554844804353365, 0.14994586317337272, 0.13607754866545962, 0.14508937478183379, 0.1402067511386448, 0.13953713152211944, 0.1381466774679414, 0.14920630953674277, 0.148103629111143, 0.14672532155782897, 0.14613835162344255, 0.14390196667496943, 0.15084638610655626, 0.14884141161515124, 0.15311721816594656, 0.14488954855684383, 0.1540479174186076, 0.1548151661574726, 0.14099896690738958, 0.14485411591161818, 0.14571865780234924, 0.16085917162736124, 0.14648787520738776, 0.16247236311251664, 0.1386277574697323, 0.15299286809961943, 0.1368078111369759, 0.151724818084473, 0.1413278658983899, 0.14223248389800225, 0.15337739929783736, 0.13887140154656072, 0.14448475390483265, 0.14649188130442983, 0.14361022129221265, 0.14867411544893652, 0.14539086492857273, 0.14813897173915194, 0.1483332056706462, 0.14097370788749314, 0.14462608319941306, 0.157788447973074, 0.15274929994295353, 0.13199351950713523, 0.1501049746027388, 0.13974684046842614, 0.160500799929978, 0.13464929929775307, 0.1449572142677948, 0.1355319787804546, 0.14603107085058492, 0.13639021926793296, 0.14376948835950734, 0.15146765223993505, 0.13412292192610867, 0.15041299416442466, 0.14425424892353478, 0.1529007630610451, 0.13582625874341636, 0.14400526395706562, 0.1561198730259159, 0.14361157556486268, 0.1354622003799262, 0.14532764740979065, 0.1592376417279971, 0.1464771472200068, 0.14998517444405132, 0.14790303562052512, 0.14368570134992337, 0.14929034029413663, 0.13672068095972317, 0.1453189866004775, 0.1450173132654928, 0.14344373583549308, 0.15058039835957157, 0.1491292674932988, 0.1467574384442782, 0.1474738789022124, 0.1487477049715878, 0.15335482802647402, 0.14603660585435582, 0.15398492668727237, 0.15213934513184443, 0.14148083673594658, 0.1462839284053125, 0.15062152725169856, 0.13934325732158556, 0.14393053420084556, 0.13520810447467158, 0.14920199316779423, 0.14777248713407304, 0.14254034517821337, 0.14353030052562232, 0.13766306791927765, 0.1439597876709399, 0.1498420004763089, 0.15313608805333057, 0.14462352598140366, 0.1442967464241807, 0.14061891143041005, 0.14595342682313667, 0.13523343083218195, 0.14188420442075586, 0.14078012900770684, 0.1475937155979609, 0.1525344575607217, 0.1413896347932014, 0.15192571522662376, 0.14753519776366714, 0.1472618421617101, 0.14536220657434362, 0.14217093740212727, 0.14746464238505635, 0.13603943670612711, 0.14137174404747171, 0.1424531827219881, 0.14162643111590087, 0.13924628033478856, 0.14369964625672885, 0.14504489073613308, 0.133455443899137, 0.14570913477161238, 0.1463296337787307, 0.14818904634003618, 0.14846220122343654, 0.14699684395996787, 0.13674605569276063, 0.14576799793817963, 0.13889905076355827, 0.14662361750173653, 0.1438077399203659, 0.1410915169651403, 0.14802448139324179, 0.1494668559043544, 0.1446495399157382, 0.14975274486873855, 0.14937002327169424, 0.14636933382573697, 0.14701484115916144, 0.13749107722504433, 0.1478858710624566, 0.149941929784292, 0.13777471114319692, 0.145072771778418, 0.1543927482691856, 0.1478920989325957, 0.14167462662171632, 0.14099855717800724, 0.1520190454638978, 0.14932615665611512, 0.15288424941113904, 0.1448098920745502]]
    [0.14500221332988372, 0.1465775519758017]
    
    # numtests = 25
    lossveclist = [[0.14929165654667872, 0.14476989937850052, 0.1431652370531077, 0.13928342106611927, 0.1481105180784011, 0.13212687778026677, 0.14442471079302682, 0.13833841478566206, 0.1469974403749125, 0.13923903662178377, 0.15033524112510596, 0.13808825812365114, 0.14835561494469526, 0.14370932614462167, 0.14900550389264416, 0.1594141247684239, 0.15002817404556096, 0.14419300974464672, 0.13196189230292646, 0.1413433699645824, 0.14140178226259342, 0.14099649395107589, 0.15111420333905323, 0.15000157523296392, 0.13175776558956634, 0.14969978779296814, 0.14410514416086198, 0.1359384372365681, 0.15144471974910564, 0.14662106516829507, 0.14093461494950923, 0.13770764941949995, 0.14119327136599946, 0.14589409818505128, 0.1415483240811351, 0.1549219334652118, 0.15034259909346834, 0.14827012207484405, 0.14164692560721018, 0.1544305553116642, 0.1491928390393004, 0.15559979751475245, 0.14258834122094993, 0.14296986852182667, 0.14649905524130072, 0.15254756039678108, 0.15994415618051708, 0.14499084459976455, 0.142361037157211, 0.14483198686002724, 0.1439363359491464, 0.1435646665084144, 0.13850829466245396, 0.14000509610712158, 0.14623346131986745, 0.1494516029814126, 0.14271096585860724, 0.14412854107536452, 0.14014322090110787, 0.13869901944959287, 0.14120180041825878, 0.15577993176898547, 0.14384750335642657, 0.14953776719289005, 0.1496455539559311, 0.15463190468940383, 0.13847712989961125, 0.1301319778208169, 0.15075948585318785, 0.1480114773194463, 0.13846833559330723, 0.14615607137923692, 0.1433922132868263, 0.15119142790723186, 0.13372822235925866, 0.1481445323960677, 0.14446450623845872, 0.1409791625130278, 0.15031559537249692, 0.14337754978552933, 0.13802068014956187, 0.14715812160275998, 0.14286161737396558, 0.13133563762479933, 0.13758375320461794, 0.1425282323993351, 0.145782457620783, 0.14544392670868025, 0.14907513684331425, 0.14863366104509992, 0.1402379891501884, 0.14210692849790243, 0.1492940022359748, 0.1419568192175121, 0.13891224989153386, 0.15000915693895966, 0.14622641231890063, 0.1468567758799618, 0.14723284683194357, 0.13357613483749012, 0.13764158814030844, 0.14735460081801072, 0.14531422615885684, 0.1410877137098853, 0.14955123787478963, 0.14437540344691446, 0.13284658244740824, 0.14506270997846582, 0.14850826567854256, 0.1431812775611784, 0.14384481547473815, 0.14481933071076525, 0.1411324580567938, 0.14518137836846626, 0.1525484112933519, 0.1445646452854976, 0.14119171916989187, 0.1422687757335097, 0.1360090523827051, 0.15705082407707682, 0.14231460763162426, 0.13963169850936383, 0.14088083546597316, 0.15037981213249726, 0.14373365537002664, 0.13760437727796623, 0.1412161654145318, 0.1402207045843932, 0.14412346433838347, 0.13359463453108592, 0.15047756683574423, 0.14209775103803768, 0.1362625740662616, 0.1563944457342287, 0.14847731663685376, 0.14397137241023067, 0.13687461576703608, 0.1379214577726269, 0.13617923985624802, 0.14486010097709515, 0.1526769708367333, 0.1468635045935116, 0.14996990070362595, 0.14492669562914967, 0.14476325608750784, 0.14766551304979972, 0.14696367195197488, 0.144349622311492, 0.14253858668335967, 0.14530831251179038, 0.14514381934831846, 0.14434054523518214, 0.13919929437775122, 0.14522206547569413, 0.14946907564379974, 0.15600864287211483, 0.1490853089878084, 0.13700172062940272, 0.14438372484976714, 0.14318696505861334, 0.1458700356471285, 0.13212420873237768, 0.14801545116170292, 0.1422719099034142, 0.14966535082215612, 0.15591858153878294, 0.14091959093259815, 0.15280828387489032, 0.1362580458121587, 0.14407309862937712, 0.14211628118488914, 0.15101677042587183, 0.13446984926089095, 0.13566278029735607, 0.14732295869240544, 0.13238096739962563, 0.14595111862146468, 0.15284797297188266, 0.14480113263006086, 0.13872757379713954, 0.15165438450118296, 0.15367250846318617, 0.1449783010598694, 0.14316322244394122, 0.14130173476162014, 0.13906866715806399, 0.1383184667020811, 0.14318420080485017, 0.14819754722664963, 0.14459417877418518, 0.1431395484933866, 0.13581477948314766, 0.14507803989675816, 0.1446772533684341, 0.13577495874140816, 0.1498714129547766, 0.1439814070775627, 0.1474885465752546, 0.13526797312399708, 0.14835854687608543]]
    [0.14348887516365055, 0.1450987291060949]    
    
    # numtests = 30
    lossveclist = [[0.13779317155584295, 0.1466483229412001, 0.1305914744898823, 0.14045340614824023, 0.1415288119190779, 0.13622826693172774, 0.13497195492286918, 0.13323548235270044, 0.14312149428812063, 0.14291500865837162, 0.15042897011969236, 0.14120716596784838, 0.14654649069730336, 0.13800995296903198, 0.14330110167601498, 0.14144132493087655, 0.1401250762277522, 0.14048598520104155, 0.14748754241512915, 0.14584730638913093, 0.1336649302830056, 0.15254917425553255, 0.1412628591738108, 0.1470766655206707, 0.14347017596625594, 0.14749415889033027, 0.14694741982683768, 0.13628623832006861, 0.14796658418077788, 0.13774407603313452, 0.1461084025628362, 0.13548709707569756, 0.1322126927738884, 0.14142479377598974, 0.1452241088437068, 0.16055691114699636, 0.14626575428980232, 0.14263257007790406, 0.13801386844102606, 0.13805470040801132, 0.14921008933880864, 0.14617886425778334, 0.13405056652257677, 0.13735225246901456, 0.14062359360368815, 0.14338408770294347, 0.14918957098019092, 0.14471604441866012, 0.14144312601091963, 0.14670961056585524, 0.13990286726951082, 0.14802488994081053, 0.1388447644527789, 0.12628770824243543, 0.13768782427618306, 0.14268462982574623, 0.13553030414578043, 0.136279460907096, 0.1498124628394062, 0.13623499597391156, 0.14317104035800904, 0.15199253049685393, 0.13777512046069446, 0.14339038192311643, 0.15358234520845634, 0.15423079652496213, 0.14216248752785446, 0.14203615626237148, 0.1515448868392956, 0.1451641014065573, 0.14576450185377826, 0.14767487578752908, 0.13619020865916018, 0.14923488856213302, 0.13824121032854436, 0.14276491320070517, 0.15231190931636698, 0.14396177784850336, 0.14129487729081874, 0.15032541741836966, 0.14782358097425924, 0.14509833304493824, 0.13084363293423165, 0.1490341011948041, 0.1363701117742744, 0.13797400064827425, 0.15064662645327168, 0.1422930919701152, 0.1466355359565519, 0.1482262722141571, 0.14176438935859742, 0.13823162599661654, 0.13902096656587565, 0.1537213606140614, 0.1507645635158129, 0.1394960475280321, 0.14610951011866696, 0.14683566640377324, 0.1350795319697564, 0.1429049875468854, 0.14425414575592294, 0.14706421912952977, 0.13995027338213192, 0.13311598568460895, 0.13763822398602318, 0.14252239438073366, 0.13930370816934687, 0.1301198796956489, 0.14246752449592698, 0.1443933013958118, 0.14037156908575618, 0.15681384208750995, 0.14233272568617852, 0.14337970603672623, 0.14092634556200273, 0.14855847313410575, 0.14033875082552627, 0.14219461728532623, 0.13684301737873666, 0.15159051439464025, 0.14688820055003549, 0.1478724634831737, 0.1361931946565252, 0.14080057740470323, 0.14131805051260463, 0.14416044493572047, 0.14289888462215977, 0.13779572304640297, 0.1452160127260369, 0.1386947493192966, 0.14717006256654538, 0.14213833695315076, 0.15280921895586305, 0.14122714114153803, 0.14798486324394122, 0.1253460325347753, 0.13319603024607746, 0.13788783421453105, 0.14930481973085982, 0.14297397672335596, 0.15499433500025772, 0.14978042701777136, 0.14902742041087935, 0.147606410106089, 0.15863409466233874, 0.14789587841453186, 0.15083050667148976, 0.15096974570837454, 0.14826129081992034, 0.1397727509926425, 0.14102462960123693, 0.13243942361009287, 0.1372346938539054, 0.14218301484177048, 0.1421487613286172, 0.14821577624409576, 0.14325664838541502, 0.14071650100008148, 0.14072223192813418, 0.1378971885132875, 0.15850622201939232, 0.1352645954511013, 0.144967839510987, 0.13614364047358835, 0.15545221706706067, 0.14934081035557115, 0.13989445180391163, 0.14799588888712795, 0.13381807056677292, 0.15181562864218967, 0.1257000263321256, 0.13993634806612892, 0.14020484389713717, 0.14572540522994032, 0.1519304777144703, 0.1434346206614827, 0.13307424067905316, 0.13728972479839868, 0.13705230913880984, 0.1362257918337577, 0.1404684252856191, 0.1340398040393584, 0.15331534569173727, 0.14173303188631228, 0.1545865837431348, 0.14607086054341484, 0.1391204365707075, 0.14301432325537278, 0.14273719131465015, 0.14303334859184433, 0.1436538883542519, 0.13927254242918996, 0.14331809213518512, 0.14760577861266333, 0.13699554440346723, 0.1458494414048793, 0.14484836262546916, 0.1376073063573045, 0.14782388132792662, 0.1414458642792053]]
    [0.14207702112839923, 0.1438092622782047]
    
    # numtests = 35
    lossveclist = [[0.1391762774455899, 0.13264671779963996, 0.14243992663528235, 0.13618781259122667, 0.14580214236327796, 0.14610593419155204, 0.12775263297698142, 0.13291018728092824, 0.14422878336037623, 0.13907971576111622, 0.14086552274591072, 0.12965041928336524, 0.1337899732006856, 0.1343957954738571, 0.1410105280588572, 0.1404404855559816, 0.14930745948638366, 0.1616301455540161, 0.129559918133873, 0.13305861268209185, 0.14521323078301257, 0.1536761845463573, 0.14269551934698127, 0.15391426733858973, 0.14089071392623995, 0.15100018376359342, 0.14825971553200082, 0.13768223260365747, 0.13733929319778004, 0.1445886431094892, 0.14609521549378096, 0.13064338209935217, 0.1377871216806365, 0.141752120375042, 0.14899569210787073, 0.15225236244216475, 0.14074937670678345, 0.13879624979712382, 0.13821462093585435, 0.14076470253115622, 0.14608714832074407, 0.13815409448495994, 0.13753097411729348, 0.13803632423646978, 0.16315072676632833, 0.14640667941890362, 0.13874070052199666, 0.136036542360735, 0.14857111633431538, 0.13890342833592356, 0.13969696992214867, 0.1397384677616832, 0.13277841111494632, 0.13524498856616168, 0.14755298881306192, 0.13649462323179604, 0.13133850795263816, 0.1539899851127854, 0.14246411669612663, 0.13094734387387694, 0.1489486317212698, 0.13737639559321993, 0.1318019966573981, 0.13683682183422233, 0.14181369927842702, 0.13673912433342644, 0.13495898174848625, 0.14058552095733926, 0.14635714798374774, 0.13763503317770062, 0.1360938888335275, 0.14175674425386223, 0.13005145718343267, 0.15449261682283733, 0.14152793417078616, 0.14164117811471644, 0.15529178042523506, 0.13953454575537894, 0.13630892289205546, 0.1540750738653636, 0.1358677970576752, 0.13243091913427948, 0.13958784111394537, 0.15009663788493458, 0.14107365264833932, 0.14168421061414654, 0.1393965020072669, 0.13312516912606273, 0.14535323687437537, 0.13663510439671864, 0.13185141067445197, 0.12796220196948185, 0.13929524907710525, 0.1330997437728412, 0.1425828975306007, 0.14354281288518195, 0.13311365386942342, 0.13792743610631647, 0.13753956902639614, 0.14410487397631566, 0.13083161202174318, 0.13934340104556983, 0.13526048526010537, 0.14090795887798815, 0.13578340866508837, 0.14996892214955035, 0.13335710655013802, 0.14046520762959386, 0.15590150870895836, 0.14501322937423866, 0.13688587213616643, 0.143092089097864, 0.12998145189710872, 0.13456057350398506, 0.13758043650351362, 0.14409095498412244, 0.14227260957680854, 0.13958004727004084, 0.13320855693561667, 0.14887158897887304, 0.13659424500812017, 0.13568495191408464, 0.1354854454739415, 0.1503817289822854, 0.14017461844195844, 0.14814669378333964, 0.13940214477283228, 0.12705583651949973, 0.1493631009372235, 0.13189564624052463, 0.1362073628604805, 0.13248424457092559, 0.14123738001357616, 0.1411232517235755, 0.1407379679535181, 0.1357982878019421, 0.13161175611944237, 0.1398737012663519, 0.1426576839055006, 0.13559460820092398, 0.14817603783859778, 0.1438585543042762, 0.14716994930900243, 0.13908029689168974, 0.14163137988998675, 0.1328318835922843, 0.13960394529540174, 0.14607241624214998, 0.14770321275902976, 0.14550112186811825, 0.13795376906752088, 0.13295669457283907, 0.14005302476798365, 0.1519948870404687, 0.14241800038050778, 0.15616064021204984, 0.14565418403489155, 0.14333961439484594, 0.14756533661191554, 0.14270858092240168, 0.14545752272964566, 0.13938477615471234, 0.14638536258634852, 0.14371377725763856, 0.14275653928428197, 0.14401770347828594, 0.1377798828688195, 0.14328916166120925, 0.13065409197307162, 0.15031396159639843, 0.13148603002872383, 0.1380738878583802, 0.14095921437941308, 0.13772995227478496, 0.14281924778853627, 0.13889192110928741, 0.14443880827941266, 0.13553622934950676, 0.14354101169673475, 0.14073183114705837, 0.14526535349586878, 0.1409372306436658, 0.1469012364041062, 0.1497646143022559, 0.1641668364319192, 0.1396301298215819, 0.1428449374033816, 0.14142042498360072, 0.13842246599198316, 0.13224883784092176, 0.14481325632208944, 0.13805044358737636, 0.1455682251781399, 0.1346717389354257, 0.1318468931606976, 0.13981867396387718, 0.15358637991492713, 0.1348787375674782, 0.1462652471002303, 0.14328813539697563]]
    [0.139945146958225, 0.14182049595968985]
    
    # numtests = 40
    lossveclist = [[0.14923328560431817, 0.14094086026241218, 0.14423356196433082, 0.13030774067034884, 0.13492453624631637, 0.14619328533541556, 0.14106742088799, 0.14188541594910636, 0.14426281868512356, 0.13891021917477997, 0.13675473401987595, 0.1362817656416003, 0.1410106285855479, 0.15181295207832057, 0.1399654499155807, 0.14039654427888326, 0.13912367817224155, 0.13346226399072908, 0.1602012574935667, 0.13948190843073507, 0.1379359119754444, 0.1493148714246625, 0.1339093752348592, 0.14726530165635557, 0.1496696040648137, 0.1384360398897158, 0.13038878841213308, 0.1284213002472483, 0.13517464000085624, 0.14446501775998466, 0.1443563246387758, 0.12395173168130082, 0.12970828180018262, 0.12958649149559937, 0.1370798464455842, 0.13659273001841732, 0.13984082312267798, 0.13244188681721067, 0.13803919719505928, 0.1460306856411136, 0.13698433820821393, 0.14367943470085498, 0.13620902001067348, 0.14242279617844286, 0.13633531350259295, 0.13409406987361244, 0.14410732673957183, 0.12562101410365412, 0.127951614927966, 0.1382430075104935, 0.134149534459074, 0.13079379222726426, 0.1290298972117456, 0.1300870052354584, 0.13716674706332363, 0.14391373268444577, 0.1488081978037174, 0.14614457436176373, 0.144628427117606, 0.1349189505839391, 0.14079049183159315, 0.1436821465616919, 0.15296840194912978, 0.13813358734381853, 0.13945081024128586, 0.1479112715478527, 0.14453069564669985, 0.1383301868988603, 0.13545959515788503, 0.1437965692942241, 0.14132551312934297, 0.13587604288880584, 0.13519814698882787, 0.13763486225418484, 0.13794683844856406, 0.1412064583852822, 0.13846850141835212, 0.14692665398165025, 0.13716557455260445, 0.14464137999095195, 0.14537481674628622, 0.13414287929619484, 0.12367003042090521, 0.1352939471943121, 0.1282226047551616, 0.13754781933719917, 0.13705174516730664, 0.14886601338132857, 0.14061789990656895, 0.153037265464442, 0.1289526518718766, 0.1471663089319128, 0.1444408807576999, 0.147087378262655, 0.13332706052045298, 0.13416413660364654, 0.13293429730771086, 0.14772212346946345, 0.12824165130555756, 0.13469356369756158, 0.1444809462861017, 0.14157881803287942, 0.14659180974292868, 0.14364706940137417, 0.1573128380677149, 0.1536156491398544, 0.1421756488209304, 0.14049937624784667, 0.13107871213167122, 0.13482672181799332, 0.13260591185334503, 0.13231037392992037, 0.13644782010547654, 0.1526207589980754, 0.13917610913001296, 0.14233307425902805, 0.1362641611150689, 0.1362641611150689, 0.14311166031136044, 0.13617550231528616, 0.13096528868037588, 0.13635339720551218, 0.132767310274018, 0.13955887139473924, 0.14475439621827227, 0.13540584050522878, 0.13939129451128132, 0.14483056165084954, 0.13742614695377736, 0.1430718818679417, 0.1475164695438944, 0.13960389830205597, 0.14113619803635663, 0.13649777706898755, 0.1366857545094388, 0.14923232525964159, 0.14916415597103505, 0.14193905564389628, 0.14952199551609935, 0.13626866326827125, 0.14114637656125661, 0.13830039981366707, 0.13377079621224755, 0.13433458157972922, 0.13647522571894644, 0.13347395252243902, 0.13579941185682767, 0.13214268623194964, 0.13760599922053396, 0.13485436504260645, 0.14940834159232264, 0.1397013303789785, 0.1389311317368623, 0.14245787427818823, 0.14962095552699933, 0.14625459838343302, 0.1374313093826791, 0.14267596645476974, 0.1439474372839799, 0.1439241151490966, 0.13954288393231068, 0.1254037682915729, 0.1337024618052971, 0.1473878986226828, 0.14844403741221615, 0.13713008911238622, 0.12992102212044815, 0.14264915673047132, 0.12536380463970936, 0.13212797941213603, 0.15430503118894529, 0.13470464763885098, 0.1308922665676316, 0.14108979373786917, 0.13335498481490596, 0.15550082971397006, 0.13137669453557654, 0.14004793869112095, 0.1453773522296514, 0.1358613783224697, 0.12803824652213244, 0.1305913220766541, 0.13137859701273363, 0.13987664267050867, 0.1335058246361434, 0.14677556598183034, 0.1473810060084061, 0.1387408856251272, 0.13260720266368037, 0.1438673372681265, 0.13156656468065844, 0.1437039653779034, 0.13945917700617447, 0.1577877348925145, 0.14574739995057376, 0.1348175357625629, 0.13886046590666945, 0.13678530057641428, 0.13696221032646672, 0.13463178872408385]]
    [0.1384348150074832, 0.1403359932689587]
    
    # numtests = 45
    lossveclist = [[0.13607454444122516, 0.133750568830303, 0.1316333707431736, 0.13316176005912952, 0.14169600017470088, 0.1372069920822581, 0.13860990489061842, 0.13628793239390602, 0.15157336486068973, 0.12911197159223498, 0.1360792338196829, 0.13661275686607494, 0.1374061907864016, 0.13578736996426166, 0.13645104913750397, 0.14861486661210518, 0.1362460470806112, 0.13268817141744987, 0.14899218792332297, 0.12953245471416502, 0.1354194320178475, 0.13820926690465735, 0.14628161762529465, 0.14109404231565928, 0.14057161099888082, 0.15104588330254307, 0.1422223714461876, 0.13723680134300786, 0.14012591115771286, 0.137284391854731, 0.13805435775661115, 0.13334087598732267, 0.1436773545297151, 0.134761725065622, 0.1375413391187424, 0.1373227756874088, 0.134946056184705, 0.1302822834586717, 0.13453334534522063, 0.14070873149264532, 0.15073314669853002, 0.15075422481108441, 0.140287049953665, 0.13082259878106514, 0.13656560816332203, 0.14194942736636304, 0.14689403000420131, 0.16566254991969523, 0.13780995141190802, 0.13960582927546064, 0.1336217371038833, 0.13417331354119114, 0.1369783952998494, 0.13992640909045098, 0.12423565546992613, 0.1382999992401276, 0.130955512533517, 0.14538466884293336, 0.14404043489689367, 0.13672043300168624, 0.14225097264407224, 0.1386824241330546, 0.128282785498405, 0.14618312999808059, 0.14270740862490833, 0.14249580174202822, 0.12330728894782976, 0.1435217885983476, 0.14635474018498623, 0.1384860601122512, 0.13168807243532502, 0.13809827356001356, 0.138997493607717, 0.1351499592412427, 0.13418574410810047, 0.13834164036206598, 0.14130792845423668, 0.13061740991384438, 0.1330726880649435, 0.13103336670736937, 0.12825844348170268, 0.1467095976216857, 0.12983340101548252, 0.13558832521821423, 0.1408203377903446, 0.13965204370876366, 0.14593381907801928, 0.12848334026616032, 0.1438249302978484, 0.14513580365748086, 0.13442301674811738, 0.12843148667405402, 0.13521795994230248, 0.13547213237637007, 0.13980964533267373, 0.13437982131979417, 0.13405906067622433, 0.13439877159598557, 0.13649397431489926, 0.13701997960877565, 0.1383694393165889, 0.13602685553422028, 0.1326212068084077, 0.12834057639414506, 0.1295475292414255, 0.14081727557932183, 0.12726789123663013, 0.13538130505277732, 0.1473524334737119, 0.1462830824818178, 0.13528765885496966, 0.17085736519486744, 0.1416377895343577, 0.13783823039133736, 0.14132877352551457, 0.14423589338066023, 0.13302661782191877, 0.14455800364546662, 0.12906723197381345, 0.14865309137476296, 0.1473817053613943, 0.1414560836226565, 0.13572476977943887, 0.140958932969139, 0.13332205827947619, 0.14236949610627117, 0.14789297350910802, 0.12440631092023911, 0.14514940232349224, 0.14193465679395487, 0.15127052026791005, 0.15293165883134646, 0.1489022988155383, 0.14002323927357616, 0.14198375193079538, 0.13898412714418343, 0.13208883184294232, 0.13941765865361438, 0.14431936176957205, 0.14147899674320172, 0.13254479413434145, 0.15092203760893927, 0.14759601659084648, 0.14553036666944147, 0.12441390937516324, 0.14293404614221197, 0.14710865429597597, 0.13707589442269671, 0.13960513620523948, 0.141863525576503, 0.1492511027579569, 0.13871235983137672, 0.14754055623161919, 0.13215166554060115, 0.13463155335342972, 0.14188257290413125, 0.1564772572375866, 0.14048738023160032, 0.13815872313130592, 0.13896233560606622, 0.1392227907437793, 0.13767385819730735, 0.1408771691136243, 0.13703669939437366, 0.1456784840273687, 0.14837151357013187, 0.1288249970473656, 0.1426703878211193, 0.12603690189343958, 0.1363048094925155, 0.13813471604964536, 0.13942932940283495, 0.12930909971237042, 0.1336608611232914, 0.13629168205104394, 0.13139661983635134, 0.14348211913454742, 0.1357519088486372, 0.1345755075223913, 0.1223988033881791, 0.1588806085791979, 0.14599781163133363, 0.14462313438093952, 0.13472099580426794, 0.13828072022117188, 0.13522193706872496, 0.1330560316569927, 0.1401199216737999, 0.1306193777789655, 0.13930272156006937, 0.1385699137677469, 0.130777929603073, 0.14257563824209726, 0.1413177931717767, 0.13279477279336943, 0.13698551756087582, 0.1414068265742274, 0.13379838571402333, 0.1411397426391024, 0.13739790968212898]]
    [0.13781609257460764, 0.13977760419667512]
    
    # numtests = 50
    lossveclist = [[0.12896503769883522, 0.1363571855265304, 0.1396810542534607, 0.15147895479315404, 0.14634672026150136, 0.13436576322595328, 0.13254703147549032, 0.12867810564428017, 0.14022234303333966, 0.13601957818329424, 0.14052703859400106, 0.1291924121063265, 0.13805985431745146, 0.13751494172626386, 0.12614880759715227, 0.13859278154248045, 0.1430991624030021, 0.14410217778914736, 0.131174267703647, 0.12464043548949001, 0.14157410305003607, 0.14178942434045383, 0.1425256211094955, 0.15082375405734647, 0.1516384912200797, 0.1358954414075092, 0.14073577540372653, 0.1302420117038025, 0.14268807394802657, 0.1422750193577662, 0.14040745709975538, 0.13052244880336283, 0.13195931121011711, 0.15234748938178325, 0.14727190757393022, 0.14099262297493384, 0.1297786426473996, 0.13715881581253814, 0.13285513256885406, 0.14593928396702086, 0.14311633218207342, 0.15544523733629387, 0.13168705440437778, 0.12853209950634917, 0.14138032052030763, 0.1384717688128257, 0.15054913902730058, 0.13486933737359405, 0.14160685405075485, 0.13928217410257196, 0.13694371596555036, 0.13498758290993337, 0.13308225990864625, 0.13442902386452052, 0.13425594109251068, 0.139558130271446, 0.13685182913730878, 0.14231959440840306, 0.13891659565426984, 0.1291416677938113, 0.13083835772044908, 0.1380877745978223, 0.13180998893017443, 0.13733092754997311, 0.1527637283845932, 0.15070990560171055, 0.12817525709133049, 0.13573258706084693, 0.1453198201070054, 0.1487337473613717, 0.12743024254527782, 0.13970730182537944, 0.13769752147846592, 0.144053013775322, 0.13272621677742005, 0.1354189693601303, 0.1459918001707142, 0.13828907814947874, 0.13424569634171785, 0.14069915089308666, 0.13771180551271034, 0.14412131058934474, 0.13806191000472495, 0.13655021538665435, 0.13557629342455071, 0.12466652998018422, 0.14197321721880046, 0.13407654572566083, 0.15256229729418258, 0.14279867147838657, 0.13121715159241162, 0.13561808412319473, 0.12869593383071015, 0.13469244237522274, 0.13670235066179828, 0.127220355493529, 0.14706852730125552, 0.13768055275874144, 0.13567165025997205, 0.13473642834222097, 0.13197451818404013, 0.13013342251800086, 0.14139493206907147, 0.1350310693093406, 0.12904648298875887, 0.13708228577809378, 0.12659518535732628, 0.1430563246387694, 0.12659518535732628, 0.13848614217067454, 0.13302838000038597, 0.14119046040991737, 0.13836170651156593, 0.1361491162910469, 0.13793879298305448, 0.13651747347037968, 0.14217760038283178, 0.1465189198136137, 0.1313938467517028, 0.1311224289521011, 0.13753266694201507, 0.14107106242530665, 0.1339411377216011, 0.14606159166805155, 0.14449390077429464, 0.13663908219960674, 0.13763051961854655, 0.12731993602953554, 0.14086460832955106, 0.1379355262867124, 0.1397758742861277, 0.13970739448058989, 0.1371668506591707, 0.15121783099964123, 0.14670890443025508, 0.13168041834723287, 0.12803262314377084, 0.12968543747867706, 0.12774475674408325, 0.12571558852380524, 0.141035733821152, 0.13603430603246064, 0.1441226620994775, 0.1418129486351037, 0.13931426481058864, 0.14712980330772135, 0.151199893938582, 0.14537651594018552, 0.13788767872719643, 0.13848237243988654, 0.15109332048583823, 0.1379234321865378, 0.1384706058471915, 0.1403811238450625, 0.135206568344619, 0.14773033113394202, 0.13885749706275805, 0.15098774023757378, 0.13531330606628958, 0.12782212934264883, 0.14641035885926246, 0.1463961097100439, 0.14649586553691463, 0.13162820861899382, 0.1483671721944478, 0.14401288520485522, 0.1329136567914102, 0.13880925742762176, 0.14049679135998586, 0.14416084439289328, 0.1278539612600553, 0.1368922851284948, 0.13438136816668564, 0.14898104831286696, 0.14777777071864134, 0.1496586797802787, 0.13463812101405556, 0.13888662424399167, 0.1360441759786969, 0.1329228201392481, 0.14827099815332287, 0.13280700096773682, 0.135517911679232, 0.1397968729050755, 0.14366584389509404, 0.13900839888271035, 0.13674365922379728, 0.13736398828126878, 0.1484218264695349, 0.13976752833285314, 0.13971647881545818, 0.13811394344698386, 0.13888146434422707, 0.13270220002577066, 0.14492287622508143, 0.14124646200528115, 0.1307159372101115, 0.12757078906519714, 0.12966396799025698, 0.14456757434440948]]
    [0.1374408776994462, 0.13929732674891734]
    
    mcmcexp_lo = [0.16021197670665502, 0.15016267023404384, 0.14764479788349866, 0.14500221332988372, 0.14348887516365055,  0.14207702112839923, 0.139945146958225, 0.1384348150074832]
    mcmcexp_hi = [0.16158723848900422, 0.15167878274470148, 0.14924724829468644, 0.1465775519758017, 0.1450987291060949, 0.1438092622782047, 0.14182049595968985, 0.1403359932689587]
    
    # FOR GENERATING 95% INTERVAL ON LOSS
    CIalpha = 0.05
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist: # FOR INTERVAL ON MEAN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (mn-intval)
        hiperc = (mn+intval)
        print('['+str(loperc)+', '+str(hiperc)+']')
    
    
    # APPROX; sampling draws from 400000 NON-UNIQUE MCMC draws, in [100,250,1000,10000,40000,80000,150000]
    # numtests in range(31)
    
    draws100 = [0.14186260283731253, 0.14955340646680668, 0.1581570807646787, 0.15626291495733963, 0.1530313758663306, 0.1761648649956917, 0.1665808864498618, 0.1632719126001704, 0.16734427743376862, 0.16951959932264013, 0.15458239857560685, 0.16384980405071115, 0.16718052231571087, 0.15524784436840006, 0.1718097196615604, 0.16624415388333005, 0.15814339204240416, 0.15558054613829564, 0.1382255566883434, 0.15485233554391267, 0.1551977377270231, 0.13647779536416518, 0.195645271701333, 0.14643317894378888, 0.08999750831434764, 0.10869190278110134, 0.22069369430237637, 0.13267689548834696, 0.10153456648042218, 0.1475554314624782, 0.12920772229474795]
    draws250 = [0.15145794295807097, 0.1625489346849844, 0.16090753228646448, 0.16725187482385473, 0.1705320347363724, 0.15454370013903224, 0.17499181518515014, 0.1817445467903465, 0.1579639847126176, 0.17698880931205332, 0.16611025618935651, 0.1853130548680134, 0.17252366287223145, 0.17052637297152495, 0.17764245891221309, 0.18375785906090925, 0.15604418761175146, 0.17690433962169777, 0.15332665267710238, 0.15580671533003013, 0.17286335343717732, 0.16027805208798404, 0.1258161018621254, 0.15961372538803403, 0.18805221754737447, 0.14674834287417227, 0.13341362424620173, 0.032775378083841344, 0.18396037541802812, 0.15855303541690194, 0.15441723410609967]
    draws1000 = [0.15804464954025157, 0.15878266199209765, 0.16016690997740363, 0.16517241974004165, 0.15763346827049385, 0.16467872683462736, 0.1658031095269363, 0.16411231933918596, 0.1717276088240643, 0.16833863901853854, 0.17870020902260253, 0.16553883063453834, 0.1797096891423593, 0.16990284920051898, 0.1784786810487418, 0.18836694143682142, 0.1747780568817911, 0.18542532539991274, 0.17130041174126964, 0.18086234773594193, 0.16464066035939282, 0.161535057954879, 0.14699060751796206, 0.15251030931495901, 0.06565260408008507, 0.12328173109904503, 0.08384702728421228, 0.10755022515015063, 0.11399446045282732, 0.11904016402686572, 0.0067184173959996705]
    draws10000 = [0.16131598003961287, 0.16138220371547865, 0.16417685819121172, 0.16434932592842844, 0.1643435078775151, 0.16714215188907489, 0.16861407782629106, 0.1687736795767924, 0.169372975086357, 0.17050065349664636, 0.17296988565107294, 0.17672390931335769, 0.17598734396249616, 0.17994672407259482, 0.1787614900334264, 0.17859610947743626, 0.1795780452496487, 0.17460958418832706, 0.17337858485396018, 0.17654188157031409, 0.174391685229564, 0.1664918890778, 0.18745336967189827, 0.15689394802838452, 0.13250269063686418, 0.1426409905303931, 0.15682886354005762, 0.15530521413329298, 0.14157192228002197, 0.1414201132947558, 0.10666767221523182]
    draws40000 = [0.1606836993114933, 0.16207526003326908, 0.16321927372574024, 0.16372215738551626, 0.16507991658419763, 0.16682818677928837, 0.16715127916180164, 0.16893888795950743, 0.17047949787543892, 0.17174592615826134, 0.17362801617228307, 0.1748462070648831, 0.1761090532286745, 0.17604102263492136, 0.17601704175928243, 0.1782907979640329, 0.18294146925243193, 0.18484582150599738, 0.17992509248599492, 0.1866661518988352, 0.1794259813334131, 0.17612100170491077, 0.17744921769124414, 0.1675505381565602, 0.1947127349388776, 0.15212548700343723, 0.17239954958919101, 0.12697556082556402, 0.15095554112957416, 0.18414293923186267, 0.13127636913669563]
    draws80000 = [0.16099707502505783, 0.16166801601322126, 0.16327298362415155, 0.16386202577970646, 0.1657232425256403, 0.16622329213065729, 0.16796626677539808, 0.16869865997982122, 0.1706374870784891, 0.1726057787831061, 0.17370867059003817, 0.17488863942016575, 0.17655120454849038, 0.17817514476495114, 0.17720149595924523, 0.17874395279152835, 0.1782442631943459, 0.17771846960779789, 0.18179001777686962, 0.17916343379730876, 0.17834033077737343, 0.17386065461860822, 0.17731323990738496, 0.17111160696544028, 0.1714612271191479, 0.15620465007019432, 0.15843265326011796, 0.1471562372064509, 0.15604734986391758, 0.1804718707960711, 0.1451176290366939]
    draws150000 = [0.16102582573911103, 0.16191797489054832, 0.1628241487965926, 0.16416869162886674, 0.16527663998985048, 0.1665171439106238, 0.1677920344957979, 0.1693061922481328, 0.1705631175552832, 0.17171858692176262, 0.17311600426078877, 0.17479849792807403, 0.17603354288586037, 0.17680469062452178, 0.17802915419011955, 0.17932589776175623, 0.18136148790383344, 0.1808446386553556, 0.18029933239645637, 0.180108582028049, 0.17684293355366543, 0.17447830301233008, 0.17869579696446236, 0.16783253083645625, 0.16857530247486852, 0.16723646376310464, 0.15204049643287745, 0.14327002082880813, 0.1445944467091393, 0.15008480524519205, 0.15730376386799713]
    
    
    '''

    # Plot
    intlist = [5,10,15,20,25]
    plt.plot(intlist, lossvec_lo, color='black', linewidth=4, label='MCMC 90% interval - high')
    plt.plot(intlist, lossvec_hi, color='black', linewidth=4, label='MCMC 90% interval - low')
    plt.plot(intlist, wts10, 'r--', linewidth=3,label='Alternate: $|\Gamma|=10,000$') # Using weights
    plt.plot(intlist, wts50, 'g--', linewidth=3,label='Alternate: $|\Gamma|=50,000$') # Using weights
    plt.plot(intlist, wts200, 'b--', linewidth=3, label='Alternate: $|\Gamma|=200,000$')  # Using weights
    plt.ylim(0.13, 0.161)
    plt.xlabel('Batch size', fontsize=12)
    plt.ylabel('Loss estimate', fontsize=12)
    plt.suptitle('Loss estimate vs. Batch size', fontsize=16)
    plt.legend(loc='lower left')
    plt.show()
    plt.close()

    return

def EvalAlgTiming():
    '''
    Script for evaluating the time for running getDesignUtility under the standard MCMC and approximation routines
    '''
    numTN, numSN = 3, 2
    # Designate testing accuracy
    s, r = 1., 1.
    # Designate the true SFP rates
    trueSFPrates = [0.5, 0.05, 0.1, 0.08, 0.02]

    # Generate a supply chain
    exampleDict = util.generateRandDataDict(numImp=numSN, numOut=numTN, diagSens=s, diagSpec=r, numSamples=0,
                                            dataType='Tracked', randSeed=86, trueRates=trueSFPrates)
    exampleDict[
        'diagSens'] = s  # bug from older version of logistigate that doesn't affect the data but reports s,r=0.9,0.99
    exampleDict['diagSpec'] = r
    # Update dictionary with needed summary vectors
    exampleDict = util.GetVectorForms(exampleDict)
    # Populate N and Y with numbers from paper example
    exampleDict['N'] = np.array([[6, 11], [12, 6], [2, 13]])
    exampleDict['Y'] = np.array([[3, 0], [6, 0], [0, 0]])
    # Add a prior
    exampleDict['prior'] = methods.prior_normal()
    exampleDict['numPostSamples'] = 10000
    exampleDict['MCMCdict'] = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    exampleDict['importerNum'] = numSN
    exampleDict['outletNum'] = numTN

    # Store the sourcing probability matrix; assume Q is known, but it could be estimated otherwise
    # Q = exampleDict['transMat']

    # Summarize the data results
    # N_init = exampleDict['N']
    # Y_init = exampleDict['Y']

    # Generate posterior draws
    exampleDict = methods.GeneratePostSamples(exampleDict)

    import pickle
    import os
    import time

    # Different designs; they take matrix form as the traces can be selected directly
    testdesign1 = np.array([[1 / 3, 0.], [1 / 3, 1 / 3], [0., 0.]])
    testdesign2 = np.array([[0., 0.], [1/2, 1/2], [0., 0.]])

    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [testdesign1]
    designNames = ['Test Design']
    numtests = 10
    omeganum = 100
    random.seed(36)
    randinds = random.sample(range(0, len(exampleDict['postSamples'])), omeganum)

    mcmcstart = time.time()
    lossvec_mcmc = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'],
                                   randinds=randinds, method = 'MCMC')[0]
    mcmcsecs = time.time()-mcmcstart

    approxstart = time.time()
    lossvec_approx = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'],
                                   randinds=randinds, method='approx')[0]
    approxsecs = time.time() - approxstart

    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))

    mn_mcmc = np.mean(lossvec_mcmc)
    sd_mcmc = np.std(lossvec_mcmc)
    intval_mcmc = z * sd_mcmc / np.sqrt(len(lossvec_mcmc))
    loint_mcmc, hiint_mcmc = mn_mcmc - intval_mcmc, mn_mcmc + intval_mcmc

    mn_approx = np.mean(lossvec_approx)
    sd_approx = np.std(lossvec_approx)
    intval_approx = z * sd_approx / np.sqrt(len(lossvec_approx))
    loint_approx, hiint_approx = mn_approx - intval_approx, mn_approx + intval_approx

    print('MCMC time: '+ str(mcmcsecs))
    print('approx time: '+ str(approxsecs))
    print(str(loint_mcmc)+', ' + str(hiint_mcmc))
    print(str(loint_approx) + ', ' + str(hiint_approx))


    '''
    TESTDESIGN1, USING NTILDE,YTILDE
    numtests=30:    0.1266, 0.1336
                    0.1511, 0.1539
    mcmc_secs: 805.2s
    approx_secs: 8.9s
                  
    numtests=5:     0.1500, 0.1551
                    0.1490, 0.1494
    mcmc_secs: 3474.2s
    approx_secs: 38.0s
    
    numtests=0:     0.1593, 0.1608
                    0.1514, 0.1514
    mcmc_secs: 5050.7s
    approx_secs: 39.8s
    
    TESTDESIGN2
    numtests=30:    0.1288, 0.1363
                    0.1423, 0.1440
    
    TESTDESIGN1, USING NOMEGA,YOMEGA
    numtests=30:    0.1560, 0.1595
    approx_secs: 8.1s
                  
    numtests=5:     0.1425, 0.1433
    approx_secs: s
    
    numtests=0:     0.1420, 0.1514
    approx_secs: 39.8s
    
    TESTDESIGN1, USING NTILDE,YTILDE W/ LOG-LIKE RATHER THAN LOG-POST; NUMPOSTSAMPLES=1,000
    (MCMClo,MCMChi)
    (approxlo,approxhi)
    numtests=30:        0.1249, 0.1317
                        0.1496, 0.1520
    MCMC time:      877.6s
    approx time:      7.0s
                  
    numtests=5:         0.1486, 0.1541
                        0.1498, 0.1502
    MCMC time:      783.0s
    approx time:      7.0s
    
    numtests=0:     0.1592, 0.1610
                    0.1603, 0.1603    
    mcmc_secs:      
    approx_secs:    6.1s
    
    TESTDESIGN1, USING NTILDE,YTILDE W/ LOG-LIKE; NUMPOSTSAMPLES=10,000
    (MCMClo,MCMChi)
    (approxlo,approxhi)
    numtests=30:        0.1261, 0.1411
                        0.1552, 0.1581
    MCMC time:      0.0s
    approx time:      0.0s
                  
    numtests=10:        0.1456, 0.1525
                        0.1556, 0.1564
    MCMC time:      1949.4s
    approx time:      60.7s
    
    numtests=5:         0.1498, 0.1552
                        0.1567, 0.1572
    MCMC time:      1949.4s
    approx time:      60.7s
    
    numtests=0:     0.1604, 0.1609
                    0.1608, 0.1608    
    MCMC time: 4935.137982368469
    approx time: 72.35974860191345
    '''

def bayesianexample():
    '''
    Use paper example to find the utility from different sampling designs; in this case, we can choose the full trace,
    i.e., we can choose the test node and supply node .
    '''
    # Designate number of test and supply nodes
    numTN, numSN = 3, 2
    # Designate testing accuracy
    s, r = 1., 1.
    # Designate the true SFP rates
    trueSFPrates = [0.5,0.05,0.1,0.08,0.02]

    # Generate a supply chain
    exampleDict = util.generateRandDataDict(numImp=numSN, numOut=numTN, diagSens=s, diagSpec=r, numSamples=0,
                                            dataType='Tracked',randSeed=86,trueRates=trueSFPrates)
    exampleDict['diagSens'] = s # bug from older version of logistigate that doesn't affect the data but reports s,r=0.9,0.99
    exampleDict['diagSpec'] = r
    # Update dictionary with needed summary vectors
    exampleDict = util.GetVectorForms(exampleDict)
    # Populate N and Y with numbers from paper example
    exampleDict['N'] = np.array([[6, 11], [12, 6], [2, 13]])
    exampleDict['Y'] = np.array([[3, 0], [6, 0], [0, 0]])
    # Add a prior
    exampleDict['prior'] = methods.prior_normal()
    exampleDict['numPostSamples'] = 1000
    exampleDict['MCMCdict'] = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    exampleDict['importerNum'] = numSN
    exampleDict['outletNum'] = numTN

    # Store the sourcing probability matrix; assume Q is known, but it could be estimated otherwise
    #Q = exampleDict['transMat']

    # Summarize the data results
    #N_init = exampleDict['N']
    #Y_init = exampleDict['Y']

    # Generate posterior draws
    exampleDict = methods.GeneratePostSamples(exampleDict)

    import pickle
    import os

    # Different designs; they take matrix form as the traces can be selected directly
    design0 = np.array([[0., 0.], [0., 0.], [0., 0.]])
    design1 = np.array([[0., 0.], [0., 0.], [1., 0.]])
    design2 = np.array([[1/3, 0.], [1/3, 1/3], [0., 0.]])
    design3 = np.array([[1/3, 0.], [1/3, 0.], [1/3, 0.]])
    design4 = np.array([[0., 0.], [0., 0.], [0., 1.]])
    design5 = np.array([[1/6, 1/6], [1/6, 1/6], [1/6, 1/6]])
    design6_6 = balancedesign(exampleDict['N'],6)
    design6_30 = balancedesign(exampleDict['N'],30)

    ### overEstWt=1, threshold=0.1 ###
    # Get null first
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt':underWt}
    riskdict = {'threshold':t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec':marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList, designnames=designNames, numtests=numtests,
                               omeganum=omeganum, type=['trace'], priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'),'rb')), randinds=randinds)
    plotLossVecs(lossveclist,lvecnames=designNames)
    # APPROXIMATION
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds, method='approx')
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Design 0']
    lossvec = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598]]
    vecSD = np.std(lossvec[0])
    vecmean = np.mean(lossvec[0])
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    intval = z * (vecSD) / np.sqrt(len(lossvec))
    print('['+str(vecmean-intval)+', '+str(vecmean)+', '+str(vecmean+intval)+']')
    # LOSS VECS: 29-AUG-22
    designNames = ['Design 0']
    lossvec = [[0.1631624760638568, 0.15720307855535465, 0.1608639458015167, 0.16447283684593733, 0.1597308858525191, 0.16530244555035933, 0.16669312810707285, 0.16160074117278947, 0.1653192236072529, 0.16204418974476908, 0.15497871429023474, 0.15467411765416555, 0.1613750771551091, 0.15747074496261462, 0.15227562871749936, 0.17145553434981564, 0.16369361082463926, 0.16692521749216743, 0.16203792928496977, 0.1590776035470591, 0.1551749348303539, 0.16082428779764713, 0.15756807299460315, 0.1550608320048446, 0.15631195454060692, 0.15770983060319332, 0.16414686544787604, 0.15488810166410838, 0.15665288807970829, 0.1603004871311405, 0.16244412648327097, 0.15682117281806454, 0.16354500356802104, 0.16415919851377875, 0.15638019764514263, 0.16670011136232835, 0.15949899115009494, 0.1615188645137574, 0.15735859905742092, 0.15677491970077437, 0.1632770477454912, 0.14924291956044927, 0.1574308890174942, 0.16345504155976637, 0.16461700092995968, 0.16393482231407522, 0.1567846630510756, 0.1592431152969494, 0.15772433382534407, 0.14844073064826993, 0.1480748185152451, 0.15995265165098485, 0.15794841277723592, 0.1572413873265836, 0.1622471046539544, 0.16417357970743476, 0.15887070770145548, 0.1564296671429403, 0.1540633086236506, 0.1574801602328406, 0.1636280978407651, 0.1614998685157631, 0.1577330744011513, 0.15305409049467894, 0.16450330767712035, 0.15431738262912842, 0.1704341250563957, 0.15808855691643203, 0.1624660034460682, 0.16984983201379783, 0.16483379350966765, 0.17121651483881745, 0.15037817832139538, 0.15245994964489948, 0.15922731238943802, 0.1591623946701067, 0.1593963075601854, 0.1566343324544281, 0.16163975965273666, 0.16063162964748812, 0.15588301419308162, 0.16196747619948323, 0.16966545510320571, 0.1608916131441504, 0.15122267730328054, 0.1650651247623661, 0.163162013176352, 0.16165030963215343, 0.16726574770151145, 0.16236020655648817, 0.16454285631917326, 0.15453297321044887, 0.15539168550866006, 0.17099218057510968, 0.1600247961031962, 0.15695387350753648, 0.15969570999392832, 0.15967241534002483, 0.15652864332227961, 0.1649838594051987]]
    vecSD = np.std(lossvec[0])
    vecmean = np.mean(lossvec[0])
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    intval = z * (vecSD) / np.sqrt(len(lossvec))
    print('['+str(vecmean-intval)+', '+str(vecmean)+', '+str(vecmean+intval)+']')
    # VIA APPROXIMATION
    lossvec = [0.15265587864150065]
    '''

    # 6 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4,design5,design6_6]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 6
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    #plotLossVecs(lossveclist,lvecnames=designNames)
    # APPROXIMATION
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds, method='approx')
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossvec0 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598]]
    lossveclist = [[0.14509325259013878, 0.14028874836906774, 0.15305064950853794, 0.16164990223848158, 0.14600334611479598, 0.14222540439564113, 0.13819926446274894, 0.14888751519994395, 0.13601042925395454, 0.13705411416940977, 0.15017616990619576, 0.1312379783345067, 0.1399484932259146, 0.13867950539952534, 0.15473940085023505, 0.16492083747756797, 0.15266627729906476, 0.14303711984400314, 0.13944081571793362, 0.1351921195153755, 0.15000995864717762, 0.13785200299246733, 0.13972241307192595, 0.1390171111021526, 0.1741896010859611, 0.1523797619746385, 0.16802109843462054, 0.2031044061496549, 0.13994207470188078, 0.1493886304687554, 0.1421754071608363, 0.14819472020134955, 0.16730339147588053, 0.14273239657853296, 0.13527345028311655, 0.161211796889484, 0.15418280898428968, 0.1660452606865663, 0.16150255257113955, 0.14213185150950894, 0.16426791944900046, 0.14820635833013102, 0.1379348973871464, 0.15140720104735936, 0.15692154621266824, 0.13800025303241972, 0.15247775657441595, 0.1644960062364241, 0.14578730342459145, 0.15137928900502245, 0.15856592647467407, 0.1452533446898607, 0.13957331327211198, 0.16653186540898943, 0.1414586386472211, 0.13863761618792944, 0.15044269753193415, 0.13513057159191263, 0.1504710967707737, 0.14143042379029486, 0.15663931070287654, 0.15513959857473436, 0.14020565695676762, 0.14589390237896285, 0.13989413525049613, 0.13558801438885254, 0.1306796412110928, 0.1454250416842359, 0.20039562872768904, 0.1464782403034093, 0.13988968170112726, 0.13273908598086082, 0.15927546532370224, 0.1489380419506682, 0.1531876733846838, 0.19678434779440154, 0.1530507244232428, 0.13319105520055818, 0.16125454610296305, 0.15576736897330287, 0.1528635292552078, 0.15762210764858464, 0.1372813163402822, 0.14506678236295964, 0.14274206157870375, 0.14123908436351088, 0.14406353557244958, 0.16702307800312768, 0.1615712677311207, 0.1824616590030932, 0.16768892695608154, 0.14098816716858714, 0.15737226104821228, 0.16533306200044573, 0.13715882215889497, 0.13977599897006332, 0.16550965937549797, 0.15297115712622983, 0.13816762272816197, 0.15015491385978758], [0.1956720067072222, 0.14582796025959086, 0.14133445883143342, 0.13394655273850037, 0.13791919305559774, 0.138730151294858, 0.15371050494373478, 0.1456021292190366, 0.1319250425240813, 0.1375072722049538, 0.1406140990828101, 0.1430055713089789, 0.13864205313828826, 0.13642487696153238, 0.1320614169852181, 0.1509248475087068, 0.13883910409639413, 0.14106540277145516, 0.146049546262876, 0.14334167052496277, 0.1339629372619241, 0.1926185003922003, 0.17758016346464042, 0.1491920333226552, 0.1603667400841546, 0.14280464001872467, 0.14464054922598446, 0.13800030314514808, 0.1493951468764879, 0.16806266838451314, 0.14859748429027228, 0.14231805555086274, 0.13587399464732944, 0.14243874399036224, 0.13670126255638165, 0.14583242858737505, 0.13950632813003996, 0.15562689824634332, 0.1423824250921553, 0.14924298096580296, 0.20697724389322608, 0.1460949487371343, 0.14795469421707771, 0.17430622572129983, 0.14512408492436776, 0.14113554048451676, 0.1537327241751154, 0.17359019459290578, 0.14384879531657424, 0.13959524672300969, 0.15202862152043561, 0.16001697660533684, 0.14846979499789756, 0.1499948669564118, 0.14153124537601383, 0.13772954596303044, 0.14363990972940935, 0.15136808141021244, 0.15613361392220237, 0.13712612253914788, 0.14544337170121016, 0.1432567876747141, 0.1421231957675725, 0.1440786800322997, 0.14538080276408763, 0.13789373750997735, 0.14974069165058337, 0.14076995929686056, 0.14993724186362994, 0.1507901760606768, 0.14004777471082522, 0.15229461354075305, 0.15401760694398595, 0.13710387516752534, 0.1414647027018001, 0.1417456053989467, 0.13354422744653818, 0.14838051421855789, 0.14542395289822482, 0.13991452019243594, 0.15267712632022873, 0.1319640120066646, 0.19650216761649236, 0.13600378730311732, 0.1372221655227576, 0.1390037888795752, 0.1517864602234419, 0.1484784157053542, 0.1410903815585296, 0.14279428667847313, 0.13497946413351267, 0.13466488752669525, 0.15250378644344884, 0.13730303466512367, 0.14912483467418075, 0.1322794152417043, 0.15093638487304123, 0.17621673919998143, 0.13674616172311452, 0.21453883679539418], [0.14450478574527914, 0.1457143474187369, 0.1555370981899616, 0.1436391164732043, 0.14857559892626956, 0.14882189288086745, 0.1468705171288977, 0.16955452187913334, 0.13678532897290058, 0.14089234072321258, 0.1480948847152767, 0.13408940045780832, 0.14579931689397393, 0.13470361790227603, 0.1604917736468268, 0.15336044842290794, 0.1582792226313595, 0.1409912236554027, 0.16070248968400108, 0.15597374264108038, 0.17114745066651715, 0.16362716893034554, 0.1386492317960576, 0.12841458294632446, 0.1496342265676232, 0.15706739426707889, 0.1635651869248081, 0.14458245478630619, 0.14985985580724623, 0.152739890793786, 0.14331329916092353, 0.14298431898321634, 0.1610973259502271, 0.15033029775958864, 0.15221396502935186, 0.13476101510453106, 0.1446673785642301, 0.14537611295308397, 0.13510235171044357, 0.14139872392421085, 0.17265276844730165, 0.15799714500574427, 0.13803596102655175, 0.14706843794819147, 0.17662834672154415, 0.14457045643981284, 0.15080936317524393, 0.1463998860311117, 0.17334334486694544, 0.14094555664159603, 0.17259544597055865, 0.1526627366421763, 0.15557536132580305, 0.17213248558696104, 0.14161228583453916, 0.14646505277949956, 0.17774920347798973, 0.13670674182184786, 0.15978646755911594, 0.14770762046928476, 0.17358979688044174, 0.15290403607434955, 0.14134147884928439, 0.13394596987460397, 0.15485249022234834, 0.13729610280077378, 0.14184233903692803, 0.17034585190186982, 0.14969869836856, 0.14801731555270858, 0.18734475216381527, 0.15692385007131002, 0.14745834051628964, 0.15660488679513565, 0.16224726292320088, 0.17979346151839826, 0.14440590510365417, 0.137562469988272, 0.13574327684035703, 0.17861265829993286, 0.15377183633705652, 0.15079136517331784, 0.1478563827709796, 0.14199839532078198, 0.14706775289001064, 0.14472975755647252, 0.14123002859089054, 0.1502795549442268, 0.14758879610022602, 0.16404339003224105, 0.1434100492836244, 0.13764483215417767, 0.16907631888713312, 0.15129202812043474, 0.14932455989775428, 0.16070251252503212, 0.16074988006598118, 0.15143565239369516, 0.13411982238435155, 0.14487272835960785], [0.15676788250313917, 0.1506111750240834, 0.146119047503663, 0.1531480010744943, 0.15891325553072025, 0.16364789811653932, 0.15138967055471977, 0.15232381776558696, 0.16727705090831244, 0.15365314898559324, 0.1614937835047277, 0.1671729947155535, 0.16834838360903145, 0.1555428431945245, 0.14413711094373374, 0.15297226203477665, 0.1452906868106968, 0.15514675672133005, 0.14883802429867538, 0.15449594618400184, 0.14954692024150854, 0.1468915783804781, 0.16541539622582993, 0.15039639571322477, 0.17431970983768832, 0.15957521947678688, 0.14994130138707149, 0.15574744645838834, 0.15719276362609919, 0.147071947241242, 0.15227145676000942, 0.18620768640824592, 0.1528031184993807, 0.16361215384154876, 0.17189493779090312, 0.157757354432221, 0.15889015229728912, 0.15414096349868017, 0.16862155409976415, 0.156557255063309, 0.15476400805618065, 0.17449627649891436, 0.15845889352308407, 0.16129636565785072, 0.15966690917865856, 0.1572434563962841, 0.15335467182368062, 0.16777616839051446, 0.15699630080635574, 0.15193324740363875, 0.1553303530070425, 0.164390703556413, 0.16347272025784904, 0.15687150028329705, 0.14935728365626375, 0.14754505277673502, 0.14909242318743854, 0.16007571421698163, 0.15391919623818737, 0.15625400008453574, 0.18723545710653547, 0.17213040034699215, 0.15609940501998898, 0.15926549287751007, 0.14567163899063548, 0.16274685080372306, 0.1545960065613862, 0.15633139001406512, 0.15892652999415324, 0.15303934766400776, 0.15059631552493977, 0.15403889891706862, 0.1539022259095633, 0.16253783488461218, 0.1470592387583713, 0.17417077612357532, 0.15750294445046722, 0.15827036163578195, 0.19232291219935202, 0.1709760048004654, 0.15998399198004493, 0.16008795236419954, 0.14577048153026603, 0.15559226733553214, 0.18426932674713797, 0.1575517601905409, 0.16265525389002614, 0.15688122546641214, 0.1449458311711252, 0.14189507294938142, 0.16548916510685419, 0.15712464113055735, 0.15688293182205262, 0.1483154536793583, 0.15759530378933792, 0.15243641076069614, 0.158700820353922, 0.1633138552220091, 0.18171188056649712, 0.1523011145605004], [0.15064835242739164, 0.20116666607354042, 0.15043956564726252, 0.14466675394693784, 0.15637998128337444, 0.15741822782432005, 0.13977683219367534, 0.1957412289440031, 0.13923360970699244, 0.1446182371621637, 0.13834016444465763, 0.19903707647390437, 0.15266927000749647, 0.1577752914338156, 0.1545287056546679, 0.14619779489477683, 0.18224028244463764, 0.1449362110746292, 0.14841518733616862, 0.14981980583887486, 0.14439088742722198, 0.15432571128956407, 0.14431185452551523, 0.1494474987670734, 0.1499296451748242, 0.1792709265788088, 0.15179620307033861, 0.14046119839668175, 0.1589951986714733, 0.1587971986838449, 0.16179333596288084, 0.14496687634342334, 0.1427064543647107, 0.1463452103669078, 0.19098869318145137, 0.1423410099162198, 0.13606055877363937, 0.15730215390106178, 0.1549993938710938, 0.15824924988456524, 0.15445091794423874, 0.16005178277938328, 0.1389694667076749, 0.14465356705709778, 0.19681848479017147, 0.16208120246861274, 0.13682343115838388, 0.14264250690168176, 0.1346243061450475, 0.15213623560499884, 0.15188804310584791, 0.16307429906602688, 0.18608934612902422, 0.15008991311402242, 0.15346980937051286, 0.1513904047600632, 0.138051413083824, 0.14444643879336055, 0.14293866624276227, 0.14493318641123032, 0.15073820451093442, 0.16209066222935622, 0.15609492424577898, 0.15339065156215131, 0.13894327416962535, 0.13706537389074008, 0.1454998798966734, 0.14816572062116629, 0.16048427962479048, 0.15868248935977627, 0.1433096077699594, 0.15765934927980016, 0.1445478165092159, 0.13537088967258903, 0.16484692239636423, 0.15681327978953305, 0.13823553836367322, 0.15720133449390905, 0.1426446097947524, 0.14257951544909594, 0.1428863212311613, 0.1572940811926901, 0.13806761812474513, 0.1708951499407444, 0.1497420224881769, 0.15279538896895953, 0.1513420762936911, 0.15307931975940578, 0.16577586008319378, 0.14025460327410805, 0.1587351406153104, 0.13412322669933777, 0.14769282479997062, 0.14592683075271304, 0.17153813510024377, 0.15053994597308007, 0.18731208881356295, 0.19872610671513688, 0.1841662522331951, 0.13422272693053547], [0.18181722019501215, 0.13875190346067637, 0.1434974174522277, 0.15056958156680675, 0.19827204377214533, 0.15921230878495077, 0.1386356089299053, 0.1510407025688063, 0.14337780219542212, 0.1410132198224032, 0.13271982492164613, 0.15893605155993584, 0.16640501776760439, 0.14563240579388123, 0.14045729078900115, 0.15651224676956504, 0.13695008439302267, 0.15157098201166191, 0.14881164301028307, 0.14409529838958476, 0.15213301195228676, 0.157048839738969, 0.13661235724713386, 0.14050145437177985, 0.14427626025663914, 0.15313316158120382, 0.14641473340092118, 0.14423881930033242, 0.15487425897069923, 0.13493039638028476, 0.14265930334976998, 0.13926964709849904, 0.15517305682143215, 0.156840168973403, 0.14120398891609437, 0.14258982720768837, 0.16224171521813027, 0.1487020658844222, 0.13593975162293093, 0.13552402374835276, 0.14435497567590433, 0.14551984656396055, 0.16925695038026414, 0.12532000473876634, 0.18787707719901314, 0.14494349346856306, 0.1460512700361367, 0.13764790699935003, 0.13205003919786196, 0.14312726436538106, 0.17641827595770393, 0.13281619405067382, 0.21002640920684798, 0.14321731551404313, 0.17479177096737247, 0.1421983860486019, 0.1421886281551943, 0.15029200646874508, 0.1473593591348698, 0.1461791592183094, 0.14995947075456567, 0.1697644130822565, 0.1510501770415216, 0.1400723544027716, 0.1460962022509319, 0.13876860340920166, 0.14118568961155942, 0.15033228824650205, 0.13811125545597394, 0.14858503827371414, 0.20975600554784413, 0.16307940402624038, 0.15869262164160572, 0.13700591045887486, 0.13700591045887486, 0.20220167392624913, 0.14708098803722688, 0.1412210489031462, 0.14796775532369322, 0.13488335442887064, 0.13772982826965108, 0.13449131824271635, 0.145407529841331, 0.2042208435093412, 0.152977855852745, 0.13525574446942762, 0.14041395660614236, 0.1458328358296098, 0.14631114120221003, 0.1342305386963775, 0.16227988289823334, 0.1431539862980931, 0.15060583592754204, 0.15952910939003356, 0.1566258669244816, 0.1537752727590032, 0.1539086023339344, 0.16598925365010353, 0.17507586529075203, 0.13986227065308077]]
    lossveclist = lossvec0+lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.1$, $n=6$')
    
    lossvec0 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598]]
    lossveclist = [[0.14509325259013878, 0.14028874836906774, 0.15305064950853794, 0.16164990223848158, 0.14600334611479598, 0.14222540439564113, 0.13819926446274894, 0.14888751519994395, 0.13601042925395454, 0.13705411416940977, 0.15017616990619576, 0.1312379783345067, 0.1399484932259146, 0.13867950539952534, 0.15473940085023505, 0.16492083747756797, 0.15266627729906476, 0.14303711984400314, 0.13944081571793362, 0.1351921195153755, 0.15000995864717762, 0.13785200299246733, 0.13972241307192595, 0.1390171111021526, 0.1741896010859611, 0.1523797619746385, 0.16802109843462054, 0.2031044061496549, 0.13994207470188078, 0.1493886304687554, 0.1421754071608363, 0.14819472020134955, 0.16730339147588053, 0.14273239657853296, 0.13527345028311655, 0.161211796889484, 0.15418280898428968, 0.1660452606865663, 0.16150255257113955, 0.14213185150950894, 0.16426791944900046, 0.14820635833013102, 0.1379348973871464, 0.15140720104735936, 0.15692154621266824, 0.13800025303241972, 0.15247775657441595, 0.1644960062364241, 0.14578730342459145, 0.15137928900502245, 0.15856592647467407, 0.1452533446898607, 0.13957331327211198, 0.16653186540898943, 0.1414586386472211, 0.13863761618792944, 0.15044269753193415, 0.13513057159191263, 0.1504710967707737, 0.14143042379029486, 0.15663931070287654, 0.15513959857473436, 0.14020565695676762, 0.14589390237896285, 0.13989413525049613, 0.13558801438885254, 0.1306796412110928, 0.1454250416842359, 0.20039562872768904, 0.1464782403034093, 0.13988968170112726, 0.13273908598086082, 0.15927546532370224, 0.1489380419506682, 0.1531876733846838, 0.19678434779440154, 0.1530507244232428, 0.13319105520055818, 0.16125454610296305, 0.15576736897330287, 0.1528635292552078, 0.15762210764858464, 0.1372813163402822, 0.14506678236295964, 0.14274206157870375, 0.14123908436351088, 0.14406353557244958, 0.16702307800312768, 0.1615712677311207, 0.1824616590030932, 0.16768892695608154, 0.14098816716858714, 0.15737226104821228, 0.16533306200044573, 0.13715882215889497, 0.13977599897006332, 0.16550965937549797, 0.15297115712622983, 0.13816762272816197, 0.15015491385978758], [0.1956720067072222, 0.14582796025959086, 0.14133445883143342, 0.13394655273850037, 0.13791919305559774, 0.138730151294858, 0.15371050494373478, 0.1456021292190366, 0.1319250425240813, 0.1375072722049538, 0.1406140990828101, 0.1430055713089789, 0.13864205313828826, 0.13642487696153238, 0.1320614169852181, 0.1509248475087068, 0.13883910409639413, 0.14106540277145516, 0.146049546262876, 0.14334167052496277, 0.1339629372619241, 0.1926185003922003, 0.17758016346464042, 0.1491920333226552, 0.1603667400841546, 0.14280464001872467, 0.14464054922598446, 0.13800030314514808, 0.1493951468764879, 0.16806266838451314, 0.14859748429027228, 0.14231805555086274, 0.13587399464732944, 0.14243874399036224, 0.13670126255638165, 0.14583242858737505, 0.13950632813003996, 0.15562689824634332, 0.1423824250921553, 0.14924298096580296, 0.20697724389322608, 0.1460949487371343, 0.14795469421707771, 0.17430622572129983, 0.14512408492436776, 0.14113554048451676, 0.1537327241751154, 0.17359019459290578, 0.14384879531657424, 0.13959524672300969, 0.15202862152043561, 0.16001697660533684, 0.14846979499789756, 0.1499948669564118, 0.14153124537601383, 0.13772954596303044, 0.14363990972940935, 0.15136808141021244, 0.15613361392220237, 0.13712612253914788, 0.14544337170121016, 0.1432567876747141, 0.1421231957675725, 0.1440786800322997, 0.14538080276408763, 0.13789373750997735, 0.14974069165058337, 0.14076995929686056, 0.14993724186362994, 0.1507901760606768, 0.14004777471082522, 0.15229461354075305, 0.15401760694398595, 0.13710387516752534, 0.1414647027018001, 0.1417456053989467, 0.13354422744653818, 0.14838051421855789, 0.14542395289822482, 0.13991452019243594, 0.15267712632022873, 0.1319640120066646, 0.19650216761649236, 0.13600378730311732, 0.1372221655227576, 0.1390037888795752, 0.1517864602234419, 0.1484784157053542, 0.1410903815585296, 0.14279428667847313, 0.13497946413351267, 0.13466488752669525, 0.15250378644344884, 0.13730303466512367, 0.14912483467418075, 0.1322794152417043, 0.15093638487304123, 0.17621673919998143, 0.13674616172311452, 0.21453883679539418], [0.14450478574527914, 0.1457143474187369, 0.1555370981899616, 0.1436391164732043, 0.14857559892626956, 0.14882189288086745, 0.1468705171288977, 0.16955452187913334, 0.13678532897290058, 0.14089234072321258, 0.1480948847152767, 0.13408940045780832, 0.14579931689397393, 0.13470361790227603, 0.1604917736468268, 0.15336044842290794, 0.1582792226313595, 0.1409912236554027, 0.16070248968400108, 0.15597374264108038, 0.17114745066651715, 0.16362716893034554, 0.1386492317960576, 0.12841458294632446, 0.1496342265676232, 0.15706739426707889, 0.1635651869248081, 0.14458245478630619, 0.14985985580724623, 0.152739890793786, 0.14331329916092353, 0.14298431898321634, 0.1610973259502271, 0.15033029775958864, 0.15221396502935186, 0.13476101510453106, 0.1446673785642301, 0.14537611295308397, 0.13510235171044357, 0.14139872392421085, 0.17265276844730165, 0.15799714500574427, 0.13803596102655175, 0.14706843794819147, 0.17662834672154415, 0.14457045643981284, 0.15080936317524393, 0.1463998860311117, 0.17334334486694544, 0.14094555664159603, 0.17259544597055865, 0.1526627366421763, 0.15557536132580305, 0.17213248558696104, 0.14161228583453916, 0.14646505277949956, 0.17774920347798973, 0.13670674182184786, 0.15978646755911594, 0.14770762046928476, 0.17358979688044174, 0.15290403607434955, 0.14134147884928439, 0.13394596987460397, 0.15485249022234834, 0.13729610280077378, 0.14184233903692803, 0.17034585190186982, 0.14969869836856, 0.14801731555270858, 0.18734475216381527, 0.15692385007131002, 0.14745834051628964, 0.15660488679513565, 0.16224726292320088, 0.17979346151839826, 0.14440590510365417, 0.137562469988272, 0.13574327684035703, 0.17861265829993286, 0.15377183633705652, 0.15079136517331784, 0.1478563827709796, 0.14199839532078198, 0.14706775289001064, 0.14472975755647252, 0.14123002859089054, 0.1502795549442268, 0.14758879610022602, 0.16404339003224105, 0.1434100492836244, 0.13764483215417767, 0.16907631888713312, 0.15129202812043474, 0.14932455989775428, 0.16070251252503212, 0.16074988006598118, 0.15143565239369516, 0.13411982238435155, 0.14487272835960785], [0.15676788250313917, 0.1506111750240834, 0.146119047503663, 0.1531480010744943, 0.15891325553072025, 0.16364789811653932, 0.15138967055471977, 0.15232381776558696, 0.16727705090831244, 0.15365314898559324, 0.1614937835047277, 0.1671729947155535, 0.16834838360903145, 0.1555428431945245, 0.14413711094373374, 0.15297226203477665, 0.1452906868106968, 0.15514675672133005, 0.14883802429867538, 0.15449594618400184, 0.14954692024150854, 0.1468915783804781, 0.16541539622582993, 0.15039639571322477, 0.17431970983768832, 0.15957521947678688, 0.14994130138707149, 0.15574744645838834, 0.15719276362609919, 0.147071947241242, 0.15227145676000942, 0.18620768640824592, 0.1528031184993807, 0.16361215384154876, 0.17189493779090312, 0.157757354432221, 0.15889015229728912, 0.15414096349868017, 0.16862155409976415, 0.156557255063309, 0.15476400805618065, 0.17449627649891436, 0.15845889352308407, 0.16129636565785072, 0.15966690917865856, 0.1572434563962841, 0.15335467182368062, 0.16777616839051446, 0.15699630080635574, 0.15193324740363875, 0.1553303530070425, 0.164390703556413, 0.16347272025784904, 0.15687150028329705, 0.14935728365626375, 0.14754505277673502, 0.14909242318743854, 0.16007571421698163, 0.15391919623818737, 0.15625400008453574, 0.18723545710653547, 0.17213040034699215, 0.15609940501998898, 0.15926549287751007, 0.14567163899063548, 0.16274685080372306, 0.1545960065613862, 0.15633139001406512, 0.15892652999415324, 0.15303934766400776, 0.15059631552493977, 0.15403889891706862, 0.1539022259095633, 0.16253783488461218, 0.1470592387583713, 0.17417077612357532, 0.15750294445046722, 0.15827036163578195, 0.19232291219935202, 0.1709760048004654, 0.15998399198004493, 0.16008795236419954, 0.14577048153026603, 0.15559226733553214, 0.18426932674713797, 0.1575517601905409, 0.16265525389002614, 0.15688122546641214, 0.1449458311711252, 0.14189507294938142, 0.16548916510685419, 0.15712464113055735, 0.15688293182205262, 0.1483154536793583, 0.15759530378933792, 0.15243641076069614, 0.158700820353922, 0.1633138552220091, 0.18171188056649712, 0.1523011145605004], [0.15064835242739164, 0.20116666607354042, 0.15043956564726252, 0.14466675394693784, 0.15637998128337444, 0.15741822782432005, 0.13977683219367534, 0.1957412289440031, 0.13923360970699244, 0.1446182371621637, 0.13834016444465763, 0.19903707647390437, 0.15266927000749647, 0.1577752914338156, 0.1545287056546679, 0.14619779489477683, 0.18224028244463764, 0.1449362110746292, 0.14841518733616862, 0.14981980583887486, 0.14439088742722198, 0.15432571128956407, 0.14431185452551523, 0.1494474987670734, 0.1499296451748242, 0.1792709265788088, 0.15179620307033861, 0.14046119839668175, 0.1589951986714733, 0.1587971986838449, 0.16179333596288084, 0.14496687634342334, 0.1427064543647107, 0.1463452103669078, 0.19098869318145137, 0.1423410099162198, 0.13606055877363937, 0.15730215390106178, 0.1549993938710938, 0.15824924988456524, 0.15445091794423874, 0.16005178277938328, 0.1389694667076749, 0.14465356705709778, 0.19681848479017147, 0.16208120246861274, 0.13682343115838388, 0.14264250690168176, 0.1346243061450475, 0.15213623560499884, 0.15188804310584791, 0.16307429906602688, 0.18608934612902422, 0.15008991311402242, 0.15346980937051286, 0.1513904047600632, 0.138051413083824, 0.14444643879336055, 0.14293866624276227, 0.14493318641123032, 0.15073820451093442, 0.16209066222935622, 0.15609492424577898, 0.15339065156215131, 0.13894327416962535, 0.13706537389074008, 0.1454998798966734, 0.14816572062116629, 0.16048427962479048, 0.15868248935977627, 0.1433096077699594, 0.15765934927980016, 0.1445478165092159, 0.13537088967258903, 0.16484692239636423, 0.15681327978953305, 0.13823553836367322, 0.15720133449390905, 0.1426446097947524, 0.14257951544909594, 0.1428863212311613, 0.1572940811926901, 0.13806761812474513, 0.1708951499407444, 0.1497420224881769, 0.15279538896895953, 0.1513420762936911, 0.15307931975940578, 0.16577586008319378, 0.14025460327410805, 0.1587351406153104, 0.13412322669933777, 0.14769282479997062, 0.14592683075271304, 0.17153813510024377, 0.15053994597308007, 0.18731208881356295, 0.19872610671513688, 0.1841662522331951, 0.13422272693053547], [0.18181722019501215, 0.13875190346067637, 0.1434974174522277, 0.15056958156680675, 0.19827204377214533, 0.15921230878495077, 0.1386356089299053, 0.1510407025688063, 0.14337780219542212, 0.1410132198224032, 0.13271982492164613, 0.15893605155993584, 0.16640501776760439, 0.14563240579388123, 0.14045729078900115, 0.15651224676956504, 0.13695008439302267, 0.15157098201166191, 0.14881164301028307, 0.14409529838958476, 0.15213301195228676, 0.157048839738969, 0.13661235724713386, 0.14050145437177985, 0.14427626025663914, 0.15313316158120382, 0.14641473340092118, 0.14423881930033242, 0.15487425897069923, 0.13493039638028476, 0.14265930334976998, 0.13926964709849904, 0.15517305682143215, 0.156840168973403, 0.14120398891609437, 0.14258982720768837, 0.16224171521813027, 0.1487020658844222, 0.13593975162293093, 0.13552402374835276, 0.14435497567590433, 0.14551984656396055, 0.16925695038026414, 0.12532000473876634, 0.18787707719901314, 0.14494349346856306, 0.1460512700361367, 0.13764790699935003, 0.13205003919786196, 0.14312726436538106, 0.17641827595770393, 0.13281619405067382, 0.21002640920684798, 0.14321731551404313, 0.17479177096737247, 0.1421983860486019, 0.1421886281551943, 0.15029200646874508, 0.1473593591348698, 0.1461791592183094, 0.14995947075456567, 0.1697644130822565, 0.1510501770415216, 0.1400723544027716, 0.1460962022509319, 0.13876860340920166, 0.14118568961155942, 0.15033228824650205, 0.13811125545597394, 0.14858503827371414, 0.20975600554784413, 0.16307940402624038, 0.15869262164160572, 0.13700591045887486, 0.13700591045887486, 0.20220167392624913, 0.14708098803722688, 0.1412210489031462, 0.14796775532369322, 0.13488335442887064, 0.13772982826965108, 0.13449131824271635, 0.145407529841331, 0.2042208435093412, 0.152977855852745, 0.13525574446942762, 0.14041395660614236, 0.1458328358296098, 0.14631114120221003, 0.1342305386963775, 0.16227988289823334, 0.1431539862980931, 0.15060583592754204, 0.15952910939003356, 0.1566258669244816, 0.1537752727590032, 0.1539086023339344, 0.16598925365010353, 0.17507586529075203, 0.13986227065308077]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist: # FOR INTERVAL ON PERCENT IMPROVEMENT FROM NULL DESIGN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    for lst in lossveclist: # FOR INTERVAL ON MEAN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = ((mn-intval))
        hiperc = ((mn+intval))
        print('['+str(loperc)+', '+str(hiperc)+']')
    # VIA APPROXIMATION
    lossvec = [0.1921631393187371, 0.1496456552426906, 0.17465394927838565, 0.14176718850304493, 0.1477586080539812, 0.15747761746906022]
        
    '''

    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.12847026958561233, 0.11986732398951072, 0.13060367191347091, 0.13456141828997675, 0.1274179951384851, 0.1395853466736562, 0.11949711627700356, 0.14222439398953382, 0.12650237999957095, 0.11742182455737671, 0.125807002876967, 0.1184952562133039, 0.11595927744994752, 0.13241341970960263, 0.1330365092362536, 0.14702475658549582, 0.12372548979744037, 0.12326210162435598, 0.11596437064058449, 0.1360079427634559, 0.13490036368964048, 0.12857099981465742, 0.12546313943515863, 0.12160934132043706, 0.1462538289015319, 0.12058229113278009, 0.1906528527577479, 0.12731827990432867, 0.15162017453679544, 0.11729449808267677, 0.1190441940260026, 0.11461052983150097, 0.12314952671527217, 0.13401586619002537, 0.11792195626961513, 0.12672867159599627, 0.13739567825608845, 0.12373221054427508, 0.1297344567932947, 0.13560544320405665, 0.19761742209602334, 0.12606856696655194, 0.1379339281846113, 0.1374334378123528, 0.1306824291013811, 0.11803407486284032, 0.12967267696704565, 0.11771991263021934, 0.1346792598792127, 0.1409915447125594, 0.12118391932460561, 0.12343177753491975, 0.12827072105544465, 0.13515099777805797, 0.1419930223266828, 0.13708165525755409, 0.12851654777366114, 0.12072503892420437, 0.13588302574565375, 0.12763095569671912, 0.11770390994278485, 0.1337648303433984, 0.1717760059155993, 0.12769012395302703, 0.14218244225977397, 0.12415284258856643, 0.12592778571793506, 0.12462257842242966, 0.14994368569109445, 0.1184717062250044, 0.127352890061241, 0.1261733842087149, 0.1553400615115116, 0.12521722674144753, 0.140173063194675, 0.17588188191245271, 0.13714986387224123, 0.1271717829247304, 0.12247977824019007, 0.145766957774525, 0.13598255520000507, 0.13351997498557475, 0.12627843146354406, 0.12668244354246871, 0.13096893060481926, 0.12175318020999325, 0.16310087594160333, 0.16095717672883847, 0.1300863114218935, 0.14288872177752412, 0.12794333127672622, 0.13113273545611268, 0.14831587955772, 0.1331221376427609, 0.12098932922272174, 0.12482044143706773, 0.15980859235266884, 0.16760616557412308, 0.12400024308665411, 0.12109142757996429], [0.10706549287250079, 0.11575611710588574, 0.11657755694309162, 0.16261739870199468, 0.13044543811112205, 0.13597871423477614, 0.1162521924230518, 0.11451468777257316, 0.11977597197875277, 0.14706270459984383, 0.11710752464564515, 0.10042574426077899, 0.13200671674442208, 0.11956001986469626, 0.14352235169529448, 0.13941878520513282, 0.11014525523119775, 0.10043722950557356, 0.12029623451868249, 0.13085447101444728, 0.11453146422406418, 0.17624798196585864, 0.14802263895111217, 0.10563726772450745, 0.11133843244043405, 0.17849680482103586, 0.14070005356490364, 0.14096922814148977, 0.156119362323945, 0.11431832309758867, 0.1347037871678656, 0.10827995515121462, 0.12991595333241354, 0.11288800385497598, 0.1087194394506875, 0.13957184220395502, 0.11433250028736858, 0.1154339703968407, 0.13531303685378834, 0.1181845974938699, 0.1624782253808026, 0.10785906088538802, 0.11187337490987176, 0.1490282005501971, 0.16584111420698566, 0.10409255587349321, 0.1531767083995999, 0.13969790265815368, 0.15893111057070325, 0.1350896551679034, 0.11223328144029465, 0.11122693364823041, 0.156758751098658, 0.13926181585327896, 0.12928728514951857, 0.14880967338603854, 0.11426618162572089, 0.12765392949835094, 0.16174518844820734, 0.12906559110102445, 0.11659937296517346, 0.10805969683894634, 0.1124038253730161, 0.11256266423435923, 0.13337769706865218, 0.12564355984905443, 0.15759371095454633, 0.1334435348161012, 0.11424065270941168, 0.10670547781120827, 0.1340283971088839, 0.11229038996424014, 0.13919071089398244, 0.11865267981990554, 0.19434057273740335, 0.16108895386440805, 0.1339694198446523, 0.1444760773776637, 0.11576840064181515, 0.15682787631356135, 0.1333306475033713, 0.11269576857300377, 0.105196751357552, 0.14939289076638698, 0.11654199774278479, 0.10779133744224585, 0.11893456865733175, 0.11701383813184087, 0.11127528879372119, 0.16543984467098882, 0.18119717818983047, 0.11419431420662064, 0.16719167236741772, 0.11701261937403842, 0.11162983384442594, 0.11346742968022439, 0.12262265636152543, 0.1353553759373205, 0.13483725103248212, 0.10472127378800088], [0.11678330073853264, 0.1483791506375431, 0.14301199387015806, 0.15291720046764978, 0.12932617682376016, 0.11415161831739352, 0.13594132427209848, 0.12851750912928456, 0.11248114383222577, 0.12569532953866397, 0.13116045541080357, 0.11350277061595218, 0.12389588123048184, 0.12255118084248208, 0.12284882809920945, 0.13101887036737578, 0.138084520666699, 0.1222912567850896, 0.11060620781755158, 0.13532426606855924, 0.12088575345283185, 0.1385368374689929, 0.11619970130129674, 0.12457753959628065, 0.13055800683995697, 0.13538545412131597, 0.14276802801025254, 0.1374871166073497, 0.15312490598902023, 0.1311127947083507, 0.12509808772524494, 0.12665143866605372, 0.14334383550981983, 0.13091911295528422, 0.12893982634754697, 0.11608514495001748, 0.11858905120451496, 0.1250175749211199, 0.11806106548991627, 0.15243464137467358, 0.16870203684370985, 0.12830671483036343, 0.11548252484653072, 0.1505001008801831, 0.15115493328869029, 0.11667149774132125, 0.1243792772803687, 0.1280739476470694, 0.1300164370813426, 0.12132283907291189, 0.12093929338546512, 0.12594551117214187, 0.16804669258024021, 0.15495788201033703, 0.13710339770258398, 0.12687569415258093, 0.12563536725886024, 0.1585903134223614, 0.13340856579979055, 0.13097073330511214, 0.1322598244909756, 0.12497751366881622, 0.16082242067367697, 0.13102265922097037, 0.13999650830061847, 0.12940941740665673, 0.13611910200945787, 0.13426229500361453, 0.12467430197220103, 0.1280500475944258, 0.13499429373161861, 0.12933260074498812, 0.12918639683395922, 0.14038571042123474, 0.16182826356035337, 0.17207014456170683, 0.14677207023614533, 0.1267900443293803, 0.14383984254649396, 0.14359682121981873, 0.12230830793897036, 0.11839440032337135, 0.12801523418544866, 0.12754693512342496, 0.1429154338734327, 0.12006421074473932, 0.13423051645822143, 0.13556868485588958, 0.12954861499487944, 0.12082549577064108, 0.12580973946180612, 0.12625040853445754, 0.15050355161408746, 0.12750415834131537, 0.1351781983382809, 0.13302548918098675, 0.13871047053836819, 0.15974484376388454, 0.12162680349486192, 0.11474779719424359], [0.1465059056453364, 0.17355428874149662, 0.15328000856689084, 0.15894192282782818, 0.17324043716825477, 0.15296093718557302, 0.1476807779826612, 0.15667981267214043, 0.14473882938402513, 0.147041241266836, 0.15386320059016986, 0.16552708813511469, 0.1540470583169911, 0.14328984608230924, 0.14375082683266385, 0.16617922349383918, 0.16088134938666387, 0.14765605602145176, 0.17435801311728671, 0.14827551829661414, 0.15329763697303322, 0.14472953426787188, 0.17125010340584843, 0.14572248129073692, 0.1336153120653446, 0.14582927809867732, 0.14848843370764533, 0.1747603051372686, 0.14383653678616662, 0.1619096631813556, 0.15540647378180358, 0.17265403646729033, 0.16111132921561488, 0.1467410645444637, 0.16665112559753137, 0.13917985697713006, 0.1734736031717337, 0.1581829967982839, 0.17158968955526813, 0.14506370061665497, 0.14202851635371547, 0.16475734273539983, 0.19468669913179526, 0.13759816729071742, 0.13796843994938945, 0.14376524182355194, 0.15355883720603658, 0.1925442891993296, 0.15769448639185818, 0.15132611280032016, 0.14602854920007455, 0.17288197778989967, 0.16947775151741457, 0.14431249870861976, 0.16104860701090984, 0.14727555923722968, 0.1649651566116195, 0.14752840612486381, 0.15137804508655991, 0.14569669080603223, 0.1886501083563279, 0.14774107101103773, 0.1846084498196342, 0.14349051783817388, 0.15687810389800352, 0.15317412505174166, 0.15008903035618867, 0.17266662696106372, 0.1408409323301772, 0.14412658538385037, 0.16184467539954767, 0.15487166636429472, 0.16349459098795593, 0.15432584946619862, 0.16286403507204014, 0.1484365267435558, 0.1462836172990036, 0.1805471712448447, 0.15163430576165168, 0.15715392809565756, 0.15185956501014095, 0.167501148591377, 0.1505870181461255, 0.15521711585069486, 0.17353187983092488, 0.14289005591572185, 0.14327479126262316, 0.15733999784282526, 0.1775225130507548, 0.16616768296254153, 0.15145744171131506, 0.16047095595386854, 0.15183626179124074, 0.13189694008126293, 0.15654448895545303, 0.1679146473604498, 0.14783128588845795, 0.16074508329785836, 0.1567832983396268, 0.14849840354821386], [0.12239399036962419, 0.1197086261601347, 0.12424211859793748, 0.1635220026458285, 0.1089637048993127, 0.16846708251443296, 0.14408634583360755, 0.13476450629262407, 0.11544993460130562, 0.13529244488181053, 0.11647890705496407, 0.10200788055334584, 0.16852112557916435, 0.13583524212164005, 0.10852897248325585, 0.11539355039000641, 0.15837853318146086, 0.12535002633620215, 0.16430813553052098, 0.13408645758854704, 0.1195983896918656, 0.11342568957821446, 0.13988713376969597, 0.11522263111548936, 0.15333439620507017, 0.10592083797633782, 0.1430609118897678, 0.13407771983393496, 0.16303638545416438, 0.10562893541059999, 0.10842261745442096, 0.1313201522438386, 0.1278049059720508, 0.12847973230537013, 0.09723977354309747, 0.13368493891311553, 0.1391343390695247, 0.11255785309292166, 0.12849223015610456, 0.10683901254437689, 0.23481491316234634, 0.12559433428323516, 0.16953349833124, 0.11491023421346894, 0.23360709780496078, 0.13194388057949516, 0.13419796101246945, 0.12912481742791232, 0.14903923016798754, 0.1116636429006959, 0.10944792225755616, 0.11074028882316397, 0.15258821863270447, 0.10664872937864546, 0.153635299569851, 0.12622624343937944, 0.13601994904646622, 0.1400035845719506, 0.13092231410371158, 0.1302476074911012, 0.13787212755683526, 0.11278520625311116, 0.11887383965717363, 0.11023236202258775, 0.11533475599376847, 0.16877783236693417, 0.16175066398667418, 0.11019125719897276, 0.11772698704897126, 0.11369291537738112, 0.11249057684541804, 0.12793067463774582, 0.12150863658112937, 0.13143969474767958, 0.1150784722196714, 0.18883632340292317, 0.1094204301469329, 0.12313822834051655, 0.13523720497236436, 0.14721144228801009, 0.1429131576440633, 0.1291553627751315, 0.14144920583947618, 0.15086967794831527, 0.1141639502689692, 0.10964170484455242, 0.11429630650151062, 0.14081298926214164, 0.143604712493729, 0.14652441772489064, 0.1657315644452783, 0.13329970819074438, 0.15431912827034824, 0.1474714170079802, 0.16782388055185915, 0.12368815625903269, 0.1141116077252593, 0.12379776726011253, 0.14272541108036985, 0.14555897805050658], [0.1502025437845887, 0.10954743001641694, 0.11752810843747293, 0.136925599190986, 0.12995982060526312, 0.11158516795697226, 0.10528831651041211, 0.10418835960384869, 0.13634588459644836, 0.14767260654584083, 0.11293964487100557, 0.10530301140382549, 0.11070578921442562, 0.11717973799649849, 0.12946781165682497, 0.13707974727474354, 0.11212882962495944, 0.10520842234487214, 0.12593143718837302, 0.10736313890807066, 0.1297720124959698, 0.11716177301879234, 0.10630349758541678, 0.11207591281794525, 0.1386097206467458, 0.11182755361043692, 0.14577850108694873, 0.13981342638865632, 0.10714386490894132, 0.11299092864245504, 0.11740393306141846, 0.116486774066614, 0.11309897013903854, 0.11108143017195383, 0.10739738617028358, 0.10603954095836655, 0.14723912576358572, 0.11138088070907391, 0.13193374185687462, 0.11546370811414708, 0.14968279066957121, 0.10728093887363854, 0.11224933379927363, 0.1531536916122009, 0.21130165374224438, 0.10790067438979271, 0.145274298151255, 0.10809409659846259, 0.16454685959707555, 0.11986873258641192, 0.1093919508048078, 0.15214492456046252, 0.12241689007127254, 0.15233828520794385, 0.1477002670266664, 0.11682125160422556, 0.1612450145107434, 0.11462144119638207, 0.17029741429213843, 0.17666313203034684, 0.13046982628625792, 0.11452315015346587, 0.11159108337844098, 0.11278996481683422, 0.13407981337896288, 0.14060699419859812, 0.17046302556931262, 0.19509018799805197, 0.12598638724298403, 0.11466884915425202, 0.1607359447695591, 0.12116741727689816, 0.12279811064457224, 0.11340971826279163, 0.1303229762303293, 0.1722897020405344, 0.1148431646196073, 0.11229024346021345, 0.13169130404526172, 0.16578175283619956, 0.14908639876681473, 0.114158475241508, 0.14060348197898215, 0.1769387683187289, 0.12257616509694474, 0.1102774362877409, 0.13969536569060098, 0.11971147899497465, 0.11235779184303205, 0.1506955870487662, 0.11301449885252206, 0.12023191288769444, 0.11889625471725013, 0.11195282415528253, 0.10796394387973061, 0.1241821107589637, 0.15486676574005767, 0.14209648959527185, 0.16354623814002167, 0.10783557610989845]]
    lossvec0 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598]]
    lossveclist = lossvec0+lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.1$, $n=30$')
    
    lossveclist = [[0.12847026958561233, 0.11986732398951072, 0.13060367191347091, 0.13456141828997675, 0.1274179951384851, 0.1395853466736562, 0.11949711627700356, 0.14222439398953382, 0.12650237999957095, 0.11742182455737671, 0.125807002876967, 0.1184952562133039, 0.11595927744994752, 0.13241341970960263, 0.1330365092362536, 0.14702475658549582, 0.12372548979744037, 0.12326210162435598, 0.11596437064058449, 0.1360079427634559, 0.13490036368964048, 0.12857099981465742, 0.12546313943515863, 0.12160934132043706, 0.1462538289015319, 0.12058229113278009, 0.1906528527577479, 0.12731827990432867, 0.15162017453679544, 0.11729449808267677, 0.1190441940260026, 0.11461052983150097, 0.12314952671527217, 0.13401586619002537, 0.11792195626961513, 0.12672867159599627, 0.13739567825608845, 0.12373221054427508, 0.1297344567932947, 0.13560544320405665, 0.19761742209602334, 0.12606856696655194, 0.1379339281846113, 0.1374334378123528, 0.1306824291013811, 0.11803407486284032, 0.12967267696704565, 0.11771991263021934, 0.1346792598792127, 0.1409915447125594, 0.12118391932460561, 0.12343177753491975, 0.12827072105544465, 0.13515099777805797, 0.1419930223266828, 0.13708165525755409, 0.12851654777366114, 0.12072503892420437, 0.13588302574565375, 0.12763095569671912, 0.11770390994278485, 0.1337648303433984, 0.1717760059155993, 0.12769012395302703, 0.14218244225977397, 0.12415284258856643, 0.12592778571793506, 0.12462257842242966, 0.14994368569109445, 0.1184717062250044, 0.127352890061241, 0.1261733842087149, 0.1553400615115116, 0.12521722674144753, 0.140173063194675, 0.17588188191245271, 0.13714986387224123, 0.1271717829247304, 0.12247977824019007, 0.145766957774525, 0.13598255520000507, 0.13351997498557475, 0.12627843146354406, 0.12668244354246871, 0.13096893060481926, 0.12175318020999325, 0.16310087594160333, 0.16095717672883847, 0.1300863114218935, 0.14288872177752412, 0.12794333127672622, 0.13113273545611268, 0.14831587955772, 0.1331221376427609, 0.12098932922272174, 0.12482044143706773, 0.15980859235266884, 0.16760616557412308, 0.12400024308665411, 0.12109142757996429], [0.10706549287250079, 0.11575611710588574, 0.11657755694309162, 0.16261739870199468, 0.13044543811112205, 0.13597871423477614, 0.1162521924230518, 0.11451468777257316, 0.11977597197875277, 0.14706270459984383, 0.11710752464564515, 0.10042574426077899, 0.13200671674442208, 0.11956001986469626, 0.14352235169529448, 0.13941878520513282, 0.11014525523119775, 0.10043722950557356, 0.12029623451868249, 0.13085447101444728, 0.11453146422406418, 0.17624798196585864, 0.14802263895111217, 0.10563726772450745, 0.11133843244043405, 0.17849680482103586, 0.14070005356490364, 0.14096922814148977, 0.156119362323945, 0.11431832309758867, 0.1347037871678656, 0.10827995515121462, 0.12991595333241354, 0.11288800385497598, 0.1087194394506875, 0.13957184220395502, 0.11433250028736858, 0.1154339703968407, 0.13531303685378834, 0.1181845974938699, 0.1624782253808026, 0.10785906088538802, 0.11187337490987176, 0.1490282005501971, 0.16584111420698566, 0.10409255587349321, 0.1531767083995999, 0.13969790265815368, 0.15893111057070325, 0.1350896551679034, 0.11223328144029465, 0.11122693364823041, 0.156758751098658, 0.13926181585327896, 0.12928728514951857, 0.14880967338603854, 0.11426618162572089, 0.12765392949835094, 0.16174518844820734, 0.12906559110102445, 0.11659937296517346, 0.10805969683894634, 0.1124038253730161, 0.11256266423435923, 0.13337769706865218, 0.12564355984905443, 0.15759371095454633, 0.1334435348161012, 0.11424065270941168, 0.10670547781120827, 0.1340283971088839, 0.11229038996424014, 0.13919071089398244, 0.11865267981990554, 0.19434057273740335, 0.16108895386440805, 0.1339694198446523, 0.1444760773776637, 0.11576840064181515, 0.15682787631356135, 0.1333306475033713, 0.11269576857300377, 0.105196751357552, 0.14939289076638698, 0.11654199774278479, 0.10779133744224585, 0.11893456865733175, 0.11701383813184087, 0.11127528879372119, 0.16543984467098882, 0.18119717818983047, 0.11419431420662064, 0.16719167236741772, 0.11701261937403842, 0.11162983384442594, 0.11346742968022439, 0.12262265636152543, 0.1353553759373205, 0.13483725103248212, 0.10472127378800088], [0.11678330073853264, 0.1483791506375431, 0.14301199387015806, 0.15291720046764978, 0.12932617682376016, 0.11415161831739352, 0.13594132427209848, 0.12851750912928456, 0.11248114383222577, 0.12569532953866397, 0.13116045541080357, 0.11350277061595218, 0.12389588123048184, 0.12255118084248208, 0.12284882809920945, 0.13101887036737578, 0.138084520666699, 0.1222912567850896, 0.11060620781755158, 0.13532426606855924, 0.12088575345283185, 0.1385368374689929, 0.11619970130129674, 0.12457753959628065, 0.13055800683995697, 0.13538545412131597, 0.14276802801025254, 0.1374871166073497, 0.15312490598902023, 0.1311127947083507, 0.12509808772524494, 0.12665143866605372, 0.14334383550981983, 0.13091911295528422, 0.12893982634754697, 0.11608514495001748, 0.11858905120451496, 0.1250175749211199, 0.11806106548991627, 0.15243464137467358, 0.16870203684370985, 0.12830671483036343, 0.11548252484653072, 0.1505001008801831, 0.15115493328869029, 0.11667149774132125, 0.1243792772803687, 0.1280739476470694, 0.1300164370813426, 0.12132283907291189, 0.12093929338546512, 0.12594551117214187, 0.16804669258024021, 0.15495788201033703, 0.13710339770258398, 0.12687569415258093, 0.12563536725886024, 0.1585903134223614, 0.13340856579979055, 0.13097073330511214, 0.1322598244909756, 0.12497751366881622, 0.16082242067367697, 0.13102265922097037, 0.13999650830061847, 0.12940941740665673, 0.13611910200945787, 0.13426229500361453, 0.12467430197220103, 0.1280500475944258, 0.13499429373161861, 0.12933260074498812, 0.12918639683395922, 0.14038571042123474, 0.16182826356035337, 0.17207014456170683, 0.14677207023614533, 0.1267900443293803, 0.14383984254649396, 0.14359682121981873, 0.12230830793897036, 0.11839440032337135, 0.12801523418544866, 0.12754693512342496, 0.1429154338734327, 0.12006421074473932, 0.13423051645822143, 0.13556868485588958, 0.12954861499487944, 0.12082549577064108, 0.12580973946180612, 0.12625040853445754, 0.15050355161408746, 0.12750415834131537, 0.1351781983382809, 0.13302548918098675, 0.13871047053836819, 0.15974484376388454, 0.12162680349486192, 0.11474779719424359], [0.1465059056453364, 0.17355428874149662, 0.15328000856689084, 0.15894192282782818, 0.17324043716825477, 0.15296093718557302, 0.1476807779826612, 0.15667981267214043, 0.14473882938402513, 0.147041241266836, 0.15386320059016986, 0.16552708813511469, 0.1540470583169911, 0.14328984608230924, 0.14375082683266385, 0.16617922349383918, 0.16088134938666387, 0.14765605602145176, 0.17435801311728671, 0.14827551829661414, 0.15329763697303322, 0.14472953426787188, 0.17125010340584843, 0.14572248129073692, 0.1336153120653446, 0.14582927809867732, 0.14848843370764533, 0.1747603051372686, 0.14383653678616662, 0.1619096631813556, 0.15540647378180358, 0.17265403646729033, 0.16111132921561488, 0.1467410645444637, 0.16665112559753137, 0.13917985697713006, 0.1734736031717337, 0.1581829967982839, 0.17158968955526813, 0.14506370061665497, 0.14202851635371547, 0.16475734273539983, 0.19468669913179526, 0.13759816729071742, 0.13796843994938945, 0.14376524182355194, 0.15355883720603658, 0.1925442891993296, 0.15769448639185818, 0.15132611280032016, 0.14602854920007455, 0.17288197778989967, 0.16947775151741457, 0.14431249870861976, 0.16104860701090984, 0.14727555923722968, 0.1649651566116195, 0.14752840612486381, 0.15137804508655991, 0.14569669080603223, 0.1886501083563279, 0.14774107101103773, 0.1846084498196342, 0.14349051783817388, 0.15687810389800352, 0.15317412505174166, 0.15008903035618867, 0.17266662696106372, 0.1408409323301772, 0.14412658538385037, 0.16184467539954767, 0.15487166636429472, 0.16349459098795593, 0.15432584946619862, 0.16286403507204014, 0.1484365267435558, 0.1462836172990036, 0.1805471712448447, 0.15163430576165168, 0.15715392809565756, 0.15185956501014095, 0.167501148591377, 0.1505870181461255, 0.15521711585069486, 0.17353187983092488, 0.14289005591572185, 0.14327479126262316, 0.15733999784282526, 0.1775225130507548, 0.16616768296254153, 0.15145744171131506, 0.16047095595386854, 0.15183626179124074, 0.13189694008126293, 0.15654448895545303, 0.1679146473604498, 0.14783128588845795, 0.16074508329785836, 0.1567832983396268, 0.14849840354821386], [0.12239399036962419, 0.1197086261601347, 0.12424211859793748, 0.1635220026458285, 0.1089637048993127, 0.16846708251443296, 0.14408634583360755, 0.13476450629262407, 0.11544993460130562, 0.13529244488181053, 0.11647890705496407, 0.10200788055334584, 0.16852112557916435, 0.13583524212164005, 0.10852897248325585, 0.11539355039000641, 0.15837853318146086, 0.12535002633620215, 0.16430813553052098, 0.13408645758854704, 0.1195983896918656, 0.11342568957821446, 0.13988713376969597, 0.11522263111548936, 0.15333439620507017, 0.10592083797633782, 0.1430609118897678, 0.13407771983393496, 0.16303638545416438, 0.10562893541059999, 0.10842261745442096, 0.1313201522438386, 0.1278049059720508, 0.12847973230537013, 0.09723977354309747, 0.13368493891311553, 0.1391343390695247, 0.11255785309292166, 0.12849223015610456, 0.10683901254437689, 0.23481491316234634, 0.12559433428323516, 0.16953349833124, 0.11491023421346894, 0.23360709780496078, 0.13194388057949516, 0.13419796101246945, 0.12912481742791232, 0.14903923016798754, 0.1116636429006959, 0.10944792225755616, 0.11074028882316397, 0.15258821863270447, 0.10664872937864546, 0.153635299569851, 0.12622624343937944, 0.13601994904646622, 0.1400035845719506, 0.13092231410371158, 0.1302476074911012, 0.13787212755683526, 0.11278520625311116, 0.11887383965717363, 0.11023236202258775, 0.11533475599376847, 0.16877783236693417, 0.16175066398667418, 0.11019125719897276, 0.11772698704897126, 0.11369291537738112, 0.11249057684541804, 0.12793067463774582, 0.12150863658112937, 0.13143969474767958, 0.1150784722196714, 0.18883632340292317, 0.1094204301469329, 0.12313822834051655, 0.13523720497236436, 0.14721144228801009, 0.1429131576440633, 0.1291553627751315, 0.14144920583947618, 0.15086967794831527, 0.1141639502689692, 0.10964170484455242, 0.11429630650151062, 0.14081298926214164, 0.143604712493729, 0.14652441772489064, 0.1657315644452783, 0.13329970819074438, 0.15431912827034824, 0.1474714170079802, 0.16782388055185915, 0.12368815625903269, 0.1141116077252593, 0.12379776726011253, 0.14272541108036985, 0.14555897805050658], [0.1502025437845887, 0.10954743001641694, 0.11752810843747293, 0.136925599190986, 0.12995982060526312, 0.11158516795697226, 0.10528831651041211, 0.10418835960384869, 0.13634588459644836, 0.14767260654584083, 0.11293964487100557, 0.10530301140382549, 0.11070578921442562, 0.11717973799649849, 0.12946781165682497, 0.13707974727474354, 0.11212882962495944, 0.10520842234487214, 0.12593143718837302, 0.10736313890807066, 0.1297720124959698, 0.11716177301879234, 0.10630349758541678, 0.11207591281794525, 0.1386097206467458, 0.11182755361043692, 0.14577850108694873, 0.13981342638865632, 0.10714386490894132, 0.11299092864245504, 0.11740393306141846, 0.116486774066614, 0.11309897013903854, 0.11108143017195383, 0.10739738617028358, 0.10603954095836655, 0.14723912576358572, 0.11138088070907391, 0.13193374185687462, 0.11546370811414708, 0.14968279066957121, 0.10728093887363854, 0.11224933379927363, 0.1531536916122009, 0.21130165374224438, 0.10790067438979271, 0.145274298151255, 0.10809409659846259, 0.16454685959707555, 0.11986873258641192, 0.1093919508048078, 0.15214492456046252, 0.12241689007127254, 0.15233828520794385, 0.1477002670266664, 0.11682125160422556, 0.1612450145107434, 0.11462144119638207, 0.17029741429213843, 0.17666313203034684, 0.13046982628625792, 0.11452315015346587, 0.11159108337844098, 0.11278996481683422, 0.13407981337896288, 0.14060699419859812, 0.17046302556931262, 0.19509018799805197, 0.12598638724298403, 0.11466884915425202, 0.1607359447695591, 0.12116741727689816, 0.12279811064457224, 0.11340971826279163, 0.1303229762303293, 0.1722897020405344, 0.1148431646196073, 0.11229024346021345, 0.13169130404526172, 0.16578175283619956, 0.14908639876681473, 0.114158475241508, 0.14060348197898215, 0.1769387683187289, 0.12257616509694474, 0.1102774362877409, 0.13969536569060098, 0.11971147899497465, 0.11235779184303205, 0.1506955870487662, 0.11301449885252206, 0.12023191288769444, 0.11889625471725013, 0.11195282415528253, 0.10796394387973061, 0.1241821107589637, 0.15486676574005767, 0.14209648959527185, 0.16354623814002167, 0.10783557610989845]]
    lossvec0 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    
    # COMBINE n=6 WITH n=30
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist6 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598], [0.14509325259013878, 0.14028874836906774, 0.15305064950853794, 0.16164990223848158, 0.14600334611479598, 0.14222540439564113, 0.13819926446274894, 0.14888751519994395, 0.13601042925395454, 0.13705411416940977, 0.15017616990619576, 0.1312379783345067, 0.1399484932259146, 0.13867950539952534, 0.15473940085023505, 0.16492083747756797, 0.15266627729906476, 0.14303711984400314, 0.13944081571793362, 0.1351921195153755, 0.15000995864717762, 0.13785200299246733, 0.13972241307192595, 0.1390171111021526, 0.1741896010859611, 0.1523797619746385, 0.16802109843462054, 0.2031044061496549, 0.13994207470188078, 0.1493886304687554, 0.1421754071608363, 0.14819472020134955, 0.16730339147588053, 0.14273239657853296, 0.13527345028311655, 0.161211796889484, 0.15418280898428968, 0.1660452606865663, 0.16150255257113955, 0.14213185150950894, 0.16426791944900046, 0.14820635833013102, 0.1379348973871464, 0.15140720104735936, 0.15692154621266824, 0.13800025303241972, 0.15247775657441595, 0.1644960062364241, 0.14578730342459145, 0.15137928900502245, 0.15856592647467407, 0.1452533446898607, 0.13957331327211198, 0.16653186540898943, 0.1414586386472211, 0.13863761618792944, 0.15044269753193415, 0.13513057159191263, 0.1504710967707737, 0.14143042379029486, 0.15663931070287654, 0.15513959857473436, 0.14020565695676762, 0.14589390237896285, 0.13989413525049613, 0.13558801438885254, 0.1306796412110928, 0.1454250416842359, 0.20039562872768904, 0.1464782403034093, 0.13988968170112726, 0.13273908598086082, 0.15927546532370224, 0.1489380419506682, 0.1531876733846838, 0.19678434779440154, 0.1530507244232428, 0.13319105520055818, 0.16125454610296305, 0.15576736897330287, 0.1528635292552078, 0.15762210764858464, 0.1372813163402822, 0.14506678236295964, 0.14274206157870375, 0.14123908436351088, 0.14406353557244958, 0.16702307800312768, 0.1615712677311207, 0.1824616590030932, 0.16768892695608154, 0.14098816716858714, 0.15737226104821228, 0.16533306200044573, 0.13715882215889497, 0.13977599897006332, 0.16550965937549797, 0.15297115712622983, 0.13816762272816197, 0.15015491385978758], [0.1956720067072222, 0.14582796025959086, 0.14133445883143342, 0.13394655273850037, 0.13791919305559774, 0.138730151294858, 0.15371050494373478, 0.1456021292190366, 0.1319250425240813, 0.1375072722049538, 0.1406140990828101, 0.1430055713089789, 0.13864205313828826, 0.13642487696153238, 0.1320614169852181, 0.1509248475087068, 0.13883910409639413, 0.14106540277145516, 0.146049546262876, 0.14334167052496277, 0.1339629372619241, 0.1926185003922003, 0.17758016346464042, 0.1491920333226552, 0.1603667400841546, 0.14280464001872467, 0.14464054922598446, 0.13800030314514808, 0.1493951468764879, 0.16806266838451314, 0.14859748429027228, 0.14231805555086274, 0.13587399464732944, 0.14243874399036224, 0.13670126255638165, 0.14583242858737505, 0.13950632813003996, 0.15562689824634332, 0.1423824250921553, 0.14924298096580296, 0.20697724389322608, 0.1460949487371343, 0.14795469421707771, 0.17430622572129983, 0.14512408492436776, 0.14113554048451676, 0.1537327241751154, 0.17359019459290578, 0.14384879531657424, 0.13959524672300969, 0.15202862152043561, 0.16001697660533684, 0.14846979499789756, 0.1499948669564118, 0.14153124537601383, 0.13772954596303044, 0.14363990972940935, 0.15136808141021244, 0.15613361392220237, 0.13712612253914788, 0.14544337170121016, 0.1432567876747141, 0.1421231957675725, 0.1440786800322997, 0.14538080276408763, 0.13789373750997735, 0.14974069165058337, 0.14076995929686056, 0.14993724186362994, 0.1507901760606768, 0.14004777471082522, 0.15229461354075305, 0.15401760694398595, 0.13710387516752534, 0.1414647027018001, 0.1417456053989467, 0.13354422744653818, 0.14838051421855789, 0.14542395289822482, 0.13991452019243594, 0.15267712632022873, 0.1319640120066646, 0.19650216761649236, 0.13600378730311732, 0.1372221655227576, 0.1390037888795752, 0.1517864602234419, 0.1484784157053542, 0.1410903815585296, 0.14279428667847313, 0.13497946413351267, 0.13466488752669525, 0.15250378644344884, 0.13730303466512367, 0.14912483467418075, 0.1322794152417043, 0.15093638487304123, 0.17621673919998143, 0.13674616172311452, 0.21453883679539418], [0.14450478574527914, 0.1457143474187369, 0.1555370981899616, 0.1436391164732043, 0.14857559892626956, 0.14882189288086745, 0.1468705171288977, 0.16955452187913334, 0.13678532897290058, 0.14089234072321258, 0.1480948847152767, 0.13408940045780832, 0.14579931689397393, 0.13470361790227603, 0.1604917736468268, 0.15336044842290794, 0.1582792226313595, 0.1409912236554027, 0.16070248968400108, 0.15597374264108038, 0.17114745066651715, 0.16362716893034554, 0.1386492317960576, 0.12841458294632446, 0.1496342265676232, 0.15706739426707889, 0.1635651869248081, 0.14458245478630619, 0.14985985580724623, 0.152739890793786, 0.14331329916092353, 0.14298431898321634, 0.1610973259502271, 0.15033029775958864, 0.15221396502935186, 0.13476101510453106, 0.1446673785642301, 0.14537611295308397, 0.13510235171044357, 0.14139872392421085, 0.17265276844730165, 0.15799714500574427, 0.13803596102655175, 0.14706843794819147, 0.17662834672154415, 0.14457045643981284, 0.15080936317524393, 0.1463998860311117, 0.17334334486694544, 0.14094555664159603, 0.17259544597055865, 0.1526627366421763, 0.15557536132580305, 0.17213248558696104, 0.14161228583453916, 0.14646505277949956, 0.17774920347798973, 0.13670674182184786, 0.15978646755911594, 0.14770762046928476, 0.17358979688044174, 0.15290403607434955, 0.14134147884928439, 0.13394596987460397, 0.15485249022234834, 0.13729610280077378, 0.14184233903692803, 0.17034585190186982, 0.14969869836856, 0.14801731555270858, 0.18734475216381527, 0.15692385007131002, 0.14745834051628964, 0.15660488679513565, 0.16224726292320088, 0.17979346151839826, 0.14440590510365417, 0.137562469988272, 0.13574327684035703, 0.17861265829993286, 0.15377183633705652, 0.15079136517331784, 0.1478563827709796, 0.14199839532078198, 0.14706775289001064, 0.14472975755647252, 0.14123002859089054, 0.1502795549442268, 0.14758879610022602, 0.16404339003224105, 0.1434100492836244, 0.13764483215417767, 0.16907631888713312, 0.15129202812043474, 0.14932455989775428, 0.16070251252503212, 0.16074988006598118, 0.15143565239369516, 0.13411982238435155, 0.14487272835960785], [0.15676788250313917, 0.1506111750240834, 0.146119047503663, 0.1531480010744943, 0.15891325553072025, 0.16364789811653932, 0.15138967055471977, 0.15232381776558696, 0.16727705090831244, 0.15365314898559324, 0.1614937835047277, 0.1671729947155535, 0.16834838360903145, 0.1555428431945245, 0.14413711094373374, 0.15297226203477665, 0.1452906868106968, 0.15514675672133005, 0.14883802429867538, 0.15449594618400184, 0.14954692024150854, 0.1468915783804781, 0.16541539622582993, 0.15039639571322477, 0.17431970983768832, 0.15957521947678688, 0.14994130138707149, 0.15574744645838834, 0.15719276362609919, 0.147071947241242, 0.15227145676000942, 0.18620768640824592, 0.1528031184993807, 0.16361215384154876, 0.17189493779090312, 0.157757354432221, 0.15889015229728912, 0.15414096349868017, 0.16862155409976415, 0.156557255063309, 0.15476400805618065, 0.17449627649891436, 0.15845889352308407, 0.16129636565785072, 0.15966690917865856, 0.1572434563962841, 0.15335467182368062, 0.16777616839051446, 0.15699630080635574, 0.15193324740363875, 0.1553303530070425, 0.164390703556413, 0.16347272025784904, 0.15687150028329705, 0.14935728365626375, 0.14754505277673502, 0.14909242318743854, 0.16007571421698163, 0.15391919623818737, 0.15625400008453574, 0.18723545710653547, 0.17213040034699215, 0.15609940501998898, 0.15926549287751007, 0.14567163899063548, 0.16274685080372306, 0.1545960065613862, 0.15633139001406512, 0.15892652999415324, 0.15303934766400776, 0.15059631552493977, 0.15403889891706862, 0.1539022259095633, 0.16253783488461218, 0.1470592387583713, 0.17417077612357532, 0.15750294445046722, 0.15827036163578195, 0.19232291219935202, 0.1709760048004654, 0.15998399198004493, 0.16008795236419954, 0.14577048153026603, 0.15559226733553214, 0.18426932674713797, 0.1575517601905409, 0.16265525389002614, 0.15688122546641214, 0.1449458311711252, 0.14189507294938142, 0.16548916510685419, 0.15712464113055735, 0.15688293182205262, 0.1483154536793583, 0.15759530378933792, 0.15243641076069614, 0.158700820353922, 0.1633138552220091, 0.18171188056649712, 0.1523011145605004], [0.15064835242739164, 0.20116666607354042, 0.15043956564726252, 0.14466675394693784, 0.15637998128337444, 0.15741822782432005, 0.13977683219367534, 0.1957412289440031, 0.13923360970699244, 0.1446182371621637, 0.13834016444465763, 0.19903707647390437, 0.15266927000749647, 0.1577752914338156, 0.1545287056546679, 0.14619779489477683, 0.18224028244463764, 0.1449362110746292, 0.14841518733616862, 0.14981980583887486, 0.14439088742722198, 0.15432571128956407, 0.14431185452551523, 0.1494474987670734, 0.1499296451748242, 0.1792709265788088, 0.15179620307033861, 0.14046119839668175, 0.1589951986714733, 0.1587971986838449, 0.16179333596288084, 0.14496687634342334, 0.1427064543647107, 0.1463452103669078, 0.19098869318145137, 0.1423410099162198, 0.13606055877363937, 0.15730215390106178, 0.1549993938710938, 0.15824924988456524, 0.15445091794423874, 0.16005178277938328, 0.1389694667076749, 0.14465356705709778, 0.19681848479017147, 0.16208120246861274, 0.13682343115838388, 0.14264250690168176, 0.1346243061450475, 0.15213623560499884, 0.15188804310584791, 0.16307429906602688, 0.18608934612902422, 0.15008991311402242, 0.15346980937051286, 0.1513904047600632, 0.138051413083824, 0.14444643879336055, 0.14293866624276227, 0.14493318641123032, 0.15073820451093442, 0.16209066222935622, 0.15609492424577898, 0.15339065156215131, 0.13894327416962535, 0.13706537389074008, 0.1454998798966734, 0.14816572062116629, 0.16048427962479048, 0.15868248935977627, 0.1433096077699594, 0.15765934927980016, 0.1445478165092159, 0.13537088967258903, 0.16484692239636423, 0.15681327978953305, 0.13823553836367322, 0.15720133449390905, 0.1426446097947524, 0.14257951544909594, 0.1428863212311613, 0.1572940811926901, 0.13806761812474513, 0.1708951499407444, 0.1497420224881769, 0.15279538896895953, 0.1513420762936911, 0.15307931975940578, 0.16577586008319378, 0.14025460327410805, 0.1587351406153104, 0.13412322669933777, 0.14769282479997062, 0.14592683075271304, 0.17153813510024377, 0.15053994597308007, 0.18731208881356295, 0.19872610671513688, 0.1841662522331951, 0.13422272693053547], [0.18181722019501215, 0.13875190346067637, 0.1434974174522277, 0.15056958156680675, 0.19827204377214533, 0.15921230878495077, 0.1386356089299053, 0.1510407025688063, 0.14337780219542212, 0.1410132198224032, 0.13271982492164613, 0.15893605155993584, 0.16640501776760439, 0.14563240579388123, 0.14045729078900115, 0.15651224676956504, 0.13695008439302267, 0.15157098201166191, 0.14881164301028307, 0.14409529838958476, 0.15213301195228676, 0.157048839738969, 0.13661235724713386, 0.14050145437177985, 0.14427626025663914, 0.15313316158120382, 0.14641473340092118, 0.14423881930033242, 0.15487425897069923, 0.13493039638028476, 0.14265930334976998, 0.13926964709849904, 0.15517305682143215, 0.156840168973403, 0.14120398891609437, 0.14258982720768837, 0.16224171521813027, 0.1487020658844222, 0.13593975162293093, 0.13552402374835276, 0.14435497567590433, 0.14551984656396055, 0.16925695038026414, 0.12532000473876634, 0.18787707719901314, 0.14494349346856306, 0.1460512700361367, 0.13764790699935003, 0.13205003919786196, 0.14312726436538106, 0.17641827595770393, 0.13281619405067382, 0.21002640920684798, 0.14321731551404313, 0.17479177096737247, 0.1421983860486019, 0.1421886281551943, 0.15029200646874508, 0.1473593591348698, 0.1461791592183094, 0.14995947075456567, 0.1697644130822565, 0.1510501770415216, 0.1400723544027716, 0.1460962022509319, 0.13876860340920166, 0.14118568961155942, 0.15033228824650205, 0.13811125545597394, 0.14858503827371414, 0.20975600554784413, 0.16307940402624038, 0.15869262164160572, 0.13700591045887486, 0.13700591045887486, 0.20220167392624913, 0.14708098803722688, 0.1412210489031462, 0.14796775532369322, 0.13488335442887064, 0.13772982826965108, 0.13449131824271635, 0.145407529841331, 0.2042208435093412, 0.152977855852745, 0.13525574446942762, 0.14041395660614236, 0.1458328358296098, 0.14631114120221003, 0.1342305386963775, 0.16227988289823334, 0.1431539862980931, 0.15060583592754204, 0.15952910939003356, 0.1566258669244816, 0.1537752727590032, 0.1539086023339344, 0.16598925365010353, 0.17507586529075203, 0.13986227065308077]]
    lossveclist30 = [[0.16316247614417786, 0.15720308016518392, 0.160863945888904, 0.16447283110683764, 0.1597308862650217, 0.16530244384804657, 0.16669312853832846, 0.16160074183245418, 0.16531921860847268, 0.16204418983966884, 0.15497871109482528, 0.15467411380815202, 0.16137507788563935, 0.15747074719610993, 0.15227562888307283, 0.17145553421385715, 0.1636936109540728, 0.1669252130711022, 0.16203792902518932, 0.1590776036970198, 0.15517493597181414, 0.16082428825129408, 0.15756807318592914, 0.15506083185262165, 0.1563119571699612, 0.1577098321842063, 0.1641468650148215, 0.15488810176193077, 0.15665288809662717, 0.1603004792908751, 0.16244412649356446, 0.15682117334200987, 0.16354500425841928, 0.16415919785812233, 0.15638019835364242, 0.16670010935518434, 0.15949899127054123, 0.16151886488912792, 0.15735859935171637, 0.15677491976724814, 0.1632770479674153, 0.14924292022848828, 0.15743089052516365, 0.16345503460451294, 0.16461700092997042, 0.16393482215356434, 0.1567846630229211, 0.15924311538390307, 0.15772433401103705, 0.14844073078598255, 0.14807481745813092, 0.15995264676230736, 0.1579484132093352, 0.15724138753152508, 0.16224710472251716, 0.1641735756558422, 0.15887070821169746, 0.15642966735431305, 0.15406330865539522, 0.1574801626153325, 0.16362808604206897, 0.16149986707782518, 0.15773307449644686, 0.1530540907925208, 0.1645033073394543, 0.15431738379696006, 0.1704341251141459, 0.15808855709519426, 0.16246600430741387, 0.1698498306376867, 0.1648337933683812, 0.17121651335895544, 0.1503781786512441, 0.1524599498085908, 0.15922731157919556, 0.15916234372331206, 0.15939630765108154, 0.15663433246236877, 0.1616397543298343, 0.16063162982298979, 0.1558830142365766, 0.1619674732314209, 0.1696654499763426, 0.16089161339847177, 0.15122267732630387, 0.1650651236958853, 0.16316201297091332, 0.16165031167909902, 0.16726574771516814, 0.16236019915686473, 0.1645428564195015, 0.1545329722426662, 0.15539168558736072, 0.17099218135813946, 0.16002479505594225, 0.15695387354065177, 0.15969571027275462, 0.1596724155733717, 0.15652864335844877, 0.16498385967878598], [0.12847026958561233, 0.11986732398951072, 0.13060367191347091, 0.13456141828997675, 0.1274179951384851, 0.1395853466736562, 0.11949711627700356, 0.14222439398953382, 0.12650237999957095, 0.11742182455737671, 0.125807002876967, 0.1184952562133039, 0.11595927744994752, 0.13241341970960263, 0.1330365092362536, 0.14702475658549582, 0.12372548979744037, 0.12326210162435598, 0.11596437064058449, 0.1360079427634559, 0.13490036368964048, 0.12857099981465742, 0.12546313943515863, 0.12160934132043706, 0.1462538289015319, 0.12058229113278009, 0.1906528527577479, 0.12731827990432867, 0.15162017453679544, 0.11729449808267677, 0.1190441940260026, 0.11461052983150097, 0.12314952671527217, 0.13401586619002537, 0.11792195626961513, 0.12672867159599627, 0.13739567825608845, 0.12373221054427508, 0.1297344567932947, 0.13560544320405665, 0.19761742209602334, 0.12606856696655194, 0.1379339281846113, 0.1374334378123528, 0.1306824291013811, 0.11803407486284032, 0.12967267696704565, 0.11771991263021934, 0.1346792598792127, 0.1409915447125594, 0.12118391932460561, 0.12343177753491975, 0.12827072105544465, 0.13515099777805797, 0.1419930223266828, 0.13708165525755409, 0.12851654777366114, 0.12072503892420437, 0.13588302574565375, 0.12763095569671912, 0.11770390994278485, 0.1337648303433984, 0.1717760059155993, 0.12769012395302703, 0.14218244225977397, 0.12415284258856643, 0.12592778571793506, 0.12462257842242966, 0.14994368569109445, 0.1184717062250044, 0.127352890061241, 0.1261733842087149, 0.1553400615115116, 0.12521722674144753, 0.140173063194675, 0.17588188191245271, 0.13714986387224123, 0.1271717829247304, 0.12247977824019007, 0.145766957774525, 0.13598255520000507, 0.13351997498557475, 0.12627843146354406, 0.12668244354246871, 0.13096893060481926, 0.12175318020999325, 0.16310087594160333, 0.16095717672883847, 0.1300863114218935, 0.14288872177752412, 0.12794333127672622, 0.13113273545611268, 0.14831587955772, 0.1331221376427609, 0.12098932922272174, 0.12482044143706773, 0.15980859235266884, 0.16760616557412308, 0.12400024308665411, 0.12109142757996429], [0.10706549287250079, 0.11575611710588574, 0.11657755694309162, 0.16261739870199468, 0.13044543811112205, 0.13597871423477614, 0.1162521924230518, 0.11451468777257316, 0.11977597197875277, 0.14706270459984383, 0.11710752464564515, 0.10042574426077899, 0.13200671674442208, 0.11956001986469626, 0.14352235169529448, 0.13941878520513282, 0.11014525523119775, 0.10043722950557356, 0.12029623451868249, 0.13085447101444728, 0.11453146422406418, 0.17624798196585864, 0.14802263895111217, 0.10563726772450745, 0.11133843244043405, 0.17849680482103586, 0.14070005356490364, 0.14096922814148977, 0.156119362323945, 0.11431832309758867, 0.1347037871678656, 0.10827995515121462, 0.12991595333241354, 0.11288800385497598, 0.1087194394506875, 0.13957184220395502, 0.11433250028736858, 0.1154339703968407, 0.13531303685378834, 0.1181845974938699, 0.1624782253808026, 0.10785906088538802, 0.11187337490987176, 0.1490282005501971, 0.16584111420698566, 0.10409255587349321, 0.1531767083995999, 0.13969790265815368, 0.15893111057070325, 0.1350896551679034, 0.11223328144029465, 0.11122693364823041, 0.156758751098658, 0.13926181585327896, 0.12928728514951857, 0.14880967338603854, 0.11426618162572089, 0.12765392949835094, 0.16174518844820734, 0.12906559110102445, 0.11659937296517346, 0.10805969683894634, 0.1124038253730161, 0.11256266423435923, 0.13337769706865218, 0.12564355984905443, 0.15759371095454633, 0.1334435348161012, 0.11424065270941168, 0.10670547781120827, 0.1340283971088839, 0.11229038996424014, 0.13919071089398244, 0.11865267981990554, 0.19434057273740335, 0.16108895386440805, 0.1339694198446523, 0.1444760773776637, 0.11576840064181515, 0.15682787631356135, 0.1333306475033713, 0.11269576857300377, 0.105196751357552, 0.14939289076638698, 0.11654199774278479, 0.10779133744224585, 0.11893456865733175, 0.11701383813184087, 0.11127528879372119, 0.16543984467098882, 0.18119717818983047, 0.11419431420662064, 0.16719167236741772, 0.11701261937403842, 0.11162983384442594, 0.11346742968022439, 0.12262265636152543, 0.1353553759373205, 0.13483725103248212, 0.10472127378800088], [0.11678330073853264, 0.1483791506375431, 0.14301199387015806, 0.15291720046764978, 0.12932617682376016, 0.11415161831739352, 0.13594132427209848, 0.12851750912928456, 0.11248114383222577, 0.12569532953866397, 0.13116045541080357, 0.11350277061595218, 0.12389588123048184, 0.12255118084248208, 0.12284882809920945, 0.13101887036737578, 0.138084520666699, 0.1222912567850896, 0.11060620781755158, 0.13532426606855924, 0.12088575345283185, 0.1385368374689929, 0.11619970130129674, 0.12457753959628065, 0.13055800683995697, 0.13538545412131597, 0.14276802801025254, 0.1374871166073497, 0.15312490598902023, 0.1311127947083507, 0.12509808772524494, 0.12665143866605372, 0.14334383550981983, 0.13091911295528422, 0.12893982634754697, 0.11608514495001748, 0.11858905120451496, 0.1250175749211199, 0.11806106548991627, 0.15243464137467358, 0.16870203684370985, 0.12830671483036343, 0.11548252484653072, 0.1505001008801831, 0.15115493328869029, 0.11667149774132125, 0.1243792772803687, 0.1280739476470694, 0.1300164370813426, 0.12132283907291189, 0.12093929338546512, 0.12594551117214187, 0.16804669258024021, 0.15495788201033703, 0.13710339770258398, 0.12687569415258093, 0.12563536725886024, 0.1585903134223614, 0.13340856579979055, 0.13097073330511214, 0.1322598244909756, 0.12497751366881622, 0.16082242067367697, 0.13102265922097037, 0.13999650830061847, 0.12940941740665673, 0.13611910200945787, 0.13426229500361453, 0.12467430197220103, 0.1280500475944258, 0.13499429373161861, 0.12933260074498812, 0.12918639683395922, 0.14038571042123474, 0.16182826356035337, 0.17207014456170683, 0.14677207023614533, 0.1267900443293803, 0.14383984254649396, 0.14359682121981873, 0.12230830793897036, 0.11839440032337135, 0.12801523418544866, 0.12754693512342496, 0.1429154338734327, 0.12006421074473932, 0.13423051645822143, 0.13556868485588958, 0.12954861499487944, 0.12082549577064108, 0.12580973946180612, 0.12625040853445754, 0.15050355161408746, 0.12750415834131537, 0.1351781983382809, 0.13302548918098675, 0.13871047053836819, 0.15974484376388454, 0.12162680349486192, 0.11474779719424359], [0.1465059056453364, 0.17355428874149662, 0.15328000856689084, 0.15894192282782818, 0.17324043716825477, 0.15296093718557302, 0.1476807779826612, 0.15667981267214043, 0.14473882938402513, 0.147041241266836, 0.15386320059016986, 0.16552708813511469, 0.1540470583169911, 0.14328984608230924, 0.14375082683266385, 0.16617922349383918, 0.16088134938666387, 0.14765605602145176, 0.17435801311728671, 0.14827551829661414, 0.15329763697303322, 0.14472953426787188, 0.17125010340584843, 0.14572248129073692, 0.1336153120653446, 0.14582927809867732, 0.14848843370764533, 0.1747603051372686, 0.14383653678616662, 0.1619096631813556, 0.15540647378180358, 0.17265403646729033, 0.16111132921561488, 0.1467410645444637, 0.16665112559753137, 0.13917985697713006, 0.1734736031717337, 0.1581829967982839, 0.17158968955526813, 0.14506370061665497, 0.14202851635371547, 0.16475734273539983, 0.19468669913179526, 0.13759816729071742, 0.13796843994938945, 0.14376524182355194, 0.15355883720603658, 0.1925442891993296, 0.15769448639185818, 0.15132611280032016, 0.14602854920007455, 0.17288197778989967, 0.16947775151741457, 0.14431249870861976, 0.16104860701090984, 0.14727555923722968, 0.1649651566116195, 0.14752840612486381, 0.15137804508655991, 0.14569669080603223, 0.1886501083563279, 0.14774107101103773, 0.1846084498196342, 0.14349051783817388, 0.15687810389800352, 0.15317412505174166, 0.15008903035618867, 0.17266662696106372, 0.1408409323301772, 0.14412658538385037, 0.16184467539954767, 0.15487166636429472, 0.16349459098795593, 0.15432584946619862, 0.16286403507204014, 0.1484365267435558, 0.1462836172990036, 0.1805471712448447, 0.15163430576165168, 0.15715392809565756, 0.15185956501014095, 0.167501148591377, 0.1505870181461255, 0.15521711585069486, 0.17353187983092488, 0.14289005591572185, 0.14327479126262316, 0.15733999784282526, 0.1775225130507548, 0.16616768296254153, 0.15145744171131506, 0.16047095595386854, 0.15183626179124074, 0.13189694008126293, 0.15654448895545303, 0.1679146473604498, 0.14783128588845795, 0.16074508329785836, 0.1567832983396268, 0.14849840354821386], [0.12239399036962419, 0.1197086261601347, 0.12424211859793748, 0.1635220026458285, 0.1089637048993127, 0.16846708251443296, 0.14408634583360755, 0.13476450629262407, 0.11544993460130562, 0.13529244488181053, 0.11647890705496407, 0.10200788055334584, 0.16852112557916435, 0.13583524212164005, 0.10852897248325585, 0.11539355039000641, 0.15837853318146086, 0.12535002633620215, 0.16430813553052098, 0.13408645758854704, 0.1195983896918656, 0.11342568957821446, 0.13988713376969597, 0.11522263111548936, 0.15333439620507017, 0.10592083797633782, 0.1430609118897678, 0.13407771983393496, 0.16303638545416438, 0.10562893541059999, 0.10842261745442096, 0.1313201522438386, 0.1278049059720508, 0.12847973230537013, 0.09723977354309747, 0.13368493891311553, 0.1391343390695247, 0.11255785309292166, 0.12849223015610456, 0.10683901254437689, 0.23481491316234634, 0.12559433428323516, 0.16953349833124, 0.11491023421346894, 0.23360709780496078, 0.13194388057949516, 0.13419796101246945, 0.12912481742791232, 0.14903923016798754, 0.1116636429006959, 0.10944792225755616, 0.11074028882316397, 0.15258821863270447, 0.10664872937864546, 0.153635299569851, 0.12622624343937944, 0.13601994904646622, 0.1400035845719506, 0.13092231410371158, 0.1302476074911012, 0.13787212755683526, 0.11278520625311116, 0.11887383965717363, 0.11023236202258775, 0.11533475599376847, 0.16877783236693417, 0.16175066398667418, 0.11019125719897276, 0.11772698704897126, 0.11369291537738112, 0.11249057684541804, 0.12793067463774582, 0.12150863658112937, 0.13143969474767958, 0.1150784722196714, 0.18883632340292317, 0.1094204301469329, 0.12313822834051655, 0.13523720497236436, 0.14721144228801009, 0.1429131576440633, 0.1291553627751315, 0.14144920583947618, 0.15086967794831527, 0.1141639502689692, 0.10964170484455242, 0.11429630650151062, 0.14081298926214164, 0.143604712493729, 0.14652441772489064, 0.1657315644452783, 0.13329970819074438, 0.15431912827034824, 0.1474714170079802, 0.16782388055185915, 0.12368815625903269, 0.1141116077252593, 0.12379776726011253, 0.14272541108036985, 0.14555897805050658], [0.1502025437845887, 0.10954743001641694, 0.11752810843747293, 0.136925599190986, 0.12995982060526312, 0.11158516795697226, 0.10528831651041211, 0.10418835960384869, 0.13634588459644836, 0.14767260654584083, 0.11293964487100557, 0.10530301140382549, 0.11070578921442562, 0.11717973799649849, 0.12946781165682497, 0.13707974727474354, 0.11212882962495944, 0.10520842234487214, 0.12593143718837302, 0.10736313890807066, 0.1297720124959698, 0.11716177301879234, 0.10630349758541678, 0.11207591281794525, 0.1386097206467458, 0.11182755361043692, 0.14577850108694873, 0.13981342638865632, 0.10714386490894132, 0.11299092864245504, 0.11740393306141846, 0.116486774066614, 0.11309897013903854, 0.11108143017195383, 0.10739738617028358, 0.10603954095836655, 0.14723912576358572, 0.11138088070907391, 0.13193374185687462, 0.11546370811414708, 0.14968279066957121, 0.10728093887363854, 0.11224933379927363, 0.1531536916122009, 0.21130165374224438, 0.10790067438979271, 0.145274298151255, 0.10809409659846259, 0.16454685959707555, 0.11986873258641192, 0.1093919508048078, 0.15214492456046252, 0.12241689007127254, 0.15233828520794385, 0.1477002670266664, 0.11682125160422556, 0.1612450145107434, 0.11462144119638207, 0.17029741429213843, 0.17666313203034684, 0.13046982628625792, 0.11452315015346587, 0.11159108337844098, 0.11278996481683422, 0.13407981337896288, 0.14060699419859812, 0.17046302556931262, 0.19509018799805197, 0.12598638724298403, 0.11466884915425202, 0.1607359447695591, 0.12116741727689816, 0.12279811064457224, 0.11340971826279163, 0.1303229762303293, 0.1722897020405344, 0.1148431646196073, 0.11229024346021345, 0.13169130404526172, 0.16578175283619956, 0.14908639876681473, 0.114158475241508, 0.14060348197898215, 0.1769387683187289, 0.12257616509694474, 0.1102774362877409, 0.13969536569060098, 0.11971147899497465, 0.11235779184303205, 0.1506955870487662, 0.11301449885252206, 0.12023191288769444, 0.11889625471725013, 0.11195282415528253, 0.10796394387973061, 0.1241821107589637, 0.15486676574005767, 0.14209648959527185, 0.16354623814002167, 0.10783557610989845]]
    lossveclist = lossveclist6 + lossveclist30
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.1$, $n=6,30$',legendlabel=['$n=6$','$n=30$'])
    '''

    ### overEstWt=5, rateTarget=0.1 ###
    # Get null first
    underWt, t = 5., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Design 0']
    lossvec = [[0.38583050924760964, 0.3805864077666326, 0.3964572768521591, 0.39227940704631165, 0.38564747589892073, 0.4033297784195582, 0.3975594889356481, 0.38863941640280203, 0.39286843713196895, 0.40201595286213565, 0.3778915589617121, 0.3732185650748028, 0.3921299976939237, 0.3846437304838668, 0.370628076035751, 0.4163607349815971, 0.396812865270099, 0.4155841835048091, 0.39587207709718675, 0.3829018469947969, 0.37800872529449936, 0.3963409862604907, 0.3789195541773716, 0.3790216064601415, 0.37228800287802993, 0.387929035196919, 0.39807375276496215, 0.3755987269229184, 0.3777473118766184, 0.38924578912330493, 0.38364387791698773, 0.38336904970923336, 0.3964706086800771, 0.3961262658187449, 0.38351666107797355, 0.40243811863426426, 0.3765660331020353, 0.38636196577719445, 0.3862189193660726, 0.3789616394474292, 0.3994137692631588, 0.3630902987236733, 0.39053855570977764, 0.40471699127502836, 0.39495257051396687, 0.3917768637550916, 0.386662841787641, 0.3820399538295663, 0.38782166421577, 0.3599592083551056, 0.3521884873328863, 0.38801406010871026, 0.3843276063895806, 0.3849402399967776, 0.40050510795022387, 0.4001304747855865, 0.38179263483054254, 0.3883680882622218, 0.37079516976196913, 0.37433781481426415, 0.3971214064327556, 0.3954597264763028, 0.39415072785293254, 0.36578702569154103, 0.3907533573541796, 0.3733732889162066, 0.4162197743753949, 0.38124504576180185, 0.40706208518614867, 0.42404348956088833, 0.3978984991900868, 0.41343299046418513, 0.3723546390001216, 0.36438198681397677, 0.3793977830813166, 0.3797484759869667, 0.38560903524390217, 0.39436162294505395, 0.39678907121771156, 0.3858027079501557, 0.377679219869191, 0.3913883828557191, 0.40750921332915535, 0.3874264156995278, 0.3779728450969454, 0.40969185272006436, 0.3897072956140699, 0.3859038430577251, 0.41547253745821033, 0.39186748425445406, 0.39633032528738044, 0.3795551822745309, 0.38500829485553184, 0.425305775265033, 0.3813767248171227, 0.37723107855392307, 0.3870630517285677, 0.3827646817180149, 0.3744239179978639, 0.38843358384701454]]
    '''
    # 30 tests for all designs
    underWt, t = 5., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossvec0 = [[0.38583050924760964, 0.3805864077666326, 0.3964572768521591, 0.39227940704631165, 0.38564747589892073, 0.4033297784195582, 0.3975594889356481, 0.38863941640280203, 0.39286843713196895, 0.40201595286213565, 0.3778915589617121, 0.3732185650748028, 0.3921299976939237, 0.3846437304838668, 0.370628076035751, 0.4163607349815971, 0.396812865270099, 0.4155841835048091, 0.39587207709718675, 0.3829018469947969, 0.37800872529449936, 0.3963409862604907, 0.3789195541773716, 0.3790216064601415, 0.37228800287802993, 0.387929035196919, 0.39807375276496215, 0.3755987269229184, 0.3777473118766184, 0.38924578912330493, 0.38364387791698773, 0.38336904970923336, 0.3964706086800771, 0.3961262658187449, 0.38351666107797355, 0.40243811863426426, 0.3765660331020353, 0.38636196577719445, 0.3862189193660726, 0.3789616394474292, 0.3994137692631588, 0.3630902987236733, 0.39053855570977764, 0.40471699127502836, 0.39495257051396687, 0.3917768637550916, 0.386662841787641, 0.3820399538295663, 0.38782166421577, 0.3599592083551056, 0.3521884873328863, 0.38801406010871026, 0.3843276063895806, 0.3849402399967776, 0.40050510795022387, 0.4001304747855865, 0.38179263483054254, 0.3883680882622218, 0.37079516976196913, 0.37433781481426415, 0.3971214064327556, 0.3954597264763028, 0.39415072785293254, 0.36578702569154103, 0.3907533573541796, 0.3733732889162066, 0.4162197743753949, 0.38124504576180185, 0.40706208518614867, 0.42404348956088833, 0.3978984991900868, 0.41343299046418513, 0.3723546390001216, 0.36438198681397677, 0.3793977830813166, 0.3797484759869667, 0.38560903524390217, 0.39436162294505395, 0.39678907121771156, 0.3858027079501557, 0.377679219869191, 0.3913883828557191, 0.40750921332915535, 0.3874264156995278, 0.3779728450969454, 0.40969185272006436, 0.3897072956140699, 0.3859038430577251, 0.41547253745821033, 0.39186748425445406, 0.39633032528738044, 0.3795551822745309, 0.38500829485553184, 0.425305775265033, 0.3813767248171227, 0.37723107855392307, 0.3870630517285677, 0.3827646817180149, 0.3744239179978639, 0.38843358384701454]]
    lossveclist = [[0.3329667804058439, 0.3048359499798749, 0.3266234011025496, 0.3300925197530628, 0.32626058972069205, 0.3501823303837523, 0.3019848965597553, 0.367305983682519, 0.31532807586565104, 0.29617613867148274, 0.3202952734221463, 0.2966100919595709, 0.29185844246237985, 0.333494902544, 0.32377699415947875, 0.3648353865755433, 0.31165300232381093, 0.3149377765212943, 0.304713416352935, 0.3369063522218454, 0.3491460413973439, 0.32340668312695464, 0.31643202401811804, 0.30810928025544665, 0.3624048459507057, 0.2991501541974906, 0.40242749072617956, 0.3249012094831088, 0.37535827352207213, 0.3001134934112857, 0.30749366420997354, 0.28951256452255814, 0.3116339157979734, 0.33004294380778293, 0.3005564270778042, 0.32680765996264294, 0.3493550928063728, 0.31078248805487313, 0.32926446623807676, 0.34144524937464726, 0.42689250273150703, 0.3127238410942225, 0.3480688567440682, 0.33734680085678026, 0.33337041256965694, 0.30181968547185545, 0.32324237715916376, 0.28920919026530056, 0.33262757611164456, 0.34130445038968366, 0.30494481906578896, 0.3107883296991158, 0.32721812630874103, 0.3341209256075047, 0.3555900307432099, 0.334480509726279, 0.32154623005739535, 0.30147161679072015, 0.33261109938595884, 0.3160214992502357, 0.2952182071940258, 0.330839120480065, 0.3988745182203615, 0.3248261535979973, 0.3557744279632362, 0.3160436613203665, 0.3235828713468373, 0.31185240516158713, 0.36886219946986043, 0.30617411043042686, 0.323323678954806, 0.3224875359937501, 0.37066699700201405, 0.320431670841849, 0.34105896327818924, 0.40514373951382265, 0.3415263393263826, 0.3238820845567901, 0.2999717157435513, 0.35972502851167487, 0.3401627042310587, 0.32834258132916605, 0.31751592678703944, 0.31495506649014454, 0.3303513406088176, 0.3155825782123415, 0.38613688566146864, 0.3790935177071438, 0.31946500807267375, 0.35364127564523784, 0.32924538917396134, 0.33474552540010605, 0.3624847226467893, 0.34184056372179483, 0.3095423710477023, 0.3160117319932685, 0.38629853216249144, 0.39164687853309227, 0.3041061965463162, 0.30715438430876174], [0.257744672193433, 0.2888282893260882, 0.2901967291431233, 0.36591784640056557, 0.3171150994792345, 0.3268690739537106, 0.2870565638990402, 0.277642628344871, 0.2878614422011107, 0.3416259772147256, 0.2868908924597531, 0.25435820755740235, 0.3201225115254679, 0.28900086827705584, 0.3247122266805658, 0.32274595944547, 0.26974593069837133, 0.24804695511489838, 0.2882192703765516, 0.3085546277656395, 0.2790445687010042, 0.3997654008090266, 0.3431249822718958, 0.2670844048171432, 0.27468736870667443, 0.40811967060997645, 0.3336883830760252, 0.32736895298207463, 0.3638344205700433, 0.28071888985169197, 0.31548301424789127, 0.2658119898358638, 0.3144222219139029, 0.2773339734963488, 0.2643265589305023, 0.3304221468268236, 0.2837543892331195, 0.28207890362419147, 0.3224202772083998, 0.28976518833222786, 0.36489014731529884, 0.26861371461889444, 0.27342079429286814, 0.3485126920581061, 0.373672433886348, 0.2606599306682989, 0.35300058499617565, 0.325378005703378, 0.36421648447543603, 0.3142262070537773, 0.28142678848861485, 0.2648293494978105, 0.3615658768085725, 0.34129474666402204, 0.31278503723393064, 0.3439709275527221, 0.2734962672790807, 0.30320827464067623, 0.36685898022551244, 0.3119651950581767, 0.28414994474494887, 0.2727001264787752, 0.2750764175846625, 0.2787894563019702, 0.3111676679988612, 0.30601021299315334, 0.358850091805662, 0.3217321722426368, 0.2869692214909194, 0.2611604824378423, 0.3125289659489906, 0.2716431619596077, 0.3185368782839191, 0.2901512953616564, 0.4265441908943728, 0.3739639860627874, 0.3227704481847098, 0.34918347302843783, 0.28770403595903943, 0.3638759804839394, 0.325876591026501, 0.2743090260974319, 0.26951665102161304, 0.34617002949759795, 0.2879157201496528, 0.2714454872326279, 0.29052393777697727, 0.28497151453611125, 0.2768038752965317, 0.388542890111358, 0.4152627193867274, 0.2809453669098231, 0.37558892553035333, 0.2945813967084882, 0.27362895596173775, 0.2754686138213334, 0.2985831372253059, 0.3205100290338167, 0.3156509354134721, 0.2616404890825223], [0.2971372848085235, 0.35762217155900466, 0.35385325710721877, 0.3702910219950034, 0.3281505564743439, 0.29370397728457054, 0.34385880434475385, 0.3166875848537482, 0.28711821267733917, 0.31960297343124167, 0.3287950717482092, 0.30602032758323067, 0.3245162663731173, 0.30263957146727255, 0.3080288845662064, 0.3191358064157132, 0.3336561111668203, 0.3020049251654214, 0.29366062906390944, 0.3354367136352083, 0.3060617749182091, 0.33765488479915423, 0.2981321730380433, 0.31675537561243855, 0.33144974932492477, 0.3203108931482405, 0.3455339254291077, 0.3390319916489087, 0.35964676417029556, 0.32714633912342217, 0.31180190739014224, 0.3246837449201044, 0.3439460821428756, 0.31834482581395, 0.32410223131351623, 0.29064478849470415, 0.29544324807603084, 0.31643546827222097, 0.3003677785570731, 0.3707633921620287, 0.3705100062938896, 0.3260261944386248, 0.28922043070036013, 0.3727390383977527, 0.3612814309321848, 0.2898347610305933, 0.308655862138811, 0.32068989867480513, 0.3212752732329235, 0.31121845724389424, 0.31146406365419865, 0.32079669555769974, 0.3772586589003442, 0.35774980284852453, 0.33132655200791156, 0.31806753811198374, 0.3180162892195609, 0.379841747323475, 0.32925548863345816, 0.3316329429576724, 0.3254057710175776, 0.3081841541004256, 0.3811282275666344, 0.3253769422189844, 0.34276453427111003, 0.3147585987998821, 0.3323067737413986, 0.32960629319648604, 0.31195743482695343, 0.3265507538043866, 0.34167330292080733, 0.3128289943257615, 0.3083990375579971, 0.34578387156746443, 0.3774411995310438, 0.35844862562115065, 0.35933682391684624, 0.3151991613549101, 0.35597247252921743, 0.3653704537318449, 0.31482451678229534, 0.2993137066904835, 0.3224659035028097, 0.31161008485261216, 0.35080130341923366, 0.31457444985976707, 0.33070790042469406, 0.33060137203603207, 0.32266753715854046, 0.30153067123385163, 0.3126972595959515, 0.32206168540715135, 0.34940405344871583, 0.3175975150190243, 0.3323692871629586, 0.3293087069021818, 0.3437838537557757, 0.36868077210401734, 0.30305061698366426, 0.2909139802412572], [0.35356529701848344, 0.4032892118305581, 0.3666916789174621, 0.37414534220441203, 0.41339754963342606, 0.3650075429475535, 0.3638280528321904, 0.3706117395305753, 0.34484980365998535, 0.34947826787595204, 0.36293118431169896, 0.39777018837995237, 0.37051801439339094, 0.33242757441202636, 0.3454489726144909, 0.3898779359473969, 0.3730032198204712, 0.34560848688438767, 0.3961808984205089, 0.35241029925525186, 0.35449236127665557, 0.3373068261816929, 0.39671977931980557, 0.34742860727554015, 0.321888523157417, 0.3391927991009402, 0.35605200523692454, 0.413418683118677, 0.3448657743992822, 0.384564172750384, 0.3675818480608681, 0.4010914631361711, 0.3836213424474641, 0.35152759162088043, 0.3934390509656022, 0.33072556462828717, 0.39479440057418963, 0.3772873878751645, 0.40354996529455284, 0.3534787425225339, 0.350747846091642, 0.38930146039855285, 0.4371534032728228, 0.33176030733605305, 0.3277196567777504, 0.34526292325712826, 0.3600341299437397, 0.4265450784796103, 0.3768900231158572, 0.3671982579876948, 0.342985361624469, 0.40698902774398743, 0.3974677021826256, 0.34769866808955424, 0.36803630766271117, 0.3480113910200984, 0.38014193271963237, 0.35861685931995674, 0.3660023414834283, 0.3509626893118353, 0.43261471539369434, 0.3434195219556941, 0.43289763330993736, 0.3557562346435377, 0.3677557442907097, 0.3585392512388753, 0.36002509765489094, 0.4039236741719207, 0.3302331347675313, 0.3384302673130634, 0.3912543199252675, 0.36195503076887225, 0.3870612990572529, 0.37169798351745087, 0.37893949945563854, 0.3556280393682289, 0.34067598416874556, 0.4254345854928101, 0.36678465843503866, 0.3698805191641889, 0.36741117053823164, 0.3931359425939009, 0.3610175347813763, 0.3640773097193725, 0.40471306050996353, 0.3396721810313701, 0.34972862648505765, 0.37964392533739, 0.41465348721822215, 0.3765072496999728, 0.3749019098933063, 0.3685258245398581, 0.3578432940643401, 0.32283307778712556, 0.3721612481565758, 0.39342951287169947, 0.3493596187034876, 0.38102720143508045, 0.3802085326063193, 0.35479091039985794], [0.2909535132172833, 0.28639432025279943, 0.31002170348393754, 0.3557225498701889, 0.2701812337849923, 0.3796496905898643, 0.32961006577458096, 0.32101094535898517, 0.2735528291170695, 0.3181618358152692, 0.281477886796332, 0.2533419996154258, 0.38340286078197316, 0.31713695137537357, 0.27198894492752373, 0.27893435571351644, 0.3580507419193977, 0.2937241604166047, 0.36498684648980284, 0.3193224057471958, 0.2787594175632516, 0.27946901574906197, 0.3341249242714609, 0.28290314405912675, 0.34558853585313415, 0.2634440522618092, 0.32333098209529665, 0.32299571883136446, 0.3688137825081031, 0.25893221646762005, 0.26197328080629434, 0.3153340647118162, 0.30358241016471343, 0.29999726539412547, 0.2439868408219093, 0.31541252770210965, 0.3346652956167079, 0.27234267970712567, 0.3020528858079882, 0.25890497325295375, 0.48111604182284945, 0.29828003079817006, 0.3879895771271837, 0.27174447734469226, 0.4875665395288702, 0.3199611689606256, 0.3127659130669512, 0.3061562241037725, 0.32675163074457203, 0.2750079242995154, 0.26558582169471107, 0.2722111481473132, 0.33956816231022036, 0.2511668241445802, 0.34193628128384973, 0.30082588852034176, 0.3194779473415008, 0.3261247520202487, 0.2997072728876144, 0.3165915045530357, 0.32885243150711857, 0.2727439263926215, 0.2885115135747382, 0.2682764781682688, 0.28048394752785544, 0.38310211346995265, 0.35004693520327396, 0.2752434059321424, 0.27822713780706976, 0.27355578916410467, 0.273754010097165, 0.31131086127235885, 0.2978646733211123, 0.314043692798358, 0.27908342684977766, 0.41541712269898273, 0.267822188540555, 0.29591137407231805, 0.317239572463381, 0.33403728358282775, 0.32500302043173446, 0.30077584627937726, 0.32470883157553737, 0.3486453735810313, 0.2723729735032787, 0.26731946506888626, 0.27027713259453584, 0.33131196193872037, 0.33696028182315685, 0.3365637788531622, 0.37858454124556273, 0.3099396029242762, 0.34796764962420057, 0.33908304465345124, 0.3695276257801136, 0.30025985170412967, 0.27605496212734726, 0.29041288820591066, 0.3479162355156688, 0.32860211523162447], [0.34793463649590334, 0.26706073373476114, 0.2944198997673966, 0.32269357102063906, 0.30699320197284036, 0.2736804932800819, 0.2628851121741416, 0.2665887541224424, 0.2627656951148074, 0.3680115508842532, 0.26561764071196453, 0.3489352792164511, 0.48140800445512416, 0.2819965976461444, 0.34328250649121816, 0.34125464938942457, 0.3167919651605555, 0.27278822214789095, 0.33055563334567484, 0.2758995092221616, 0.29083187683627204, 0.31817541704323826, 0.3511722866872512, 0.2595267058068628, 0.2924862024899678, 0.2448737718212477, 0.3188153625886802, 0.3141115354071789, 0.3499493106689039, 0.26267214160180646, 0.27842900307930185, 0.31203925937680843, 0.273888133079002, 0.27808981165018226, 0.24637427384015448, 0.27767008520055914, 0.31591584998777195, 0.2856687687079382, 0.25915766990365674, 0.2824758342956606, 0.424390600761535, 0.2844436801297481, 0.2688860097825145, 0.42715404781335753, 0.48504907244714945, 0.24233730512178725, 0.3475879377286157, 0.26514173098674515, 0.27365921475176963, 0.2626020421737361, 0.2606251275317717, 0.33697669770871735, 0.3692646883491512, 0.2818296916377751, 0.34011528782066486, 0.2750214427590449, 0.2779441751130232, 0.28986558347036895, 0.3360750587601039, 0.34896666182125574, 0.25741678444382654, 0.26992364373844496, 0.2988976168426383, 0.27660576795784403, 0.27506749553060433, 0.2687373843381487, 0.3116717322857473, 0.3430677280034757, 0.3012900321927989, 0.35192554656869585, 0.28176396507171814, 0.28836280087240757, 0.3427865639849126, 0.311909735452995, 0.27518587621049373, 0.34115439109105217, 0.2829736940852685, 0.3250174281180645, 0.2718225828180446, 0.34034663582711416, 0.27929015895430653, 0.28179603621572186, 0.3143326186952946, 0.34732473161012123, 0.27755617983918773, 0.254501765146523, 0.33083470071538124, 0.28812645836642176, 0.26725548044031916, 0.26723153087647683, 0.3489044751946007, 0.295831565237281, 0.3296854527125243, 0.2918831236977706, 0.34755181836759075, 0.30174910051510173, 0.3131761931284442, 0.329102783817209, 0.24091996123984383, 0.30970600337668514]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=5$, $l=0.1$, $n=30$')
    
    lossvec0 = [[0.38583050924760964, 0.3805864077666326, 0.3964572768521591, 0.39227940704631165, 0.38564747589892073, 0.4033297784195582, 0.3975594889356481, 0.38863941640280203, 0.39286843713196895, 0.40201595286213565, 0.3778915589617121, 0.3732185650748028, 0.3921299976939237, 0.3846437304838668, 0.370628076035751, 0.4163607349815971, 0.396812865270099, 0.4155841835048091, 0.39587207709718675, 0.3829018469947969, 0.37800872529449936, 0.3963409862604907, 0.3789195541773716, 0.3790216064601415, 0.37228800287802993, 0.387929035196919, 0.39807375276496215, 0.3755987269229184, 0.3777473118766184, 0.38924578912330493, 0.38364387791698773, 0.38336904970923336, 0.3964706086800771, 0.3961262658187449, 0.38351666107797355, 0.40243811863426426, 0.3765660331020353, 0.38636196577719445, 0.3862189193660726, 0.3789616394474292, 0.3994137692631588, 0.3630902987236733, 0.39053855570977764, 0.40471699127502836, 0.39495257051396687, 0.3917768637550916, 0.386662841787641, 0.3820399538295663, 0.38782166421577, 0.3599592083551056, 0.3521884873328863, 0.38801406010871026, 0.3843276063895806, 0.3849402399967776, 0.40050510795022387, 0.4001304747855865, 0.38179263483054254, 0.3883680882622218, 0.37079516976196913, 0.37433781481426415, 0.3971214064327556, 0.3954597264763028, 0.39415072785293254, 0.36578702569154103, 0.3907533573541796, 0.3733732889162066, 0.4162197743753949, 0.38124504576180185, 0.40706208518614867, 0.42404348956088833, 0.3978984991900868, 0.41343299046418513, 0.3723546390001216, 0.36438198681397677, 0.3793977830813166, 0.3797484759869667, 0.38560903524390217, 0.39436162294505395, 0.39678907121771156, 0.3858027079501557, 0.377679219869191, 0.3913883828557191, 0.40750921332915535, 0.3874264156995278, 0.3779728450969454, 0.40969185272006436, 0.3897072956140699, 0.3859038430577251, 0.41547253745821033, 0.39186748425445406, 0.39633032528738044, 0.3795551822745309, 0.38500829485553184, 0.425305775265033, 0.3813767248171227, 0.37723107855392307, 0.3870630517285677, 0.3827646817180149, 0.3744239179978639, 0.38843358384701454]]
    lossveclist = [[0.3329667804058439, 0.3048359499798749, 0.3266234011025496, 0.3300925197530628, 0.32626058972069205, 0.3501823303837523, 0.3019848965597553, 0.367305983682519, 0.31532807586565104, 0.29617613867148274, 0.3202952734221463, 0.2966100919595709, 0.29185844246237985, 0.333494902544, 0.32377699415947875, 0.3648353865755433, 0.31165300232381093, 0.3149377765212943, 0.304713416352935, 0.3369063522218454, 0.3491460413973439, 0.32340668312695464, 0.31643202401811804, 0.30810928025544665, 0.3624048459507057, 0.2991501541974906, 0.40242749072617956, 0.3249012094831088, 0.37535827352207213, 0.3001134934112857, 0.30749366420997354, 0.28951256452255814, 0.3116339157979734, 0.33004294380778293, 0.3005564270778042, 0.32680765996264294, 0.3493550928063728, 0.31078248805487313, 0.32926446623807676, 0.34144524937464726, 0.42689250273150703, 0.3127238410942225, 0.3480688567440682, 0.33734680085678026, 0.33337041256965694, 0.30181968547185545, 0.32324237715916376, 0.28920919026530056, 0.33262757611164456, 0.34130445038968366, 0.30494481906578896, 0.3107883296991158, 0.32721812630874103, 0.3341209256075047, 0.3555900307432099, 0.334480509726279, 0.32154623005739535, 0.30147161679072015, 0.33261109938595884, 0.3160214992502357, 0.2952182071940258, 0.330839120480065, 0.3988745182203615, 0.3248261535979973, 0.3557744279632362, 0.3160436613203665, 0.3235828713468373, 0.31185240516158713, 0.36886219946986043, 0.30617411043042686, 0.323323678954806, 0.3224875359937501, 0.37066699700201405, 0.320431670841849, 0.34105896327818924, 0.40514373951382265, 0.3415263393263826, 0.3238820845567901, 0.2999717157435513, 0.35972502851167487, 0.3401627042310587, 0.32834258132916605, 0.31751592678703944, 0.31495506649014454, 0.3303513406088176, 0.3155825782123415, 0.38613688566146864, 0.3790935177071438, 0.31946500807267375, 0.35364127564523784, 0.32924538917396134, 0.33474552540010605, 0.3624847226467893, 0.34184056372179483, 0.3095423710477023, 0.3160117319932685, 0.38629853216249144, 0.39164687853309227, 0.3041061965463162, 0.30715438430876174], [0.257744672193433, 0.2888282893260882, 0.2901967291431233, 0.36591784640056557, 0.3171150994792345, 0.3268690739537106, 0.2870565638990402, 0.277642628344871, 0.2878614422011107, 0.3416259772147256, 0.2868908924597531, 0.25435820755740235, 0.3201225115254679, 0.28900086827705584, 0.3247122266805658, 0.32274595944547, 0.26974593069837133, 0.24804695511489838, 0.2882192703765516, 0.3085546277656395, 0.2790445687010042, 0.3997654008090266, 0.3431249822718958, 0.2670844048171432, 0.27468736870667443, 0.40811967060997645, 0.3336883830760252, 0.32736895298207463, 0.3638344205700433, 0.28071888985169197, 0.31548301424789127, 0.2658119898358638, 0.3144222219139029, 0.2773339734963488, 0.2643265589305023, 0.3304221468268236, 0.2837543892331195, 0.28207890362419147, 0.3224202772083998, 0.28976518833222786, 0.36489014731529884, 0.26861371461889444, 0.27342079429286814, 0.3485126920581061, 0.373672433886348, 0.2606599306682989, 0.35300058499617565, 0.325378005703378, 0.36421648447543603, 0.3142262070537773, 0.28142678848861485, 0.2648293494978105, 0.3615658768085725, 0.34129474666402204, 0.31278503723393064, 0.3439709275527221, 0.2734962672790807, 0.30320827464067623, 0.36685898022551244, 0.3119651950581767, 0.28414994474494887, 0.2727001264787752, 0.2750764175846625, 0.2787894563019702, 0.3111676679988612, 0.30601021299315334, 0.358850091805662, 0.3217321722426368, 0.2869692214909194, 0.2611604824378423, 0.3125289659489906, 0.2716431619596077, 0.3185368782839191, 0.2901512953616564, 0.4265441908943728, 0.3739639860627874, 0.3227704481847098, 0.34918347302843783, 0.28770403595903943, 0.3638759804839394, 0.325876591026501, 0.2743090260974319, 0.26951665102161304, 0.34617002949759795, 0.2879157201496528, 0.2714454872326279, 0.29052393777697727, 0.28497151453611125, 0.2768038752965317, 0.388542890111358, 0.4152627193867274, 0.2809453669098231, 0.37558892553035333, 0.2945813967084882, 0.27362895596173775, 0.2754686138213334, 0.2985831372253059, 0.3205100290338167, 0.3156509354134721, 0.2616404890825223], [0.2971372848085235, 0.35762217155900466, 0.35385325710721877, 0.3702910219950034, 0.3281505564743439, 0.29370397728457054, 0.34385880434475385, 0.3166875848537482, 0.28711821267733917, 0.31960297343124167, 0.3287950717482092, 0.30602032758323067, 0.3245162663731173, 0.30263957146727255, 0.3080288845662064, 0.3191358064157132, 0.3336561111668203, 0.3020049251654214, 0.29366062906390944, 0.3354367136352083, 0.3060617749182091, 0.33765488479915423, 0.2981321730380433, 0.31675537561243855, 0.33144974932492477, 0.3203108931482405, 0.3455339254291077, 0.3390319916489087, 0.35964676417029556, 0.32714633912342217, 0.31180190739014224, 0.3246837449201044, 0.3439460821428756, 0.31834482581395, 0.32410223131351623, 0.29064478849470415, 0.29544324807603084, 0.31643546827222097, 0.3003677785570731, 0.3707633921620287, 0.3705100062938896, 0.3260261944386248, 0.28922043070036013, 0.3727390383977527, 0.3612814309321848, 0.2898347610305933, 0.308655862138811, 0.32068989867480513, 0.3212752732329235, 0.31121845724389424, 0.31146406365419865, 0.32079669555769974, 0.3772586589003442, 0.35774980284852453, 0.33132655200791156, 0.31806753811198374, 0.3180162892195609, 0.379841747323475, 0.32925548863345816, 0.3316329429576724, 0.3254057710175776, 0.3081841541004256, 0.3811282275666344, 0.3253769422189844, 0.34276453427111003, 0.3147585987998821, 0.3323067737413986, 0.32960629319648604, 0.31195743482695343, 0.3265507538043866, 0.34167330292080733, 0.3128289943257615, 0.3083990375579971, 0.34578387156746443, 0.3774411995310438, 0.35844862562115065, 0.35933682391684624, 0.3151991613549101, 0.35597247252921743, 0.3653704537318449, 0.31482451678229534, 0.2993137066904835, 0.3224659035028097, 0.31161008485261216, 0.35080130341923366, 0.31457444985976707, 0.33070790042469406, 0.33060137203603207, 0.32266753715854046, 0.30153067123385163, 0.3126972595959515, 0.32206168540715135, 0.34940405344871583, 0.3175975150190243, 0.3323692871629586, 0.3293087069021818, 0.3437838537557757, 0.36868077210401734, 0.30305061698366426, 0.2909139802412572], [0.35356529701848344, 0.4032892118305581, 0.3666916789174621, 0.37414534220441203, 0.41339754963342606, 0.3650075429475535, 0.3638280528321904, 0.3706117395305753, 0.34484980365998535, 0.34947826787595204, 0.36293118431169896, 0.39777018837995237, 0.37051801439339094, 0.33242757441202636, 0.3454489726144909, 0.3898779359473969, 0.3730032198204712, 0.34560848688438767, 0.3961808984205089, 0.35241029925525186, 0.35449236127665557, 0.3373068261816929, 0.39671977931980557, 0.34742860727554015, 0.321888523157417, 0.3391927991009402, 0.35605200523692454, 0.413418683118677, 0.3448657743992822, 0.384564172750384, 0.3675818480608681, 0.4010914631361711, 0.3836213424474641, 0.35152759162088043, 0.3934390509656022, 0.33072556462828717, 0.39479440057418963, 0.3772873878751645, 0.40354996529455284, 0.3534787425225339, 0.350747846091642, 0.38930146039855285, 0.4371534032728228, 0.33176030733605305, 0.3277196567777504, 0.34526292325712826, 0.3600341299437397, 0.4265450784796103, 0.3768900231158572, 0.3671982579876948, 0.342985361624469, 0.40698902774398743, 0.3974677021826256, 0.34769866808955424, 0.36803630766271117, 0.3480113910200984, 0.38014193271963237, 0.35861685931995674, 0.3660023414834283, 0.3509626893118353, 0.43261471539369434, 0.3434195219556941, 0.43289763330993736, 0.3557562346435377, 0.3677557442907097, 0.3585392512388753, 0.36002509765489094, 0.4039236741719207, 0.3302331347675313, 0.3384302673130634, 0.3912543199252675, 0.36195503076887225, 0.3870612990572529, 0.37169798351745087, 0.37893949945563854, 0.3556280393682289, 0.34067598416874556, 0.4254345854928101, 0.36678465843503866, 0.3698805191641889, 0.36741117053823164, 0.3931359425939009, 0.3610175347813763, 0.3640773097193725, 0.40471306050996353, 0.3396721810313701, 0.34972862648505765, 0.37964392533739, 0.41465348721822215, 0.3765072496999728, 0.3749019098933063, 0.3685258245398581, 0.3578432940643401, 0.32283307778712556, 0.3721612481565758, 0.39342951287169947, 0.3493596187034876, 0.38102720143508045, 0.3802085326063193, 0.35479091039985794], [0.2909535132172833, 0.28639432025279943, 0.31002170348393754, 0.3557225498701889, 0.2701812337849923, 0.3796496905898643, 0.32961006577458096, 0.32101094535898517, 0.2735528291170695, 0.3181618358152692, 0.281477886796332, 0.2533419996154258, 0.38340286078197316, 0.31713695137537357, 0.27198894492752373, 0.27893435571351644, 0.3580507419193977, 0.2937241604166047, 0.36498684648980284, 0.3193224057471958, 0.2787594175632516, 0.27946901574906197, 0.3341249242714609, 0.28290314405912675, 0.34558853585313415, 0.2634440522618092, 0.32333098209529665, 0.32299571883136446, 0.3688137825081031, 0.25893221646762005, 0.26197328080629434, 0.3153340647118162, 0.30358241016471343, 0.29999726539412547, 0.2439868408219093, 0.31541252770210965, 0.3346652956167079, 0.27234267970712567, 0.3020528858079882, 0.25890497325295375, 0.48111604182284945, 0.29828003079817006, 0.3879895771271837, 0.27174447734469226, 0.4875665395288702, 0.3199611689606256, 0.3127659130669512, 0.3061562241037725, 0.32675163074457203, 0.2750079242995154, 0.26558582169471107, 0.2722111481473132, 0.33956816231022036, 0.2511668241445802, 0.34193628128384973, 0.30082588852034176, 0.3194779473415008, 0.3261247520202487, 0.2997072728876144, 0.3165915045530357, 0.32885243150711857, 0.2727439263926215, 0.2885115135747382, 0.2682764781682688, 0.28048394752785544, 0.38310211346995265, 0.35004693520327396, 0.2752434059321424, 0.27822713780706976, 0.27355578916410467, 0.273754010097165, 0.31131086127235885, 0.2978646733211123, 0.314043692798358, 0.27908342684977766, 0.41541712269898273, 0.267822188540555, 0.29591137407231805, 0.317239572463381, 0.33403728358282775, 0.32500302043173446, 0.30077584627937726, 0.32470883157553737, 0.3486453735810313, 0.2723729735032787, 0.26731946506888626, 0.27027713259453584, 0.33131196193872037, 0.33696028182315685, 0.3365637788531622, 0.37858454124556273, 0.3099396029242762, 0.34796764962420057, 0.33908304465345124, 0.3695276257801136, 0.30025985170412967, 0.27605496212734726, 0.29041288820591066, 0.3479162355156688, 0.32860211523162447], [0.34793463649590334, 0.26706073373476114, 0.2944198997673966, 0.32269357102063906, 0.30699320197284036, 0.2736804932800819, 0.2628851121741416, 0.2665887541224424, 0.2627656951148074, 0.3680115508842532, 0.26561764071196453, 0.3489352792164511, 0.48140800445512416, 0.2819965976461444, 0.34328250649121816, 0.34125464938942457, 0.3167919651605555, 0.27278822214789095, 0.33055563334567484, 0.2758995092221616, 0.29083187683627204, 0.31817541704323826, 0.3511722866872512, 0.2595267058068628, 0.2924862024899678, 0.2448737718212477, 0.3188153625886802, 0.3141115354071789, 0.3499493106689039, 0.26267214160180646, 0.27842900307930185, 0.31203925937680843, 0.273888133079002, 0.27808981165018226, 0.24637427384015448, 0.27767008520055914, 0.31591584998777195, 0.2856687687079382, 0.25915766990365674, 0.2824758342956606, 0.424390600761535, 0.2844436801297481, 0.2688860097825145, 0.42715404781335753, 0.48504907244714945, 0.24233730512178725, 0.3475879377286157, 0.26514173098674515, 0.27365921475176963, 0.2626020421737361, 0.2606251275317717, 0.33697669770871735, 0.3692646883491512, 0.2818296916377751, 0.34011528782066486, 0.2750214427590449, 0.2779441751130232, 0.28986558347036895, 0.3360750587601039, 0.34896666182125574, 0.25741678444382654, 0.26992364373844496, 0.2988976168426383, 0.27660576795784403, 0.27506749553060433, 0.2687373843381487, 0.3116717322857473, 0.3430677280034757, 0.3012900321927989, 0.35192554656869585, 0.28176396507171814, 0.28836280087240757, 0.3427865639849126, 0.311909735452995, 0.27518587621049373, 0.34115439109105217, 0.2829736940852685, 0.3250174281180645, 0.2718225828180446, 0.34034663582711416, 0.27929015895430653, 0.28179603621572186, 0.3143326186952946, 0.34732473161012123, 0.27755617983918773, 0.254501765146523, 0.33083470071538124, 0.28812645836642176, 0.26725548044031916, 0.26723153087647683, 0.3489044751946007, 0.295831565237281, 0.3296854527125243, 0.2918831236977706, 0.34755181836759075, 0.30174910051510173, 0.3131761931284442, 0.329102783817209, 0.24091996123984383, 0.30970600337668514]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### overEstWt=0.2, rateTarget=0.1 ###
    # Get null first
    underWt, t = 0.2, 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Design 0']
    lossvec = [[0.04874981168155717, 0.04601627598721148, 0.046602509349972523, 0.050586168495252604, 0.047650039131627096, 0.04900758374021014, 0.05083789310453001, 0.04815940526219456, 0.04894303779884694, 0.04872188439052756, 0.04596113107150889, 0.04533036788057144, 0.047702491234585545, 0.04605326438814462, 0.0445759009504151, 0.053495095666269976, 0.04786314057031166, 0.04960261382638776, 0.048985348721622135, 0.04767482107021301, 0.04715583207351171, 0.0476421221058353, 0.04696364472561235, 0.04691241877782879, 0.04513892571546784, 0.04654400401716812, 0.04892125037855425, 0.0455866952254014, 0.046053861253317854, 0.047858963944586455, 0.04881940384220125, 0.04737662377020264, 0.049525288614961915, 0.04957435122175646, 0.04575276971922458, 0.04960007226271745, 0.04824906144665322, 0.04810665616041669, 0.047014452407872546, 0.047600033676595356, 0.04839777879360045, 0.045558118647944186, 0.047518293650248594, 0.05036545697743948, 0.049412171532409094, 0.04856483735481838, 0.04754430576186313, 0.046404639783898714, 0.04646733894411559, 0.04443174099410009, 0.04350771594448622, 0.04825966263047179, 0.04778314333024609, 0.04821113384089001, 0.04797284516136274, 0.048938148885673535, 0.04687477057177605, 0.04670793693255172, 0.04495711920901903, 0.04735873038334376, 0.05014163434178577, 0.047774072750534476, 0.04683807874548834, 0.04655733411954765, 0.048538584046488004, 0.045772918950249715, 0.049308758668981205, 0.04680097274856691, 0.04714223637422627, 0.05147392076156743, 0.04874938178896028, 0.051631306011019514, 0.04493540958584115, 0.04595306111401679, 0.04643543723089674, 0.04715820518602384, 0.04857938775379486, 0.04739208539927517, 0.04798729370505646, 0.04720470339582102, 0.04780471892428656, 0.04721535246277248, 0.050363706530987845, 0.04699765461372573, 0.04592028467371892, 0.04890129988747958, 0.048202645680428875, 0.0487827386622787, 0.049712689106432645, 0.048768532287325035, 0.0482422597277323, 0.04691256438345368, 0.047261297155268917, 0.053601021618157114, 0.04745636245268635, 0.046792417128567285, 0.04759514246217367, 0.04665313645744631, 0.04604447426571351, 0.05065028847795186]]
    '''
    # 30 tests for all designs
    underWt, t = 0.2, 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossvec0 = [[0.04874981168155717, 0.04601627598721148, 0.046602509349972523, 0.050586168495252604, 0.047650039131627096, 0.04900758374021014, 0.05083789310453001, 0.04815940526219456, 0.04894303779884694, 0.04872188439052756, 0.04596113107150889, 0.04533036788057144, 0.047702491234585545, 0.04605326438814462, 0.0445759009504151, 0.053495095666269976, 0.04786314057031166, 0.04960261382638776, 0.048985348721622135, 0.04767482107021301, 0.04715583207351171, 0.0476421221058353, 0.04696364472561235, 0.04691241877782879, 0.04513892571546784, 0.04654400401716812, 0.04892125037855425, 0.0455866952254014, 0.046053861253317854, 0.047858963944586455, 0.04881940384220125, 0.04737662377020264, 0.049525288614961915, 0.04957435122175646, 0.04575276971922458, 0.04960007226271745, 0.04824906144665322, 0.04810665616041669, 0.047014452407872546, 0.047600033676595356, 0.04839777879360045, 0.045558118647944186, 0.047518293650248594, 0.05036545697743948, 0.049412171532409094, 0.04856483735481838, 0.04754430576186313, 0.046404639783898714, 0.04646733894411559, 0.04443174099410009, 0.04350771594448622, 0.04825966263047179, 0.04778314333024609, 0.04821113384089001, 0.04797284516136274, 0.048938148885673535, 0.04687477057177605, 0.04670793693255172, 0.04495711920901903, 0.04735873038334376, 0.05014163434178577, 0.047774072750534476, 0.04683807874548834, 0.04655733411954765, 0.048538584046488004, 0.045772918950249715, 0.049308758668981205, 0.04680097274856691, 0.04714223637422627, 0.05147392076156743, 0.04874938178896028, 0.051631306011019514, 0.04493540958584115, 0.04595306111401679, 0.04643543723089674, 0.04715820518602384, 0.04857938775379486, 0.04739208539927517, 0.04798729370505646, 0.04720470339582102, 0.04780471892428656, 0.04721535246277248, 0.050363706530987845, 0.04699765461372573, 0.04592028467371892, 0.04890129988747958, 0.048202645680428875, 0.0487827386622787, 0.049712689106432645, 0.048768532287325035, 0.0482422597277323, 0.04691256438345368, 0.047261297155268917, 0.053601021618157114, 0.04745636245268635, 0.046792417128567285, 0.04759514246217367, 0.04665313645744631, 0.04604447426571351, 0.05065028847795186]]
    lossveclist = [[0.03600387141169995, 0.0342730895471504, 0.037231245719616474, 0.03821681656593368, 0.036524971635385796, 0.03949410935896119, 0.03446591045419293, 0.0396743369833525, 0.035792210076944615, 0.033537117437739294, 0.03604002814257922, 0.03417521321342557, 0.033347089545724476, 0.03769482474517408, 0.03846517972190049, 0.0413523467226083, 0.036049512120723166, 0.03406534550385596, 0.03394704273824553, 0.03850120087976367, 0.03812376762208605, 0.03652952777060523, 0.03568045219506099, 0.03365921678428877, 0.040797963743401014, 0.03474034286476377, 0.05681018234607664, 0.03642466430890088, 0.042151979721033954, 0.0336656061000447, 0.03321807915010236, 0.03222030432492298, 0.035741544892543525, 0.03838025443578791, 0.033512676132623126, 0.03546218227682308, 0.03889728003774697, 0.0352736552930459, 0.035973969825781035, 0.03755704163857905, 0.06055880514457488, 0.03614881522940921, 0.038411144933868206, 0.03919233964066806, 0.03667805662919395, 0.03413958669579258, 0.03690343099030715, 0.03394220152714762, 0.03751124422446472, 0.040262454415152846, 0.03394337372005103, 0.034812870011651315, 0.035718060541246405, 0.03819795905683452, 0.040033154300366934, 0.03926265471770691, 0.03615325568009378, 0.03365933453732525, 0.039068440027706486, 0.03632450405529403, 0.03327959039466234, 0.0380557669942912, 0.04857213410814255, 0.035188985655768945, 0.04043738663945356, 0.03461658117604629, 0.03575857100926664, 0.03573843165258482, 0.041993840306214, 0.034306677060425186, 0.03628713978405569, 0.035703868798188966, 0.04458347755061121, 0.03624753151316024, 0.03948719381822563, 0.0514030225739673, 0.038867823954609415, 0.03579494111342879, 0.03538579136099024, 0.040838587502597105, 0.03860451142831938, 0.03780565036781205, 0.0364963808518118, 0.03618359146640712, 0.03728674563978707, 0.0342052606993684, 0.045607219514922345, 0.04675837831369056, 0.03679145357401076, 0.04088944957649345, 0.03692985402786966, 0.03721957441070393, 0.042556929527808776, 0.03757894146988101, 0.03353467132919647, 0.03493478178400731, 0.04450977788157231, 0.04781059757709734, 0.03589444014000382, 0.033811352639167375], [0.03247157870333634, 0.03318194492752637, 0.03463007097425255, 0.051049050308552654, 0.03850730819930318, 0.04031901861803653, 0.03427235557674851, 0.034010168412598525, 0.03461466855192819, 0.04494374691651651, 0.035001417462513, 0.030302300847453317, 0.03834485640504798, 0.036675865548538744, 0.04393559480015078, 0.04171363265433519, 0.032376466219710374, 0.02986458157263873, 0.03490510512201936, 0.03878342509033107, 0.03367242870226093, 0.056341030724462164, 0.045020820645025425, 0.030372632377275544, 0.032162543220543065, 0.05401742832969433, 0.041445568653376175, 0.04284420518708859, 0.04765206808932774, 0.03391888757449491, 0.03988226390744916, 0.033000930756513544, 0.038185424287346156, 0.03368507076972996, 0.03233114140824264, 0.04168701037128857, 0.03406393637814948, 0.03418946308678494, 0.03933680556781036, 0.03399084828193904, 0.05074275526585784, 0.032796910349761337, 0.032659712566455654, 0.04539497882900675, 0.05051831094601719, 0.029931880893275625, 0.04796828589248162, 0.04168298058798658, 0.04872696928716215, 0.04069324216312038, 0.03243693579734485, 0.03323599415950701, 0.048568322418253346, 0.042294829590725495, 0.03910458769537142, 0.045775296653764445, 0.03354795525028503, 0.037764855128641764, 0.05015406721005048, 0.03809590534052541, 0.034092449566365424, 0.03192536473147988, 0.03338906979697374, 0.03405221582313484, 0.039050300393319776, 0.03699284053439283, 0.049395076390538695, 0.03939699492630544, 0.03376631330866659, 0.03175395707785087, 0.04166174840370486, 0.03341813377413406, 0.04254266141756018, 0.034659866752009376, 0.06275555188744339, 0.05049307765392174, 0.03998382795544256, 0.04293386300734962, 0.033606869374793354, 0.047297897957060346, 0.03833376298075429, 0.0332286396228541, 0.03158250901388399, 0.04668935395333933, 0.033945699303054584, 0.03147228908338381, 0.035373923564573986, 0.03488084616055411, 0.03228131554947106, 0.0505732397344586, 0.05706422299839914, 0.03369960203925626, 0.052998423043877294, 0.033865538758937094, 0.03286412239080154, 0.033561143488023235, 0.035605295311343946, 0.04184254246240404, 0.04038704504286295, 0.031249250442076954], [0.033017079198157655, 0.04158532422078846, 0.041584553328429245, 0.04378565796802446, 0.03648249332542842, 0.03285357328461722, 0.038337274948866344, 0.03621970705590605, 0.03134156703771401, 0.035769886104954754, 0.037340849467323044, 0.0313665823797126, 0.034185424944983625, 0.0346548574587842, 0.03503335515078644, 0.037647210644051854, 0.03938458639535794, 0.035818627580583, 0.03146852009362715, 0.03854829589823155, 0.03491682633595039, 0.04043411715199262, 0.03332958738501635, 0.03488517732439377, 0.036522183240414854, 0.03878276627088863, 0.040702785667591695, 0.03928052926912373, 0.04460865727437838, 0.03625447097454831, 0.035233226312654305, 0.03604404700950841, 0.0411184144450268, 0.03750206229114288, 0.036314680348407284, 0.03301700243309977, 0.03433712906986775, 0.03555874588534948, 0.033902050694291495, 0.04487873866473983, 0.049715667580449895, 0.036955848547248364, 0.032740287723456794, 0.042622143635322275, 0.0452423713565602, 0.03381648743585423, 0.03484262523639304, 0.036487508684135035, 0.03708003362600682, 0.03503568780671189, 0.034033817891264015, 0.0358573204501911, 0.049648869591577244, 0.044987952671725985, 0.03996986063720047, 0.03646058941378137, 0.035576230729342864, 0.04566123163597354, 0.0387087251236214, 0.037457786875952866, 0.03756700987706567, 0.03616318935573511, 0.04671659726632212, 0.03719334834992154, 0.04039422637036856, 0.03737281399601109, 0.03884991594071239, 0.038929789359679313, 0.035750910560064846, 0.03602774009934691, 0.03952613283758204, 0.037071455923011705, 0.03654932653704365, 0.041694779457145836, 0.048420990544304654, 0.051296976226234685, 0.04090492302306896, 0.036090092170553034, 0.0413647470016485, 0.04173275036967798, 0.03532536020525261, 0.033619708684659896, 0.03719942747580999, 0.03663784706817902, 0.04144032431517964, 0.033895151070847424, 0.038627240821490286, 0.03905010744514432, 0.037019306837756394, 0.03510359335589479, 0.03563129831370164, 0.03587367215302844, 0.04355355805186783, 0.03657673447757109, 0.037700004723844, 0.038454263683708634, 0.03921639876725657, 0.04503020832295625, 0.03517907034431479, 0.033077511202575224], [0.04379407078966705, 0.05305412318148922, 0.04583816667558644, 0.047337872892934174, 0.0517290689775664, 0.045949552657458016, 0.0460782079382982, 0.04714375564778112, 0.043659644263216564, 0.04376589618703744, 0.04525035790520816, 0.04885348398995539, 0.0464080636775798, 0.0430697207499657, 0.04355532886053957, 0.050101923017053906, 0.04980119837337879, 0.045382466690564095, 0.05359484312092717, 0.04569116979755993, 0.04677643528031598, 0.04419515937788168, 0.05143605032176487, 0.04384752182779513, 0.04044578921274152, 0.04413803216675421, 0.04529427074410668, 0.055447921381077535, 0.043915648832631854, 0.048951133981999455, 0.0462388096162442, 0.052548818353136996, 0.049752495856480596, 0.0444371243265047, 0.05038582691162898, 0.04218378014475623, 0.05175916447447992, 0.047780787952355915, 0.05145916832735254, 0.04519185793183949, 0.042987146788644924, 0.0507493243429472, 0.061762590238264956, 0.042503407825992136, 0.042049286894654564, 0.04452911557695291, 0.046277824793847316, 0.0601094980017077, 0.047292175800146635, 0.045916053281276716, 0.044769619817141115, 0.05133190382490209, 0.05169188195253921, 0.04396709424051003, 0.05015185237173614, 0.04443194245608358, 0.05048978410429253, 0.04471712782303962, 0.044438573183524815, 0.04513459184453437, 0.05709265271109162, 0.044763382298039514, 0.058148145935187315, 0.044334705954274294, 0.04747621669217515, 0.046159470310520784, 0.045975625129722524, 0.05197097913829445, 0.043107143009489195, 0.04386236684431435, 0.04834427406983873, 0.046656949433527654, 0.04937132587304585, 0.047112377919507745, 0.049010382552576746, 0.0456998987358388, 0.04563171714112648, 0.054812648450932054, 0.047015222771747536, 0.045994359596999365, 0.047643265181751035, 0.05132410132747876, 0.04574938246312426, 0.04641110753128421, 0.053405069946187426, 0.04380667315544283, 0.042693406426730196, 0.047576529648319314, 0.05354090534467667, 0.049918152479466696, 0.04430353562990423, 0.04991055058053264, 0.045813393648375195, 0.03917351615592717, 0.04644971531696419, 0.05108892218082214, 0.044990386019412826, 0.049450313147062296, 0.04759169818499728, 0.04496219681129428], [0.037057652812811336, 0.035937114666838896, 0.036418754815719274, 0.04998137600951598, 0.032383487210943335, 0.051615359704323134, 0.04395146332174924, 0.03917009318220277, 0.03379712472624289, 0.04048728862447243, 0.03479676288113116, 0.03060548728474418, 0.05305893192806684, 0.040887618862965, 0.03291136650835345, 0.034109380839842, 0.04858443903287711, 0.03720320214137501, 0.05100966237561072, 0.039258666377079324, 0.03582955376561388, 0.033610223477848325, 0.04120585699812694, 0.03485040140526949, 0.04848060846024003, 0.03130856473288647, 0.043490697685169624, 0.039489826052234944, 0.05081409259631775, 0.03156308221321965, 0.03201709671725595, 0.0378480002830186, 0.0385258596749226, 0.03908521380968775, 0.028789456028220858, 0.03911203677596096, 0.04072348908939193, 0.03435122448023628, 0.03882225709852575, 0.032110982357268864, 0.0775222145803899, 0.03810387732421076, 0.05187195542063112, 0.03397518318805308, 0.07699853884999773, 0.03936186213573828, 0.04022632686322773, 0.03863306799264579, 0.048183198078463434, 0.034317139331466594, 0.03231318443878067, 0.032796555594963146, 0.04668260977626428, 0.031208538916614396, 0.047630298527774, 0.037311307067506294, 0.040679856423737525, 0.04254264165885353, 0.038838701083116364, 0.038087348133642035, 0.04044873871974779, 0.033135025003602714, 0.03561986951467849, 0.03172074963458127, 0.03361406630933486, 0.050664324956714295, 0.05013713127934687, 0.03281985414317755, 0.035482295648784974, 0.033949428608136274, 0.033133984241045904, 0.03726782344672396, 0.03500989562073132, 0.03929902253085143, 0.034631913124886504, 0.059384017743973984, 0.03213043925988722, 0.03531971665259015, 0.04131905000989418, 0.04528558582191684, 0.04439627640532285, 0.03824862880881337, 0.043257616890353685, 0.04479226010595114, 0.033881288968361484, 0.03241793685276733, 0.03427990430505567, 0.041535345124885596, 0.04234010644585691, 0.043877453198735254, 0.05124801024964286, 0.039215082891787226, 0.04916849505316357, 0.044771926794602686, 0.05544368836241387, 0.03753117593561701, 0.03497510718541545, 0.03785008790836552, 0.04244160214655629, 0.043081865304832434], [0.04504438414549744, 0.032007347639550286, 0.034567198008157704, 0.040037438226426636, 0.038260972454935906, 0.03279651115654428, 0.031857143050798065, 0.0317152221660294, 0.030419492674772185, 0.049785940971736595, 0.0309369747578923, 0.046637626557350126, 0.06936920423909326, 0.032678915117107264, 0.04905993776621415, 0.0449552022018826, 0.04030479531763029, 0.03182087818432183, 0.04150334157748829, 0.0325383655008692, 0.034581890611656466, 0.04210250602725982, 0.0428750999742645, 0.03068362320893862, 0.03438810481010428, 0.02937094359374039, 0.040395875423927266, 0.0394006077748758, 0.04453773508108354, 0.03169840676495003, 0.033810718336486655, 0.0398553625275625, 0.03398291536197145, 0.03349103132925242, 0.027578152614055856, 0.03392739823559373, 0.04026153809945305, 0.03382667888836688, 0.031237564593356328, 0.03379919663826887, 0.05891556679892013, 0.0335470337682961, 0.031179319278051978, 0.05871877699517557, 0.0775766980403925, 0.02821416565382691, 0.04423675925828131, 0.0328634627773499, 0.03277314206053577, 0.03229216928094897, 0.03150639116800713, 0.04534773632070569, 0.05480725170304846, 0.034040832439223456, 0.04264470806890969, 0.03292222525192653, 0.03364597029691965, 0.03425475633082702, 0.04628824507045611, 0.04351300749027977, 0.03155136384260368, 0.03222199177191704, 0.039347544699728024, 0.03227019382250165, 0.03198771340691302, 0.03133296038121776, 0.03853005114664913, 0.04426062220722953, 0.035905423447104186, 0.04340285876281895, 0.03415142948461233, 0.03429021566556796, 0.041384147825654555, 0.038289134583400566, 0.03243479795744189, 0.04397951875710644, 0.033665467996051836, 0.04094734313855272, 0.03245457715752503, 0.04323960125667464, 0.03414162463983005, 0.0331359286240394, 0.03895731494654217, 0.046332371457561264, 0.03257981155842544, 0.029846340200657132, 0.0425851253047408, 0.03351655149534, 0.03141763363951522, 0.032291479090400546, 0.04507650550919211, 0.034666362602499945, 0.04066689336865024, 0.03433534282749658, 0.04413945028021679, 0.035599594695786, 0.037386604675449284, 0.04124759067575332, 0.028373020155373206, 0.035862795597776165]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=0.2$, $l=0.1$, $n=30$')
    
    lossvec0 = [[0.04874981168155717, 0.04601627598721148, 0.046602509349972523, 0.050586168495252604, 0.047650039131627096, 0.04900758374021014, 0.05083789310453001, 0.04815940526219456, 0.04894303779884694, 0.04872188439052756, 0.04596113107150889, 0.04533036788057144, 0.047702491234585545, 0.04605326438814462, 0.0445759009504151, 0.053495095666269976, 0.04786314057031166, 0.04960261382638776, 0.048985348721622135, 0.04767482107021301, 0.04715583207351171, 0.0476421221058353, 0.04696364472561235, 0.04691241877782879, 0.04513892571546784, 0.04654400401716812, 0.04892125037855425, 0.0455866952254014, 0.046053861253317854, 0.047858963944586455, 0.04881940384220125, 0.04737662377020264, 0.049525288614961915, 0.04957435122175646, 0.04575276971922458, 0.04960007226271745, 0.04824906144665322, 0.04810665616041669, 0.047014452407872546, 0.047600033676595356, 0.04839777879360045, 0.045558118647944186, 0.047518293650248594, 0.05036545697743948, 0.049412171532409094, 0.04856483735481838, 0.04754430576186313, 0.046404639783898714, 0.04646733894411559, 0.04443174099410009, 0.04350771594448622, 0.04825966263047179, 0.04778314333024609, 0.04821113384089001, 0.04797284516136274, 0.048938148885673535, 0.04687477057177605, 0.04670793693255172, 0.04495711920901903, 0.04735873038334376, 0.05014163434178577, 0.047774072750534476, 0.04683807874548834, 0.04655733411954765, 0.048538584046488004, 0.045772918950249715, 0.049308758668981205, 0.04680097274856691, 0.04714223637422627, 0.05147392076156743, 0.04874938178896028, 0.051631306011019514, 0.04493540958584115, 0.04595306111401679, 0.04643543723089674, 0.04715820518602384, 0.04857938775379486, 0.04739208539927517, 0.04798729370505646, 0.04720470339582102, 0.04780471892428656, 0.04721535246277248, 0.050363706530987845, 0.04699765461372573, 0.04592028467371892, 0.04890129988747958, 0.048202645680428875, 0.0487827386622787, 0.049712689106432645, 0.048768532287325035, 0.0482422597277323, 0.04691256438345368, 0.047261297155268917, 0.053601021618157114, 0.04745636245268635, 0.046792417128567285, 0.04759514246217367, 0.04665313645744631, 0.04604447426571351, 0.05065028847795186]]
    lossveclist = [[0.03600387141169995, 0.0342730895471504, 0.037231245719616474, 0.03821681656593368, 0.036524971635385796, 0.03949410935896119, 0.03446591045419293, 0.0396743369833525, 0.035792210076944615, 0.033537117437739294, 0.03604002814257922, 0.03417521321342557, 0.033347089545724476, 0.03769482474517408, 0.03846517972190049, 0.0413523467226083, 0.036049512120723166, 0.03406534550385596, 0.03394704273824553, 0.03850120087976367, 0.03812376762208605, 0.03652952777060523, 0.03568045219506099, 0.03365921678428877, 0.040797963743401014, 0.03474034286476377, 0.05681018234607664, 0.03642466430890088, 0.042151979721033954, 0.0336656061000447, 0.03321807915010236, 0.03222030432492298, 0.035741544892543525, 0.03838025443578791, 0.033512676132623126, 0.03546218227682308, 0.03889728003774697, 0.0352736552930459, 0.035973969825781035, 0.03755704163857905, 0.06055880514457488, 0.03614881522940921, 0.038411144933868206, 0.03919233964066806, 0.03667805662919395, 0.03413958669579258, 0.03690343099030715, 0.03394220152714762, 0.03751124422446472, 0.040262454415152846, 0.03394337372005103, 0.034812870011651315, 0.035718060541246405, 0.03819795905683452, 0.040033154300366934, 0.03926265471770691, 0.03615325568009378, 0.03365933453732525, 0.039068440027706486, 0.03632450405529403, 0.03327959039466234, 0.0380557669942912, 0.04857213410814255, 0.035188985655768945, 0.04043738663945356, 0.03461658117604629, 0.03575857100926664, 0.03573843165258482, 0.041993840306214, 0.034306677060425186, 0.03628713978405569, 0.035703868798188966, 0.04458347755061121, 0.03624753151316024, 0.03948719381822563, 0.0514030225739673, 0.038867823954609415, 0.03579494111342879, 0.03538579136099024, 0.040838587502597105, 0.03860451142831938, 0.03780565036781205, 0.0364963808518118, 0.03618359146640712, 0.03728674563978707, 0.0342052606993684, 0.045607219514922345, 0.04675837831369056, 0.03679145357401076, 0.04088944957649345, 0.03692985402786966, 0.03721957441070393, 0.042556929527808776, 0.03757894146988101, 0.03353467132919647, 0.03493478178400731, 0.04450977788157231, 0.04781059757709734, 0.03589444014000382, 0.033811352639167375], [0.03247157870333634, 0.03318194492752637, 0.03463007097425255, 0.051049050308552654, 0.03850730819930318, 0.04031901861803653, 0.03427235557674851, 0.034010168412598525, 0.03461466855192819, 0.04494374691651651, 0.035001417462513, 0.030302300847453317, 0.03834485640504798, 0.036675865548538744, 0.04393559480015078, 0.04171363265433519, 0.032376466219710374, 0.02986458157263873, 0.03490510512201936, 0.03878342509033107, 0.03367242870226093, 0.056341030724462164, 0.045020820645025425, 0.030372632377275544, 0.032162543220543065, 0.05401742832969433, 0.041445568653376175, 0.04284420518708859, 0.04765206808932774, 0.03391888757449491, 0.03988226390744916, 0.033000930756513544, 0.038185424287346156, 0.03368507076972996, 0.03233114140824264, 0.04168701037128857, 0.03406393637814948, 0.03418946308678494, 0.03933680556781036, 0.03399084828193904, 0.05074275526585784, 0.032796910349761337, 0.032659712566455654, 0.04539497882900675, 0.05051831094601719, 0.029931880893275625, 0.04796828589248162, 0.04168298058798658, 0.04872696928716215, 0.04069324216312038, 0.03243693579734485, 0.03323599415950701, 0.048568322418253346, 0.042294829590725495, 0.03910458769537142, 0.045775296653764445, 0.03354795525028503, 0.037764855128641764, 0.05015406721005048, 0.03809590534052541, 0.034092449566365424, 0.03192536473147988, 0.03338906979697374, 0.03405221582313484, 0.039050300393319776, 0.03699284053439283, 0.049395076390538695, 0.03939699492630544, 0.03376631330866659, 0.03175395707785087, 0.04166174840370486, 0.03341813377413406, 0.04254266141756018, 0.034659866752009376, 0.06275555188744339, 0.05049307765392174, 0.03998382795544256, 0.04293386300734962, 0.033606869374793354, 0.047297897957060346, 0.03833376298075429, 0.0332286396228541, 0.03158250901388399, 0.04668935395333933, 0.033945699303054584, 0.03147228908338381, 0.035373923564573986, 0.03488084616055411, 0.03228131554947106, 0.0505732397344586, 0.05706422299839914, 0.03369960203925626, 0.052998423043877294, 0.033865538758937094, 0.03286412239080154, 0.033561143488023235, 0.035605295311343946, 0.04184254246240404, 0.04038704504286295, 0.031249250442076954], [0.033017079198157655, 0.04158532422078846, 0.041584553328429245, 0.04378565796802446, 0.03648249332542842, 0.03285357328461722, 0.038337274948866344, 0.03621970705590605, 0.03134156703771401, 0.035769886104954754, 0.037340849467323044, 0.0313665823797126, 0.034185424944983625, 0.0346548574587842, 0.03503335515078644, 0.037647210644051854, 0.03938458639535794, 0.035818627580583, 0.03146852009362715, 0.03854829589823155, 0.03491682633595039, 0.04043411715199262, 0.03332958738501635, 0.03488517732439377, 0.036522183240414854, 0.03878276627088863, 0.040702785667591695, 0.03928052926912373, 0.04460865727437838, 0.03625447097454831, 0.035233226312654305, 0.03604404700950841, 0.0411184144450268, 0.03750206229114288, 0.036314680348407284, 0.03301700243309977, 0.03433712906986775, 0.03555874588534948, 0.033902050694291495, 0.04487873866473983, 0.049715667580449895, 0.036955848547248364, 0.032740287723456794, 0.042622143635322275, 0.0452423713565602, 0.03381648743585423, 0.03484262523639304, 0.036487508684135035, 0.03708003362600682, 0.03503568780671189, 0.034033817891264015, 0.0358573204501911, 0.049648869591577244, 0.044987952671725985, 0.03996986063720047, 0.03646058941378137, 0.035576230729342864, 0.04566123163597354, 0.0387087251236214, 0.037457786875952866, 0.03756700987706567, 0.03616318935573511, 0.04671659726632212, 0.03719334834992154, 0.04039422637036856, 0.03737281399601109, 0.03884991594071239, 0.038929789359679313, 0.035750910560064846, 0.03602774009934691, 0.03952613283758204, 0.037071455923011705, 0.03654932653704365, 0.041694779457145836, 0.048420990544304654, 0.051296976226234685, 0.04090492302306896, 0.036090092170553034, 0.0413647470016485, 0.04173275036967798, 0.03532536020525261, 0.033619708684659896, 0.03719942747580999, 0.03663784706817902, 0.04144032431517964, 0.033895151070847424, 0.038627240821490286, 0.03905010744514432, 0.037019306837756394, 0.03510359335589479, 0.03563129831370164, 0.03587367215302844, 0.04355355805186783, 0.03657673447757109, 0.037700004723844, 0.038454263683708634, 0.03921639876725657, 0.04503020832295625, 0.03517907034431479, 0.033077511202575224], [0.04379407078966705, 0.05305412318148922, 0.04583816667558644, 0.047337872892934174, 0.0517290689775664, 0.045949552657458016, 0.0460782079382982, 0.04714375564778112, 0.043659644263216564, 0.04376589618703744, 0.04525035790520816, 0.04885348398995539, 0.0464080636775798, 0.0430697207499657, 0.04355532886053957, 0.050101923017053906, 0.04980119837337879, 0.045382466690564095, 0.05359484312092717, 0.04569116979755993, 0.04677643528031598, 0.04419515937788168, 0.05143605032176487, 0.04384752182779513, 0.04044578921274152, 0.04413803216675421, 0.04529427074410668, 0.055447921381077535, 0.043915648832631854, 0.048951133981999455, 0.0462388096162442, 0.052548818353136996, 0.049752495856480596, 0.0444371243265047, 0.05038582691162898, 0.04218378014475623, 0.05175916447447992, 0.047780787952355915, 0.05145916832735254, 0.04519185793183949, 0.042987146788644924, 0.0507493243429472, 0.061762590238264956, 0.042503407825992136, 0.042049286894654564, 0.04452911557695291, 0.046277824793847316, 0.0601094980017077, 0.047292175800146635, 0.045916053281276716, 0.044769619817141115, 0.05133190382490209, 0.05169188195253921, 0.04396709424051003, 0.05015185237173614, 0.04443194245608358, 0.05048978410429253, 0.04471712782303962, 0.044438573183524815, 0.04513459184453437, 0.05709265271109162, 0.044763382298039514, 0.058148145935187315, 0.044334705954274294, 0.04747621669217515, 0.046159470310520784, 0.045975625129722524, 0.05197097913829445, 0.043107143009489195, 0.04386236684431435, 0.04834427406983873, 0.046656949433527654, 0.04937132587304585, 0.047112377919507745, 0.049010382552576746, 0.0456998987358388, 0.04563171714112648, 0.054812648450932054, 0.047015222771747536, 0.045994359596999365, 0.047643265181751035, 0.05132410132747876, 0.04574938246312426, 0.04641110753128421, 0.053405069946187426, 0.04380667315544283, 0.042693406426730196, 0.047576529648319314, 0.05354090534467667, 0.049918152479466696, 0.04430353562990423, 0.04991055058053264, 0.045813393648375195, 0.03917351615592717, 0.04644971531696419, 0.05108892218082214, 0.044990386019412826, 0.049450313147062296, 0.04759169818499728, 0.04496219681129428], [0.037057652812811336, 0.035937114666838896, 0.036418754815719274, 0.04998137600951598, 0.032383487210943335, 0.051615359704323134, 0.04395146332174924, 0.03917009318220277, 0.03379712472624289, 0.04048728862447243, 0.03479676288113116, 0.03060548728474418, 0.05305893192806684, 0.040887618862965, 0.03291136650835345, 0.034109380839842, 0.04858443903287711, 0.03720320214137501, 0.05100966237561072, 0.039258666377079324, 0.03582955376561388, 0.033610223477848325, 0.04120585699812694, 0.03485040140526949, 0.04848060846024003, 0.03130856473288647, 0.043490697685169624, 0.039489826052234944, 0.05081409259631775, 0.03156308221321965, 0.03201709671725595, 0.0378480002830186, 0.0385258596749226, 0.03908521380968775, 0.028789456028220858, 0.03911203677596096, 0.04072348908939193, 0.03435122448023628, 0.03882225709852575, 0.032110982357268864, 0.0775222145803899, 0.03810387732421076, 0.05187195542063112, 0.03397518318805308, 0.07699853884999773, 0.03936186213573828, 0.04022632686322773, 0.03863306799264579, 0.048183198078463434, 0.034317139331466594, 0.03231318443878067, 0.032796555594963146, 0.04668260977626428, 0.031208538916614396, 0.047630298527774, 0.037311307067506294, 0.040679856423737525, 0.04254264165885353, 0.038838701083116364, 0.038087348133642035, 0.04044873871974779, 0.033135025003602714, 0.03561986951467849, 0.03172074963458127, 0.03361406630933486, 0.050664324956714295, 0.05013713127934687, 0.03281985414317755, 0.035482295648784974, 0.033949428608136274, 0.033133984241045904, 0.03726782344672396, 0.03500989562073132, 0.03929902253085143, 0.034631913124886504, 0.059384017743973984, 0.03213043925988722, 0.03531971665259015, 0.04131905000989418, 0.04528558582191684, 0.04439627640532285, 0.03824862880881337, 0.043257616890353685, 0.04479226010595114, 0.033881288968361484, 0.03241793685276733, 0.03427990430505567, 0.041535345124885596, 0.04234010644585691, 0.043877453198735254, 0.05124801024964286, 0.039215082891787226, 0.04916849505316357, 0.044771926794602686, 0.05544368836241387, 0.03753117593561701, 0.03497510718541545, 0.03785008790836552, 0.04244160214655629, 0.043081865304832434], [0.04504438414549744, 0.032007347639550286, 0.034567198008157704, 0.040037438226426636, 0.038260972454935906, 0.03279651115654428, 0.031857143050798065, 0.0317152221660294, 0.030419492674772185, 0.049785940971736595, 0.0309369747578923, 0.046637626557350126, 0.06936920423909326, 0.032678915117107264, 0.04905993776621415, 0.0449552022018826, 0.04030479531763029, 0.03182087818432183, 0.04150334157748829, 0.0325383655008692, 0.034581890611656466, 0.04210250602725982, 0.0428750999742645, 0.03068362320893862, 0.03438810481010428, 0.02937094359374039, 0.040395875423927266, 0.0394006077748758, 0.04453773508108354, 0.03169840676495003, 0.033810718336486655, 0.0398553625275625, 0.03398291536197145, 0.03349103132925242, 0.027578152614055856, 0.03392739823559373, 0.04026153809945305, 0.03382667888836688, 0.031237564593356328, 0.03379919663826887, 0.05891556679892013, 0.0335470337682961, 0.031179319278051978, 0.05871877699517557, 0.0775766980403925, 0.02821416565382691, 0.04423675925828131, 0.0328634627773499, 0.03277314206053577, 0.03229216928094897, 0.03150639116800713, 0.04534773632070569, 0.05480725170304846, 0.034040832439223456, 0.04264470806890969, 0.03292222525192653, 0.03364597029691965, 0.03425475633082702, 0.04628824507045611, 0.04351300749027977, 0.03155136384260368, 0.03222199177191704, 0.039347544699728024, 0.03227019382250165, 0.03198771340691302, 0.03133296038121776, 0.03853005114664913, 0.04426062220722953, 0.035905423447104186, 0.04340285876281895, 0.03415142948461233, 0.03429021566556796, 0.041384147825654555, 0.038289134583400566, 0.03243479795744189, 0.04397951875710644, 0.033665467996051836, 0.04094734313855272, 0.03245457715752503, 0.04323960125667464, 0.03414162463983005, 0.0331359286240394, 0.03895731494654217, 0.046332371457561264, 0.03257981155842544, 0.029846340200657132, 0.0425851253047408, 0.03351655149534, 0.03141763363951522, 0.032291479090400546, 0.04507650550919211, 0.034666362602499945, 0.04066689336865024, 0.03433534282749658, 0.04413945028021679, 0.035599594695786, 0.037386604675449284, 0.04124759067575332, 0.028373020155373206, 0.035862795597776165]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### overEstWt=1., rateTarget=0.01 ###
    # Get null first
    underWt, t = 1., 0.01
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Design 0']
    lossveclist = [[0.18716330553485447, 0.18860184054407664, 0.19325608589009952, 0.1770557715099232, 0.18909962053862173, 0.18459170372398095, 0.18559537079732366, 0.19418957403161127, 0.19056777303140543, 0.19661722173995794, 0.18615517172133905, 0.18656234789959142, 0.18207911627849313, 0.19136687879390743, 0.19674573354643832, 0.1868874400406348, 0.18707867853840698, 0.1935239829381169, 0.18205086526045547, 0.19672122304180922, 0.18881630904487404, 0.1833803571459253, 0.19315812241755476, 0.1939300012408022, 0.1823919862711381, 0.19573388201746308, 0.18127684565012528, 0.1845268243447256, 0.2064338189794515, 0.20159672625324548, 0.175570766914338, 0.19471220948547244, 0.19506311055926825, 0.20018623541754793, 0.19098447267714874, 0.19502464029641609, 0.17798875406147763, 0.19399013962692402, 0.19200981099081268, 0.1946489101903228, 0.19112257101531924, 0.19993782678396535, 0.18597183732475736, 0.17973046264056863, 0.19279044896209913, 0.18991506529423824, 0.1849965998756091, 0.18460638724691056, 0.187766224917971, 0.18747905139303478, 0.17826392927939785, 0.19325741567524662, 0.18312120450517352, 0.192776652857974, 0.1857877196910409, 0.1858789089584243, 0.18760130405861783, 0.18436246826117497, 0.18657854615884836, 0.20529250618228734, 0.1854399759521401, 0.18781946613353975, 0.19103850589477586, 0.19321925534650095, 0.1833887432242402, 0.19466555433451851, 0.17968140555283613, 0.18826368627863668, 0.18936852542619723, 0.18239636499178297, 0.18166912854423528, 0.1886670787540829, 0.18214968590293265, 0.18688054274220603, 0.2007408440158043, 0.1887733025755799, 0.17529884693459136, 0.1945086526775307, 0.19507746617481378, 0.19771191076229758, 0.1900978061604873, 0.18303813831240057, 0.1848877412408327, 0.1815693595110686, 0.20485972236370922, 0.19125618875026087, 0.18942591264028497, 0.1927734061166825, 0.19628853444448496, 0.18576300190829131, 0.19292331937386653, 0.19252042667402308, 0.19919255729620128, 0.17874313897780772, 0.19420424824610283, 0.19765025474532247, 0.18019946811985466, 0.18734538778408527, 0.18392117311158634, 0.1831644019563764]]
    '''
    # 30 tests for all designs
    underWt, t = 1., 0.01
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.14650254664622714, 0.14945395718824386, 0.14817265992801912, 0.16780559963962108, 0.15015565057421484, 0.1426526674446709, 0.127002701263839, 0.14973599001313034, 0.14379745340214456, 0.139837977683405, 0.14502588322123583, 0.139449297639265, 0.14810411834859855, 0.15197187990784472, 0.15791019249363777, 0.15643605447685077, 0.14765671976379613, 0.13687337021104218, 0.13463438684752851, 0.14846295180230243, 0.16679816334649855, 0.14580028683657037, 0.1478038400866632, 0.14563147804011073, 0.15441590083470796, 0.1564344145623141, 0.1593382152170522, 0.18063524690611607, 0.1670782852909844, 0.13985541309997757, 0.1521875325717327, 0.14825753966584898, 0.16675812235739884, 0.17604370551612047, 0.14514470914049415, 0.16569697103017872, 0.15513959923699175, 0.1444528032396159, 0.1524501638573838, 0.14966713103805857, 0.21339217740516067, 0.1717505430981025, 0.16197688582265382, 0.14879477291575577, 0.17324758971090004, 0.13475689502411448, 0.15952066224395176, 0.1395240818149531, 0.13372823443914056, 0.14626752917298552, 0.14255560367544684, 0.16864603454678168, 0.1675395520468658, 0.16305733505059994, 0.16475180207848314, 0.1555465538253874, 0.15097334496266968, 0.1596651666911441, 0.14908110113270723, 0.13950854179243416, 0.14186888511399237, 0.17709946113486652, 0.21839742071304266, 0.1412147903777371, 0.16901968770351639, 0.15177394305620334, 0.17802333470109044, 0.13737017443790986, 0.16652892954690995, 0.14031458123601576, 0.15461527063584157, 0.15966429894529732, 0.154394638043801, 0.1459457521408128, 0.1832923218320714, 0.2061347031376535, 0.16324217584051984, 0.1534169859177199, 0.16022608027154742, 0.1628399681179009, 0.14533494762138024, 0.16097521054846833, 0.15804829181572244, 0.14210649098126377, 0.16777027956484572, 0.14487665915373688, 0.1583214382403871, 0.15757408855364202, 0.14410097478669381, 0.1655557817674055, 0.15448986549984361, 0.1666104593548441, 0.2320281234815435, 0.16149421956944393, 0.1390202951533169, 0.14055013493578047, 0.2171495850751611, 0.18402861524840328, 0.13812561305510793, 0.15135301286637445], [0.12822586019501847, 0.1321711755229878, 0.14780291045025645, 0.19112732108198258, 0.16460835749376856, 0.20512855801617605, 0.13905743630487483, 0.12991549737465286, 0.12986023761410312, 0.15682962441439094, 0.15617173408981583, 0.18916889825633365, 0.15212586508172765, 0.1361103258060248, 0.13684286337882728, 0.1349381906416406, 0.1441570020654102, 0.15856547089441478, 0.12913389749755522, 0.1333750259016545, 0.13350289606916466, 0.15886633070741857, 0.12926898230236622, 0.13326705145487033, 0.1716497571473108, 0.13139164463427333, 0.1935626638596365, 0.13868435522391082, 0.13426235325259547, 0.11980439053984904, 0.1282176702087814, 0.13674149582020215, 0.15711538053955262, 0.13557976341475253, 0.13150568640905383, 0.13150015832968534, 0.1444623973507264, 0.16416242532876463, 0.15010528483224667, 0.1723917883221508, 0.18454634645090953, 0.13766710248806327, 0.13435774488169153, 0.19383786494230143, 0.20928799956596694, 0.13193350389302197, 0.185304343401545, 0.15817130347005756, 0.1729433508574668, 0.1612704561122801, 0.1547070315354061, 0.16160353671247057, 0.20666092027386476, 0.15233436025005273, 0.16053697665031072, 0.19756549055694927, 0.1782023963051965, 0.13480241581951694, 0.17773748800077005, 0.1369416887968862, 0.1526075769885384, 0.1261822986166664, 0.13865265975850918, 0.12982610455506613, 0.18611607607165134, 0.1411308774753208, 0.20504472163297377, 0.1901091435730258, 0.17181237702186822, 0.11918766659045749, 0.14432961693587548, 0.13753503201927253, 0.14092088902470803, 0.12971933440055586, 0.13681249876336649, 0.2028860498781577, 0.1549730964895876, 0.12690373463942792, 0.1383566781516739, 0.16963981808237397, 0.15641789411864104, 0.17169770649799404, 0.18700527671256195, 0.19065864267818491, 0.1309407474992356, 0.12421216252334584, 0.1710025557453492, 0.13575549986446728, 0.15882914777539564, 0.13421724496738202, 0.18202812515643987, 0.15906333973501838, 0.1841636626578887, 0.1373436010533669, 0.12976290829778933, 0.13138675399128782, 0.15864506874917345, 0.19863290799750477, 0.17376647017387617, 0.13023949278989824], [0.15948700430936635, 0.14881415351029484, 0.1665382543009113, 0.19739384014646436, 0.14279547246593427, 0.1602487290852922, 0.1443502046861278, 0.1477645995216703, 0.14684325626943812, 0.14990244644764686, 0.14016165950457665, 0.13341124326410497, 0.14695877269303975, 0.15227526416044523, 0.15749161164572767, 0.15729223690302188, 0.17221815545678631, 0.14795112917429265, 0.14195110722093066, 0.14277944233436815, 0.2140101235094532, 0.15725194145547766, 0.14708254724843245, 0.14210050867463256, 0.1592661217439993, 0.1412520712506917, 0.1559211435677211, 0.13710481428912988, 0.15442983443747144, 0.1462716055977131, 0.15420765781023116, 0.15049466580589183, 0.15844330611344196, 0.15730163775386505, 0.13719632665171627, 0.1473157278343939, 0.1721010384613611, 0.14233968237993586, 0.16780648469908943, 0.1492351344055081, 0.15765959322331125, 0.16235341894804878, 0.14493121335847772, 0.14589389921317572, 0.17081651987425195, 0.15633121008825107, 0.1479305609682166, 0.14593870864786462, 0.152092534785864, 0.15355355912128726, 0.14434286374829897, 0.1510229795080887, 0.15072913866849413, 0.1494642650707675, 0.16387057416638762, 0.15657492516809682, 0.1538878159711883, 0.15026257442209684, 0.16867977456217942, 0.15113672768320807, 0.16058551730193363, 0.1409273371707429, 0.19357468282904128, 0.16608498159762336, 0.18438814463455766, 0.15231108475675414, 0.14522722828286308, 0.17175235066876413, 0.1857974177693353, 0.15534558453606986, 0.15773736873379368, 0.1491764193562065, 0.15435504236977496, 0.1441683497803102, 0.14629741294381635, 0.19331653657013648, 0.14596771944872128, 0.15143860274713322, 0.16137127041144814, 0.167616707964461, 0.14721037800228215, 0.14974149886198523, 0.16702640806063068, 0.13607495929941996, 0.1710198002388864, 0.14671563891761077, 0.17228400960485835, 0.14747360861474998, 0.13837484929592822, 0.14983993701949844, 0.15192874438016546, 0.210800291105933, 0.1663481371123751, 0.160105628190309, 0.1498394414090056, 0.1505251301163232, 0.16162713515236798, 0.15274782620528793, 0.1462070434707487, 0.14409512840431657], [0.16954625481913121, 0.1901718832551768, 0.19364765772117012, 0.16774955619213022, 0.1709879279384199, 0.1873864099154524, 0.16800038613288693, 0.17146031102016684, 0.1932578565125582, 0.1825115723843282, 0.17563910573113095, 0.1805991194609222, 0.21872448216330007, 0.16615541163012112, 0.17912387972776253, 0.17683514241860326, 0.2074712304366564, 0.1667201774806018, 0.20137746994454503, 0.20172046556992715, 0.18873562539136343, 0.16551425222448643, 0.2103678570826695, 0.2148029259534594, 0.19162833605315965, 0.188215964360798, 0.17737643336816158, 0.182712040180987, 0.18111270486051453, 0.1950686481363047, 0.20807572498200613, 0.23365045823005345, 0.16278356529267482, 0.17409985601202851, 0.19035032723473028, 0.18401884708179825, 0.20483626065550337, 0.17633637851277292, 0.17884612567309285, 0.1790524276221689, 0.16687559462820775, 0.16551655853120426, 0.206778585797234, 0.1717315170803021, 0.16663934126869012, 0.172732005566281, 0.19767059975710108, 0.20947884869266742, 0.20531721260042676, 0.1801119949516722, 0.17960000586146432, 0.17030975955790034, 0.18158202758337436, 0.1934492363690483, 0.17080443982907037, 0.17227865300995154, 0.16295808020635724, 0.17335967307132719, 0.18636540845679442, 0.19308805542779442, 0.19389643145605487, 0.20101712999348448, 0.1931386186431096, 0.17753826550505045, 0.1753950336476594, 0.1733497072817976, 0.18633409640038512, 0.18709204104381216, 0.19312158544133579, 0.16261175753920729, 0.18698021916153518, 0.18023442047035956, 0.20053311344145025, 0.19746230301170137, 0.24064319397807737, 0.18417983171345323, 0.17264348969902368, 0.22006129173634212, 0.18152633986333705, 0.1893185149569937, 0.17501175761817658, 0.19609030686883697, 0.18360964120784243, 0.18184462028283052, 0.20964731718464436, 0.1865260127273663, 0.1600895190121818, 0.18010869589381892, 0.18469217240420463, 0.19363602176455716, 0.21311931629384248, 0.17526706316401044, 0.17581517567359625, 0.18924919629193276, 0.1675528609475671, 0.18333597853796868, 0.17480730186055893, 0.17947291575007915, 0.21004374906240647, 0.18964537163152143], [0.16556888234566478, 0.1542855365452661, 0.13171045437346537, 0.22515718063959847, 0.1871638150635688, 0.21084879604207696, 0.13584147400210997, 0.16901365209078378, 0.12678094619735375, 0.20929235153538567, 0.1615410411632925, 0.12373580059371152, 0.20763958294353171, 0.13411932447274913, 0.15748955307407564, 0.16172036015508454, 0.1563258464284742, 0.12765462751432893, 0.14678717402460714, 0.158933824455612, 0.16484466371386797, 0.14826522168804793, 0.1537785811658445, 0.1268846944561489, 0.16902906345694435, 0.15516187066848797, 0.2125989692086097, 0.13607803032337376, 0.17123074462205154, 0.12353341771676689, 0.13264874447220995, 0.14513724859402746, 0.12611763991080563, 0.15469794202278664, 0.11956405207686889, 0.18990435317450177, 0.1512887162497417, 0.14224948346963717, 0.12924437950298753, 0.17522751403950093, 0.18946108432921774, 0.13309770058129453, 0.22409962798138258, 0.13705240412793485, 0.20528815548880308, 0.1255030218041865, 0.15871383773434533, 0.17341538860959435, 0.154819034256908, 0.1351641267779231, 0.15047050007408552, 0.1771867951157211, 0.13146247412179224, 0.15744292634947019, 0.20755935812924636, 0.1555266510405062, 0.12700866230512273, 0.12919432399308087, 0.16832852360454514, 0.1617620175653375, 0.1738900850870444, 0.12818055476453447, 0.16598976403885946, 0.11573463065115226, 0.13793367837765233, 0.128952557698321, 0.1733299065757096, 0.18323846661577872, 0.1519633497587757, 0.1554289052947499, 0.13362825772232528, 0.1334864427841444, 0.1347836643576305, 0.12894117657907336, 0.1475220433429826, 0.2157213627653278, 0.14810190732924422, 0.14752796987970598, 0.14079578114204855, 0.13514631837280827, 0.15209738570431897, 0.12679777674187553, 0.16395648069730878, 0.16137703834882056, 0.15092646845268748, 0.1410347727059475, 0.14557265605263836, 0.1353881271591467, 0.12594538383963186, 0.16269129972463442, 0.1719459730609683, 0.1697697847791753, 0.15228860610137906, 0.14982602831684774, 0.21084703137930993, 0.17422440205494064, 0.1899229731775834, 0.1870277978960944, 0.18588329625407415, 0.12844614527571546], [0.1894598231055358, 0.13277356275571717, 0.13889863339653638, 0.1621285962686956, 0.13591260887448375, 0.12810067370823977, 0.16251866268512136, 0.166442123415905, 0.12896292716048502, 0.15781427073441573, 0.1523306541449955, 0.12163783256458402, 0.17847831364218555, 0.14091482198895963, 0.14333145620197343, 0.17521367867463383, 0.15884103109302705, 0.13081814938395311, 0.163675463609266, 0.12610954026019577, 0.14344264772836007, 0.1392711796115823, 0.20016092172461772, 0.1310195353738602, 0.1639585650356019, 0.13906282460611474, 0.23956324621062547, 0.12902474370878173, 0.18400885927702507, 0.15879088109109832, 0.12016688480685905, 0.13415782123778275, 0.13290599360965566, 0.15110266415998144, 0.12170398235752643, 0.1361592867343966, 0.1822649624812303, 0.14086891664293014, 0.1314999838503278, 0.13454794764224, 0.13916079848909713, 0.1343677725549534, 0.1507830223780761, 0.12462988122691722, 0.19656789566387126, 0.12787260376258808, 0.17343737371677673, 0.23581427107799494, 0.17973114091404152, 0.12751841475562575, 0.1352489239120318, 0.13719867047872888, 0.19277737769413805, 0.18043775217361838, 0.13371688336003926, 0.16893044787928432, 0.19984670908824864, 0.12607671753429764, 0.16386311065255632, 0.1237143269094767, 0.15993075983870222, 0.16826168214238627, 0.1677582642446411, 0.1346298259813943, 0.14141286276794254, 0.1563206400622418, 0.19579332900313148, 0.13684806356838447, 0.13394577546546602, 0.13198841403617684, 0.1656500351101068, 0.13069728581420353, 0.18706825822485465, 0.13117417236765383, 0.2103800904098541, 0.15789313250519335, 0.1333311480734136, 0.1374074740879396, 0.1376537602670433, 0.13815572333728426, 0.14139245169047537, 0.1663786563641575, 0.1385070291365642, 0.17905247594965065, 0.13808893189418994, 0.11703491283175965, 0.16921414614391042, 0.13271469951766737, 0.16735859847950035, 0.1712028328992981, 0.13020290097599665, 0.1793711973162959, 0.12972729027855906, 0.13526515183495066, 0.16184216729989287, 0.13900252039648722, 0.12898022588702288, 0.2241999903676712, 0.18739026613086757, 0.15751397881353915]]
    lossvec0 = [[0.18716330553485447, 0.18860184054407664, 0.19325608589009952, 0.1770557715099232, 0.18909962053862173, 0.18459170372398095, 0.18559537079732366, 0.19418957403161127, 0.19056777303140543, 0.19661722173995794, 0.18615517172133905, 0.18656234789959142, 0.18207911627849313, 0.19136687879390743, 0.19674573354643832, 0.1868874400406348, 0.18707867853840698, 0.1935239829381169, 0.18205086526045547, 0.19672122304180922, 0.18881630904487404, 0.1833803571459253, 0.19315812241755476, 0.1939300012408022, 0.1823919862711381, 0.19573388201746308, 0.18127684565012528, 0.1845268243447256, 0.2064338189794515, 0.20159672625324548, 0.175570766914338, 0.19471220948547244, 0.19506311055926825, 0.20018623541754793, 0.19098447267714874, 0.19502464029641609, 0.17798875406147763, 0.19399013962692402, 0.19200981099081268, 0.1946489101903228, 0.19112257101531924, 0.19993782678396535, 0.18597183732475736, 0.17973046264056863, 0.19279044896209913, 0.18991506529423824, 0.1849965998756091, 0.18460638724691056, 0.187766224917971, 0.18747905139303478, 0.17826392927939785, 0.19325741567524662, 0.18312120450517352, 0.192776652857974, 0.1857877196910409, 0.1858789089584243, 0.18760130405861783, 0.18436246826117497, 0.18657854615884836, 0.20529250618228734, 0.1854399759521401, 0.18781946613353975, 0.19103850589477586, 0.19321925534650095, 0.1833887432242402, 0.19466555433451851, 0.17968140555283613, 0.18826368627863668, 0.18936852542619723, 0.18239636499178297, 0.18166912854423528, 0.1886670787540829, 0.18214968590293265, 0.18688054274220603, 0.2007408440158043, 0.1887733025755799, 0.17529884693459136, 0.1945086526775307, 0.19507746617481378, 0.19771191076229758, 0.1900978061604873, 0.18303813831240057, 0.1848877412408327, 0.1815693595110686, 0.20485972236370922, 0.19125618875026087, 0.18942591264028497, 0.1927734061166825, 0.19628853444448496, 0.18576300190829131, 0.19292331937386653, 0.19252042667402308, 0.19919255729620128, 0.17874313897780772, 0.19420424824610283, 0.19765025474532247, 0.18019946811985466, 0.18734538778408527, 0.18392117311158634, 0.1831644019563764]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.01$, $n=30$')
    
    lossveclist = [[0.14650254664622714, 0.14945395718824386, 0.14817265992801912, 0.16780559963962108, 0.15015565057421484, 0.1426526674446709, 0.127002701263839, 0.14973599001313034, 0.14379745340214456, 0.139837977683405, 0.14502588322123583, 0.139449297639265, 0.14810411834859855, 0.15197187990784472, 0.15791019249363777, 0.15643605447685077, 0.14765671976379613, 0.13687337021104218, 0.13463438684752851, 0.14846295180230243, 0.16679816334649855, 0.14580028683657037, 0.1478038400866632, 0.14563147804011073, 0.15441590083470796, 0.1564344145623141, 0.1593382152170522, 0.18063524690611607, 0.1670782852909844, 0.13985541309997757, 0.1521875325717327, 0.14825753966584898, 0.16675812235739884, 0.17604370551612047, 0.14514470914049415, 0.16569697103017872, 0.15513959923699175, 0.1444528032396159, 0.1524501638573838, 0.14966713103805857, 0.21339217740516067, 0.1717505430981025, 0.16197688582265382, 0.14879477291575577, 0.17324758971090004, 0.13475689502411448, 0.15952066224395176, 0.1395240818149531, 0.13372823443914056, 0.14626752917298552, 0.14255560367544684, 0.16864603454678168, 0.1675395520468658, 0.16305733505059994, 0.16475180207848314, 0.1555465538253874, 0.15097334496266968, 0.1596651666911441, 0.14908110113270723, 0.13950854179243416, 0.14186888511399237, 0.17709946113486652, 0.21839742071304266, 0.1412147903777371, 0.16901968770351639, 0.15177394305620334, 0.17802333470109044, 0.13737017443790986, 0.16652892954690995, 0.14031458123601576, 0.15461527063584157, 0.15966429894529732, 0.154394638043801, 0.1459457521408128, 0.1832923218320714, 0.2061347031376535, 0.16324217584051984, 0.1534169859177199, 0.16022608027154742, 0.1628399681179009, 0.14533494762138024, 0.16097521054846833, 0.15804829181572244, 0.14210649098126377, 0.16777027956484572, 0.14487665915373688, 0.1583214382403871, 0.15757408855364202, 0.14410097478669381, 0.1655557817674055, 0.15448986549984361, 0.1666104593548441, 0.2320281234815435, 0.16149421956944393, 0.1390202951533169, 0.14055013493578047, 0.2171495850751611, 0.18402861524840328, 0.13812561305510793, 0.15135301286637445], [0.12822586019501847, 0.1321711755229878, 0.14780291045025645, 0.19112732108198258, 0.16460835749376856, 0.20512855801617605, 0.13905743630487483, 0.12991549737465286, 0.12986023761410312, 0.15682962441439094, 0.15617173408981583, 0.18916889825633365, 0.15212586508172765, 0.1361103258060248, 0.13684286337882728, 0.1349381906416406, 0.1441570020654102, 0.15856547089441478, 0.12913389749755522, 0.1333750259016545, 0.13350289606916466, 0.15886633070741857, 0.12926898230236622, 0.13326705145487033, 0.1716497571473108, 0.13139164463427333, 0.1935626638596365, 0.13868435522391082, 0.13426235325259547, 0.11980439053984904, 0.1282176702087814, 0.13674149582020215, 0.15711538053955262, 0.13557976341475253, 0.13150568640905383, 0.13150015832968534, 0.1444623973507264, 0.16416242532876463, 0.15010528483224667, 0.1723917883221508, 0.18454634645090953, 0.13766710248806327, 0.13435774488169153, 0.19383786494230143, 0.20928799956596694, 0.13193350389302197, 0.185304343401545, 0.15817130347005756, 0.1729433508574668, 0.1612704561122801, 0.1547070315354061, 0.16160353671247057, 0.20666092027386476, 0.15233436025005273, 0.16053697665031072, 0.19756549055694927, 0.1782023963051965, 0.13480241581951694, 0.17773748800077005, 0.1369416887968862, 0.1526075769885384, 0.1261822986166664, 0.13865265975850918, 0.12982610455506613, 0.18611607607165134, 0.1411308774753208, 0.20504472163297377, 0.1901091435730258, 0.17181237702186822, 0.11918766659045749, 0.14432961693587548, 0.13753503201927253, 0.14092088902470803, 0.12971933440055586, 0.13681249876336649, 0.2028860498781577, 0.1549730964895876, 0.12690373463942792, 0.1383566781516739, 0.16963981808237397, 0.15641789411864104, 0.17169770649799404, 0.18700527671256195, 0.19065864267818491, 0.1309407474992356, 0.12421216252334584, 0.1710025557453492, 0.13575549986446728, 0.15882914777539564, 0.13421724496738202, 0.18202812515643987, 0.15906333973501838, 0.1841636626578887, 0.1373436010533669, 0.12976290829778933, 0.13138675399128782, 0.15864506874917345, 0.19863290799750477, 0.17376647017387617, 0.13023949278989824], [0.15948700430936635, 0.14881415351029484, 0.1665382543009113, 0.19739384014646436, 0.14279547246593427, 0.1602487290852922, 0.1443502046861278, 0.1477645995216703, 0.14684325626943812, 0.14990244644764686, 0.14016165950457665, 0.13341124326410497, 0.14695877269303975, 0.15227526416044523, 0.15749161164572767, 0.15729223690302188, 0.17221815545678631, 0.14795112917429265, 0.14195110722093066, 0.14277944233436815, 0.2140101235094532, 0.15725194145547766, 0.14708254724843245, 0.14210050867463256, 0.1592661217439993, 0.1412520712506917, 0.1559211435677211, 0.13710481428912988, 0.15442983443747144, 0.1462716055977131, 0.15420765781023116, 0.15049466580589183, 0.15844330611344196, 0.15730163775386505, 0.13719632665171627, 0.1473157278343939, 0.1721010384613611, 0.14233968237993586, 0.16780648469908943, 0.1492351344055081, 0.15765959322331125, 0.16235341894804878, 0.14493121335847772, 0.14589389921317572, 0.17081651987425195, 0.15633121008825107, 0.1479305609682166, 0.14593870864786462, 0.152092534785864, 0.15355355912128726, 0.14434286374829897, 0.1510229795080887, 0.15072913866849413, 0.1494642650707675, 0.16387057416638762, 0.15657492516809682, 0.1538878159711883, 0.15026257442209684, 0.16867977456217942, 0.15113672768320807, 0.16058551730193363, 0.1409273371707429, 0.19357468282904128, 0.16608498159762336, 0.18438814463455766, 0.15231108475675414, 0.14522722828286308, 0.17175235066876413, 0.1857974177693353, 0.15534558453606986, 0.15773736873379368, 0.1491764193562065, 0.15435504236977496, 0.1441683497803102, 0.14629741294381635, 0.19331653657013648, 0.14596771944872128, 0.15143860274713322, 0.16137127041144814, 0.167616707964461, 0.14721037800228215, 0.14974149886198523, 0.16702640806063068, 0.13607495929941996, 0.1710198002388864, 0.14671563891761077, 0.17228400960485835, 0.14747360861474998, 0.13837484929592822, 0.14983993701949844, 0.15192874438016546, 0.210800291105933, 0.1663481371123751, 0.160105628190309, 0.1498394414090056, 0.1505251301163232, 0.16162713515236798, 0.15274782620528793, 0.1462070434707487, 0.14409512840431657], [0.16954625481913121, 0.1901718832551768, 0.19364765772117012, 0.16774955619213022, 0.1709879279384199, 0.1873864099154524, 0.16800038613288693, 0.17146031102016684, 0.1932578565125582, 0.1825115723843282, 0.17563910573113095, 0.1805991194609222, 0.21872448216330007, 0.16615541163012112, 0.17912387972776253, 0.17683514241860326, 0.2074712304366564, 0.1667201774806018, 0.20137746994454503, 0.20172046556992715, 0.18873562539136343, 0.16551425222448643, 0.2103678570826695, 0.2148029259534594, 0.19162833605315965, 0.188215964360798, 0.17737643336816158, 0.182712040180987, 0.18111270486051453, 0.1950686481363047, 0.20807572498200613, 0.23365045823005345, 0.16278356529267482, 0.17409985601202851, 0.19035032723473028, 0.18401884708179825, 0.20483626065550337, 0.17633637851277292, 0.17884612567309285, 0.1790524276221689, 0.16687559462820775, 0.16551655853120426, 0.206778585797234, 0.1717315170803021, 0.16663934126869012, 0.172732005566281, 0.19767059975710108, 0.20947884869266742, 0.20531721260042676, 0.1801119949516722, 0.17960000586146432, 0.17030975955790034, 0.18158202758337436, 0.1934492363690483, 0.17080443982907037, 0.17227865300995154, 0.16295808020635724, 0.17335967307132719, 0.18636540845679442, 0.19308805542779442, 0.19389643145605487, 0.20101712999348448, 0.1931386186431096, 0.17753826550505045, 0.1753950336476594, 0.1733497072817976, 0.18633409640038512, 0.18709204104381216, 0.19312158544133579, 0.16261175753920729, 0.18698021916153518, 0.18023442047035956, 0.20053311344145025, 0.19746230301170137, 0.24064319397807737, 0.18417983171345323, 0.17264348969902368, 0.22006129173634212, 0.18152633986333705, 0.1893185149569937, 0.17501175761817658, 0.19609030686883697, 0.18360964120784243, 0.18184462028283052, 0.20964731718464436, 0.1865260127273663, 0.1600895190121818, 0.18010869589381892, 0.18469217240420463, 0.19363602176455716, 0.21311931629384248, 0.17526706316401044, 0.17581517567359625, 0.18924919629193276, 0.1675528609475671, 0.18333597853796868, 0.17480730186055893, 0.17947291575007915, 0.21004374906240647, 0.18964537163152143], [0.16556888234566478, 0.1542855365452661, 0.13171045437346537, 0.22515718063959847, 0.1871638150635688, 0.21084879604207696, 0.13584147400210997, 0.16901365209078378, 0.12678094619735375, 0.20929235153538567, 0.1615410411632925, 0.12373580059371152, 0.20763958294353171, 0.13411932447274913, 0.15748955307407564, 0.16172036015508454, 0.1563258464284742, 0.12765462751432893, 0.14678717402460714, 0.158933824455612, 0.16484466371386797, 0.14826522168804793, 0.1537785811658445, 0.1268846944561489, 0.16902906345694435, 0.15516187066848797, 0.2125989692086097, 0.13607803032337376, 0.17123074462205154, 0.12353341771676689, 0.13264874447220995, 0.14513724859402746, 0.12611763991080563, 0.15469794202278664, 0.11956405207686889, 0.18990435317450177, 0.1512887162497417, 0.14224948346963717, 0.12924437950298753, 0.17522751403950093, 0.18946108432921774, 0.13309770058129453, 0.22409962798138258, 0.13705240412793485, 0.20528815548880308, 0.1255030218041865, 0.15871383773434533, 0.17341538860959435, 0.154819034256908, 0.1351641267779231, 0.15047050007408552, 0.1771867951157211, 0.13146247412179224, 0.15744292634947019, 0.20755935812924636, 0.1555266510405062, 0.12700866230512273, 0.12919432399308087, 0.16832852360454514, 0.1617620175653375, 0.1738900850870444, 0.12818055476453447, 0.16598976403885946, 0.11573463065115226, 0.13793367837765233, 0.128952557698321, 0.1733299065757096, 0.18323846661577872, 0.1519633497587757, 0.1554289052947499, 0.13362825772232528, 0.1334864427841444, 0.1347836643576305, 0.12894117657907336, 0.1475220433429826, 0.2157213627653278, 0.14810190732924422, 0.14752796987970598, 0.14079578114204855, 0.13514631837280827, 0.15209738570431897, 0.12679777674187553, 0.16395648069730878, 0.16137703834882056, 0.15092646845268748, 0.1410347727059475, 0.14557265605263836, 0.1353881271591467, 0.12594538383963186, 0.16269129972463442, 0.1719459730609683, 0.1697697847791753, 0.15228860610137906, 0.14982602831684774, 0.21084703137930993, 0.17422440205494064, 0.1899229731775834, 0.1870277978960944, 0.18588329625407415, 0.12844614527571546], [0.1894598231055358, 0.13277356275571717, 0.13889863339653638, 0.1621285962686956, 0.13591260887448375, 0.12810067370823977, 0.16251866268512136, 0.166442123415905, 0.12896292716048502, 0.15781427073441573, 0.1523306541449955, 0.12163783256458402, 0.17847831364218555, 0.14091482198895963, 0.14333145620197343, 0.17521367867463383, 0.15884103109302705, 0.13081814938395311, 0.163675463609266, 0.12610954026019577, 0.14344264772836007, 0.1392711796115823, 0.20016092172461772, 0.1310195353738602, 0.1639585650356019, 0.13906282460611474, 0.23956324621062547, 0.12902474370878173, 0.18400885927702507, 0.15879088109109832, 0.12016688480685905, 0.13415782123778275, 0.13290599360965566, 0.15110266415998144, 0.12170398235752643, 0.1361592867343966, 0.1822649624812303, 0.14086891664293014, 0.1314999838503278, 0.13454794764224, 0.13916079848909713, 0.1343677725549534, 0.1507830223780761, 0.12462988122691722, 0.19656789566387126, 0.12787260376258808, 0.17343737371677673, 0.23581427107799494, 0.17973114091404152, 0.12751841475562575, 0.1352489239120318, 0.13719867047872888, 0.19277737769413805, 0.18043775217361838, 0.13371688336003926, 0.16893044787928432, 0.19984670908824864, 0.12607671753429764, 0.16386311065255632, 0.1237143269094767, 0.15993075983870222, 0.16826168214238627, 0.1677582642446411, 0.1346298259813943, 0.14141286276794254, 0.1563206400622418, 0.19579332900313148, 0.13684806356838447, 0.13394577546546602, 0.13198841403617684, 0.1656500351101068, 0.13069728581420353, 0.18706825822485465, 0.13117417236765383, 0.2103800904098541, 0.15789313250519335, 0.1333311480734136, 0.1374074740879396, 0.1376537602670433, 0.13815572333728426, 0.14139245169047537, 0.1663786563641575, 0.1385070291365642, 0.17905247594965065, 0.13808893189418994, 0.11703491283175965, 0.16921414614391042, 0.13271469951766737, 0.16735859847950035, 0.1712028328992981, 0.13020290097599665, 0.1793711973162959, 0.12972729027855906, 0.13526515183495066, 0.16184216729989287, 0.13900252039648722, 0.12898022588702288, 0.2241999903676712, 0.18739026613086757, 0.15751397881353915]]
    lossvec0 = [[0.18716330553485447, 0.18860184054407664, 0.19325608589009952, 0.1770557715099232, 0.18909962053862173, 0.18459170372398095, 0.18559537079732366, 0.19418957403161127, 0.19056777303140543, 0.19661722173995794, 0.18615517172133905, 0.18656234789959142, 0.18207911627849313, 0.19136687879390743, 0.19674573354643832, 0.1868874400406348, 0.18707867853840698, 0.1935239829381169, 0.18205086526045547, 0.19672122304180922, 0.18881630904487404, 0.1833803571459253, 0.19315812241755476, 0.1939300012408022, 0.1823919862711381, 0.19573388201746308, 0.18127684565012528, 0.1845268243447256, 0.2064338189794515, 0.20159672625324548, 0.175570766914338, 0.19471220948547244, 0.19506311055926825, 0.20018623541754793, 0.19098447267714874, 0.19502464029641609, 0.17798875406147763, 0.19399013962692402, 0.19200981099081268, 0.1946489101903228, 0.19112257101531924, 0.19993782678396535, 0.18597183732475736, 0.17973046264056863, 0.19279044896209913, 0.18991506529423824, 0.1849965998756091, 0.18460638724691056, 0.187766224917971, 0.18747905139303478, 0.17826392927939785, 0.19325741567524662, 0.18312120450517352, 0.192776652857974, 0.1857877196910409, 0.1858789089584243, 0.18760130405861783, 0.18436246826117497, 0.18657854615884836, 0.20529250618228734, 0.1854399759521401, 0.18781946613353975, 0.19103850589477586, 0.19321925534650095, 0.1833887432242402, 0.19466555433451851, 0.17968140555283613, 0.18826368627863668, 0.18936852542619723, 0.18239636499178297, 0.18166912854423528, 0.1886670787540829, 0.18214968590293265, 0.18688054274220603, 0.2007408440158043, 0.1887733025755799, 0.17529884693459136, 0.1945086526775307, 0.19507746617481378, 0.19771191076229758, 0.1900978061604873, 0.18303813831240057, 0.1848877412408327, 0.1815693595110686, 0.20485972236370922, 0.19125618875026087, 0.18942591264028497, 0.1927734061166825, 0.19628853444448496, 0.18576300190829131, 0.19292331937386653, 0.19252042667402308, 0.19919255729620128, 0.17874313897780772, 0.19420424824610283, 0.19765025474532247, 0.18019946811985466, 0.18734538778408527, 0.18392117311158634, 0.1831644019563764]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### overEstWt=1., rateTarget=0.4 ###
    # Get null first
    underWt, t = 1., 0.4
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Design 0']
    lossveclist = [[0.05869716357936193, 0.06496469072191993, 0.06445388890620267, 0.061190271263857884, 0.060801952120124174, 0.0628518155011463, 0.06103055368862017, 0.0645339303067024, 0.06345518080997543, 0.06798749988287238, 0.0635577827604388, 0.06448244774348906, 0.06460408960457555, 0.06423479803724086, 0.06346570148697925, 0.0610220274476332, 0.06653268660497995, 0.0637819632898739, 0.06458153281918987, 0.06219370776874488, 0.06158502380780164, 0.06450099815646547, 0.06261581321267679, 0.06241165203529875, 0.06127086472011553, 0.06284592849557297, 0.06433899359307356, 0.06298260297368505, 0.06333552441384119, 0.061629484523442635, 0.06555605978760054, 0.06382096899959443, 0.06501828365590352, 0.06262780410665626, 0.06140928933603194, 0.06260452785273529, 0.06452117625338971, 0.06131657543913682, 0.06331224204223371, 0.059988330185667786, 0.06040264892287001, 0.06288617348285885, 0.06166245680508134, 0.0628351006999992, 0.06251416854556381, 0.06278572087523576, 0.06433018328228853, 0.060095054181502905, 0.0626561852934667, 0.06395959213148232, 0.06599653261118309, 0.06301622084736008, 0.06534010734028481, 0.06182977435688999, 0.060662926582686065, 0.06509633058008522, 0.06571845189114096, 0.06336204765334655, 0.06121765310765021, 0.06212960321981213, 0.06139979355188204, 0.06715352252234444, 0.06494291982692406, 0.0630487850259678, 0.05997319784634728, 0.06093541747803282, 0.062345506188413474, 0.05898777693762918, 0.06426586972711376, 0.06636850613688819, 0.05779544547041826, 0.06434274816921044, 0.06208405024947255, 0.06377646674187719, 0.06871680581791573, 0.06252993209726768, 0.06316452053900942, 0.0640895085756315, 0.06197286743720706, 0.060706810755013996, 0.06439778673649788, 0.06553858203941768, 0.06679639345658742, 0.06140427401580309, 0.06518312241091204, 0.06411355265029997, 0.06358547090601545, 0.06435113477421903, 0.06085434251111577, 0.06343789286904834, 0.06418355308710491, 0.06435364560539769, 0.061155853975873246, 0.06391964006755392, 0.06019878534789032, 0.06399455155349086, 0.0591792232272502, 0.061147998138276795, 0.06630087518492675, 0.063835916003289]]
    '''
    # 30 tests for all designs
    underWt, t = 1., 0.4
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.04718947466709231, 0.046553585017072636, 0.052441688225299425, 0.05142784398450772, 0.046390263414362864, 0.051698049737683556, 0.047687574554680354, 0.0505419556635018, 0.047825610693482186, 0.047304684784099396, 0.05032773327557194, 0.045866836046140835, 0.04731872633796882, 0.04849988735453309, 0.049833875600876903, 0.05328195537423884, 0.05202206828613756, 0.04698807342979201, 0.04530187048423474, 0.04713490395600838, 0.05589074135663584, 0.050074601384535344, 0.046701690276989165, 0.04593018728222049, 0.05643642453230507, 0.04804260259106695, 0.05285151581410675, 0.04852504573649602, 0.05001104938159274, 0.04829438047555947, 0.046032411527801013, 0.048433839785773494, 0.05205737244071572, 0.05245656060786794, 0.044547490664291416, 0.050402855221848696, 0.0520232095764459, 0.05104728442799498, 0.049435110552061304, 0.05040513734288222, 0.058983784498691294, 0.04622636707546684, 0.046203887020108546, 0.049674070038625555, 0.05377995874049181, 0.04272867131056178, 0.048664447648189245, 0.05108022669062065, 0.04808777371555936, 0.04773567155828597, 0.0450558113520085, 0.04959772643375383, 0.04866410298505742, 0.052034115222010735, 0.04996997044282836, 0.04916178365000783, 0.0496805088532744, 0.049017330645103885, 0.04681821650649419, 0.04928261377110753, 0.04647344134530747, 0.04621650629459626, 0.04907718845812723, 0.0505965734401475, 0.054224008336253626, 0.047962683302389536, 0.05047017075775085, 0.04756326814889569, 0.053087459122950535, 0.04943206054309928, 0.0490911212469289, 0.05537001186878515, 0.052115193956457716, 0.04654668529053779, 0.05033283814871047, 0.06491828642516612, 0.04984620149171715, 0.04696845876693901, 0.052696972519148656, 0.04796090608182052, 0.04989275734293907, 0.0474146231424664, 0.047196056872370135, 0.04935695516231519, 0.048711933446900335, 0.04561887327753751, 0.04920745736993924, 0.054215819692971394, 0.0459418596674953, 0.04689973247421375, 0.04962532929275384, 0.04845276012740564, 0.06610363063631257, 0.060747937019962034, 0.05150789510837962, 0.04972581725824374, 0.052775827152395934, 0.0510685154422887, 0.04846971783522132, 0.047901722939409364], [0.04202643550609381, 0.06589450517212515, 0.043377190719077155, 0.059862902521271716, 0.06386016045956844, 0.04296398068290836, 0.03970765683733988, 0.04439803392363333, 0.05156554515835239, 0.07326249907031858, 0.04384704357841969, 0.04976415829662597, 0.055601419363565434, 0.04793100015686585, 0.06933859539248141, 0.0427233892114996, 0.054799886501655945, 0.04390025401749118, 0.04036817034949196, 0.044708069654443766, 0.04334447099807764, 0.04230648572494449, 0.04209920350460376, 0.052455990127224295, 0.044172404899220946, 0.05205554819906337, 0.05199661406598822, 0.0465113616568588, 0.048763746055357264, 0.04696494754945756, 0.0613356521377245, 0.04311738546489749, 0.04457616762342732, 0.05840162444131683, 0.04389920529204706, 0.05095654729267569, 0.044746143872630324, 0.04324502042935202, 0.050261898916394966, 0.04485845693189978, 0.06404627184768251, 0.04248406122614014, 0.04291656692790913, 0.049617111614401535, 0.0677677984530416, 0.04267913904061335, 0.05033123315478716, 0.057283401428623315, 0.05712040014699135, 0.042500230273976376, 0.043475822695473065, 0.04499635354313451, 0.053478980260077816, 0.049534479004213566, 0.05789027015354712, 0.050100573126581706, 0.04325841843879437, 0.04311789564958334, 0.0667746223800157, 0.06919444648680512, 0.05094999365581101, 0.043617255890164165, 0.04012019471628615, 0.045440838820962955, 0.043596933660373906, 0.041854706317297, 0.052224833195818735, 0.04521175529935366, 0.04198122065821659, 0.04695900796407898, 0.042825262728654105, 0.04328952783296294, 0.04504703161377443, 0.05315872068966912, 0.04315115004245762, 0.06377502138233124, 0.05228229264502121, 0.05097086375250558, 0.051179035384482374, 0.046281136548554584, 0.059988497648267775, 0.0529469186163836, 0.0434966641746704, 0.07124195684882738, 0.043262028314717024, 0.03992375414421128, 0.04543022290840141, 0.04360952764864418, 0.04007303438578696, 0.06236830480064966, 0.04178925928829542, 0.06719154470076101, 0.06103951545667047, 0.05283062791484994, 0.043435908679902345, 0.052875944486525016, 0.04178131224495984, 0.041641693893051404, 0.06271528870021247, 0.04506044471943217], [0.056375782535309366, 0.0540164404568614, 0.06142207121137624, 0.08333916108781919, 0.04702345417667515, 0.04630761654708922, 0.05634646121030997, 0.04682124152446064, 0.04978352752023907, 0.04636380493886591, 0.04869848754116311, 0.04468936231514173, 0.05332282663771207, 0.04718398234090467, 0.05190222039683934, 0.047523624905599346, 0.05508253746910051, 0.0468192222360863, 0.07365915645383718, 0.05529786532649205, 0.05455078857931464, 0.05207129555069004, 0.05427197038609077, 0.04550540306670446, 0.05637574898574325, 0.04740855699675642, 0.05679164985149167, 0.05118724470720141, 0.061399334349447825, 0.05435914453080109, 0.050453417636448145, 0.05698062382096072, 0.048348021977917155, 0.05670013450784788, 0.05263234247266128, 0.04953114853201924, 0.044945374415620694, 0.06233847472589005, 0.05910463900508917, 0.0511041237059723, 0.062081755919400725, 0.051337176981404796, 0.04878507732867753, 0.050286527330977736, 0.06548252589907094, 0.055885857616232854, 0.04923185224101348, 0.048199026849183944, 0.051239585026177925, 0.051349416804423904, 0.0538318521148374, 0.0569931992618994, 0.04554032874804494, 0.04954248013130453, 0.04928320615672681, 0.0472163612170336, 0.05673778440821332, 0.04575724829998562, 0.04811606196136697, 0.04635627086347767, 0.04551970771937594, 0.06868034746364289, 0.05649548822498982, 0.05811486447740096, 0.0453318963770274, 0.04956348033187072, 0.04529245536240283, 0.04989037821298754, 0.045519396641266786, 0.047555005381776386, 0.04530123546809766, 0.04328601175164473, 0.05438778908544311, 0.05061164206743058, 0.05243637808180345, 0.06753855094214896, 0.04936519789315764, 0.047272759909694, 0.05488646607014433, 0.04697148836131248, 0.0591261650270494, 0.0487081473811296, 0.04417860365426792, 0.04921702742865538, 0.052954080594235564, 0.0503531079562106, 0.05313215271030215, 0.05073453487341686, 0.04639133189780766, 0.06373618714186649, 0.04763925005600707, 0.045335895520981086, 0.054596180318519524, 0.04691142479493527, 0.047056621681336175, 0.04905121601700016, 0.04452933176775695, 0.05668207167266129, 0.04961786284833492, 0.05825280150820189], [0.061928482311921086, 0.0587581476874802, 0.056148473026565074, 0.06166995515565239, 0.06565779626435884, 0.05980544750085227, 0.05909271269634892, 0.06793258235046004, 0.05703475457171625, 0.06504304169672175, 0.0602574527625619, 0.06456802579600043, 0.07206479627250462, 0.062440123721270786, 0.06492519611970508, 0.06205768778279433, 0.060933552677926626, 0.0560849006290909, 0.06474606752558366, 0.05787250955232471, 0.06064670559238793, 0.05658853795139464, 0.06355919809712081, 0.0667891845245568, 0.06056704134276551, 0.056945472128210675, 0.06387088314474369, 0.05946546261066135, 0.05836864693024579, 0.06624898301047073, 0.05970416952178477, 0.0756323372074193, 0.05914731902802569, 0.06988714949441664, 0.06722556844154236, 0.06371067082828374, 0.0730909780658769, 0.05919535646869778, 0.06130116318412533, 0.05867978154122717, 0.06254818926318269, 0.060321005931503205, 0.06609217229072012, 0.061790033423365635, 0.060818679168426315, 0.057601795235921044, 0.059975299663291376, 0.0677695453653534, 0.061238646018946026, 0.053836385085828525, 0.057911207668327365, 0.06299959274779497, 0.05661947381660562, 0.056703936702377396, 0.07542446608460204, 0.05933371137224752, 0.06853792821681826, 0.05635574727325928, 0.06381232730754664, 0.059362748105546426, 0.07153634720563387, 0.06471665521713847, 0.07424850580984757, 0.06081901171001376, 0.06338576286821111, 0.06522675746078284, 0.06294212831808836, 0.062249098551463954, 0.06440076960587542, 0.06377587086846702, 0.05681749329960772, 0.061003761270497746, 0.060043798780413736, 0.05924611680888631, 0.06776499981444438, 0.07124408238322676, 0.05875534701246783, 0.06621401377555956, 0.06028833225751559, 0.06386002163946665, 0.05798760233068233, 0.06230492200612411, 0.07476821507009576, 0.062482796141876955, 0.05830598429063079, 0.05979813815871211, 0.059741535236514993, 0.05876383246645608, 0.0665503467756949, 0.06860598262493801, 0.07286870483361216, 0.058094102806268734, 0.05781132704327996, 0.06635116887066655, 0.058732348692566314, 0.06352966038863633, 0.05803779536144432, 0.061431418123421386, 0.06589407692005882, 0.06130783688132981], [0.040489321553820526, 0.04244078998180305, 0.04125966074347432, 0.05667209468853502, 0.044225696511919044, 0.04927599223256981, 0.04224237766217725, 0.060950837742035906, 0.038977039787093944, 0.0674208501899324, 0.041850180498087496, 0.043858118989270015, 0.042042116457551446, 0.044755060173182044, 0.05122016456133793, 0.04471540266864987, 0.043701532174481555, 0.04409056571347227, 0.05853504595090346, 0.04047059168317013, 0.042864691018189294, 0.053394472814121074, 0.053686346681494704, 0.04526485814000074, 0.04401526196275226, 0.04762915794587917, 0.0602309627385934, 0.04914290040151967, 0.04414413930695505, 0.05544949991619214, 0.060486706117795094, 0.05306546016244729, 0.05679612061944266, 0.042380391980056484, 0.03826244773170778, 0.04370093592918342, 0.06479867693245595, 0.05088980504293229, 0.04527679229850352, 0.051052289499822615, 0.0553097897910019, 0.044692784017188965, 0.057045323447748916, 0.06416777639064077, 0.06876808947560054, 0.04786405318938938, 0.051604196622558475, 0.07762173809320441, 0.06337059443462839, 0.0415575907100501, 0.04174956317184485, 0.04896049827364559, 0.04417308215353506, 0.06020389487577384, 0.056249980248916795, 0.04845916794865732, 0.043452893561183537, 0.05914347195847798, 0.05984951174250666, 0.04986840231400949, 0.06845115714067525, 0.041836817741971906, 0.05479219477183879, 0.04183408633306046, 0.044618556420927234, 0.054295738860990254, 0.053218465722711605, 0.04451430074143453, 0.048376549299497404, 0.04245751408580303, 0.043719311911518344, 0.05352631085925154, 0.04699906285230979, 0.040184977928674225, 0.04486253275655541, 0.05099136671006231, 0.04198374884484359, 0.04183976052918914, 0.054296000789238866, 0.04220670612743487, 0.04351445217117176, 0.047827918028844146, 0.051114036092779556, 0.043451681565485525, 0.04280973595988829, 0.042541004765868244, 0.0437248854444402, 0.05501642342091162, 0.06416113031242052, 0.06472977784046886, 0.05349957721005731, 0.05174012685278827, 0.05303908699945791, 0.07453312469858808, 0.05086995277909006, 0.042851611524546585, 0.04808428401105628, 0.0485197422613639, 0.0722407547569935, 0.04161740204102268], [0.05197818548931857, 0.04283416780838432, 0.05275307225337346, 0.0626196705953624, 0.05851077997098658, 0.05259595870874338, 0.04504015742426838, 0.04171876706369997, 0.051138309917515834, 0.06337962379048559, 0.0518289147308588, 0.062492123239681056, 0.044082780973521404, 0.04414207122954296, 0.044330476814432994, 0.043683675690194754, 0.05421848561663584, 0.04030282790268034, 0.043860758659854254, 0.04489878686938463, 0.0457607625132273, 0.051613216582683405, 0.04685057825012286, 0.039782893911372144, 0.0416034061510837, 0.04978413984845904, 0.06681992615392633, 0.04852453381773872, 0.042450942844571446, 0.045809513045281094, 0.05105538833316079, 0.052781024592023586, 0.044141608378222195, 0.05817328313228881, 0.04072748896561036, 0.04422682148349758, 0.043930210172144074, 0.04526188882429295, 0.042302668931202304, 0.04316624317728075, 0.06035328968170272, 0.04243423637827852, 0.04238073910532582, 0.045247034733862636, 0.06294793330677213, 0.04290226029304104, 0.05072919812844076, 0.04460952361292469, 0.0453650056951224, 0.04363795747549339, 0.05289023600968533, 0.0423946668295946, 0.061044996351850594, 0.05121697475413964, 0.062309087411169146, 0.04390508295791547, 0.041728948649031525, 0.04182875209138459, 0.06419102265518958, 0.04373679692381783, 0.047552119376513, 0.043805383237774664, 0.040219836839461724, 0.040581250453936416, 0.043812817478909985, 0.04168312753181721, 0.061032179384050596, 0.04182093384536687, 0.04584221604400611, 0.04261003974310658, 0.05775532123884922, 0.04404271999533429, 0.04706827295331688, 0.04293383705509819, 0.04208396963928862, 0.07189412684593975, 0.043245590114054315, 0.04254883876614613, 0.0428727453843279, 0.05881362313255464, 0.05697398424736654, 0.0532204242106488, 0.06575700009065709, 0.04381752623303783, 0.04108377046102695, 0.041303849612705446, 0.0587384378426794, 0.04502196660975431, 0.044209104925344814, 0.054621022899475374, 0.042964824776503915, 0.051812176361804865, 0.041557561444120455, 0.042586058825917206, 0.043068378898926556, 0.04431068129240971, 0.042503391950227884, 0.0607587899777066, 0.05472818866556392, 0.04196667552235796]]
    lossvec0 = [[0.05869716357936193, 0.06496469072191993, 0.06445388890620267, 0.061190271263857884, 0.060801952120124174, 0.0628518155011463, 0.06103055368862017, 0.0645339303067024, 0.06345518080997543, 0.06798749988287238, 0.0635577827604388, 0.06448244774348906, 0.06460408960457555, 0.06423479803724086, 0.06346570148697925, 0.0610220274476332, 0.06653268660497995, 0.0637819632898739, 0.06458153281918987, 0.06219370776874488, 0.06158502380780164, 0.06450099815646547, 0.06261581321267679, 0.06241165203529875, 0.06127086472011553, 0.06284592849557297, 0.06433899359307356, 0.06298260297368505, 0.06333552441384119, 0.061629484523442635, 0.06555605978760054, 0.06382096899959443, 0.06501828365590352, 0.06262780410665626, 0.06140928933603194, 0.06260452785273529, 0.06452117625338971, 0.06131657543913682, 0.06331224204223371, 0.059988330185667786, 0.06040264892287001, 0.06288617348285885, 0.06166245680508134, 0.0628351006999992, 0.06251416854556381, 0.06278572087523576, 0.06433018328228853, 0.060095054181502905, 0.0626561852934667, 0.06395959213148232, 0.06599653261118309, 0.06301622084736008, 0.06534010734028481, 0.06182977435688999, 0.060662926582686065, 0.06509633058008522, 0.06571845189114096, 0.06336204765334655, 0.06121765310765021, 0.06212960321981213, 0.06139979355188204, 0.06715352252234444, 0.06494291982692406, 0.0630487850259678, 0.05997319784634728, 0.06093541747803282, 0.062345506188413474, 0.05898777693762918, 0.06426586972711376, 0.06636850613688819, 0.05779544547041826, 0.06434274816921044, 0.06208405024947255, 0.06377646674187719, 0.06871680581791573, 0.06252993209726768, 0.06316452053900942, 0.0640895085756315, 0.06197286743720706, 0.060706810755013996, 0.06439778673649788, 0.06553858203941768, 0.06679639345658742, 0.06140427401580309, 0.06518312241091204, 0.06411355265029997, 0.06358547090601545, 0.06435113477421903, 0.06085434251111577, 0.06343789286904834, 0.06418355308710491, 0.06435364560539769, 0.061155853975873246, 0.06391964006755392, 0.06019878534789032, 0.06399455155349086, 0.0591792232272502, 0.061147998138276795, 0.06630087518492675, 0.063835916003289]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.4$, $n=30$')
    
    lossveclist = [[0.04718947466709231, 0.046553585017072636, 0.052441688225299425, 0.05142784398450772, 0.046390263414362864, 0.051698049737683556, 0.047687574554680354, 0.0505419556635018, 0.047825610693482186, 0.047304684784099396, 0.05032773327557194, 0.045866836046140835, 0.04731872633796882, 0.04849988735453309, 0.049833875600876903, 0.05328195537423884, 0.05202206828613756, 0.04698807342979201, 0.04530187048423474, 0.04713490395600838, 0.05589074135663584, 0.050074601384535344, 0.046701690276989165, 0.04593018728222049, 0.05643642453230507, 0.04804260259106695, 0.05285151581410675, 0.04852504573649602, 0.05001104938159274, 0.04829438047555947, 0.046032411527801013, 0.048433839785773494, 0.05205737244071572, 0.05245656060786794, 0.044547490664291416, 0.050402855221848696, 0.0520232095764459, 0.05104728442799498, 0.049435110552061304, 0.05040513734288222, 0.058983784498691294, 0.04622636707546684, 0.046203887020108546, 0.049674070038625555, 0.05377995874049181, 0.04272867131056178, 0.048664447648189245, 0.05108022669062065, 0.04808777371555936, 0.04773567155828597, 0.0450558113520085, 0.04959772643375383, 0.04866410298505742, 0.052034115222010735, 0.04996997044282836, 0.04916178365000783, 0.0496805088532744, 0.049017330645103885, 0.04681821650649419, 0.04928261377110753, 0.04647344134530747, 0.04621650629459626, 0.04907718845812723, 0.0505965734401475, 0.054224008336253626, 0.047962683302389536, 0.05047017075775085, 0.04756326814889569, 0.053087459122950535, 0.04943206054309928, 0.0490911212469289, 0.05537001186878515, 0.052115193956457716, 0.04654668529053779, 0.05033283814871047, 0.06491828642516612, 0.04984620149171715, 0.04696845876693901, 0.052696972519148656, 0.04796090608182052, 0.04989275734293907, 0.0474146231424664, 0.047196056872370135, 0.04935695516231519, 0.048711933446900335, 0.04561887327753751, 0.04920745736993924, 0.054215819692971394, 0.0459418596674953, 0.04689973247421375, 0.04962532929275384, 0.04845276012740564, 0.06610363063631257, 0.060747937019962034, 0.05150789510837962, 0.04972581725824374, 0.052775827152395934, 0.0510685154422887, 0.04846971783522132, 0.047901722939409364], [0.04202643550609381, 0.06589450517212515, 0.043377190719077155, 0.059862902521271716, 0.06386016045956844, 0.04296398068290836, 0.03970765683733988, 0.04439803392363333, 0.05156554515835239, 0.07326249907031858, 0.04384704357841969, 0.04976415829662597, 0.055601419363565434, 0.04793100015686585, 0.06933859539248141, 0.0427233892114996, 0.054799886501655945, 0.04390025401749118, 0.04036817034949196, 0.044708069654443766, 0.04334447099807764, 0.04230648572494449, 0.04209920350460376, 0.052455990127224295, 0.044172404899220946, 0.05205554819906337, 0.05199661406598822, 0.0465113616568588, 0.048763746055357264, 0.04696494754945756, 0.0613356521377245, 0.04311738546489749, 0.04457616762342732, 0.05840162444131683, 0.04389920529204706, 0.05095654729267569, 0.044746143872630324, 0.04324502042935202, 0.050261898916394966, 0.04485845693189978, 0.06404627184768251, 0.04248406122614014, 0.04291656692790913, 0.049617111614401535, 0.0677677984530416, 0.04267913904061335, 0.05033123315478716, 0.057283401428623315, 0.05712040014699135, 0.042500230273976376, 0.043475822695473065, 0.04499635354313451, 0.053478980260077816, 0.049534479004213566, 0.05789027015354712, 0.050100573126581706, 0.04325841843879437, 0.04311789564958334, 0.0667746223800157, 0.06919444648680512, 0.05094999365581101, 0.043617255890164165, 0.04012019471628615, 0.045440838820962955, 0.043596933660373906, 0.041854706317297, 0.052224833195818735, 0.04521175529935366, 0.04198122065821659, 0.04695900796407898, 0.042825262728654105, 0.04328952783296294, 0.04504703161377443, 0.05315872068966912, 0.04315115004245762, 0.06377502138233124, 0.05228229264502121, 0.05097086375250558, 0.051179035384482374, 0.046281136548554584, 0.059988497648267775, 0.0529469186163836, 0.0434966641746704, 0.07124195684882738, 0.043262028314717024, 0.03992375414421128, 0.04543022290840141, 0.04360952764864418, 0.04007303438578696, 0.06236830480064966, 0.04178925928829542, 0.06719154470076101, 0.06103951545667047, 0.05283062791484994, 0.043435908679902345, 0.052875944486525016, 0.04178131224495984, 0.041641693893051404, 0.06271528870021247, 0.04506044471943217], [0.056375782535309366, 0.0540164404568614, 0.06142207121137624, 0.08333916108781919, 0.04702345417667515, 0.04630761654708922, 0.05634646121030997, 0.04682124152446064, 0.04978352752023907, 0.04636380493886591, 0.04869848754116311, 0.04468936231514173, 0.05332282663771207, 0.04718398234090467, 0.05190222039683934, 0.047523624905599346, 0.05508253746910051, 0.0468192222360863, 0.07365915645383718, 0.05529786532649205, 0.05455078857931464, 0.05207129555069004, 0.05427197038609077, 0.04550540306670446, 0.05637574898574325, 0.04740855699675642, 0.05679164985149167, 0.05118724470720141, 0.061399334349447825, 0.05435914453080109, 0.050453417636448145, 0.05698062382096072, 0.048348021977917155, 0.05670013450784788, 0.05263234247266128, 0.04953114853201924, 0.044945374415620694, 0.06233847472589005, 0.05910463900508917, 0.0511041237059723, 0.062081755919400725, 0.051337176981404796, 0.04878507732867753, 0.050286527330977736, 0.06548252589907094, 0.055885857616232854, 0.04923185224101348, 0.048199026849183944, 0.051239585026177925, 0.051349416804423904, 0.0538318521148374, 0.0569931992618994, 0.04554032874804494, 0.04954248013130453, 0.04928320615672681, 0.0472163612170336, 0.05673778440821332, 0.04575724829998562, 0.04811606196136697, 0.04635627086347767, 0.04551970771937594, 0.06868034746364289, 0.05649548822498982, 0.05811486447740096, 0.0453318963770274, 0.04956348033187072, 0.04529245536240283, 0.04989037821298754, 0.045519396641266786, 0.047555005381776386, 0.04530123546809766, 0.04328601175164473, 0.05438778908544311, 0.05061164206743058, 0.05243637808180345, 0.06753855094214896, 0.04936519789315764, 0.047272759909694, 0.05488646607014433, 0.04697148836131248, 0.0591261650270494, 0.0487081473811296, 0.04417860365426792, 0.04921702742865538, 0.052954080594235564, 0.0503531079562106, 0.05313215271030215, 0.05073453487341686, 0.04639133189780766, 0.06373618714186649, 0.04763925005600707, 0.045335895520981086, 0.054596180318519524, 0.04691142479493527, 0.047056621681336175, 0.04905121601700016, 0.04452933176775695, 0.05668207167266129, 0.04961786284833492, 0.05825280150820189], [0.061928482311921086, 0.0587581476874802, 0.056148473026565074, 0.06166995515565239, 0.06565779626435884, 0.05980544750085227, 0.05909271269634892, 0.06793258235046004, 0.05703475457171625, 0.06504304169672175, 0.0602574527625619, 0.06456802579600043, 0.07206479627250462, 0.062440123721270786, 0.06492519611970508, 0.06205768778279433, 0.060933552677926626, 0.0560849006290909, 0.06474606752558366, 0.05787250955232471, 0.06064670559238793, 0.05658853795139464, 0.06355919809712081, 0.0667891845245568, 0.06056704134276551, 0.056945472128210675, 0.06387088314474369, 0.05946546261066135, 0.05836864693024579, 0.06624898301047073, 0.05970416952178477, 0.0756323372074193, 0.05914731902802569, 0.06988714949441664, 0.06722556844154236, 0.06371067082828374, 0.0730909780658769, 0.05919535646869778, 0.06130116318412533, 0.05867978154122717, 0.06254818926318269, 0.060321005931503205, 0.06609217229072012, 0.061790033423365635, 0.060818679168426315, 0.057601795235921044, 0.059975299663291376, 0.0677695453653534, 0.061238646018946026, 0.053836385085828525, 0.057911207668327365, 0.06299959274779497, 0.05661947381660562, 0.056703936702377396, 0.07542446608460204, 0.05933371137224752, 0.06853792821681826, 0.05635574727325928, 0.06381232730754664, 0.059362748105546426, 0.07153634720563387, 0.06471665521713847, 0.07424850580984757, 0.06081901171001376, 0.06338576286821111, 0.06522675746078284, 0.06294212831808836, 0.062249098551463954, 0.06440076960587542, 0.06377587086846702, 0.05681749329960772, 0.061003761270497746, 0.060043798780413736, 0.05924611680888631, 0.06776499981444438, 0.07124408238322676, 0.05875534701246783, 0.06621401377555956, 0.06028833225751559, 0.06386002163946665, 0.05798760233068233, 0.06230492200612411, 0.07476821507009576, 0.062482796141876955, 0.05830598429063079, 0.05979813815871211, 0.059741535236514993, 0.05876383246645608, 0.0665503467756949, 0.06860598262493801, 0.07286870483361216, 0.058094102806268734, 0.05781132704327996, 0.06635116887066655, 0.058732348692566314, 0.06352966038863633, 0.05803779536144432, 0.061431418123421386, 0.06589407692005882, 0.06130783688132981], [0.040489321553820526, 0.04244078998180305, 0.04125966074347432, 0.05667209468853502, 0.044225696511919044, 0.04927599223256981, 0.04224237766217725, 0.060950837742035906, 0.038977039787093944, 0.0674208501899324, 0.041850180498087496, 0.043858118989270015, 0.042042116457551446, 0.044755060173182044, 0.05122016456133793, 0.04471540266864987, 0.043701532174481555, 0.04409056571347227, 0.05853504595090346, 0.04047059168317013, 0.042864691018189294, 0.053394472814121074, 0.053686346681494704, 0.04526485814000074, 0.04401526196275226, 0.04762915794587917, 0.0602309627385934, 0.04914290040151967, 0.04414413930695505, 0.05544949991619214, 0.060486706117795094, 0.05306546016244729, 0.05679612061944266, 0.042380391980056484, 0.03826244773170778, 0.04370093592918342, 0.06479867693245595, 0.05088980504293229, 0.04527679229850352, 0.051052289499822615, 0.0553097897910019, 0.044692784017188965, 0.057045323447748916, 0.06416777639064077, 0.06876808947560054, 0.04786405318938938, 0.051604196622558475, 0.07762173809320441, 0.06337059443462839, 0.0415575907100501, 0.04174956317184485, 0.04896049827364559, 0.04417308215353506, 0.06020389487577384, 0.056249980248916795, 0.04845916794865732, 0.043452893561183537, 0.05914347195847798, 0.05984951174250666, 0.04986840231400949, 0.06845115714067525, 0.041836817741971906, 0.05479219477183879, 0.04183408633306046, 0.044618556420927234, 0.054295738860990254, 0.053218465722711605, 0.04451430074143453, 0.048376549299497404, 0.04245751408580303, 0.043719311911518344, 0.05352631085925154, 0.04699906285230979, 0.040184977928674225, 0.04486253275655541, 0.05099136671006231, 0.04198374884484359, 0.04183976052918914, 0.054296000789238866, 0.04220670612743487, 0.04351445217117176, 0.047827918028844146, 0.051114036092779556, 0.043451681565485525, 0.04280973595988829, 0.042541004765868244, 0.0437248854444402, 0.05501642342091162, 0.06416113031242052, 0.06472977784046886, 0.05349957721005731, 0.05174012685278827, 0.05303908699945791, 0.07453312469858808, 0.05086995277909006, 0.042851611524546585, 0.04808428401105628, 0.0485197422613639, 0.0722407547569935, 0.04161740204102268], [0.05197818548931857, 0.04283416780838432, 0.05275307225337346, 0.0626196705953624, 0.05851077997098658, 0.05259595870874338, 0.04504015742426838, 0.04171876706369997, 0.051138309917515834, 0.06337962379048559, 0.0518289147308588, 0.062492123239681056, 0.044082780973521404, 0.04414207122954296, 0.044330476814432994, 0.043683675690194754, 0.05421848561663584, 0.04030282790268034, 0.043860758659854254, 0.04489878686938463, 0.0457607625132273, 0.051613216582683405, 0.04685057825012286, 0.039782893911372144, 0.0416034061510837, 0.04978413984845904, 0.06681992615392633, 0.04852453381773872, 0.042450942844571446, 0.045809513045281094, 0.05105538833316079, 0.052781024592023586, 0.044141608378222195, 0.05817328313228881, 0.04072748896561036, 0.04422682148349758, 0.043930210172144074, 0.04526188882429295, 0.042302668931202304, 0.04316624317728075, 0.06035328968170272, 0.04243423637827852, 0.04238073910532582, 0.045247034733862636, 0.06294793330677213, 0.04290226029304104, 0.05072919812844076, 0.04460952361292469, 0.0453650056951224, 0.04363795747549339, 0.05289023600968533, 0.0423946668295946, 0.061044996351850594, 0.05121697475413964, 0.062309087411169146, 0.04390508295791547, 0.041728948649031525, 0.04182875209138459, 0.06419102265518958, 0.04373679692381783, 0.047552119376513, 0.043805383237774664, 0.040219836839461724, 0.040581250453936416, 0.043812817478909985, 0.04168312753181721, 0.061032179384050596, 0.04182093384536687, 0.04584221604400611, 0.04261003974310658, 0.05775532123884922, 0.04404271999533429, 0.04706827295331688, 0.04293383705509819, 0.04208396963928862, 0.07189412684593975, 0.043245590114054315, 0.04254883876614613, 0.0428727453843279, 0.05881362313255464, 0.05697398424736654, 0.0532204242106488, 0.06575700009065709, 0.04381752623303783, 0.04108377046102695, 0.041303849612705446, 0.0587384378426794, 0.04502196660975431, 0.044209104925344814, 0.054621022899475374, 0.042964824776503915, 0.051812176361804865, 0.041557561444120455, 0.042586058825917206, 0.043068378898926556, 0.04431068129240971, 0.042503391950227884, 0.0607587899777066, 0.05472818866556392, 0.04196667552235796]]
    lossvec0 = [[0.05869716357936193, 0.06496469072191993, 0.06445388890620267, 0.061190271263857884, 0.060801952120124174, 0.0628518155011463, 0.06103055368862017, 0.0645339303067024, 0.06345518080997543, 0.06798749988287238, 0.0635577827604388, 0.06448244774348906, 0.06460408960457555, 0.06423479803724086, 0.06346570148697925, 0.0610220274476332, 0.06653268660497995, 0.0637819632898739, 0.06458153281918987, 0.06219370776874488, 0.06158502380780164, 0.06450099815646547, 0.06261581321267679, 0.06241165203529875, 0.06127086472011553, 0.06284592849557297, 0.06433899359307356, 0.06298260297368505, 0.06333552441384119, 0.061629484523442635, 0.06555605978760054, 0.06382096899959443, 0.06501828365590352, 0.06262780410665626, 0.06140928933603194, 0.06260452785273529, 0.06452117625338971, 0.06131657543913682, 0.06331224204223371, 0.059988330185667786, 0.06040264892287001, 0.06288617348285885, 0.06166245680508134, 0.0628351006999992, 0.06251416854556381, 0.06278572087523576, 0.06433018328228853, 0.060095054181502905, 0.0626561852934667, 0.06395959213148232, 0.06599653261118309, 0.06301622084736008, 0.06534010734028481, 0.06182977435688999, 0.060662926582686065, 0.06509633058008522, 0.06571845189114096, 0.06336204765334655, 0.06121765310765021, 0.06212960321981213, 0.06139979355188204, 0.06715352252234444, 0.06494291982692406, 0.0630487850259678, 0.05997319784634728, 0.06093541747803282, 0.062345506188413474, 0.05898777693762918, 0.06426586972711376, 0.06636850613688819, 0.05779544547041826, 0.06434274816921044, 0.06208405024947255, 0.06377646674187719, 0.06871680581791573, 0.06252993209726768, 0.06316452053900942, 0.0640895085756315, 0.06197286743720706, 0.060706810755013996, 0.06439778673649788, 0.06553858203941768, 0.06679639345658742, 0.06140427401580309, 0.06518312241091204, 0.06411355265029997, 0.06358547090601545, 0.06435113477421903, 0.06085434251111577, 0.06343789286904834, 0.06418355308710491, 0.06435364560539769, 0.061155853975873246, 0.06391964006755392, 0.06019878534789032, 0.06399455155349086, 0.0591792232272502, 0.061147998138276795, 0.06630087518492675, 0.063835916003289]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### rateTarget=0.1, CHECK SCORE, m=0.1 ###
    # Get null first
    mScore, t = 0.1, 0.1
    scoredict = {'name': 'Check', 'slope': mScore}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_check, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Design 0']
    lossveclist = [[0.05141967341150602, 0.050488375800416346, 0.04981603776427598, 0.04764752786354282, 0.05055707866938051, 0.050775369507042215, 0.05047037260382936, 0.05051120458303731, 0.04799348062043705, 0.0497507936561569, 0.04879137858100735, 0.04883946868244083, 0.045910956748735604, 0.048472072618171214, 0.04978500634403664, 0.05101606054952856, 0.05051232661176904, 0.04946272518395998, 0.04949053152654033, 0.047121897142850366, 0.050613432794927714, 0.04872340953947927, 0.04730732974375995, 0.04707379888969331, 0.05026936711418364, 0.0496259790557982, 0.05005177020260493, 0.04558164115846085, 0.04750218707405135, 0.04872077186125756, 0.049864477557876014, 0.048975390346388446, 0.04737853776354648, 0.053897053334010146, 0.04892433440314092, 0.04806983586034234, 0.049401612612163616, 0.04919975785394658, 0.051452607063234485, 0.04861894943595187, 0.04915236197730954, 0.04799461122296129, 0.051187972900031325, 0.048739577379698605, 0.04828325531103462, 0.04685464619629295, 0.04954078801178165, 0.05053827036929954, 0.04776411506228511, 0.05457268338942284, 0.0483221637988486, 0.04861589005291251, 0.05029666993229396, 0.046769460510686436, 0.04997417808215994, 0.04846030442514717, 0.04862335586728392, 0.048397593261808605, 0.0506201938145519, 0.050901545388903714, 0.04605532245901115, 0.048267323233028576, 0.05063036850021813, 0.0500902181154842, 0.04789690100561125, 0.0491534394998639, 0.04814608557898573, 0.05132696414848426, 0.04998554057448066, 0.04866477345081097, 0.04817798082532481, 0.04741883870718274, 0.04954626143276108, 0.05109931822730183, 0.04803866217672809, 0.04880241998252823, 0.051658540280846224, 0.04642040264187238, 0.047685889716944506, 0.0477681546950277, 0.047728490875300095, 0.04844515537490979, 0.04800573966185571, 0.04689480508492717, 0.04956981044342672, 0.04789963195455775, 0.050579824924073154, 0.047878593234791884, 0.04899565710765956, 0.04889107828992235, 0.04850235492334388, 0.04975680873578155, 0.05020298613341479, 0.04784143984868255, 0.04659091953814041, 0.053399696082267245, 0.04897711074096094, 0.05063872728710386, 0.04881581854084665, 0.04870321948150379]]
    '''
    # 30 tests for all designs
    mScore, t = 0.1, 0.1
    scoredict = {'name': 'Check', 'slope': mScore}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_check, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.04190104555276653, 0.042638406456415055, 0.050114911640995116, 0.043337703748643236, 0.04037769057061473, 0.042800567887932614, 0.03867629504379225, 0.039753031958574984, 0.0399515600185753, 0.040095994557639236, 0.040494237346789, 0.038783815926068915, 0.03873784714311815, 0.03816712446780221, 0.038734611218196095, 0.04093163608892898, 0.04089929153975861, 0.038015901176388395, 0.03845252795523308, 0.04138693765919372, 0.04906306003362314, 0.046025751276810585, 0.03596660953131131, 0.03757078717831047, 0.04559469515975417, 0.04213623001184617, 0.04424264370493216, 0.04107218442336022, 0.04174029376501296, 0.03857252110350617, 0.03926616214313116, 0.039256228109224904, 0.046048521857951226, 0.04362606174181843, 0.04344322503534693, 0.03987527904114251, 0.039924546413550574, 0.04178539718312685, 0.040637985684906335, 0.04111027956472964, 0.04881285021807444, 0.04008820458308847, 0.03782153613779288, 0.04121280567542108, 0.04069526963647479, 0.03831317041972452, 0.041669797421274093, 0.03757361804643317, 0.041070682882185794, 0.04215880219566272, 0.04161214103270918, 0.04334558012126977, 0.04541393518041159, 0.040245762999436496, 0.04302336176067074, 0.04417515606146429, 0.04131368545456549, 0.04348651506705213, 0.040881744737416015, 0.03912792018778864, 0.042163810398601786, 0.043506328430270254, 0.049058585142390226, 0.04053587260891177, 0.042988745464871546, 0.041795656264804144, 0.03789652884236195, 0.04147412121955538, 0.046321883702117435, 0.04183568972554154, 0.039507098129056166, 0.050060479804640484, 0.0413890727208952, 0.042061070427489716, 0.04661410149196618, 0.053090722603873076, 0.0423616646801263, 0.03857278254477465, 0.03943898927702687, 0.04279935167302481, 0.042373830693433506, 0.041530282706686523, 0.04111168557937257, 0.04002649623551674, 0.04339225497556752, 0.039986738823449025, 0.044232347331346844, 0.04438968061322869, 0.04084063683585815, 0.045477553037929046, 0.041849596861205055, 0.04459621113922286, 0.04288296281366825, 0.04479944904319051, 0.04036120876257611, 0.03947147851987372, 0.04688190506163185, 0.046931123554572, 0.03759541998762883, 0.039882898048758934], [0.042425156133885325, 0.033863377296484316, 0.036043364893993644, 0.04165867697661706, 0.04393146330868022, 0.04173209524037377, 0.039782215029713776, 0.04728765381759341, 0.03502753202102314, 0.04039612953979622, 0.03408026294091918, 0.037110489461742856, 0.04698115098171874, 0.03317644761918645, 0.035996171419567125, 0.04599601081195377, 0.04373297951856798, 0.03282818470448618, 0.038528554969307086, 0.03687386842668735, 0.036001740500376286, 0.041233631200249934, 0.03834758973668743, 0.03468827950851292, 0.042555524555203554, 0.04624065289686511, 0.04198879922553205, 0.03519043028445858, 0.04142771399956689, 0.03489633044371446, 0.04429830971975487, 0.03188799558104105, 0.03361065405909838, 0.03680771547890033, 0.031623058453419624, 0.035048617788916256, 0.03740783205753665, 0.032746769119646676, 0.041710713982718375, 0.03599179659922748, 0.0411531630694273, 0.0375299750458188, 0.03644648909008507, 0.03963060350297909, 0.04825547965152491, 0.03553495064826336, 0.03383620375580719, 0.038491481551395944, 0.039369765752842144, 0.03508829001695311, 0.0345718865593651, 0.03701973633365099, 0.044286334844030426, 0.0442133788993993, 0.0443488646857971, 0.04216332080128134, 0.03540328016577308, 0.03682491306905045, 0.03783009995586358, 0.03647518651522753, 0.036897123230777026, 0.034174253303209216, 0.034374363793513794, 0.03518964209232047, 0.03487589454844085, 0.04078615037974799, 0.046745441174616924, 0.035478085814305074, 0.03425523363529121, 0.03641677095558293, 0.04687492944830132, 0.03560183774291138, 0.032199812848451574, 0.03530349161569807, 0.04168125597583328, 0.04395904702888886, 0.03636270016145833, 0.03808372327340154, 0.04179229956712697, 0.03482152271866748, 0.03746987605999862, 0.035522033113732907, 0.045905358616497936, 0.04523083551126632, 0.03396351004960368, 0.03550357152621858, 0.04460685047168262, 0.036347979401597855, 0.03888530441728337, 0.04755576731061955, 0.039795719637039234, 0.05155070620471664, 0.0352221984365748, 0.03443598794885387, 0.036040368336239276, 0.03978143178255326, 0.033966626774979226, 0.04482798712224122, 0.03652269385058549, 0.036107653400317706], [0.04164415496155746, 0.041457821768404936, 0.045634688075453164, 0.04330696642837157, 0.03778113630396278, 0.038180739936140504, 0.04607844134391053, 0.04390629912949341, 0.03953639132740114, 0.04110132461320815, 0.04098009076882133, 0.0402068939967276, 0.04028968498329687, 0.04144029659978274, 0.04057933809815282, 0.042830510197017356, 0.050757913544203094, 0.039995271857201656, 0.0393840652605432, 0.042993804088896664, 0.04618686277288413, 0.04192223057424026, 0.041966596170625044, 0.035897467882646854, 0.044830367145415786, 0.04217896900888916, 0.040402185194523356, 0.046126602954967684, 0.03972941939171822, 0.03999784583030041, 0.04069524228092932, 0.041119467686793726, 0.04520412372948027, 0.039021253155059575, 0.04161942992274582, 0.0383419747916236, 0.04150677417273541, 0.042223337958111694, 0.03961517260835058, 0.04316803186133485, 0.04693310102859578, 0.04326900928078274, 0.039695226388900884, 0.04485034573566034, 0.047398574404836046, 0.04051822739579463, 0.04197311590599289, 0.03996152489204583, 0.04233022645206548, 0.039577722976188855, 0.043966928485594796, 0.042063846751492176, 0.04708538057132759, 0.03950542385702507, 0.04573805548740482, 0.04613120056620187, 0.03791740865974129, 0.04124519570819873, 0.03801478054582377, 0.041530247176115496, 0.04097610342837598, 0.04061551657177308, 0.03815891430068598, 0.040299299947354865, 0.04015923378647696, 0.04400079980436187, 0.03894806268398221, 0.0382912750099167, 0.04184046509598251, 0.04084687080225559, 0.0463259814981084, 0.042444248663938686, 0.04257791793064433, 0.039491131035091685, 0.038123052033191496, 0.053751220473689014, 0.04420579563356115, 0.04242647004833428, 0.040410288718529926, 0.04086021875324341, 0.04036588375896679, 0.039640098249579515, 0.03873473530195311, 0.03967006172662319, 0.03997055082372265, 0.041701095965171804, 0.04296992971099752, 0.04175356385362448, 0.041960028026629397, 0.03944201676228052, 0.040801286356756485, 0.05259677907536268, 0.04330456179207548, 0.038083721132053175, 0.04290223841900877, 0.042002366921821674, 0.043361118047490516, 0.04868238489703051, 0.03714582508122746, 0.043436470884047965], [0.04245068456563985, 0.04463458207213338, 0.043024913422648456, 0.04752801987072207, 0.04387460062521562, 0.04473364773713034, 0.04237200108382268, 0.04981576283379314, 0.04088222588123987, 0.04931825201311945, 0.04247911625299222, 0.04551864622675427, 0.04330133822332822, 0.04624100518894291, 0.04691221408536941, 0.03971536364467199, 0.05075692355496023, 0.04588267946890234, 0.047720293232797875, 0.046068808028405725, 0.05095384474738728, 0.047146493340690876, 0.049902530222970594, 0.0461075967754621, 0.04324056125063989, 0.047226510974585585, 0.04712159606563903, 0.044237124289980695, 0.041681675252779674, 0.04593832759342872, 0.04739491571392467, 0.048025673869436854, 0.04448078653089567, 0.04644797958258055, 0.053949360944628634, 0.04696272373655468, 0.05112460524657989, 0.04498033262363156, 0.04827486919653827, 0.04745579264067997, 0.04368085027189842, 0.04806864382088575, 0.054407678765385194, 0.04307189309432506, 0.045756435351949176, 0.04446035942159731, 0.045668542248604255, 0.05671491916018405, 0.04766320142283048, 0.04435291467294752, 0.04399336355850021, 0.05133281477800743, 0.046050925454571894, 0.047865578179910405, 0.04606498323227303, 0.044549910989670316, 0.04597157737417439, 0.04355306312285869, 0.04897046294462772, 0.04527083704363383, 0.05288192019115905, 0.04766260748861184, 0.04819401398818066, 0.04477427418284245, 0.04578573378457153, 0.04294261876744727, 0.04263159038644739, 0.04581102619236585, 0.04459259481709561, 0.04930697653186578, 0.043411115140453205, 0.046321572146284545, 0.05018501760362005, 0.044068895116761854, 0.04795873947185419, 0.05463960165293386, 0.04288360952671259, 0.04763434670197763, 0.04697875048442935, 0.04495972184366811, 0.04438877098604583, 0.04642048822354356, 0.048216829234158605, 0.04415568469069297, 0.05117711522905716, 0.04769617562070032, 0.04336563711507005, 0.051006283052528856, 0.0520271494927239, 0.04446243734643147, 0.04981359954479499, 0.04353133983220956, 0.0505726870027484, 0.04540077322995491, 0.044117813713057036, 0.043263802272700394, 0.04482850107023578, 0.04496066600567296, 0.05281507228994638, 0.043275001349032796], [0.03462739760862808, 0.044886102594633756, 0.03350905295055346, 0.03713450474424246, 0.0455842673168563, 0.04167956642889076, 0.033237991698551884, 0.03269391749476358, 0.033261924151090604, 0.04027292910698906, 0.033175365548654225, 0.033242050695844634, 0.04090054804870786, 0.0367079329987606, 0.038176094147125264, 0.037526696748410804, 0.03927281069300986, 0.03442066752175069, 0.03976544917489012, 0.03372350990468549, 0.035884527826260476, 0.04150474622934896, 0.03711401929342482, 0.04106167514665851, 0.047058774046109704, 0.045484909286715766, 0.040840856112280055, 0.032992087877595146, 0.03635208684818733, 0.03851547981755558, 0.03723727335660887, 0.041250690782203094, 0.03372699290850908, 0.03948008018424946, 0.030584322320092516, 0.03651920899375563, 0.04462935570010397, 0.03716005606105881, 0.037297446621710514, 0.04032709998366924, 0.04980780205331333, 0.03486908354352975, 0.06322414784038889, 0.04342328092332761, 0.04473764186354332, 0.035662236510421615, 0.03236510831082821, 0.04497895015900662, 0.03692660973908365, 0.03460297914934424, 0.034007351776460304, 0.037430014746711204, 0.03974696721436706, 0.035751961173792875, 0.040735643751810414, 0.03404199637528354, 0.03669465232286101, 0.035925778174635145, 0.044400450922128784, 0.032292480329224854, 0.041476381580789146, 0.034231753604650667, 0.039158386793486585, 0.03695085760924472, 0.03367258235218534, 0.03568816566132855, 0.036112448692395105, 0.038545757863918076, 0.03555105679030451, 0.032653579947112835, 0.04082349049946729, 0.033630738041799675, 0.03604528886422054, 0.03739920791283366, 0.03453784456493854, 0.056444400313872475, 0.03269161796648844, 0.0403340337288822, 0.03352218090747728, 0.03911556521509884, 0.0391643682276823, 0.0351720803139224, 0.045312111193155966, 0.049665290489892155, 0.03386001833241178, 0.03830668875852967, 0.03482476777206025, 0.03354559269514429, 0.035349067387333434, 0.04395692083514154, 0.03856594424510277, 0.03998607179947111, 0.045255300327825036, 0.041877483406094644, 0.04532058972645467, 0.045029487668923576, 0.04339734054317102, 0.042051832562676215, 0.04879510519289141, 0.047223585193462196], [0.039501782837203805, 0.04441633345159088, 0.03459293590607108, 0.0433200157113193, 0.04597479760217045, 0.04815884060654332, 0.03289872298240642, 0.03808613681064582, 0.033219255698095786, 0.04257011861478809, 0.03663868723280091, 0.039074693381457457, 0.04724543600358661, 0.036289526280813875, 0.04414637874351868, 0.034223881894454404, 0.03935589538255432, 0.030864504152234497, 0.03866486566089559, 0.03443475467471388, 0.03742272376584788, 0.03447977158606758, 0.04039172441406948, 0.0342323270907812, 0.04162641562441664, 0.0422281214244858, 0.03556566848587841, 0.036609462170274276, 0.04612066835271534, 0.038928728815867876, 0.035015716231559704, 0.034718978118637694, 0.03705135473273945, 0.03512066609903974, 0.037959615438035214, 0.03586319288310158, 0.03396794723461969, 0.03465388876640225, 0.038940986534820886, 0.034228167632629945, 0.04573764473257103, 0.03427658065334294, 0.034569261219822324, 0.036366013600000024, 0.045174415578660705, 0.032493485619043895, 0.039812424039902476, 0.03555720230320878, 0.04262508753637171, 0.034528217486682805, 0.0327567388895314, 0.035803994636206635, 0.044731485884276966, 0.03527979952403814, 0.04300824381331047, 0.034849745611559506, 0.03593431855799131, 0.03777549560916171, 0.041144268067300156, 0.04207780999026448, 0.03997991143203633, 0.03464484394983014, 0.03538204882515407, 0.03898681192540062, 0.040284968624574, 0.03368379275952636, 0.04423681728550799, 0.04081578057349034, 0.037983666956394053, 0.034710083931878626, 0.03774123358110783, 0.03437178841928199, 0.03578159978621291, 0.03447986924860966, 0.04068279174413486, 0.042275168427986475, 0.034310505059182074, 0.03411961080859363, 0.03502998976312125, 0.04086993841570853, 0.03643360112132487, 0.03712853249108974, 0.04157022114146362, 0.03817940080562053, 0.040598015630147075, 0.030455387580937934, 0.03395241279671245, 0.03468357255141507, 0.03450902632898317, 0.04062456967869956, 0.045190249508251484, 0.037117265679111534, 0.046963000393518244, 0.034449469867445195, 0.04180461055825995, 0.034174694054870614, 0.03530304974166931, 0.03999126392019518, 0.04565861335820034, 0.036827699692506294]]
    lossvec0 = [[0.05141967341150602, 0.050488375800416346, 0.04981603776427598, 0.04764752786354282, 0.05055707866938051, 0.050775369507042215, 0.05047037260382936, 0.05051120458303731, 0.04799348062043705, 0.0497507936561569, 0.04879137858100735, 0.04883946868244083, 0.045910956748735604, 0.048472072618171214, 0.04978500634403664, 0.05101606054952856, 0.05051232661176904, 0.04946272518395998, 0.04949053152654033, 0.047121897142850366, 0.050613432794927714, 0.04872340953947927, 0.04730732974375995, 0.04707379888969331, 0.05026936711418364, 0.0496259790557982, 0.05005177020260493, 0.04558164115846085, 0.04750218707405135, 0.04872077186125756, 0.049864477557876014, 0.048975390346388446, 0.04737853776354648, 0.053897053334010146, 0.04892433440314092, 0.04806983586034234, 0.049401612612163616, 0.04919975785394658, 0.051452607063234485, 0.04861894943595187, 0.04915236197730954, 0.04799461122296129, 0.051187972900031325, 0.048739577379698605, 0.04828325531103462, 0.04685464619629295, 0.04954078801178165, 0.05053827036929954, 0.04776411506228511, 0.05457268338942284, 0.0483221637988486, 0.04861589005291251, 0.05029666993229396, 0.046769460510686436, 0.04997417808215994, 0.04846030442514717, 0.04862335586728392, 0.048397593261808605, 0.0506201938145519, 0.050901545388903714, 0.04605532245901115, 0.048267323233028576, 0.05063036850021813, 0.0500902181154842, 0.04789690100561125, 0.0491534394998639, 0.04814608557898573, 0.05132696414848426, 0.04998554057448066, 0.04866477345081097, 0.04817798082532481, 0.04741883870718274, 0.04954626143276108, 0.05109931822730183, 0.04803866217672809, 0.04880241998252823, 0.051658540280846224, 0.04642040264187238, 0.047685889716944506, 0.0477681546950277, 0.047728490875300095, 0.04844515537490979, 0.04800573966185571, 0.04689480508492717, 0.04956981044342672, 0.04789963195455775, 0.050579824924073154, 0.047878593234791884, 0.04899565710765956, 0.04889107828992235, 0.04850235492334388, 0.04975680873578155, 0.05020298613341479, 0.04784143984868255, 0.04659091953814041, 0.053399696082267245, 0.04897711074096094, 0.05063872728710386, 0.04881581854084665, 0.04870321948150379]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.4$, $n=30$')

    lossveclist = [[0.04190104555276653, 0.042638406456415055, 0.050114911640995116, 0.043337703748643236, 0.04037769057061473, 0.042800567887932614, 0.03867629504379225, 0.039753031958574984, 0.0399515600185753, 0.040095994557639236, 0.040494237346789, 0.038783815926068915, 0.03873784714311815, 0.03816712446780221, 0.038734611218196095, 0.04093163608892898, 0.04089929153975861, 0.038015901176388395, 0.03845252795523308, 0.04138693765919372, 0.04906306003362314, 0.046025751276810585, 0.03596660953131131, 0.03757078717831047, 0.04559469515975417, 0.04213623001184617, 0.04424264370493216, 0.04107218442336022, 0.04174029376501296, 0.03857252110350617, 0.03926616214313116, 0.039256228109224904, 0.046048521857951226, 0.04362606174181843, 0.04344322503534693, 0.03987527904114251, 0.039924546413550574, 0.04178539718312685, 0.040637985684906335, 0.04111027956472964, 0.04881285021807444, 0.04008820458308847, 0.03782153613779288, 0.04121280567542108, 0.04069526963647479, 0.03831317041972452, 0.041669797421274093, 0.03757361804643317, 0.041070682882185794, 0.04215880219566272, 0.04161214103270918, 0.04334558012126977, 0.04541393518041159, 0.040245762999436496, 0.04302336176067074, 0.04417515606146429, 0.04131368545456549, 0.04348651506705213, 0.040881744737416015, 0.03912792018778864, 0.042163810398601786, 0.043506328430270254, 0.049058585142390226, 0.04053587260891177, 0.042988745464871546, 0.041795656264804144, 0.03789652884236195, 0.04147412121955538, 0.046321883702117435, 0.04183568972554154, 0.039507098129056166, 0.050060479804640484, 0.0413890727208952, 0.042061070427489716, 0.04661410149196618, 0.053090722603873076, 0.0423616646801263, 0.03857278254477465, 0.03943898927702687, 0.04279935167302481, 0.042373830693433506, 0.041530282706686523, 0.04111168557937257, 0.04002649623551674, 0.04339225497556752, 0.039986738823449025, 0.044232347331346844, 0.04438968061322869, 0.04084063683585815, 0.045477553037929046, 0.041849596861205055, 0.04459621113922286, 0.04288296281366825, 0.04479944904319051, 0.04036120876257611, 0.03947147851987372, 0.04688190506163185, 0.046931123554572, 0.03759541998762883, 0.039882898048758934], [0.042425156133885325, 0.033863377296484316, 0.036043364893993644, 0.04165867697661706, 0.04393146330868022, 0.04173209524037377, 0.039782215029713776, 0.04728765381759341, 0.03502753202102314, 0.04039612953979622, 0.03408026294091918, 0.037110489461742856, 0.04698115098171874, 0.03317644761918645, 0.035996171419567125, 0.04599601081195377, 0.04373297951856798, 0.03282818470448618, 0.038528554969307086, 0.03687386842668735, 0.036001740500376286, 0.041233631200249934, 0.03834758973668743, 0.03468827950851292, 0.042555524555203554, 0.04624065289686511, 0.04198879922553205, 0.03519043028445858, 0.04142771399956689, 0.03489633044371446, 0.04429830971975487, 0.03188799558104105, 0.03361065405909838, 0.03680771547890033, 0.031623058453419624, 0.035048617788916256, 0.03740783205753665, 0.032746769119646676, 0.041710713982718375, 0.03599179659922748, 0.0411531630694273, 0.0375299750458188, 0.03644648909008507, 0.03963060350297909, 0.04825547965152491, 0.03553495064826336, 0.03383620375580719, 0.038491481551395944, 0.039369765752842144, 0.03508829001695311, 0.0345718865593651, 0.03701973633365099, 0.044286334844030426, 0.0442133788993993, 0.0443488646857971, 0.04216332080128134, 0.03540328016577308, 0.03682491306905045, 0.03783009995586358, 0.03647518651522753, 0.036897123230777026, 0.034174253303209216, 0.034374363793513794, 0.03518964209232047, 0.03487589454844085, 0.04078615037974799, 0.046745441174616924, 0.035478085814305074, 0.03425523363529121, 0.03641677095558293, 0.04687492944830132, 0.03560183774291138, 0.032199812848451574, 0.03530349161569807, 0.04168125597583328, 0.04395904702888886, 0.03636270016145833, 0.03808372327340154, 0.04179229956712697, 0.03482152271866748, 0.03746987605999862, 0.035522033113732907, 0.045905358616497936, 0.04523083551126632, 0.03396351004960368, 0.03550357152621858, 0.04460685047168262, 0.036347979401597855, 0.03888530441728337, 0.04755576731061955, 0.039795719637039234, 0.05155070620471664, 0.0352221984365748, 0.03443598794885387, 0.036040368336239276, 0.03978143178255326, 0.033966626774979226, 0.04482798712224122, 0.03652269385058549, 0.036107653400317706], [0.04164415496155746, 0.041457821768404936, 0.045634688075453164, 0.04330696642837157, 0.03778113630396278, 0.038180739936140504, 0.04607844134391053, 0.04390629912949341, 0.03953639132740114, 0.04110132461320815, 0.04098009076882133, 0.0402068939967276, 0.04028968498329687, 0.04144029659978274, 0.04057933809815282, 0.042830510197017356, 0.050757913544203094, 0.039995271857201656, 0.0393840652605432, 0.042993804088896664, 0.04618686277288413, 0.04192223057424026, 0.041966596170625044, 0.035897467882646854, 0.044830367145415786, 0.04217896900888916, 0.040402185194523356, 0.046126602954967684, 0.03972941939171822, 0.03999784583030041, 0.04069524228092932, 0.041119467686793726, 0.04520412372948027, 0.039021253155059575, 0.04161942992274582, 0.0383419747916236, 0.04150677417273541, 0.042223337958111694, 0.03961517260835058, 0.04316803186133485, 0.04693310102859578, 0.04326900928078274, 0.039695226388900884, 0.04485034573566034, 0.047398574404836046, 0.04051822739579463, 0.04197311590599289, 0.03996152489204583, 0.04233022645206548, 0.039577722976188855, 0.043966928485594796, 0.042063846751492176, 0.04708538057132759, 0.03950542385702507, 0.04573805548740482, 0.04613120056620187, 0.03791740865974129, 0.04124519570819873, 0.03801478054582377, 0.041530247176115496, 0.04097610342837598, 0.04061551657177308, 0.03815891430068598, 0.040299299947354865, 0.04015923378647696, 0.04400079980436187, 0.03894806268398221, 0.0382912750099167, 0.04184046509598251, 0.04084687080225559, 0.0463259814981084, 0.042444248663938686, 0.04257791793064433, 0.039491131035091685, 0.038123052033191496, 0.053751220473689014, 0.04420579563356115, 0.04242647004833428, 0.040410288718529926, 0.04086021875324341, 0.04036588375896679, 0.039640098249579515, 0.03873473530195311, 0.03967006172662319, 0.03997055082372265, 0.041701095965171804, 0.04296992971099752, 0.04175356385362448, 0.041960028026629397, 0.03944201676228052, 0.040801286356756485, 0.05259677907536268, 0.04330456179207548, 0.038083721132053175, 0.04290223841900877, 0.042002366921821674, 0.043361118047490516, 0.04868238489703051, 0.03714582508122746, 0.043436470884047965], [0.04245068456563985, 0.04463458207213338, 0.043024913422648456, 0.04752801987072207, 0.04387460062521562, 0.04473364773713034, 0.04237200108382268, 0.04981576283379314, 0.04088222588123987, 0.04931825201311945, 0.04247911625299222, 0.04551864622675427, 0.04330133822332822, 0.04624100518894291, 0.04691221408536941, 0.03971536364467199, 0.05075692355496023, 0.04588267946890234, 0.047720293232797875, 0.046068808028405725, 0.05095384474738728, 0.047146493340690876, 0.049902530222970594, 0.0461075967754621, 0.04324056125063989, 0.047226510974585585, 0.04712159606563903, 0.044237124289980695, 0.041681675252779674, 0.04593832759342872, 0.04739491571392467, 0.048025673869436854, 0.04448078653089567, 0.04644797958258055, 0.053949360944628634, 0.04696272373655468, 0.05112460524657989, 0.04498033262363156, 0.04827486919653827, 0.04745579264067997, 0.04368085027189842, 0.04806864382088575, 0.054407678765385194, 0.04307189309432506, 0.045756435351949176, 0.04446035942159731, 0.045668542248604255, 0.05671491916018405, 0.04766320142283048, 0.04435291467294752, 0.04399336355850021, 0.05133281477800743, 0.046050925454571894, 0.047865578179910405, 0.04606498323227303, 0.044549910989670316, 0.04597157737417439, 0.04355306312285869, 0.04897046294462772, 0.04527083704363383, 0.05288192019115905, 0.04766260748861184, 0.04819401398818066, 0.04477427418284245, 0.04578573378457153, 0.04294261876744727, 0.04263159038644739, 0.04581102619236585, 0.04459259481709561, 0.04930697653186578, 0.043411115140453205, 0.046321572146284545, 0.05018501760362005, 0.044068895116761854, 0.04795873947185419, 0.05463960165293386, 0.04288360952671259, 0.04763434670197763, 0.04697875048442935, 0.04495972184366811, 0.04438877098604583, 0.04642048822354356, 0.048216829234158605, 0.04415568469069297, 0.05117711522905716, 0.04769617562070032, 0.04336563711507005, 0.051006283052528856, 0.0520271494927239, 0.04446243734643147, 0.04981359954479499, 0.04353133983220956, 0.0505726870027484, 0.04540077322995491, 0.044117813713057036, 0.043263802272700394, 0.04482850107023578, 0.04496066600567296, 0.05281507228994638, 0.043275001349032796], [0.03462739760862808, 0.044886102594633756, 0.03350905295055346, 0.03713450474424246, 0.0455842673168563, 0.04167956642889076, 0.033237991698551884, 0.03269391749476358, 0.033261924151090604, 0.04027292910698906, 0.033175365548654225, 0.033242050695844634, 0.04090054804870786, 0.0367079329987606, 0.038176094147125264, 0.037526696748410804, 0.03927281069300986, 0.03442066752175069, 0.03976544917489012, 0.03372350990468549, 0.035884527826260476, 0.04150474622934896, 0.03711401929342482, 0.04106167514665851, 0.047058774046109704, 0.045484909286715766, 0.040840856112280055, 0.032992087877595146, 0.03635208684818733, 0.03851547981755558, 0.03723727335660887, 0.041250690782203094, 0.03372699290850908, 0.03948008018424946, 0.030584322320092516, 0.03651920899375563, 0.04462935570010397, 0.03716005606105881, 0.037297446621710514, 0.04032709998366924, 0.04980780205331333, 0.03486908354352975, 0.06322414784038889, 0.04342328092332761, 0.04473764186354332, 0.035662236510421615, 0.03236510831082821, 0.04497895015900662, 0.03692660973908365, 0.03460297914934424, 0.034007351776460304, 0.037430014746711204, 0.03974696721436706, 0.035751961173792875, 0.040735643751810414, 0.03404199637528354, 0.03669465232286101, 0.035925778174635145, 0.044400450922128784, 0.032292480329224854, 0.041476381580789146, 0.034231753604650667, 0.039158386793486585, 0.03695085760924472, 0.03367258235218534, 0.03568816566132855, 0.036112448692395105, 0.038545757863918076, 0.03555105679030451, 0.032653579947112835, 0.04082349049946729, 0.033630738041799675, 0.03604528886422054, 0.03739920791283366, 0.03453784456493854, 0.056444400313872475, 0.03269161796648844, 0.0403340337288822, 0.03352218090747728, 0.03911556521509884, 0.0391643682276823, 0.0351720803139224, 0.045312111193155966, 0.049665290489892155, 0.03386001833241178, 0.03830668875852967, 0.03482476777206025, 0.03354559269514429, 0.035349067387333434, 0.04395692083514154, 0.03856594424510277, 0.03998607179947111, 0.045255300327825036, 0.041877483406094644, 0.04532058972645467, 0.045029487668923576, 0.04339734054317102, 0.042051832562676215, 0.04879510519289141, 0.047223585193462196], [0.039501782837203805, 0.04441633345159088, 0.03459293590607108, 0.0433200157113193, 0.04597479760217045, 0.04815884060654332, 0.03289872298240642, 0.03808613681064582, 0.033219255698095786, 0.04257011861478809, 0.03663868723280091, 0.039074693381457457, 0.04724543600358661, 0.036289526280813875, 0.04414637874351868, 0.034223881894454404, 0.03935589538255432, 0.030864504152234497, 0.03866486566089559, 0.03443475467471388, 0.03742272376584788, 0.03447977158606758, 0.04039172441406948, 0.0342323270907812, 0.04162641562441664, 0.0422281214244858, 0.03556566848587841, 0.036609462170274276, 0.04612066835271534, 0.038928728815867876, 0.035015716231559704, 0.034718978118637694, 0.03705135473273945, 0.03512066609903974, 0.037959615438035214, 0.03586319288310158, 0.03396794723461969, 0.03465388876640225, 0.038940986534820886, 0.034228167632629945, 0.04573764473257103, 0.03427658065334294, 0.034569261219822324, 0.036366013600000024, 0.045174415578660705, 0.032493485619043895, 0.039812424039902476, 0.03555720230320878, 0.04262508753637171, 0.034528217486682805, 0.0327567388895314, 0.035803994636206635, 0.044731485884276966, 0.03527979952403814, 0.04300824381331047, 0.034849745611559506, 0.03593431855799131, 0.03777549560916171, 0.041144268067300156, 0.04207780999026448, 0.03997991143203633, 0.03464484394983014, 0.03538204882515407, 0.03898681192540062, 0.040284968624574, 0.03368379275952636, 0.04423681728550799, 0.04081578057349034, 0.037983666956394053, 0.034710083931878626, 0.03774123358110783, 0.03437178841928199, 0.03578159978621291, 0.03447986924860966, 0.04068279174413486, 0.042275168427986475, 0.034310505059182074, 0.03411961080859363, 0.03502998976312125, 0.04086993841570853, 0.03643360112132487, 0.03712853249108974, 0.04157022114146362, 0.03817940080562053, 0.040598015630147075, 0.030455387580937934, 0.03395241279671245, 0.03468357255141507, 0.03450902632898317, 0.04062456967869956, 0.045190249508251484, 0.037117265679111534, 0.046963000393518244, 0.034449469867445195, 0.04180461055825995, 0.034174694054870614, 0.03530304974166931, 0.03999126392019518, 0.04565861335820034, 0.036827699692506294]]
    lossvec0 = [[0.05141967341150602, 0.050488375800416346, 0.04981603776427598, 0.04764752786354282, 0.05055707866938051, 0.050775369507042215, 0.05047037260382936, 0.05051120458303731, 0.04799348062043705, 0.0497507936561569, 0.04879137858100735, 0.04883946868244083, 0.045910956748735604, 0.048472072618171214, 0.04978500634403664, 0.05101606054952856, 0.05051232661176904, 0.04946272518395998, 0.04949053152654033, 0.047121897142850366, 0.050613432794927714, 0.04872340953947927, 0.04730732974375995, 0.04707379888969331, 0.05026936711418364, 0.0496259790557982, 0.05005177020260493, 0.04558164115846085, 0.04750218707405135, 0.04872077186125756, 0.049864477557876014, 0.048975390346388446, 0.04737853776354648, 0.053897053334010146, 0.04892433440314092, 0.04806983586034234, 0.049401612612163616, 0.04919975785394658, 0.051452607063234485, 0.04861894943595187, 0.04915236197730954, 0.04799461122296129, 0.051187972900031325, 0.048739577379698605, 0.04828325531103462, 0.04685464619629295, 0.04954078801178165, 0.05053827036929954, 0.04776411506228511, 0.05457268338942284, 0.0483221637988486, 0.04861589005291251, 0.05029666993229396, 0.046769460510686436, 0.04997417808215994, 0.04846030442514717, 0.04862335586728392, 0.048397593261808605, 0.0506201938145519, 0.050901545388903714, 0.04605532245901115, 0.048267323233028576, 0.05063036850021813, 0.0500902181154842, 0.04789690100561125, 0.0491534394998639, 0.04814608557898573, 0.05132696414848426, 0.04998554057448066, 0.04866477345081097, 0.04817798082532481, 0.04741883870718274, 0.04954626143276108, 0.05109931822730183, 0.04803866217672809, 0.04880241998252823, 0.051658540280846224, 0.04642040264187238, 0.047685889716944506, 0.0477681546950277, 0.047728490875300095, 0.04844515537490979, 0.04800573966185571, 0.04689480508492717, 0.04956981044342672, 0.04789963195455775, 0.050579824924073154, 0.047878593234791884, 0.04899565710765956, 0.04889107828992235, 0.04850235492334388, 0.04975680873578155, 0.05020298613341479, 0.04784143984868255, 0.04659091953814041, 0.053399696082267245, 0.04897711074096094, 0.05063872728710386, 0.04881581854084665, 0.04870321948150379]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### rateTarget=0.1, CHECK SCORE, m=0.9 ###
    # Get null first
    mScore, t = 0.9, 0.1
    scoredict = {'name': 'Check', 'slope': mScore}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_check, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Design 0']
    lossveclist = [[0.02560107724424959, 0.0269081801621786, 0.02669660522249634, 0.024729879634511596, 0.025648857312298146, 0.02621274724511835, 0.02664297823115476, 0.027534154570625254, 0.026244620566208486, 0.027881593052699803, 0.02514771882528392, 0.025895062905339265, 0.02455871777661818, 0.027156616863238704, 0.02735149824834501, 0.025705315325367052, 0.025806568293725865, 0.027597040229040144, 0.02538788033694342, 0.027420697680479774, 0.025476306009058022, 0.024608029993090273, 0.026194758004510457, 0.027466699239850206, 0.024961439325118986, 0.026921795586244086, 0.024937067089825887, 0.025422998284085577, 0.030289895527172327, 0.02808349107457011, 0.024561936943751948, 0.026968849333778293, 0.026602448626910736, 0.02829059977337076, 0.026260425878946406, 0.02850330749550472, 0.02451231559113149, 0.027845590886068625, 0.026930801182693493, 0.026330377252314557, 0.026995226987541025, 0.027451621006970028, 0.026367181127762842, 0.02452135147336047, 0.02704915553978583, 0.025228282218213424, 0.026167150545201624, 0.025108869432533893, 0.02606536486296084, 0.025287997631841128, 0.02475351964514969, 0.02647467518363552, 0.025666737801675867, 0.026643570458971793, 0.026059390440933035, 0.025298807652974674, 0.026506798949966857, 0.026024380081188316, 0.02557315791399944, 0.030009943253208392, 0.025153893658539202, 0.0253468193160923, 0.02592543622144289, 0.02641334902509686, 0.025176813756536635, 0.02755753121466075, 0.025124624251483426, 0.025992996261683138, 0.025673998569412985, 0.02581325227760266, 0.025023094332624146, 0.025532723971422838, 0.025590704181495262, 0.026040218656333953, 0.02847555279382509, 0.025378476158844056, 0.02507065180013407, 0.026501962039809663, 0.026412834010457513, 0.02826787001557972, 0.026475103538068246, 0.0245268772293418, 0.02555268533464695, 0.025034599537149413, 0.02796105479569308, 0.026286657790315953, 0.025897425065924642, 0.02705748334863733, 0.028445717798772408, 0.025602823621338675, 0.026492259689535724, 0.027023593306534886, 0.02793286214600318, 0.024594574378462016, 0.026178200371476123, 0.02710415839232178, 0.024512329588119566, 0.025541495439706432, 0.02554922103435433, 0.02540587481027131]]
    '''
    # 30 tests for all designs
    mScore, t = 0.9, 0.1
    scoredict = {'name': 'Check', 'slope': mScore}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_check, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.01812748071917698, 0.018876793914675186, 0.021257685602342084, 0.020459690876102294, 0.018852863867380384, 0.021259359113153086, 0.01897370603149916, 0.02006270285282531, 0.018984942754615344, 0.019161513263085104, 0.02057156961763707, 0.018367258638853627, 0.018965612207244156, 0.019012950586770886, 0.020236255663152944, 0.02159043028497999, 0.021729427177781452, 0.01845943894415715, 0.01796129667118211, 0.01847315012178006, 0.021987185782655558, 0.020128111378433042, 0.018726856897999064, 0.018119249103619332, 0.022808962069408443, 0.019720317415041343, 0.021404376261158334, 0.019782072468996707, 0.020560800418601352, 0.01916063110601593, 0.018792463672390475, 0.020002018930828327, 0.02033638116879233, 0.021432204328884104, 0.017783106942237874, 0.020763153199559334, 0.020866873255472977, 0.0197215178453607, 0.01984572869918766, 0.020422047090861928, 0.024283381380691867, 0.018432873144890276, 0.01821082022601273, 0.02014532316667027, 0.021521042378879033, 0.017390926800459852, 0.01964324038731639, 0.02000631406762651, 0.01900317289587959, 0.01921419218838949, 0.01814081912107971, 0.02052897627536531, 0.019653053792729348, 0.02079293942016379, 0.02012966526500114, 0.019644848565945547, 0.020332028225516104, 0.019409847856650758, 0.019276625729073214, 0.019716122091463287, 0.01889199574064096, 0.018711913763210127, 0.020131886377432802, 0.02052708335660409, 0.021994694427295243, 0.019495164563900984, 0.020613405884402865, 0.019279738338214607, 0.021381807609897763, 0.02031751065833226, 0.019083111154517468, 0.023102957135886965, 0.020845977270873138, 0.01858748022215092, 0.020758222189359576, 0.030733846177539687, 0.01952799339385963, 0.018993371578526253, 0.020919321613045265, 0.01965813249390387, 0.01996494467987496, 0.018832761137595258, 0.01892490309210201, 0.0197858633957759, 0.01949634914027642, 0.018074573901163054, 0.02026931392004915, 0.021742353765380428, 0.019031504034362417, 0.018889026583824284, 0.01970667206503646, 0.019878724491403443, 0.02819718678277317, 0.02606573117020109, 0.0202002960711448, 0.019382493316935135, 0.021178107735956412, 0.020826748653220643, 0.018710690602367557, 0.019217081385916095], [0.017242924142570053, 0.02946449288891925, 0.019194328076912105, 0.02717808342521106, 0.028335241607322727, 0.017741293452439404, 0.016177921458220692, 0.018292712799660542, 0.021276411841702245, 0.0329251761382907, 0.01921155032303231, 0.021088464717309192, 0.025027992902102534, 0.019963261915952348, 0.03146587004209414, 0.019082452506732142, 0.0240806160456614, 0.01818986040052774, 0.016453981495428757, 0.018635305791928323, 0.017670108242837906, 0.018884031912231754, 0.01659989681996534, 0.02174674633015945, 0.018221934701224213, 0.02200483931841161, 0.02437722117931706, 0.019339724267609562, 0.022322862301713264, 0.018637184546346046, 0.02764556180979337, 0.01791101000205525, 0.018407339873149426, 0.028637985079546336, 0.017626723445221894, 0.020706290361268708, 0.018704045485428193, 0.018485759615234378, 0.02134771724616014, 0.01984943740713292, 0.03169009622845424, 0.017124133318241898, 0.01791775072282249, 0.021877557857871283, 0.03139399657126762, 0.01758748440156295, 0.020858167891254133, 0.02647483937188925, 0.027101604351504157, 0.018326738601310445, 0.0175442585533922, 0.019113408596763113, 0.023692468055401254, 0.021701751907165574, 0.02606753365071215, 0.021036682194250998, 0.01903885105975377, 0.01802835515491814, 0.030591505667783327, 0.030263782633526807, 0.024831778862453486, 0.0191023602577076, 0.017692659819896452, 0.018809055602026503, 0.018544608669918267, 0.017494003244483164, 0.022795259982468737, 0.018852230902856367, 0.01856431974976075, 0.018751989170540932, 0.017609500567143947, 0.01840655332887805, 0.019259351748745324, 0.022878102930084677, 0.017994306011463946, 0.030334336848234486, 0.02199297408967497, 0.02093240009442333, 0.022401053143421938, 0.019664811600799467, 0.02922197745188414, 0.022045622721168102, 0.01802915159804679, 0.033850727724821214, 0.019181138493660925, 0.015979058796029427, 0.019255623419254932, 0.019197086361426335, 0.017131107826066555, 0.028522508249157984, 0.018102403887265896, 0.03275293765926531, 0.029095067982623627, 0.022157849219440688, 0.01699317872069141, 0.023341087183141766, 0.01826466480295264, 0.01814738598586747, 0.028556942482181248, 0.0177475371142064], [0.023542479362141017, 0.021034245833247187, 0.02694102655843221, 0.034264102096117965, 0.019164587456230377, 0.018669727984356874, 0.022412193519657685, 0.01857406920605009, 0.019977761068592025, 0.018622994390269734, 0.018743073672487818, 0.01838773767901546, 0.02126723417824426, 0.019470513056083768, 0.02191229276749173, 0.019344827769360674, 0.021603798100591303, 0.01922174811302297, 0.028802937327723942, 0.021804842795837564, 0.023495637346762542, 0.022015273621700224, 0.02202954854088322, 0.017868915910618573, 0.025039701931412583, 0.0193278586143951, 0.02439258680185718, 0.02062764300843308, 0.026521078277870324, 0.021667532730024867, 0.020108646097734002, 0.022916268427705326, 0.01947046417235299, 0.02372535890669548, 0.01993578721679329, 0.019933825180421295, 0.01926945875179087, 0.02585732892121936, 0.023621157945211642, 0.020584881962742003, 0.027627582125544715, 0.02049966100400379, 0.020420121062328545, 0.019486009001262385, 0.02554255230353879, 0.02104823597123129, 0.019308618355301503, 0.019673585224942808, 0.02110214266926285, 0.021173773322821325, 0.02148967795232418, 0.02603398660739978, 0.018772119598852027, 0.021170939734018988, 0.020773316685929192, 0.01862758889268693, 0.023312576121452138, 0.01919817019155011, 0.019340179890049138, 0.018839768628876315, 0.018365706536753415, 0.029355741049012885, 0.025039734195856953, 0.023610664360721182, 0.018485893707598292, 0.01927919767883327, 0.018918051357635614, 0.01977893296901806, 0.01990746241106252, 0.019948477884307876, 0.018615030126412437, 0.01806623379163119, 0.023071480127105425, 0.021250602455927102, 0.02221911662486828, 0.03046534811899472, 0.020591047995765294, 0.019289893447312082, 0.022370476636887748, 0.019946382477933705, 0.024052211705659087, 0.019602121567677242, 0.017003059564600045, 0.018980054942964442, 0.021276539575860984, 0.019255514320625437, 0.02304018800111426, 0.019904727246771566, 0.01867890853087338, 0.02545644621702517, 0.018900260307838947, 0.018299427751838137, 0.022872832760866324, 0.01921480934635435, 0.0186694064891724, 0.019347080289702556, 0.018864651870586762, 0.023711020850386177, 0.01952633424731314, 0.022767402994445626], [0.025698493356494594, 0.024555137662427912, 0.02377368736691741, 0.02545110690919743, 0.02722367280627243, 0.024424901951183933, 0.02539887190654805, 0.028836619181793016, 0.024457534233524866, 0.02743292453725589, 0.026070582793462336, 0.027953402771623663, 0.03206035113735102, 0.02719557797072211, 0.028465817158221, 0.025815331696502342, 0.025411958655102176, 0.022843711623814777, 0.029963531409078228, 0.02522428036469254, 0.025625351557924, 0.02432210537211289, 0.026238108607235293, 0.02803921474569685, 0.02593523858889062, 0.0260800724968954, 0.02666649377230411, 0.0247245099127456, 0.024156083229147148, 0.03046739500371631, 0.024484658083071088, 0.03253797882096315, 0.024551461482682547, 0.03010244373621906, 0.028627086333163895, 0.026008744611390962, 0.03234880268130134, 0.02597450353828824, 0.02814914516766175, 0.02459346648208009, 0.025984032328456825, 0.02613153786248958, 0.02975968915098901, 0.02752908066933788, 0.025426090848461907, 0.023998555089371702, 0.024314155946222337, 0.02860845564265384, 0.02551273240726737, 0.022579628825076345, 0.02381881382795529, 0.02693373754348185, 0.024645384150264037, 0.023841993355502904, 0.032038236285042765, 0.02496324935571206, 0.029112587598778838, 0.02384603112475982, 0.02751513776998946, 0.025055835572159863, 0.03303414360842958, 0.02728430430919463, 0.0319713610044365, 0.025845692733770107, 0.026304722186738863, 0.02722346736817596, 0.027017981860498433, 0.026420195537888772, 0.027362823745645626, 0.02850331286889141, 0.023180915221786915, 0.0254494264290577, 0.026067893232854616, 0.025203161966300396, 0.02948518481630864, 0.030809657364169032, 0.02533678394473645, 0.029404690771683593, 0.02574791274780146, 0.027418199450325142, 0.024902408831709983, 0.025864334996515317, 0.031366953404629264, 0.02625191890962083, 0.0245027955153664, 0.025935789063775673, 0.026222109082776456, 0.02496541362437069, 0.029084365087469102, 0.03011773049471874, 0.031054940376357778, 0.02386589283451919, 0.02465978551248577, 0.02833632218641387, 0.023165506691171265, 0.028252902395366604, 0.025112841392884874, 0.02609227837589042, 0.02782225204732056, 0.025567074281498372], [0.016350853304102908, 0.017384188386155755, 0.016870804159088575, 0.02372984910538565, 0.018882862579953637, 0.021582194772117487, 0.01710580474073211, 0.025639648582136538, 0.015934345953301544, 0.028207925297025847, 0.017506823138699834, 0.01796430813234792, 0.016930275545442526, 0.018666181464226956, 0.023224257966539742, 0.019076921950673457, 0.01816320643209991, 0.018118033983382974, 0.022713706951224554, 0.017065907534021874, 0.018671136405359088, 0.022723491007227124, 0.022516726006388585, 0.01853864382428405, 0.01901957258965063, 0.020244077778870898, 0.027388077859795388, 0.02026740238549639, 0.01891938665109149, 0.02307627008087928, 0.026582325926953605, 0.022517590545958685, 0.02423579607290935, 0.017681151298166366, 0.015631833913183, 0.01887987383043214, 0.028856869527520725, 0.02220302568056124, 0.01942566239067651, 0.022628097262001094, 0.025310848797970593, 0.019462484339686167, 0.023356263772518503, 0.02930966248068627, 0.030745348794722332, 0.020236788078145468, 0.0223401140058202, 0.03284581345919575, 0.028433239643870095, 0.01816351405316449, 0.017306732645515566, 0.021061859340283262, 0.019248169907533037, 0.027264615312499327, 0.025421899541187263, 0.020987802605622177, 0.018277837623851705, 0.025354880628698777, 0.027383184200177033, 0.02091865114439352, 0.029422750963084048, 0.01735882933060455, 0.02341534861406757, 0.017583421796822995, 0.019678215502731668, 0.02204714915242286, 0.02257154781507425, 0.018511153521770036, 0.020593290744795947, 0.017722243782107704, 0.018188555173651897, 0.02315138510549908, 0.02133058285683711, 0.01658201384948988, 0.020083597474429005, 0.02227627822768789, 0.018117866361597866, 0.018152536579170694, 0.025056229706093742, 0.017641701619423345, 0.019029514553202512, 0.020323571053129427, 0.02166415447676049, 0.017966016621941052, 0.018430538741738268, 0.01708106373228107, 0.018559440166808, 0.023413737885939152, 0.027151409730453536, 0.02943447366668932, 0.022524391858745284, 0.020997285249202566, 0.022515559608353032, 0.03469477010016515, 0.022271472355575223, 0.01922654829426734, 0.020649519682330458, 0.021089200095686135, 0.031301172059349465, 0.01674525159956911], [0.020809452051964453, 0.017531851246995443, 0.02270622963316592, 0.0269098107447837, 0.026660235319394286, 0.02183054967646363, 0.018369369477973813, 0.017658592726984158, 0.0213515293539821, 0.027912600236811108, 0.02166374660040715, 0.026408067468096097, 0.018702419087666924, 0.018158541910471962, 0.01884901335906671, 0.019116558746420608, 0.02298243465512765, 0.016664103986766696, 0.01790431783326161, 0.018994245091513807, 0.019766493039658325, 0.02238875336981272, 0.01969174000159229, 0.015992252693153176, 0.018187295878789353, 0.02032839628353958, 0.031866048616723465, 0.020801315829977202, 0.018092041113975915, 0.018436697660519898, 0.021000578713678515, 0.021506953711207855, 0.018679272196435736, 0.025318223420316383, 0.016237985521115227, 0.019394523023550776, 0.017896752936220266, 0.019336312228519583, 0.018198447994879813, 0.017710755576458632, 0.02806422398585089, 0.018141683797760186, 0.017360640066054863, 0.01836577063770503, 0.029065749308100332, 0.01681954510327969, 0.022492923467151916, 0.01829204723992134, 0.01845596377113216, 0.017619018193102673, 0.022173753211684657, 0.018475220833876274, 0.028155293958271137, 0.021924983916235777, 0.0278734680882656, 0.01829462676658939, 0.017530495755698306, 0.017658636523406733, 0.027385047629039264, 0.017524022202908423, 0.020012887032501193, 0.018698043611510427, 0.016724010999107117, 0.016836714597368015, 0.018382929958360716, 0.016722549320060794, 0.027435686161612842, 0.017027949476981784, 0.018745611603430717, 0.01792475818304379, 0.02519980209864064, 0.018565174099094233, 0.02098069167743456, 0.018051158710019805, 0.01829733662671937, 0.031886881769121, 0.017793861346543267, 0.017501857055468858, 0.018782972748926992, 0.026176349334652047, 0.02327153575467277, 0.02162756930538805, 0.02820677605713063, 0.018525041047710543, 0.017924548354201125, 0.016633017738457007, 0.02647435595822223, 0.018999250770189532, 0.0182685502768329, 0.023955723095328053, 0.017784888327246347, 0.02105423530726375, 0.018062929925974254, 0.01846488461299132, 0.01734557498552594, 0.018228038316912408, 0.01870298508018937, 0.026891737589681938, 0.021892412679876308, 0.01696945478315148]]
    lossvec0 = [[0.02560107724424959, 0.0269081801621786, 0.02669660522249634, 0.024729879634511596, 0.025648857312298146, 0.02621274724511835, 0.02664297823115476, 0.027534154570625254, 0.026244620566208486, 0.027881593052699803, 0.02514771882528392, 0.025895062905339265, 0.02455871777661818, 0.027156616863238704, 0.02735149824834501, 0.025705315325367052, 0.025806568293725865, 0.027597040229040144, 0.02538788033694342, 0.027420697680479774, 0.025476306009058022, 0.024608029993090273, 0.026194758004510457, 0.027466699239850206, 0.024961439325118986, 0.026921795586244086, 0.024937067089825887, 0.025422998284085577, 0.030289895527172327, 0.02808349107457011, 0.024561936943751948, 0.026968849333778293, 0.026602448626910736, 0.02829059977337076, 0.026260425878946406, 0.02850330749550472, 0.02451231559113149, 0.027845590886068625, 0.026930801182693493, 0.026330377252314557, 0.026995226987541025, 0.027451621006970028, 0.026367181127762842, 0.02452135147336047, 0.02704915553978583, 0.025228282218213424, 0.026167150545201624, 0.025108869432533893, 0.02606536486296084, 0.025287997631841128, 0.02475351964514969, 0.02647467518363552, 0.025666737801675867, 0.026643570458971793, 0.026059390440933035, 0.025298807652974674, 0.026506798949966857, 0.026024380081188316, 0.02557315791399944, 0.030009943253208392, 0.025153893658539202, 0.0253468193160923, 0.02592543622144289, 0.02641334902509686, 0.025176813756536635, 0.02755753121466075, 0.025124624251483426, 0.025992996261683138, 0.025673998569412985, 0.02581325227760266, 0.025023094332624146, 0.025532723971422838, 0.025590704181495262, 0.026040218656333953, 0.02847555279382509, 0.025378476158844056, 0.02507065180013407, 0.026501962039809663, 0.026412834010457513, 0.02826787001557972, 0.026475103538068246, 0.0245268772293418, 0.02555268533464695, 0.025034599537149413, 0.02796105479569308, 0.026286657790315953, 0.025897425065924642, 0.02705748334863733, 0.028445717798772408, 0.025602823621338675, 0.026492259689535724, 0.027023593306534886, 0.02793286214600318, 0.024594574378462016, 0.026178200371476123, 0.02710415839232178, 0.024512329588119566, 0.025541495439706432, 0.02554922103435433, 0.02540587481027131]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.4$, $n=30$')

    lossveclist = [[0.01812748071917698, 0.018876793914675186, 0.021257685602342084, 0.020459690876102294, 0.018852863867380384, 0.021259359113153086, 0.01897370603149916, 0.02006270285282531, 0.018984942754615344, 0.019161513263085104, 0.02057156961763707, 0.018367258638853627, 0.018965612207244156, 0.019012950586770886, 0.020236255663152944, 0.02159043028497999, 0.021729427177781452, 0.01845943894415715, 0.01796129667118211, 0.01847315012178006, 0.021987185782655558, 0.020128111378433042, 0.018726856897999064, 0.018119249103619332, 0.022808962069408443, 0.019720317415041343, 0.021404376261158334, 0.019782072468996707, 0.020560800418601352, 0.01916063110601593, 0.018792463672390475, 0.020002018930828327, 0.02033638116879233, 0.021432204328884104, 0.017783106942237874, 0.020763153199559334, 0.020866873255472977, 0.0197215178453607, 0.01984572869918766, 0.020422047090861928, 0.024283381380691867, 0.018432873144890276, 0.01821082022601273, 0.02014532316667027, 0.021521042378879033, 0.017390926800459852, 0.01964324038731639, 0.02000631406762651, 0.01900317289587959, 0.01921419218838949, 0.01814081912107971, 0.02052897627536531, 0.019653053792729348, 0.02079293942016379, 0.02012966526500114, 0.019644848565945547, 0.020332028225516104, 0.019409847856650758, 0.019276625729073214, 0.019716122091463287, 0.01889199574064096, 0.018711913763210127, 0.020131886377432802, 0.02052708335660409, 0.021994694427295243, 0.019495164563900984, 0.020613405884402865, 0.019279738338214607, 0.021381807609897763, 0.02031751065833226, 0.019083111154517468, 0.023102957135886965, 0.020845977270873138, 0.01858748022215092, 0.020758222189359576, 0.030733846177539687, 0.01952799339385963, 0.018993371578526253, 0.020919321613045265, 0.01965813249390387, 0.01996494467987496, 0.018832761137595258, 0.01892490309210201, 0.0197858633957759, 0.01949634914027642, 0.018074573901163054, 0.02026931392004915, 0.021742353765380428, 0.019031504034362417, 0.018889026583824284, 0.01970667206503646, 0.019878724491403443, 0.02819718678277317, 0.02606573117020109, 0.0202002960711448, 0.019382493316935135, 0.021178107735956412, 0.020826748653220643, 0.018710690602367557, 0.019217081385916095], [0.017242924142570053, 0.02946449288891925, 0.019194328076912105, 0.02717808342521106, 0.028335241607322727, 0.017741293452439404, 0.016177921458220692, 0.018292712799660542, 0.021276411841702245, 0.0329251761382907, 0.01921155032303231, 0.021088464717309192, 0.025027992902102534, 0.019963261915952348, 0.03146587004209414, 0.019082452506732142, 0.0240806160456614, 0.01818986040052774, 0.016453981495428757, 0.018635305791928323, 0.017670108242837906, 0.018884031912231754, 0.01659989681996534, 0.02174674633015945, 0.018221934701224213, 0.02200483931841161, 0.02437722117931706, 0.019339724267609562, 0.022322862301713264, 0.018637184546346046, 0.02764556180979337, 0.01791101000205525, 0.018407339873149426, 0.028637985079546336, 0.017626723445221894, 0.020706290361268708, 0.018704045485428193, 0.018485759615234378, 0.02134771724616014, 0.01984943740713292, 0.03169009622845424, 0.017124133318241898, 0.01791775072282249, 0.021877557857871283, 0.03139399657126762, 0.01758748440156295, 0.020858167891254133, 0.02647483937188925, 0.027101604351504157, 0.018326738601310445, 0.0175442585533922, 0.019113408596763113, 0.023692468055401254, 0.021701751907165574, 0.02606753365071215, 0.021036682194250998, 0.01903885105975377, 0.01802835515491814, 0.030591505667783327, 0.030263782633526807, 0.024831778862453486, 0.0191023602577076, 0.017692659819896452, 0.018809055602026503, 0.018544608669918267, 0.017494003244483164, 0.022795259982468737, 0.018852230902856367, 0.01856431974976075, 0.018751989170540932, 0.017609500567143947, 0.01840655332887805, 0.019259351748745324, 0.022878102930084677, 0.017994306011463946, 0.030334336848234486, 0.02199297408967497, 0.02093240009442333, 0.022401053143421938, 0.019664811600799467, 0.02922197745188414, 0.022045622721168102, 0.01802915159804679, 0.033850727724821214, 0.019181138493660925, 0.015979058796029427, 0.019255623419254932, 0.019197086361426335, 0.017131107826066555, 0.028522508249157984, 0.018102403887265896, 0.03275293765926531, 0.029095067982623627, 0.022157849219440688, 0.01699317872069141, 0.023341087183141766, 0.01826466480295264, 0.01814738598586747, 0.028556942482181248, 0.0177475371142064], [0.023542479362141017, 0.021034245833247187, 0.02694102655843221, 0.034264102096117965, 0.019164587456230377, 0.018669727984356874, 0.022412193519657685, 0.01857406920605009, 0.019977761068592025, 0.018622994390269734, 0.018743073672487818, 0.01838773767901546, 0.02126723417824426, 0.019470513056083768, 0.02191229276749173, 0.019344827769360674, 0.021603798100591303, 0.01922174811302297, 0.028802937327723942, 0.021804842795837564, 0.023495637346762542, 0.022015273621700224, 0.02202954854088322, 0.017868915910618573, 0.025039701931412583, 0.0193278586143951, 0.02439258680185718, 0.02062764300843308, 0.026521078277870324, 0.021667532730024867, 0.020108646097734002, 0.022916268427705326, 0.01947046417235299, 0.02372535890669548, 0.01993578721679329, 0.019933825180421295, 0.01926945875179087, 0.02585732892121936, 0.023621157945211642, 0.020584881962742003, 0.027627582125544715, 0.02049966100400379, 0.020420121062328545, 0.019486009001262385, 0.02554255230353879, 0.02104823597123129, 0.019308618355301503, 0.019673585224942808, 0.02110214266926285, 0.021173773322821325, 0.02148967795232418, 0.02603398660739978, 0.018772119598852027, 0.021170939734018988, 0.020773316685929192, 0.01862758889268693, 0.023312576121452138, 0.01919817019155011, 0.019340179890049138, 0.018839768628876315, 0.018365706536753415, 0.029355741049012885, 0.025039734195856953, 0.023610664360721182, 0.018485893707598292, 0.01927919767883327, 0.018918051357635614, 0.01977893296901806, 0.01990746241106252, 0.019948477884307876, 0.018615030126412437, 0.01806623379163119, 0.023071480127105425, 0.021250602455927102, 0.02221911662486828, 0.03046534811899472, 0.020591047995765294, 0.019289893447312082, 0.022370476636887748, 0.019946382477933705, 0.024052211705659087, 0.019602121567677242, 0.017003059564600045, 0.018980054942964442, 0.021276539575860984, 0.019255514320625437, 0.02304018800111426, 0.019904727246771566, 0.01867890853087338, 0.02545644621702517, 0.018900260307838947, 0.018299427751838137, 0.022872832760866324, 0.01921480934635435, 0.0186694064891724, 0.019347080289702556, 0.018864651870586762, 0.023711020850386177, 0.01952633424731314, 0.022767402994445626], [0.025698493356494594, 0.024555137662427912, 0.02377368736691741, 0.02545110690919743, 0.02722367280627243, 0.024424901951183933, 0.02539887190654805, 0.028836619181793016, 0.024457534233524866, 0.02743292453725589, 0.026070582793462336, 0.027953402771623663, 0.03206035113735102, 0.02719557797072211, 0.028465817158221, 0.025815331696502342, 0.025411958655102176, 0.022843711623814777, 0.029963531409078228, 0.02522428036469254, 0.025625351557924, 0.02432210537211289, 0.026238108607235293, 0.02803921474569685, 0.02593523858889062, 0.0260800724968954, 0.02666649377230411, 0.0247245099127456, 0.024156083229147148, 0.03046739500371631, 0.024484658083071088, 0.03253797882096315, 0.024551461482682547, 0.03010244373621906, 0.028627086333163895, 0.026008744611390962, 0.03234880268130134, 0.02597450353828824, 0.02814914516766175, 0.02459346648208009, 0.025984032328456825, 0.02613153786248958, 0.02975968915098901, 0.02752908066933788, 0.025426090848461907, 0.023998555089371702, 0.024314155946222337, 0.02860845564265384, 0.02551273240726737, 0.022579628825076345, 0.02381881382795529, 0.02693373754348185, 0.024645384150264037, 0.023841993355502904, 0.032038236285042765, 0.02496324935571206, 0.029112587598778838, 0.02384603112475982, 0.02751513776998946, 0.025055835572159863, 0.03303414360842958, 0.02728430430919463, 0.0319713610044365, 0.025845692733770107, 0.026304722186738863, 0.02722346736817596, 0.027017981860498433, 0.026420195537888772, 0.027362823745645626, 0.02850331286889141, 0.023180915221786915, 0.0254494264290577, 0.026067893232854616, 0.025203161966300396, 0.02948518481630864, 0.030809657364169032, 0.02533678394473645, 0.029404690771683593, 0.02574791274780146, 0.027418199450325142, 0.024902408831709983, 0.025864334996515317, 0.031366953404629264, 0.02625191890962083, 0.0245027955153664, 0.025935789063775673, 0.026222109082776456, 0.02496541362437069, 0.029084365087469102, 0.03011773049471874, 0.031054940376357778, 0.02386589283451919, 0.02465978551248577, 0.02833632218641387, 0.023165506691171265, 0.028252902395366604, 0.025112841392884874, 0.02609227837589042, 0.02782225204732056, 0.025567074281498372], [0.016350853304102908, 0.017384188386155755, 0.016870804159088575, 0.02372984910538565, 0.018882862579953637, 0.021582194772117487, 0.01710580474073211, 0.025639648582136538, 0.015934345953301544, 0.028207925297025847, 0.017506823138699834, 0.01796430813234792, 0.016930275545442526, 0.018666181464226956, 0.023224257966539742, 0.019076921950673457, 0.01816320643209991, 0.018118033983382974, 0.022713706951224554, 0.017065907534021874, 0.018671136405359088, 0.022723491007227124, 0.022516726006388585, 0.01853864382428405, 0.01901957258965063, 0.020244077778870898, 0.027388077859795388, 0.02026740238549639, 0.01891938665109149, 0.02307627008087928, 0.026582325926953605, 0.022517590545958685, 0.02423579607290935, 0.017681151298166366, 0.015631833913183, 0.01887987383043214, 0.028856869527520725, 0.02220302568056124, 0.01942566239067651, 0.022628097262001094, 0.025310848797970593, 0.019462484339686167, 0.023356263772518503, 0.02930966248068627, 0.030745348794722332, 0.020236788078145468, 0.0223401140058202, 0.03284581345919575, 0.028433239643870095, 0.01816351405316449, 0.017306732645515566, 0.021061859340283262, 0.019248169907533037, 0.027264615312499327, 0.025421899541187263, 0.020987802605622177, 0.018277837623851705, 0.025354880628698777, 0.027383184200177033, 0.02091865114439352, 0.029422750963084048, 0.01735882933060455, 0.02341534861406757, 0.017583421796822995, 0.019678215502731668, 0.02204714915242286, 0.02257154781507425, 0.018511153521770036, 0.020593290744795947, 0.017722243782107704, 0.018188555173651897, 0.02315138510549908, 0.02133058285683711, 0.01658201384948988, 0.020083597474429005, 0.02227627822768789, 0.018117866361597866, 0.018152536579170694, 0.025056229706093742, 0.017641701619423345, 0.019029514553202512, 0.020323571053129427, 0.02166415447676049, 0.017966016621941052, 0.018430538741738268, 0.01708106373228107, 0.018559440166808, 0.023413737885939152, 0.027151409730453536, 0.02943447366668932, 0.022524391858745284, 0.020997285249202566, 0.022515559608353032, 0.03469477010016515, 0.022271472355575223, 0.01922654829426734, 0.020649519682330458, 0.021089200095686135, 0.031301172059349465, 0.01674525159956911], [0.020809452051964453, 0.017531851246995443, 0.02270622963316592, 0.0269098107447837, 0.026660235319394286, 0.02183054967646363, 0.018369369477973813, 0.017658592726984158, 0.0213515293539821, 0.027912600236811108, 0.02166374660040715, 0.026408067468096097, 0.018702419087666924, 0.018158541910471962, 0.01884901335906671, 0.019116558746420608, 0.02298243465512765, 0.016664103986766696, 0.01790431783326161, 0.018994245091513807, 0.019766493039658325, 0.02238875336981272, 0.01969174000159229, 0.015992252693153176, 0.018187295878789353, 0.02032839628353958, 0.031866048616723465, 0.020801315829977202, 0.018092041113975915, 0.018436697660519898, 0.021000578713678515, 0.021506953711207855, 0.018679272196435736, 0.025318223420316383, 0.016237985521115227, 0.019394523023550776, 0.017896752936220266, 0.019336312228519583, 0.018198447994879813, 0.017710755576458632, 0.02806422398585089, 0.018141683797760186, 0.017360640066054863, 0.01836577063770503, 0.029065749308100332, 0.01681954510327969, 0.022492923467151916, 0.01829204723992134, 0.01845596377113216, 0.017619018193102673, 0.022173753211684657, 0.018475220833876274, 0.028155293958271137, 0.021924983916235777, 0.0278734680882656, 0.01829462676658939, 0.017530495755698306, 0.017658636523406733, 0.027385047629039264, 0.017524022202908423, 0.020012887032501193, 0.018698043611510427, 0.016724010999107117, 0.016836714597368015, 0.018382929958360716, 0.016722549320060794, 0.027435686161612842, 0.017027949476981784, 0.018745611603430717, 0.01792475818304379, 0.02519980209864064, 0.018565174099094233, 0.02098069167743456, 0.018051158710019805, 0.01829733662671937, 0.031886881769121, 0.017793861346543267, 0.017501857055468858, 0.018782972748926992, 0.026176349334652047, 0.02327153575467277, 0.02162756930538805, 0.02820677605713063, 0.018525041047710543, 0.017924548354201125, 0.016633017738457007, 0.02647435595822223, 0.018999250770189532, 0.0182685502768329, 0.023955723095328053, 0.017784888327246347, 0.02105423530726375, 0.018062929925974254, 0.01846488461299132, 0.01734557498552594, 0.018228038316912408, 0.01870298508018937, 0.026891737589681938, 0.021892412679876308, 0.01696945478315148]]
    lossvec0 = [[0.02560107724424959, 0.0269081801621786, 0.02669660522249634, 0.024729879634511596, 0.025648857312298146, 0.02621274724511835, 0.02664297823115476, 0.027534154570625254, 0.026244620566208486, 0.027881593052699803, 0.02514771882528392, 0.025895062905339265, 0.02455871777661818, 0.027156616863238704, 0.02735149824834501, 0.025705315325367052, 0.025806568293725865, 0.027597040229040144, 0.02538788033694342, 0.027420697680479774, 0.025476306009058022, 0.024608029993090273, 0.026194758004510457, 0.027466699239850206, 0.024961439325118986, 0.026921795586244086, 0.024937067089825887, 0.025422998284085577, 0.030289895527172327, 0.02808349107457011, 0.024561936943751948, 0.026968849333778293, 0.026602448626910736, 0.02829059977337076, 0.026260425878946406, 0.02850330749550472, 0.02451231559113149, 0.027845590886068625, 0.026930801182693493, 0.026330377252314557, 0.026995226987541025, 0.027451621006970028, 0.026367181127762842, 0.02452135147336047, 0.02704915553978583, 0.025228282218213424, 0.026167150545201624, 0.025108869432533893, 0.02606536486296084, 0.025287997631841128, 0.02475351964514969, 0.02647467518363552, 0.025666737801675867, 0.026643570458971793, 0.026059390440933035, 0.025298807652974674, 0.026506798949966857, 0.026024380081188316, 0.02557315791399944, 0.030009943253208392, 0.025153893658539202, 0.0253468193160923, 0.02592543622144289, 0.02641334902509686, 0.025176813756536635, 0.02755753121466075, 0.025124624251483426, 0.025992996261683138, 0.025673998569412985, 0.02581325227760266, 0.025023094332624146, 0.025532723971422838, 0.025590704181495262, 0.026040218656333953, 0.02847555279382509, 0.025378476158844056, 0.02507065180013407, 0.026501962039809663, 0.026412834010457513, 0.02826787001557972, 0.026475103538068246, 0.0245268772293418, 0.02555268533464695, 0.025034599537149413, 0.02796105479569308, 0.026286657790315953, 0.025897425065924642, 0.02705748334863733, 0.028445717798772408, 0.025602823621338675, 0.026492259689535724, 0.027023593306534886, 0.02793286214600318, 0.024594574378462016, 0.026178200371476123, 0.02710415839232178, 0.024512329588119566, 0.025541495439706432, 0.02554922103435433, 0.02540587481027131]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### underEstWt=1., CHECK RISK, m=0.1 ###
    # Get null first
    underWt, mRisk = 1., 0.1
    t = 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t, 'slope': mRisk}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_check, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 09-AUG-22
    designNames = ['Design 0']
    lossveclist = [[0.20818351333430446, 0.19981285653588504, 0.20510718595284982, 0.20984635247607544, 0.2034003249549822, 0.21024687557633845, 0.21078277725917077, 0.20653370198423912, 0.21013932241578603, 0.20505582112496656, 0.19698161102331044, 0.19550270268205727, 0.20498398521223687, 0.2004045472147817, 0.1938799390627333, 0.21772568431732175, 0.2083464340948261, 0.21312427103457943, 0.20674441400411894, 0.20197090673753015, 0.19674417388980864, 0.20320873715142776, 0.20001795522201402, 0.19731847013024467, 0.19853312040101412, 0.20129907350618043, 0.20838641921522089, 0.19830498772912775, 0.19879061907507514, 0.2035717258104826, 0.2071246318183616, 0.19911613689133936, 0.20837133964626825, 0.20733400082767026, 0.1996090026481862, 0.21174315412005834, 0.20255750876325515, 0.20502087246770231, 0.20067829356497618, 0.19911627064069187, 0.20702832251436945, 0.19062101256686145, 0.20061988655929894, 0.20834205780624665, 0.2084570714048183, 0.20801329073256525, 0.1997740355226297, 0.20237710448742754, 0.2006843667433806, 0.18904631172160938, 0.18869161011054442, 0.20306350078420582, 0.20086275950573393, 0.19911989150292886, 0.20728355930120665, 0.20825225333936473, 0.20277188661312381, 0.19901486402762184, 0.19576125972752062, 0.2003416781983626, 0.20685900926340084, 0.20535431418632566, 0.20014654589662578, 0.19353750842864006, 0.20862085650120285, 0.19620696021568787, 0.2171938959481364, 0.20043573679795187, 0.20652926543952865, 0.21575306577144276, 0.20894506769395718, 0.21674504563265906, 0.19200237127934186, 0.192631343530857, 0.20276170950880298, 0.20117767984285972, 0.20228917232107702, 0.19913795365197445, 0.2053118917034573, 0.2041415103259663, 0.1988746636985184, 0.2060420797280611, 0.2156591816397663, 0.2051412500684295, 0.19190375324465064, 0.21039661234083334, 0.20799739772136383, 0.20549524103215222, 0.21305080974941387, 0.2058906120337652, 0.2089697343776439, 0.19586999330899366, 0.19757790116004362, 0.21739047753762414, 0.20433306212483993, 0.19943430194574346, 0.2024540919495018, 0.2032482493316871, 0.1982019813597425, 0.2090213243106029]]
    '''
    # 30 tests for all designs
    underWt, mRisk = 1., 0.1
    t = 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t, 'slope': mRisk}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_check, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 09-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.16128046324006215, 0.1534955735864618, 0.1598244433572646, 0.16572487053029172, 0.16055013431802773, 0.17135385959145977, 0.15588520712339546, 0.17500900693927607, 0.1589642565332563, 0.1515644536704604, 0.15743614700622485, 0.15485572185840935, 0.15005821471524342, 0.16582094550483328, 0.16358095488872104, 0.17960980398260118, 0.156900798444042, 0.15974218400785706, 0.15230225966856248, 0.17011169503266826, 0.16761487680179435, 0.16227610021737018, 0.15756673429837378, 0.15871624665458128, 0.17954688863159887, 0.15509719857139567, 0.23193256445769161, 0.1591611175334134, 0.1856332455115818, 0.15172290660022889, 0.15386788369396712, 0.14735925906701755, 0.15493887188492927, 0.16457670732931684, 0.15410631780253203, 0.1592712993123911, 0.170780059844864, 0.15516752148515717, 0.16121575826541895, 0.16896550536819824, 0.2422280476498597, 0.15866687668660148, 0.16962434514474634, 0.1682979306352954, 0.16205167385249578, 0.14998479375706847, 0.16465277393790018, 0.1488852234705307, 0.1678966997728805, 0.1721145101823836, 0.15483092674528373, 0.15596291070580576, 0.15794974166055242, 0.166333956788314, 0.17369156838060085, 0.16809659933021928, 0.15845941519837967, 0.15692826305176366, 0.1678677391820066, 0.1588580553619429, 0.15141658138571729, 0.1660340292101784, 0.20939979379586096, 0.1596538513664725, 0.17337490192227517, 0.1574009044194363, 0.16031471237713246, 0.15670645860698895, 0.18390196028852399, 0.1532174968450483, 0.15600272569873505, 0.15709720647781478, 0.18868659978262517, 0.158754481363829, 0.17075271799360053, 0.21404889749015968, 0.16896697721633977, 0.15897110871701042, 0.15346351609962988, 0.17770169165711985, 0.1682159521940313, 0.165527211422002, 0.15709065048740437, 0.15829519602284908, 0.16108712309131232, 0.157800929578829, 0.19904283442843207, 0.19557548076812456, 0.16139829107802156, 0.17496450758604443, 0.16193900699079028, 0.1623900835334086, 0.18145775317578164, 0.1637968482599369, 0.15663488295242137, 0.15958879606269727, 0.19508899552830233, 0.20380839420333444, 0.1579234259416651, 0.15521008129785727], [0.1359039100546709, 0.1502435185916458, 0.14473285562372326, 0.198239335465382, 0.16560881968320923, 0.1722037983905823, 0.14528156482720386, 0.14325371508384804, 0.14970926838553908, 0.1913227761898451, 0.1479207278652812, 0.1317063902178966, 0.17043461039052632, 0.1474351440472262, 0.17732861798643923, 0.17139965192347648, 0.1410474347333284, 0.13651853832329058, 0.16295934962178427, 0.16481649537975773, 0.143264829208327, 0.21439035670671988, 0.19310924612208413, 0.1440843768304938, 0.13638844107243875, 0.22242251457446602, 0.17251307984845424, 0.1717870154482948, 0.19214676979145434, 0.14526571095748775, 0.168172360576851, 0.13746950365184024, 0.16726495743992031, 0.14148763103645912, 0.14255273664025803, 0.1754471080274901, 0.14100246230390884, 0.1459086968041366, 0.171619984947047, 0.1460723494861141, 0.1985336400955749, 0.13865034711408972, 0.1402611882768604, 0.1867858679116178, 0.2078522949563755, 0.1415433074208529, 0.18654689535456925, 0.17560551383772552, 0.20365317450806258, 0.16415497532490864, 0.14914208747462832, 0.13780750913632142, 0.19669850045090378, 0.17238512843722315, 0.15949659074884293, 0.18395493670197172, 0.1422570229100149, 0.1623704982671745, 0.2045225946392991, 0.1704201190494518, 0.1452678903392349, 0.1384966938475233, 0.14062205533219607, 0.13810356693256604, 0.16458795066014187, 0.1605313489505847, 0.19483231812935595, 0.1676984333096826, 0.14092224535535913, 0.13705587127069171, 0.16437297670897574, 0.13839033232645037, 0.17086132550729852, 0.1494164540539857, 0.23784976846399675, 0.2002602533634236, 0.16516768838834045, 0.1785209107343623, 0.14304615973961432, 0.19653921191419152, 0.17112291326002113, 0.1411109999574424, 0.136522496662072, 0.18638575453702294, 0.14504671354926665, 0.14280112676060905, 0.14748974336182538, 0.1427846098254798, 0.13830041951183722, 0.2051075135770645, 0.22714559216498847, 0.14375751278812507, 0.2041956495246469, 0.1485405626645498, 0.14211092665258485, 0.1437789834128651, 0.151424016377492, 0.16617527979907276, 0.1709283808219253, 0.13926124620926436], [0.15157911682667888, 0.1865326575438386, 0.17385267833861773, 0.18989837387616765, 0.16011899811105682, 0.1463139134010669, 0.1748952933284981, 0.1595955824335415, 0.14753475956469295, 0.15972602432896474, 0.16638432431698255, 0.14970865174457945, 0.1597254036470066, 0.15085598574960066, 0.15061562350071103, 0.16084189009376346, 0.1711837249783019, 0.15638663062985456, 0.14468740219506868, 0.16691602791878954, 0.15095269072890152, 0.16880667048501846, 0.15241256793202398, 0.16326657212359902, 0.16235261045298746, 0.17008045533079724, 0.17510135259240558, 0.1682960834616401, 0.1857432828028751, 0.1674150661735411, 0.16196395513714523, 0.16191727647577706, 0.17439502119746936, 0.1613572016315564, 0.16427963526067058, 0.1437949485645752, 0.14505023193682307, 0.15504048519043867, 0.15143828118262523, 0.1854701999331783, 0.20230334464658178, 0.1589602604847931, 0.14593590571843432, 0.1898961481487456, 0.18509488450920075, 0.14810456059607868, 0.15822653229080477, 0.16095209626006532, 0.16305830333054133, 0.15495010518323235, 0.1613522226206439, 0.15890694362822885, 0.20617893535840745, 0.1900877430615602, 0.16778086022499664, 0.166402130202129, 0.15683492216281597, 0.19837994730847291, 0.16763184987473795, 0.16849642821131522, 0.16512991959475398, 0.15447151153070443, 0.1968640017595128, 0.16441808854623136, 0.17360001817119328, 0.16177261411199084, 0.16636833831149644, 0.16369762891292594, 0.15337039998032326, 0.1606852337816176, 0.16625655414494037, 0.15718964494127854, 0.15573027887167815, 0.17266396261860387, 0.19653782027896904, 0.20713474742974058, 0.1835464607039273, 0.15905293831711872, 0.1777482711794229, 0.17496871999387464, 0.1558802252836892, 0.14949915140110745, 0.16266443812325435, 0.15946064627290701, 0.17522445128978006, 0.15776928876572108, 0.16474770810893422, 0.16515620484076046, 0.16212670992934577, 0.1517940602686054, 0.16148400329317952, 0.15818292750565993, 0.18091831545501022, 0.15663624828538655, 0.17041273340554522, 0.165128057319708, 0.17041614834282057, 0.19482511861626708, 0.15747166189471107, 0.14306343025369256], [0.18811908558518164, 0.21934862066327498, 0.19510939109092362, 0.20199901232590353, 0.22088504690011132, 0.19457005030345362, 0.18864037580731047, 0.1998949779592681, 0.1848202341540553, 0.1880914388275318, 0.19599061976594193, 0.2112468406640609, 0.19639583502265281, 0.18334492587618667, 0.18366524353671992, 0.2110376531243332, 0.2045190053957147, 0.18833821063623066, 0.21862683595598273, 0.18948037547724794, 0.1954554031359344, 0.18426963187329304, 0.21652527178910788, 0.1861301438716434, 0.17197580041974989, 0.1866882817708748, 0.19050141185040975, 0.22202675277554054, 0.183735946077554, 0.20695089476014009, 0.1965052498421009, 0.21727182258808228, 0.20537226074138018, 0.18725936485545888, 0.2110014594597231, 0.17718960877763326, 0.219786730809935, 0.20026892552857492, 0.21706150250045161, 0.1848561437314398, 0.18228988365021764, 0.20848733247625115, 0.24481225792843592, 0.17604608673185343, 0.17594777317379942, 0.18438187955470256, 0.1967962384308554, 0.24282414783423062, 0.20092062008327077, 0.19292167189266846, 0.1875971733988719, 0.2187936584094861, 0.21568688244593248, 0.1839977880731962, 0.20393564755596327, 0.18814355116993622, 0.20880103488402263, 0.18844519316798297, 0.19323061727869165, 0.18687253013282112, 0.2380694761950305, 0.18857155131856054, 0.23274177879374583, 0.1835506351501335, 0.20071786641834144, 0.19563424738300625, 0.1915047793587807, 0.21894545874144686, 0.18088862100151665, 0.18377694592140534, 0.2054506135652157, 0.19667462656145687, 0.20759516872388736, 0.19558112827081328, 0.2062451946383479, 0.1881499710091324, 0.18686045062624462, 0.22716578616469815, 0.19322067238682816, 0.19953223038109527, 0.19344906685388277, 0.21176738363544845, 0.19344426143338858, 0.19756744151936861, 0.21890570975749085, 0.18296170932344571, 0.18359437566815842, 0.20040403393326284, 0.2250244269672026, 0.20950670454764708, 0.19278834116775026, 0.20407801333741335, 0.1940827910687393, 0.167995074462947, 0.19995532968480512, 0.21268001996522481, 0.18904035093038812, 0.2040606618612378, 0.19911989370456956, 0.19012533083682398], [0.15827257507729528, 0.15582113551088228, 0.15559392793025878, 0.20239374058904572, 0.13743835483564723, 0.20818507029313266, 0.18493431036923297, 0.16697071520873427, 0.15499209714859133, 0.1749134526125417, 0.14949183712601058, 0.1347274887040455, 0.21793032118482658, 0.17077206096619052, 0.13822357313343286, 0.1400068481258136, 0.19537820231656244, 0.1637504016776044, 0.21200782824583794, 0.16732016434227895, 0.14628094326542487, 0.14633288449435253, 0.17353219591962363, 0.1540949006275829, 0.18903064547081896, 0.13883577426404345, 0.17490376307867375, 0.17371732295507403, 0.2012982890456049, 0.135164569627142, 0.13937496756766665, 0.16654832758340535, 0.15908998146428996, 0.15801955110390903, 0.1329773044384674, 0.16871632194520136, 0.1741987485605136, 0.1444389467613179, 0.16046847039248183, 0.13697185192598516, 0.29381257228895075, 0.15670878203454613, 0.2066972989283294, 0.1441221859962293, 0.2936433572550496, 0.16946974388362326, 0.16660587754021355, 0.1589795825441841, 0.18693053852437608, 0.14002177123084483, 0.1427620091729178, 0.13642241440308345, 0.18902558750393625, 0.133122651248456, 0.18777441591793234, 0.15719478598503545, 0.17096735724675768, 0.17225769752391037, 0.16475106377477913, 0.16569348645969656, 0.1727218175691204, 0.14073708353666411, 0.14823111808136047, 0.14348332761650923, 0.14071030456691916, 0.20975917814393522, 0.1978949487587753, 0.1433398206058781, 0.14701780125731023, 0.14493229046552103, 0.1429478566974774, 0.15885490272572123, 0.15102188321054416, 0.16326340845000845, 0.14409286004764996, 0.23230357189168568, 0.1402564305803771, 0.15723135769532415, 0.1647395684115326, 0.1816716247914323, 0.1802294355872763, 0.16147569020320576, 0.17891811872381375, 0.1954627802811629, 0.14461955469985172, 0.14209663109079504, 0.14319440186007615, 0.1735984254033426, 0.18126496400954295, 0.18617884494849374, 0.20885213879460998, 0.1685752430244811, 0.1884629472976591, 0.18101873479529546, 0.21191991184213513, 0.1510864101460429, 0.14463154470267608, 0.15100180125708915, 0.18003068417388635, 0.18450409234789622], [0.19263272104007997, 0.14100710750742584, 0.14407029338073232, 0.1682440880750341, 0.16387620113386192, 0.13878197805810727, 0.1340086266643323, 0.1373052697627711, 0.1382017455657353, 0.20421473594720624, 0.13980272263690643, 0.19206437288830105, 0.2817464463639736, 0.1413458520970173, 0.19031046867053003, 0.1804596028474243, 0.16791767699934454, 0.1388888804912433, 0.179038756604695, 0.13993756801613108, 0.1448179722323464, 0.1722392148016903, 0.19277383151751437, 0.1376985653049388, 0.14551524954396475, 0.13332366419437722, 0.17022903525040048, 0.16697807262856426, 0.18428281426933105, 0.143742501316644, 0.14746930371177291, 0.16688853488255792, 0.13960881277544576, 0.1459550285485862, 0.13349547108599527, 0.14108609382926948, 0.17168230516685007, 0.14340940722485312, 0.13397529972175173, 0.14321219096062815, 0.23517895232938488, 0.14142332457196646, 0.13950269965068288, 0.2425009168725944, 0.2918700343430081, 0.135343230655926, 0.18581311226584254, 0.13553834406366794, 0.1416049410248834, 0.13744530201112576, 0.13506005731575527, 0.18408159284028439, 0.21534102657950407, 0.14378145462660025, 0.17408065150838942, 0.14395829317921513, 0.14149810944905197, 0.1463693545956684, 0.1905600510479834, 0.1924226360234655, 0.1341140498912619, 0.1384883150658107, 0.15963800665167985, 0.14327704915869494, 0.13649155377093636, 0.13671628486718526, 0.16261198901129365, 0.18124573220115456, 0.1495324082863124, 0.18553816470914378, 0.14270918157346374, 0.14370186833369114, 0.17578649073012947, 0.16275475144200818, 0.13514783781218534, 0.1802117249748641, 0.14466751418402238, 0.17316518675538725, 0.13790059064639007, 0.17835782700918498, 0.14695323723064782, 0.14002262868082146, 0.1697708648732214, 0.1951583827169044, 0.13724547964199718, 0.13528916216086645, 0.17414800842275782, 0.1430114581483038, 0.1421848534237272, 0.14002973471219923, 0.18919812802445066, 0.15934151199906063, 0.16610785047874965, 0.14536349384756642, 0.18964478210377825, 0.15365322419369917, 0.15769508095641097, 0.17030517813398593, 0.12982198892592878, 0.15177372485459611]]
    lossvec0 = [[0.20818351333430446, 0.19981285653588504, 0.20510718595284982, 0.20984635247607544, 0.2034003249549822, 0.21024687557633845, 0.21078277725917077, 0.20653370198423912, 0.21013932241578603, 0.20505582112496656, 0.19698161102331044, 0.19550270268205727, 0.20498398521223687, 0.2004045472147817, 0.1938799390627333, 0.21772568431732175, 0.2083464340948261, 0.21312427103457943, 0.20674441400411894, 0.20197090673753015, 0.19674417388980864, 0.20320873715142776, 0.20001795522201402, 0.19731847013024467, 0.19853312040101412, 0.20129907350618043, 0.20838641921522089, 0.19830498772912775, 0.19879061907507514, 0.2035717258104826, 0.2071246318183616, 0.19911613689133936, 0.20837133964626825, 0.20733400082767026, 0.1996090026481862, 0.21174315412005834, 0.20255750876325515, 0.20502087246770231, 0.20067829356497618, 0.19911627064069187, 0.20702832251436945, 0.19062101256686145, 0.20061988655929894, 0.20834205780624665, 0.2084570714048183, 0.20801329073256525, 0.1997740355226297, 0.20237710448742754, 0.2006843667433806, 0.18904631172160938, 0.18869161011054442, 0.20306350078420582, 0.20086275950573393, 0.19911989150292886, 0.20728355930120665, 0.20825225333936473, 0.20277188661312381, 0.19901486402762184, 0.19576125972752062, 0.2003416781983626, 0.20685900926340084, 0.20535431418632566, 0.20014654589662578, 0.19353750842864006, 0.20862085650120285, 0.19620696021568787, 0.2171938959481364, 0.20043573679795187, 0.20652926543952865, 0.21575306577144276, 0.20894506769395718, 0.21674504563265906, 0.19200237127934186, 0.192631343530857, 0.20276170950880298, 0.20117767984285972, 0.20228917232107702, 0.19913795365197445, 0.2053118917034573, 0.2041415103259663, 0.1988746636985184, 0.2060420797280611, 0.2156591816397663, 0.2051412500684295, 0.19190375324465064, 0.21039661234083334, 0.20799739772136383, 0.20549524103215222, 0.21305080974941387, 0.2058906120337652, 0.2089697343776439, 0.19586999330899366, 0.19757790116004362, 0.21739047753762414, 0.20433306212483993, 0.19943430194574346, 0.2024540919495018, 0.2032482493316871, 0.1982019813597425, 0.2090213243106029]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.4$, $n=30$')

    lossveclist = [[0.16128046324006215, 0.1534955735864618, 0.1598244433572646, 0.16572487053029172, 0.16055013431802773, 0.17135385959145977, 0.15588520712339546, 0.17500900693927607, 0.1589642565332563, 0.1515644536704604, 0.15743614700622485, 0.15485572185840935, 0.15005821471524342, 0.16582094550483328, 0.16358095488872104, 0.17960980398260118, 0.156900798444042, 0.15974218400785706, 0.15230225966856248, 0.17011169503266826, 0.16761487680179435, 0.16227610021737018, 0.15756673429837378, 0.15871624665458128, 0.17954688863159887, 0.15509719857139567, 0.23193256445769161, 0.1591611175334134, 0.1856332455115818, 0.15172290660022889, 0.15386788369396712, 0.14735925906701755, 0.15493887188492927, 0.16457670732931684, 0.15410631780253203, 0.1592712993123911, 0.170780059844864, 0.15516752148515717, 0.16121575826541895, 0.16896550536819824, 0.2422280476498597, 0.15866687668660148, 0.16962434514474634, 0.1682979306352954, 0.16205167385249578, 0.14998479375706847, 0.16465277393790018, 0.1488852234705307, 0.1678966997728805, 0.1721145101823836, 0.15483092674528373, 0.15596291070580576, 0.15794974166055242, 0.166333956788314, 0.17369156838060085, 0.16809659933021928, 0.15845941519837967, 0.15692826305176366, 0.1678677391820066, 0.1588580553619429, 0.15141658138571729, 0.1660340292101784, 0.20939979379586096, 0.1596538513664725, 0.17337490192227517, 0.1574009044194363, 0.16031471237713246, 0.15670645860698895, 0.18390196028852399, 0.1532174968450483, 0.15600272569873505, 0.15709720647781478, 0.18868659978262517, 0.158754481363829, 0.17075271799360053, 0.21404889749015968, 0.16896697721633977, 0.15897110871701042, 0.15346351609962988, 0.17770169165711985, 0.1682159521940313, 0.165527211422002, 0.15709065048740437, 0.15829519602284908, 0.16108712309131232, 0.157800929578829, 0.19904283442843207, 0.19557548076812456, 0.16139829107802156, 0.17496450758604443, 0.16193900699079028, 0.1623900835334086, 0.18145775317578164, 0.1637968482599369, 0.15663488295242137, 0.15958879606269727, 0.19508899552830233, 0.20380839420333444, 0.1579234259416651, 0.15521008129785727], [0.1359039100546709, 0.1502435185916458, 0.14473285562372326, 0.198239335465382, 0.16560881968320923, 0.1722037983905823, 0.14528156482720386, 0.14325371508384804, 0.14970926838553908, 0.1913227761898451, 0.1479207278652812, 0.1317063902178966, 0.17043461039052632, 0.1474351440472262, 0.17732861798643923, 0.17139965192347648, 0.1410474347333284, 0.13651853832329058, 0.16295934962178427, 0.16481649537975773, 0.143264829208327, 0.21439035670671988, 0.19310924612208413, 0.1440843768304938, 0.13638844107243875, 0.22242251457446602, 0.17251307984845424, 0.1717870154482948, 0.19214676979145434, 0.14526571095748775, 0.168172360576851, 0.13746950365184024, 0.16726495743992031, 0.14148763103645912, 0.14255273664025803, 0.1754471080274901, 0.14100246230390884, 0.1459086968041366, 0.171619984947047, 0.1460723494861141, 0.1985336400955749, 0.13865034711408972, 0.1402611882768604, 0.1867858679116178, 0.2078522949563755, 0.1415433074208529, 0.18654689535456925, 0.17560551383772552, 0.20365317450806258, 0.16415497532490864, 0.14914208747462832, 0.13780750913632142, 0.19669850045090378, 0.17238512843722315, 0.15949659074884293, 0.18395493670197172, 0.1422570229100149, 0.1623704982671745, 0.2045225946392991, 0.1704201190494518, 0.1452678903392349, 0.1384966938475233, 0.14062205533219607, 0.13810356693256604, 0.16458795066014187, 0.1605313489505847, 0.19483231812935595, 0.1676984333096826, 0.14092224535535913, 0.13705587127069171, 0.16437297670897574, 0.13839033232645037, 0.17086132550729852, 0.1494164540539857, 0.23784976846399675, 0.2002602533634236, 0.16516768838834045, 0.1785209107343623, 0.14304615973961432, 0.19653921191419152, 0.17112291326002113, 0.1411109999574424, 0.136522496662072, 0.18638575453702294, 0.14504671354926665, 0.14280112676060905, 0.14748974336182538, 0.1427846098254798, 0.13830041951183722, 0.2051075135770645, 0.22714559216498847, 0.14375751278812507, 0.2041956495246469, 0.1485405626645498, 0.14211092665258485, 0.1437789834128651, 0.151424016377492, 0.16617527979907276, 0.1709283808219253, 0.13926124620926436], [0.15157911682667888, 0.1865326575438386, 0.17385267833861773, 0.18989837387616765, 0.16011899811105682, 0.1463139134010669, 0.1748952933284981, 0.1595955824335415, 0.14753475956469295, 0.15972602432896474, 0.16638432431698255, 0.14970865174457945, 0.1597254036470066, 0.15085598574960066, 0.15061562350071103, 0.16084189009376346, 0.1711837249783019, 0.15638663062985456, 0.14468740219506868, 0.16691602791878954, 0.15095269072890152, 0.16880667048501846, 0.15241256793202398, 0.16326657212359902, 0.16235261045298746, 0.17008045533079724, 0.17510135259240558, 0.1682960834616401, 0.1857432828028751, 0.1674150661735411, 0.16196395513714523, 0.16191727647577706, 0.17439502119746936, 0.1613572016315564, 0.16427963526067058, 0.1437949485645752, 0.14505023193682307, 0.15504048519043867, 0.15143828118262523, 0.1854701999331783, 0.20230334464658178, 0.1589602604847931, 0.14593590571843432, 0.1898961481487456, 0.18509488450920075, 0.14810456059607868, 0.15822653229080477, 0.16095209626006532, 0.16305830333054133, 0.15495010518323235, 0.1613522226206439, 0.15890694362822885, 0.20617893535840745, 0.1900877430615602, 0.16778086022499664, 0.166402130202129, 0.15683492216281597, 0.19837994730847291, 0.16763184987473795, 0.16849642821131522, 0.16512991959475398, 0.15447151153070443, 0.1968640017595128, 0.16441808854623136, 0.17360001817119328, 0.16177261411199084, 0.16636833831149644, 0.16369762891292594, 0.15337039998032326, 0.1606852337816176, 0.16625655414494037, 0.15718964494127854, 0.15573027887167815, 0.17266396261860387, 0.19653782027896904, 0.20713474742974058, 0.1835464607039273, 0.15905293831711872, 0.1777482711794229, 0.17496871999387464, 0.1558802252836892, 0.14949915140110745, 0.16266443812325435, 0.15946064627290701, 0.17522445128978006, 0.15776928876572108, 0.16474770810893422, 0.16515620484076046, 0.16212670992934577, 0.1517940602686054, 0.16148400329317952, 0.15818292750565993, 0.18091831545501022, 0.15663624828538655, 0.17041273340554522, 0.165128057319708, 0.17041614834282057, 0.19482511861626708, 0.15747166189471107, 0.14306343025369256], [0.18811908558518164, 0.21934862066327498, 0.19510939109092362, 0.20199901232590353, 0.22088504690011132, 0.19457005030345362, 0.18864037580731047, 0.1998949779592681, 0.1848202341540553, 0.1880914388275318, 0.19599061976594193, 0.2112468406640609, 0.19639583502265281, 0.18334492587618667, 0.18366524353671992, 0.2110376531243332, 0.2045190053957147, 0.18833821063623066, 0.21862683595598273, 0.18948037547724794, 0.1954554031359344, 0.18426963187329304, 0.21652527178910788, 0.1861301438716434, 0.17197580041974989, 0.1866882817708748, 0.19050141185040975, 0.22202675277554054, 0.183735946077554, 0.20695089476014009, 0.1965052498421009, 0.21727182258808228, 0.20537226074138018, 0.18725936485545888, 0.2110014594597231, 0.17718960877763326, 0.219786730809935, 0.20026892552857492, 0.21706150250045161, 0.1848561437314398, 0.18228988365021764, 0.20848733247625115, 0.24481225792843592, 0.17604608673185343, 0.17594777317379942, 0.18438187955470256, 0.1967962384308554, 0.24282414783423062, 0.20092062008327077, 0.19292167189266846, 0.1875971733988719, 0.2187936584094861, 0.21568688244593248, 0.1839977880731962, 0.20393564755596327, 0.18814355116993622, 0.20880103488402263, 0.18844519316798297, 0.19323061727869165, 0.18687253013282112, 0.2380694761950305, 0.18857155131856054, 0.23274177879374583, 0.1835506351501335, 0.20071786641834144, 0.19563424738300625, 0.1915047793587807, 0.21894545874144686, 0.18088862100151665, 0.18377694592140534, 0.2054506135652157, 0.19667462656145687, 0.20759516872388736, 0.19558112827081328, 0.2062451946383479, 0.1881499710091324, 0.18686045062624462, 0.22716578616469815, 0.19322067238682816, 0.19953223038109527, 0.19344906685388277, 0.21176738363544845, 0.19344426143338858, 0.19756744151936861, 0.21890570975749085, 0.18296170932344571, 0.18359437566815842, 0.20040403393326284, 0.2250244269672026, 0.20950670454764708, 0.19278834116775026, 0.20407801333741335, 0.1940827910687393, 0.167995074462947, 0.19995532968480512, 0.21268001996522481, 0.18904035093038812, 0.2040606618612378, 0.19911989370456956, 0.19012533083682398], [0.15827257507729528, 0.15582113551088228, 0.15559392793025878, 0.20239374058904572, 0.13743835483564723, 0.20818507029313266, 0.18493431036923297, 0.16697071520873427, 0.15499209714859133, 0.1749134526125417, 0.14949183712601058, 0.1347274887040455, 0.21793032118482658, 0.17077206096619052, 0.13822357313343286, 0.1400068481258136, 0.19537820231656244, 0.1637504016776044, 0.21200782824583794, 0.16732016434227895, 0.14628094326542487, 0.14633288449435253, 0.17353219591962363, 0.1540949006275829, 0.18903064547081896, 0.13883577426404345, 0.17490376307867375, 0.17371732295507403, 0.2012982890456049, 0.135164569627142, 0.13937496756766665, 0.16654832758340535, 0.15908998146428996, 0.15801955110390903, 0.1329773044384674, 0.16871632194520136, 0.1741987485605136, 0.1444389467613179, 0.16046847039248183, 0.13697185192598516, 0.29381257228895075, 0.15670878203454613, 0.2066972989283294, 0.1441221859962293, 0.2936433572550496, 0.16946974388362326, 0.16660587754021355, 0.1589795825441841, 0.18693053852437608, 0.14002177123084483, 0.1427620091729178, 0.13642241440308345, 0.18902558750393625, 0.133122651248456, 0.18777441591793234, 0.15719478598503545, 0.17096735724675768, 0.17225769752391037, 0.16475106377477913, 0.16569348645969656, 0.1727218175691204, 0.14073708353666411, 0.14823111808136047, 0.14348332761650923, 0.14071030456691916, 0.20975917814393522, 0.1978949487587753, 0.1433398206058781, 0.14701780125731023, 0.14493229046552103, 0.1429478566974774, 0.15885490272572123, 0.15102188321054416, 0.16326340845000845, 0.14409286004764996, 0.23230357189168568, 0.1402564305803771, 0.15723135769532415, 0.1647395684115326, 0.1816716247914323, 0.1802294355872763, 0.16147569020320576, 0.17891811872381375, 0.1954627802811629, 0.14461955469985172, 0.14209663109079504, 0.14319440186007615, 0.1735984254033426, 0.18126496400954295, 0.18617884494849374, 0.20885213879460998, 0.1685752430244811, 0.1884629472976591, 0.18101873479529546, 0.21191991184213513, 0.1510864101460429, 0.14463154470267608, 0.15100180125708915, 0.18003068417388635, 0.18450409234789622], [0.19263272104007997, 0.14100710750742584, 0.14407029338073232, 0.1682440880750341, 0.16387620113386192, 0.13878197805810727, 0.1340086266643323, 0.1373052697627711, 0.1382017455657353, 0.20421473594720624, 0.13980272263690643, 0.19206437288830105, 0.2817464463639736, 0.1413458520970173, 0.19031046867053003, 0.1804596028474243, 0.16791767699934454, 0.1388888804912433, 0.179038756604695, 0.13993756801613108, 0.1448179722323464, 0.1722392148016903, 0.19277383151751437, 0.1376985653049388, 0.14551524954396475, 0.13332366419437722, 0.17022903525040048, 0.16697807262856426, 0.18428281426933105, 0.143742501316644, 0.14746930371177291, 0.16688853488255792, 0.13960881277544576, 0.1459550285485862, 0.13349547108599527, 0.14108609382926948, 0.17168230516685007, 0.14340940722485312, 0.13397529972175173, 0.14321219096062815, 0.23517895232938488, 0.14142332457196646, 0.13950269965068288, 0.2425009168725944, 0.2918700343430081, 0.135343230655926, 0.18581311226584254, 0.13553834406366794, 0.1416049410248834, 0.13744530201112576, 0.13506005731575527, 0.18408159284028439, 0.21534102657950407, 0.14378145462660025, 0.17408065150838942, 0.14395829317921513, 0.14149810944905197, 0.1463693545956684, 0.1905600510479834, 0.1924226360234655, 0.1341140498912619, 0.1384883150658107, 0.15963800665167985, 0.14327704915869494, 0.13649155377093636, 0.13671628486718526, 0.16261198901129365, 0.18124573220115456, 0.1495324082863124, 0.18553816470914378, 0.14270918157346374, 0.14370186833369114, 0.17578649073012947, 0.16275475144200818, 0.13514783781218534, 0.1802117249748641, 0.14466751418402238, 0.17316518675538725, 0.13790059064639007, 0.17835782700918498, 0.14695323723064782, 0.14002262868082146, 0.1697708648732214, 0.1951583827169044, 0.13724547964199718, 0.13528916216086645, 0.17414800842275782, 0.1430114581483038, 0.1421848534237272, 0.14002973471219923, 0.18919812802445066, 0.15934151199906063, 0.16610785047874965, 0.14536349384756642, 0.18964478210377825, 0.15365322419369917, 0.15769508095641097, 0.17030517813398593, 0.12982198892592878, 0.15177372485459611]] 
    lossvec0 = [[0.20818351333430446, 0.19981285653588504, 0.20510718595284982, 0.20984635247607544, 0.2034003249549822, 0.21024687557633845, 0.21078277725917077, 0.20653370198423912, 0.21013932241578603, 0.20505582112496656, 0.19698161102331044, 0.19550270268205727, 0.20498398521223687, 0.2004045472147817, 0.1938799390627333, 0.21772568431732175, 0.2083464340948261, 0.21312427103457943, 0.20674441400411894, 0.20197090673753015, 0.19674417388980864, 0.20320873715142776, 0.20001795522201402, 0.19731847013024467, 0.19853312040101412, 0.20129907350618043, 0.20838641921522089, 0.19830498772912775, 0.19879061907507514, 0.2035717258104826, 0.2071246318183616, 0.19911613689133936, 0.20837133964626825, 0.20733400082767026, 0.1996090026481862, 0.21174315412005834, 0.20255750876325515, 0.20502087246770231, 0.20067829356497618, 0.19911627064069187, 0.20702832251436945, 0.19062101256686145, 0.20061988655929894, 0.20834205780624665, 0.2084570714048183, 0.20801329073256525, 0.1997740355226297, 0.20237710448742754, 0.2006843667433806, 0.18904631172160938, 0.18869161011054442, 0.20306350078420582, 0.20086275950573393, 0.19911989150292886, 0.20728355930120665, 0.20825225333936473, 0.20277188661312381, 0.19901486402762184, 0.19576125972752062, 0.2003416781983626, 0.20685900926340084, 0.20535431418632566, 0.20014654589662578, 0.19353750842864006, 0.20862085650120285, 0.19620696021568787, 0.2171938959481364, 0.20043573679795187, 0.20652926543952865, 0.21575306577144276, 0.20894506769395718, 0.21674504563265906, 0.19200237127934186, 0.192631343530857, 0.20276170950880298, 0.20117767984285972, 0.20228917232107702, 0.19913795365197445, 0.2053118917034573, 0.2041415103259663, 0.1988746636985184, 0.2060420797280611, 0.2156591816397663, 0.2051412500684295, 0.19190375324465064, 0.21039661234083334, 0.20799739772136383, 0.20549524103215222, 0.21305080974941387, 0.2058906120337652, 0.2089697343776439, 0.19586999330899366, 0.19757790116004362, 0.21739047753762414, 0.20433306212483993, 0.19943430194574346, 0.2024540919495018, 0.2032482493316871, 0.1982019813597425, 0.2090213243106029]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### underEstWt=1., CHECK RISK, m=0.9 ###
    # Get null first
    underWt, mRisk = 1., 0.9
    t = 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t, 'slope': mRisk}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_check, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Design 0']
    lossveclist = [[0.16597802897111774, 0.15996095375166333, 0.16315377449905738, 0.16709385471740032, 0.16223604504081496, 0.16787038260289883, 0.17025544510198098, 0.163791476432921, 0.16848099488742213, 0.16489627171671106, 0.15760044389575256, 0.15785115369417924, 0.16408198061074042, 0.1598533599278423, 0.15449585943582206, 0.1750598465754737, 0.16614576393745734, 0.16923773527880995, 0.16460620608384577, 0.16190115822727313, 0.15810967664973408, 0.16407909022751818, 0.16026045986764553, 0.15765819153661284, 0.15897563984076873, 0.15975324878659747, 0.1667928400485794, 0.15693699393495145, 0.15941638077253348, 0.1633059031227892, 0.16506569680911848, 0.15991943760302568, 0.16653397794919153, 0.16761769734952817, 0.15862461424004679, 0.16947981397398293, 0.1625175216067931, 0.1642963883159985, 0.1598249118580695, 0.1594821232720838, 0.1663844647792147, 0.151702282305509, 0.16007801184471343, 0.16615560545935965, 0.16747507093841507, 0.1672319351687157, 0.15921699224837965, 0.16144441718727978, 0.16033715326933085, 0.15078390444450038, 0.15043391888197627, 0.16302757251578356, 0.16029584026190669, 0.1606699655143099, 0.16479478158829503, 0.166972897028503, 0.16130367226115588, 0.1589918137109038, 0.1569504494376272, 0.160453788776047, 0.16700743290429812, 0.16405886593323754, 0.16047754170841802, 0.15585029514997822, 0.16752203321332865, 0.15686204768628875, 0.17275253549891784, 0.16140880214989634, 0.16487712914500727, 0.17292740158524705, 0.16790366017474928, 0.17440135689111055, 0.15259069457765256, 0.1560716053293768, 0.16169115849672036, 0.16223075560693828, 0.16239045097898486, 0.1589526036845048, 0.1645686342139668, 0.16352139277796754, 0.15890470106178106, 0.1646775573214811, 0.17278154067224977, 0.16370760674595625, 0.15374220454906015, 0.16732212872716812, 0.16599996075324752, 0.16445547169184174, 0.16966023074880957, 0.1652197324988904, 0.16712485049710307, 0.15751336856591852, 0.15837324173878412, 0.17393491820691703, 0.16245030209982433, 0.1599659017727201, 0.16267526761494608, 0.1620845605509126, 0.159355672994947, 0.1683375276733328]]
    '''
    # 30 tests for all designs
    underWt, mRisk = 1., 0.9
    t = 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t, 'slope': mRisk}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_check, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3, design4, design5, design6_30]
    designNames = ['Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    plotLossVecs(lossveclist, lvecnames=designNames)
    '''
    # LOSS VECS: 10-AUG-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3', 'Design 4', 'Design 5', 'Design 6']
    lossveclist = [[0.1316259081405389, 0.12241469619824905, 0.13595975675152286, 0.1391606376565047, 0.13003734929434396, 0.14450026817222575, 0.12206542321118974, 0.14670344406630845, 0.12953678340854882, 0.12048178898274628, 0.1289335615204511, 0.12071956427464588, 0.11816935380385059, 0.1360536061926024, 0.13775793978387588, 0.15283082143804855, 0.1265269458483293, 0.12593213115885876, 0.11774812074555613, 0.13914598397182232, 0.1379352516009799, 0.13131782032313274, 0.12840137576052144, 0.12463120017110187, 0.15143423547183762, 0.12276596361755064, 0.19959093434531242, 0.13122400672371914, 0.15689856016652023, 0.11976787329665463, 0.12164767165406896, 0.11728691950610347, 0.1259844498198805, 0.13885852956313638, 0.12009514168769946, 0.12954607883296182, 0.1411473261993964, 0.12682193845340567, 0.13345516070695, 0.13905207867225555, 0.20620062195092703, 0.1291868451813161, 0.14259228025462586, 0.14254155316383857, 0.13420701143028071, 0.120556215639047, 0.13227692501563953, 0.12059426073764878, 0.13834209544127352, 0.14647709918603352, 0.12386513383515489, 0.12620709931540525, 0.13254373905772326, 0.13985050065853352, 0.1473386703805468, 0.14235052253294236, 0.13280443907013811, 0.12303633402247593, 0.14037974844197074, 0.13142228123733254, 0.1204610222475023, 0.13767185665114476, 0.17926856366970062, 0.1311229872014409, 0.1484118221134304, 0.1271558138483244, 0.12878896880378787, 0.12770152208877605, 0.15523230170204125, 0.12096466840153444, 0.1323227794786257, 0.1296257359457382, 0.16233646610309896, 0.1277742411018091, 0.1460598316192438, 0.18401080103304535, 0.1419123206550052, 0.13027144906048035, 0.12590564845608904, 0.1517556727865302, 0.13995532118360005, 0.1374436014610329, 0.12991407822077017, 0.13033392693802331, 0.13559070396563627, 0.12400729511254578, 0.16993539013380818, 0.16864361770318548, 0.13382205324217478, 0.14826082147816874, 0.13062199763331914, 0.1355075523260727, 0.15404125276397473, 0.13752029371227115, 0.12357225864953962, 0.12734271212761814, 0.16616348682790988, 0.1750873240830171, 0.12697828802646685, 0.12338885019620685], [0.10903790890103747, 0.11679914187891981, 0.1202501963158447, 0.17016590323032094, 0.13339703911700854, 0.1391489546913259, 0.1193188380403039, 0.1174693662626131, 0.12274286046052152, 0.14909193878515484, 0.11913734989707696, 0.1015197515821045, 0.1345700376998718, 0.12394253140263232, 0.14835613362544778, 0.14511069816205857, 0.11225139627496668, 0.10170566526177287, 0.12283183522660492, 0.13419382798483406, 0.11721366010831194, 0.18523174536304887, 0.15067947103049836, 0.10688090073575604, 0.11607341913886886, 0.1830056986550466, 0.1470930323779514, 0.148213148377557, 0.16199542537662945, 0.11637623831959037, 0.13876387083354452, 0.11033493816715502, 0.13276851669464879, 0.11557096131567757, 0.11053575066045807, 0.14255260253954566, 0.11849615246497665, 0.1176019056403865, 0.13853200086551815, 0.12208866692676594, 0.1696972158425766, 0.10955604006325538, 0.11435208530068997, 0.152565667127096, 0.16966741535667715, 0.1058275194090969, 0.16074268925429683, 0.14288078892516143, 0.1607509490432518, 0.1425198552998309, 0.11334458392244447, 0.11491059651330389, 0.1595052134817906, 0.14418992244742465, 0.13426335590254007, 0.15400838439857653, 0.11756627770067554, 0.1305679853677264, 0.1631104773432233, 0.13144637151466204, 0.11968764949453542, 0.10962289966488774, 0.11526319191802181, 0.11740593973153288, 0.13800616925462156, 0.12725319046191633, 0.16237617238989405, 0.13686328300590758, 0.11819820733668898, 0.1079943387177205, 0.13995588458329097, 0.11643487816512088, 0.14529101150033788, 0.12098588886921799, 0.20248142572218109, 0.16515045838993453, 0.13917622920812578, 0.14954619196210983, 0.11942874882740481, 0.1606102720834637, 0.13587326622624316, 0.11539001808925338, 0.10642752321894096, 0.15319054480668273, 0.12014287458967303, 0.10910148745302882, 0.12282600834547076, 0.12281763987470978, 0.11457149494725866, 0.17075591302803136, 0.18385586288152955, 0.11661473334202269, 0.17484327157415508, 0.11891194654727842, 0.11362279564357838, 0.11570434833803948, 0.12676725228785357, 0.14075696331166915, 0.13816995635834817, 0.10584963874007289], [0.11934589636695833, 0.15106543581539977, 0.15024648937544743, 0.1555301175640814, 0.13312055504426926, 0.11647017573730405, 0.13770240373978718, 0.13254331585546072, 0.11529046674971083, 0.12816808562893886, 0.13399669178460072, 0.1162818176679848, 0.1256856525757671, 0.12751375203612836, 0.12801178205236932, 0.1363705740525829, 0.14210567783521177, 0.12456790364797639, 0.11273703901922887, 0.13969982163507672, 0.1241314413220568, 0.14477810548081538, 0.11829994886496407, 0.12702567531698583, 0.1344691635603848, 0.13858789213497416, 0.14795452884213015, 0.14322313157436228, 0.16069798363783705, 0.13342509703610267, 0.1273440456464081, 0.12858934664511804, 0.15023543504671302, 0.13556354858810643, 0.13151531277141804, 0.1197387809696714, 0.12404970042833934, 0.12913854121205648, 0.1205197197467309, 0.15987060831008915, 0.17962869721502994, 0.13225744589253643, 0.11853057809109632, 0.1524666650811845, 0.15706333827980476, 0.11929203558465865, 0.12715910569520625, 0.13112050929709057, 0.13339563491998427, 0.12372312046133303, 0.12252026496700345, 0.1290720189754229, 0.1735849972333422, 0.1602087101267603, 0.1428049645645243, 0.12837265249844526, 0.12923058121485095, 0.16108805820756142, 0.1360891911896802, 0.13250560253394916, 0.13581768479147588, 0.1294677602416416, 0.16719187697011412, 0.1340542640164839, 0.14326673712513877, 0.13288276465819973, 0.14219420488981005, 0.14020392756958433, 0.12908419978910948, 0.13134350780319654, 0.1392969316996172, 0.13611350869066327, 0.13822326430529006, 0.145296810948529, 0.16966065274457234, 0.18297764585858142, 0.1494188118076114, 0.13005450845762148, 0.1483750432228933, 0.15002141805030425, 0.12476705202200712, 0.12138964642968184, 0.1303562156355201, 0.13089107627280805, 0.14860956375678394, 0.1220691287169845, 0.13961768994410614, 0.14205966010745563, 0.13301216416399117, 0.12435112022358435, 0.1279674732146207, 0.12925654787513532, 0.16018489576551387, 0.13259129516942728, 0.13786854610551563, 0.13673091965278455, 0.1438457936182639, 0.16630124139689595, 0.12397917759614807, 0.11838100901752564], [0.14740309944751787, 0.17799562389842324, 0.1553224592896402, 0.16171796045466488, 0.17604844043333034, 0.15505112559257894, 0.14890372831736398, 0.15858915048026082, 0.14576779891538655, 0.14842133071950508, 0.1552180102061238, 0.16813380602020056, 0.15558023097251925, 0.14462210868354503, 0.14503527479177236, 0.16944027566211076, 0.16430021515669643, 0.14922947092345284, 0.1797144699366921, 0.1496493065535918, 0.155626986732515, 0.14654585219009378, 0.17558079021184647, 0.14680951466852765, 0.13439098731087448, 0.14688823425521882, 0.14938972206257642, 0.17805177692144192, 0.14507642918987418, 0.16411062577423396, 0.15877588364530043, 0.17757836150117726, 0.16269920848996672, 0.1479374928744562, 0.1700221269456827, 0.14054480720089157, 0.17760642338039076, 0.16151959132920776, 0.17507157462399878, 0.14661540849640586, 0.1426184605669872, 0.168297262721314, 0.20039714470767392, 0.13890624537023438, 0.13948910878447598, 0.1445958639971635, 0.15441151006876286, 0.19771448490337806, 0.1596742090662715, 0.1530253270933004, 0.14725158300476962, 0.17718407248038912, 0.17127601160017572, 0.1461646952941327, 0.1639649145398182, 0.1490762639060838, 0.16895109913488462, 0.14867588560553294, 0.1531465806115723, 0.1471645873709389, 0.19347540967810264, 0.14904269550363497, 0.18889436994045647, 0.14455939765699571, 0.15883809594438464, 0.15496891099426044, 0.15144599040147202, 0.17686332393832827, 0.14188825549631867, 0.14533616193803217, 0.16476484967614358, 0.15713776160902568, 0.1661212555462443, 0.1568962844719248, 0.16614484846872057, 0.15082570525258937, 0.148033297905117, 0.1854732102873875, 0.1532159100075933, 0.15954472081437288, 0.15407543282963973, 0.17079721040227555, 0.1515763498493144, 0.15652054314518463, 0.1778557499071949, 0.1441136772494537, 0.14411899719137727, 0.15970252916419037, 0.18155840137802656, 0.17077230711374966, 0.1529781373448898, 0.16219508624168125, 0.15373935931877486, 0.13309600962861126, 0.15828572250864642, 0.17139813375310783, 0.14939786150005208, 0.16431518470385958, 0.15895047116671554, 0.14975528189209947], [0.12488676978727421, 0.12178191619057677, 0.12673223704191564, 0.16747809077777256, 0.11097347036131253, 0.17409807796206758, 0.14487061983560443, 0.13948756180890048, 0.11801318195029811, 0.13651056424039476, 0.11785172263724829, 0.1029125689103356, 0.17048089877927203, 0.1385498079297023, 0.10997707090241984, 0.1220370054962243, 0.16391185183463444, 0.12722604314145872, 0.16469166483824618, 0.13760036218304414, 0.12491250925362911, 0.11448126722934143, 0.14451062197135991, 0.11740632048808355, 0.15818461171241183, 0.10706916875823648, 0.14906594683429264, 0.13587903556737163, 0.16795269753369627, 0.10737708684335319, 0.10959581907749097, 0.1341862223012829, 0.13186967810732128, 0.1330521830394183, 0.09834947307949754, 0.1364929076584685, 0.14355507116156085, 0.11378689393001559, 0.13175714243100306, 0.10816440864962508, 0.23906207711366906, 0.12921817680311923, 0.17797861106103827, 0.11755915864802373, 0.23663248401531273, 0.13398685504021907, 0.13859146754756443, 0.13442562644644693, 0.1511388285975989, 0.1143197073591347, 0.11057129202698344, 0.1146128431926649, 0.15622013719016398, 0.109150925601927, 0.15988524478632007, 0.12920898632335062, 0.13885120950018318, 0.14522478256358493, 0.13375401202549975, 0.13341251372887997, 0.14155884210947803, 0.1156730423097772, 0.1218706518214402, 0.11135727548666094, 0.12086031343518344, 0.17438571094447158, 0.16771693402080556, 0.11108607364940637, 0.12064988548013315, 0.11529003555166142, 0.11408581625640295, 0.1320449864294479, 0.12472159450971707, 0.13452356773730004, 0.11749014221801982, 0.19485532150504767, 0.11087932267367875, 0.1253035792699246, 0.1416414891303947, 0.15182360097156658, 0.14517598140736415, 0.13221544578509703, 0.14304166187852319, 0.15348007705266112, 0.11579762122614516, 0.11032673672005865, 0.11683888627046861, 0.1462202663398809, 0.14758414635206502, 0.150041479755863, 0.16905672741213987, 0.13564967034411246, 0.1615667253067127, 0.15298182571453003, 0.1691787021501899, 0.1294934682338705, 0.11585839364707144, 0.13009520073256006, 0.1456376096532226, 0.1469661968491979], [0.1520893312262227, 0.11100480755415487, 0.12232838038324184, 0.14231991396851598, 0.13292575952673386, 0.11488164950684045, 0.10714279658756636, 0.11003937672348797, 0.10656291933587075, 0.16588111365357167, 0.10919428502356072, 0.1499839753513018, 0.22305300365811004, 0.1146994759618664, 0.15964264219358412, 0.15475984766555254, 0.13753288347857265, 0.11034675817373536, 0.1401331860459149, 0.11384244395125219, 0.12355366203349147, 0.14401699822312858, 0.15221363309030106, 0.10493441140982818, 0.12357230548872852, 0.09933192942260209, 0.1431960587365649, 0.13572399406035396, 0.15669013575531457, 0.11097186747618355, 0.11511126127218088, 0.13729123736532475, 0.11695852379612937, 0.11396179377858537, 0.0995787532016013, 0.1155810736907562, 0.13900802475540758, 0.11827212450559303, 0.1103244471135246, 0.12035998290337442, 0.20242374430644675, 0.11959198930433684, 0.11016583662831285, 0.19742433325381056, 0.24121797100482764, 0.09927642969385418, 0.15139471713100017, 0.11330693939110772, 0.11162626653782069, 0.11142171224645966, 0.10611576636337017, 0.15030704620610152, 0.17161375083745037, 0.1233802763254865, 0.14878113295166143, 0.11351119441942964, 0.11697561617891812, 0.12025319328009942, 0.15171515329207097, 0.15118703698871275, 0.10805450795241628, 0.11186238170238089, 0.1370896260262204, 0.1123192125524258, 0.11308970466411895, 0.10928150054664601, 0.13683453649373628, 0.15111947648986468, 0.12618714208206616, 0.15257089564237658, 0.1187599211217835, 0.1206345017658549, 0.14675276020469777, 0.13334649612359206, 0.11457397303046728, 0.15703775999452607, 0.11831546847814468, 0.14138353137976306, 0.11191905874965248, 0.14763172703445449, 0.11966249405211311, 0.11774148471189422, 0.13431737180038353, 0.15440617741887938, 0.11770529329273297, 0.10289955869718914, 0.14844751315248123, 0.11780062053233492, 0.11116939423996174, 0.11262016610121144, 0.16016303929380873, 0.1239767533309162, 0.14646284145204583, 0.12189566497635329, 0.15161634048323808, 0.12780398624467254, 0.13281489356359988, 0.14448897011620165, 0.09774258893302955, 0.12854513935665182]]
    lossvec0 = [[0.16597802897111774, 0.15996095375166333, 0.16315377449905738, 0.16709385471740032, 0.16223604504081496, 0.16787038260289883, 0.17025544510198098, 0.163791476432921, 0.16848099488742213, 0.16489627171671106, 0.15760044389575256, 0.15785115369417924, 0.16408198061074042, 0.1598533599278423, 0.15449585943582206, 0.1750598465754737, 0.16614576393745734, 0.16923773527880995, 0.16460620608384577, 0.16190115822727313, 0.15810967664973408, 0.16407909022751818, 0.16026045986764553, 0.15765819153661284, 0.15897563984076873, 0.15975324878659747, 0.1667928400485794, 0.15693699393495145, 0.15941638077253348, 0.1633059031227892, 0.16506569680911848, 0.15991943760302568, 0.16653397794919153, 0.16761769734952817, 0.15862461424004679, 0.16947981397398293, 0.1625175216067931, 0.1642963883159985, 0.1598249118580695, 0.1594821232720838, 0.1663844647792147, 0.151702282305509, 0.16007801184471343, 0.16615560545935965, 0.16747507093841507, 0.1672319351687157, 0.15921699224837965, 0.16144441718727978, 0.16033715326933085, 0.15078390444450038, 0.15043391888197627, 0.16302757251578356, 0.16029584026190669, 0.1606699655143099, 0.16479478158829503, 0.166972897028503, 0.16130367226115588, 0.1589918137109038, 0.1569504494376272, 0.160453788776047, 0.16700743290429812, 0.16405886593323754, 0.16047754170841802, 0.15585029514997822, 0.16752203321332865, 0.15686204768628875, 0.17275253549891784, 0.16140880214989634, 0.16487712914500727, 0.17292740158524705, 0.16790366017474928, 0.17440135689111055, 0.15259069457765256, 0.1560716053293768, 0.16169115849672036, 0.16223075560693828, 0.16239045097898486, 0.1589526036845048, 0.1645686342139668, 0.16352139277796754, 0.15890470106178106, 0.1646775573214811, 0.17278154067224977, 0.16370760674595625, 0.15374220454906015, 0.16732212872716812, 0.16599996075324752, 0.16445547169184174, 0.16966023074880957, 0.1652197324988904, 0.16712485049710307, 0.15751336856591852, 0.15837324173878412, 0.17393491820691703, 0.16245030209982433, 0.1599659017727201, 0.16267526761494608, 0.1620845605509126, 0.159355672994947, 0.1683375276733328]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.4$, $n=30$')

    lossveclist = [[0.1316259081405389, 0.12241469619824905, 0.13595975675152286, 0.1391606376565047, 0.13003734929434396, 0.14450026817222575, 0.12206542321118974, 0.14670344406630845, 0.12953678340854882, 0.12048178898274628, 0.1289335615204511, 0.12071956427464588, 0.11816935380385059, 0.1360536061926024, 0.13775793978387588, 0.15283082143804855, 0.1265269458483293, 0.12593213115885876, 0.11774812074555613, 0.13914598397182232, 0.1379352516009799, 0.13131782032313274, 0.12840137576052144, 0.12463120017110187, 0.15143423547183762, 0.12276596361755064, 0.19959093434531242, 0.13122400672371914, 0.15689856016652023, 0.11976787329665463, 0.12164767165406896, 0.11728691950610347, 0.1259844498198805, 0.13885852956313638, 0.12009514168769946, 0.12954607883296182, 0.1411473261993964, 0.12682193845340567, 0.13345516070695, 0.13905207867225555, 0.20620062195092703, 0.1291868451813161, 0.14259228025462586, 0.14254155316383857, 0.13420701143028071, 0.120556215639047, 0.13227692501563953, 0.12059426073764878, 0.13834209544127352, 0.14647709918603352, 0.12386513383515489, 0.12620709931540525, 0.13254373905772326, 0.13985050065853352, 0.1473386703805468, 0.14235052253294236, 0.13280443907013811, 0.12303633402247593, 0.14037974844197074, 0.13142228123733254, 0.1204610222475023, 0.13767185665114476, 0.17926856366970062, 0.1311229872014409, 0.1484118221134304, 0.1271558138483244, 0.12878896880378787, 0.12770152208877605, 0.15523230170204125, 0.12096466840153444, 0.1323227794786257, 0.1296257359457382, 0.16233646610309896, 0.1277742411018091, 0.1460598316192438, 0.18401080103304535, 0.1419123206550052, 0.13027144906048035, 0.12590564845608904, 0.1517556727865302, 0.13995532118360005, 0.1374436014610329, 0.12991407822077017, 0.13033392693802331, 0.13559070396563627, 0.12400729511254578, 0.16993539013380818, 0.16864361770318548, 0.13382205324217478, 0.14826082147816874, 0.13062199763331914, 0.1355075523260727, 0.15404125276397473, 0.13752029371227115, 0.12357225864953962, 0.12734271212761814, 0.16616348682790988, 0.1750873240830171, 0.12697828802646685, 0.12338885019620685], [0.10903790890103747, 0.11679914187891981, 0.1202501963158447, 0.17016590323032094, 0.13339703911700854, 0.1391489546913259, 0.1193188380403039, 0.1174693662626131, 0.12274286046052152, 0.14909193878515484, 0.11913734989707696, 0.1015197515821045, 0.1345700376998718, 0.12394253140263232, 0.14835613362544778, 0.14511069816205857, 0.11225139627496668, 0.10170566526177287, 0.12283183522660492, 0.13419382798483406, 0.11721366010831194, 0.18523174536304887, 0.15067947103049836, 0.10688090073575604, 0.11607341913886886, 0.1830056986550466, 0.1470930323779514, 0.148213148377557, 0.16199542537662945, 0.11637623831959037, 0.13876387083354452, 0.11033493816715502, 0.13276851669464879, 0.11557096131567757, 0.11053575066045807, 0.14255260253954566, 0.11849615246497665, 0.1176019056403865, 0.13853200086551815, 0.12208866692676594, 0.1696972158425766, 0.10955604006325538, 0.11435208530068997, 0.152565667127096, 0.16966741535667715, 0.1058275194090969, 0.16074268925429683, 0.14288078892516143, 0.1607509490432518, 0.1425198552998309, 0.11334458392244447, 0.11491059651330389, 0.1595052134817906, 0.14418992244742465, 0.13426335590254007, 0.15400838439857653, 0.11756627770067554, 0.1305679853677264, 0.1631104773432233, 0.13144637151466204, 0.11968764949453542, 0.10962289966488774, 0.11526319191802181, 0.11740593973153288, 0.13800616925462156, 0.12725319046191633, 0.16237617238989405, 0.13686328300590758, 0.11819820733668898, 0.1079943387177205, 0.13995588458329097, 0.11643487816512088, 0.14529101150033788, 0.12098588886921799, 0.20248142572218109, 0.16515045838993453, 0.13917622920812578, 0.14954619196210983, 0.11942874882740481, 0.1606102720834637, 0.13587326622624316, 0.11539001808925338, 0.10642752321894096, 0.15319054480668273, 0.12014287458967303, 0.10910148745302882, 0.12282600834547076, 0.12281763987470978, 0.11457149494725866, 0.17075591302803136, 0.18385586288152955, 0.11661473334202269, 0.17484327157415508, 0.11891194654727842, 0.11362279564357838, 0.11570434833803948, 0.12676725228785357, 0.14075696331166915, 0.13816995635834817, 0.10584963874007289], [0.11934589636695833, 0.15106543581539977, 0.15024648937544743, 0.1555301175640814, 0.13312055504426926, 0.11647017573730405, 0.13770240373978718, 0.13254331585546072, 0.11529046674971083, 0.12816808562893886, 0.13399669178460072, 0.1162818176679848, 0.1256856525757671, 0.12751375203612836, 0.12801178205236932, 0.1363705740525829, 0.14210567783521177, 0.12456790364797639, 0.11273703901922887, 0.13969982163507672, 0.1241314413220568, 0.14477810548081538, 0.11829994886496407, 0.12702567531698583, 0.1344691635603848, 0.13858789213497416, 0.14795452884213015, 0.14322313157436228, 0.16069798363783705, 0.13342509703610267, 0.1273440456464081, 0.12858934664511804, 0.15023543504671302, 0.13556354858810643, 0.13151531277141804, 0.1197387809696714, 0.12404970042833934, 0.12913854121205648, 0.1205197197467309, 0.15987060831008915, 0.17962869721502994, 0.13225744589253643, 0.11853057809109632, 0.1524666650811845, 0.15706333827980476, 0.11929203558465865, 0.12715910569520625, 0.13112050929709057, 0.13339563491998427, 0.12372312046133303, 0.12252026496700345, 0.1290720189754229, 0.1735849972333422, 0.1602087101267603, 0.1428049645645243, 0.12837265249844526, 0.12923058121485095, 0.16108805820756142, 0.1360891911896802, 0.13250560253394916, 0.13581768479147588, 0.1294677602416416, 0.16719187697011412, 0.1340542640164839, 0.14326673712513877, 0.13288276465819973, 0.14219420488981005, 0.14020392756958433, 0.12908419978910948, 0.13134350780319654, 0.1392969316996172, 0.13611350869066327, 0.13822326430529006, 0.145296810948529, 0.16966065274457234, 0.18297764585858142, 0.1494188118076114, 0.13005450845762148, 0.1483750432228933, 0.15002141805030425, 0.12476705202200712, 0.12138964642968184, 0.1303562156355201, 0.13089107627280805, 0.14860956375678394, 0.1220691287169845, 0.13961768994410614, 0.14205966010745563, 0.13301216416399117, 0.12435112022358435, 0.1279674732146207, 0.12925654787513532, 0.16018489576551387, 0.13259129516942728, 0.13786854610551563, 0.13673091965278455, 0.1438457936182639, 0.16630124139689595, 0.12397917759614807, 0.11838100901752564], [0.14740309944751787, 0.17799562389842324, 0.1553224592896402, 0.16171796045466488, 0.17604844043333034, 0.15505112559257894, 0.14890372831736398, 0.15858915048026082, 0.14576779891538655, 0.14842133071950508, 0.1552180102061238, 0.16813380602020056, 0.15558023097251925, 0.14462210868354503, 0.14503527479177236, 0.16944027566211076, 0.16430021515669643, 0.14922947092345284, 0.1797144699366921, 0.1496493065535918, 0.155626986732515, 0.14654585219009378, 0.17558079021184647, 0.14680951466852765, 0.13439098731087448, 0.14688823425521882, 0.14938972206257642, 0.17805177692144192, 0.14507642918987418, 0.16411062577423396, 0.15877588364530043, 0.17757836150117726, 0.16269920848996672, 0.1479374928744562, 0.1700221269456827, 0.14054480720089157, 0.17760642338039076, 0.16151959132920776, 0.17507157462399878, 0.14661540849640586, 0.1426184605669872, 0.168297262721314, 0.20039714470767392, 0.13890624537023438, 0.13948910878447598, 0.1445958639971635, 0.15441151006876286, 0.19771448490337806, 0.1596742090662715, 0.1530253270933004, 0.14725158300476962, 0.17718407248038912, 0.17127601160017572, 0.1461646952941327, 0.1639649145398182, 0.1490762639060838, 0.16895109913488462, 0.14867588560553294, 0.1531465806115723, 0.1471645873709389, 0.19347540967810264, 0.14904269550363497, 0.18889436994045647, 0.14455939765699571, 0.15883809594438464, 0.15496891099426044, 0.15144599040147202, 0.17686332393832827, 0.14188825549631867, 0.14533616193803217, 0.16476484967614358, 0.15713776160902568, 0.1661212555462443, 0.1568962844719248, 0.16614484846872057, 0.15082570525258937, 0.148033297905117, 0.1854732102873875, 0.1532159100075933, 0.15954472081437288, 0.15407543282963973, 0.17079721040227555, 0.1515763498493144, 0.15652054314518463, 0.1778557499071949, 0.1441136772494537, 0.14411899719137727, 0.15970252916419037, 0.18155840137802656, 0.17077230711374966, 0.1529781373448898, 0.16219508624168125, 0.15373935931877486, 0.13309600962861126, 0.15828572250864642, 0.17139813375310783, 0.14939786150005208, 0.16431518470385958, 0.15895047116671554, 0.14975528189209947], [0.12488676978727421, 0.12178191619057677, 0.12673223704191564, 0.16747809077777256, 0.11097347036131253, 0.17409807796206758, 0.14487061983560443, 0.13948756180890048, 0.11801318195029811, 0.13651056424039476, 0.11785172263724829, 0.1029125689103356, 0.17048089877927203, 0.1385498079297023, 0.10997707090241984, 0.1220370054962243, 0.16391185183463444, 0.12722604314145872, 0.16469166483824618, 0.13760036218304414, 0.12491250925362911, 0.11448126722934143, 0.14451062197135991, 0.11740632048808355, 0.15818461171241183, 0.10706916875823648, 0.14906594683429264, 0.13587903556737163, 0.16795269753369627, 0.10737708684335319, 0.10959581907749097, 0.1341862223012829, 0.13186967810732128, 0.1330521830394183, 0.09834947307949754, 0.1364929076584685, 0.14355507116156085, 0.11378689393001559, 0.13175714243100306, 0.10816440864962508, 0.23906207711366906, 0.12921817680311923, 0.17797861106103827, 0.11755915864802373, 0.23663248401531273, 0.13398685504021907, 0.13859146754756443, 0.13442562644644693, 0.1511388285975989, 0.1143197073591347, 0.11057129202698344, 0.1146128431926649, 0.15622013719016398, 0.109150925601927, 0.15988524478632007, 0.12920898632335062, 0.13885120950018318, 0.14522478256358493, 0.13375401202549975, 0.13341251372887997, 0.14155884210947803, 0.1156730423097772, 0.1218706518214402, 0.11135727548666094, 0.12086031343518344, 0.17438571094447158, 0.16771693402080556, 0.11108607364940637, 0.12064988548013315, 0.11529003555166142, 0.11408581625640295, 0.1320449864294479, 0.12472159450971707, 0.13452356773730004, 0.11749014221801982, 0.19485532150504767, 0.11087932267367875, 0.1253035792699246, 0.1416414891303947, 0.15182360097156658, 0.14517598140736415, 0.13221544578509703, 0.14304166187852319, 0.15348007705266112, 0.11579762122614516, 0.11032673672005865, 0.11683888627046861, 0.1462202663398809, 0.14758414635206502, 0.150041479755863, 0.16905672741213987, 0.13564967034411246, 0.1615667253067127, 0.15298182571453003, 0.1691787021501899, 0.1294934682338705, 0.11585839364707144, 0.13009520073256006, 0.1456376096532226, 0.1469661968491979], [0.1520893312262227, 0.11100480755415487, 0.12232838038324184, 0.14231991396851598, 0.13292575952673386, 0.11488164950684045, 0.10714279658756636, 0.11003937672348797, 0.10656291933587075, 0.16588111365357167, 0.10919428502356072, 0.1499839753513018, 0.22305300365811004, 0.1146994759618664, 0.15964264219358412, 0.15475984766555254, 0.13753288347857265, 0.11034675817373536, 0.1401331860459149, 0.11384244395125219, 0.12355366203349147, 0.14401699822312858, 0.15221363309030106, 0.10493441140982818, 0.12357230548872852, 0.09933192942260209, 0.1431960587365649, 0.13572399406035396, 0.15669013575531457, 0.11097186747618355, 0.11511126127218088, 0.13729123736532475, 0.11695852379612937, 0.11396179377858537, 0.0995787532016013, 0.1155810736907562, 0.13900802475540758, 0.11827212450559303, 0.1103244471135246, 0.12035998290337442, 0.20242374430644675, 0.11959198930433684, 0.11016583662831285, 0.19742433325381056, 0.24121797100482764, 0.09927642969385418, 0.15139471713100017, 0.11330693939110772, 0.11162626653782069, 0.11142171224645966, 0.10611576636337017, 0.15030704620610152, 0.17161375083745037, 0.1233802763254865, 0.14878113295166143, 0.11351119441942964, 0.11697561617891812, 0.12025319328009942, 0.15171515329207097, 0.15118703698871275, 0.10805450795241628, 0.11186238170238089, 0.1370896260262204, 0.1123192125524258, 0.11308970466411895, 0.10928150054664601, 0.13683453649373628, 0.15111947648986468, 0.12618714208206616, 0.15257089564237658, 0.1187599211217835, 0.1206345017658549, 0.14675276020469777, 0.13334649612359206, 0.11457397303046728, 0.15703775999452607, 0.11831546847814468, 0.14138353137976306, 0.11191905874965248, 0.14763172703445449, 0.11966249405211311, 0.11774148471189422, 0.13431737180038353, 0.15440617741887938, 0.11770529329273297, 0.10289955869718914, 0.14844751315248123, 0.11780062053233492, 0.11116939423996174, 0.11262016610121144, 0.16016303929380873, 0.1239767533309162, 0.14646284145204583, 0.12189566497635329, 0.15161634048323808, 0.12780398624467254, 0.13281489356359988, 0.14448897011620165, 0.09774258893302955, 0.12854513935665182]]
    lossvec0 = [[0.16597802897111774, 0.15996095375166333, 0.16315377449905738, 0.16709385471740032, 0.16223604504081496, 0.16787038260289883, 0.17025544510198098, 0.163791476432921, 0.16848099488742213, 0.16489627171671106, 0.15760044389575256, 0.15785115369417924, 0.16408198061074042, 0.1598533599278423, 0.15449585943582206, 0.1750598465754737, 0.16614576393745734, 0.16923773527880995, 0.16460620608384577, 0.16190115822727313, 0.15810967664973408, 0.16407909022751818, 0.16026045986764553, 0.15765819153661284, 0.15897563984076873, 0.15975324878659747, 0.1667928400485794, 0.15693699393495145, 0.15941638077253348, 0.1633059031227892, 0.16506569680911848, 0.15991943760302568, 0.16653397794919153, 0.16761769734952817, 0.15862461424004679, 0.16947981397398293, 0.1625175216067931, 0.1642963883159985, 0.1598249118580695, 0.1594821232720838, 0.1663844647792147, 0.151702282305509, 0.16007801184471343, 0.16615560545935965, 0.16747507093841507, 0.1672319351687157, 0.15921699224837965, 0.16144441718727978, 0.16033715326933085, 0.15078390444450038, 0.15043391888197627, 0.16302757251578356, 0.16029584026190669, 0.1606699655143099, 0.16479478158829503, 0.166972897028503, 0.16130367226115588, 0.1589918137109038, 0.1569504494376272, 0.160453788776047, 0.16700743290429812, 0.16405886593323754, 0.16047754170841802, 0.15585029514997822, 0.16752203321332865, 0.15686204768628875, 0.17275253549891784, 0.16140880214989634, 0.16487712914500727, 0.17292740158524705, 0.16790366017474928, 0.17440135689111055, 0.15259069457765256, 0.1560716053293768, 0.16169115849672036, 0.16223075560693828, 0.16239045097898486, 0.1589526036845048, 0.1645686342139668, 0.16352139277796754, 0.15890470106178106, 0.1646775573214811, 0.17278154067224977, 0.16370760674595625, 0.15374220454906015, 0.16732212872716812, 0.16599996075324752, 0.16445547169184174, 0.16966023074880957, 0.1652197324988904, 0.16712485049710307, 0.15751336856591852, 0.15837324173878412, 0.17393491820691703, 0.16245030209982433, 0.1599659017727201, 0.16267526761494608, 0.1620845605509126, 0.159355672994947, 0.1683375276733328]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    ### type='test node', overEstWt=1., rateTarget=0.1 ###
    design0 = np.array([0., 0.,0.])
    design1 = np.array([0.,0.,1.])
    design2 = np.array([1 / 3, 2 / 3, 0.])
    design3 = np.array([1 / 3 , 1 / 3 , 1 / 3])

    # Build list of 1000 Qest matrices, for use in order with each omega
    import numpy.random as nprandom
    Qlist = []
    obsQ = np.array([[ 6, 11], [12,  6], [ 2, 13]])
    nprandom.seed(3)
    for scenind in range(100):
        newQ = np.array([[0.,0.], [0.,0.], [0.,0.]])
        for btsamp in range(50):
            currTNind = choice([i for i in range(numTN)], p=np.sum(obsQ,axis=1)/np.sum(obsQ).tolist())
            currSNind = choice([i for i in range(numSN)], p=obsQ[currTNind]/np.sum(obsQ[currTNind]).tolist())
            newQ[currTNind][currSNind] += 1
        Qlist.append(newQ)

    # Get null first
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    lossveclist=[]
    for scenind in range(100):
        omeganum = 1
        Qest = Qlist[scenind]
        lossvec = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum,
                                   type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
        lossveclist.append(lossvec[0][0])
        print('Scenario '+str(scenind)+' finished')
    '''
    # LOSS VECS: 13-JUL-22
    designNames = ['Design 0']
    lossvec = [0.019690827482368705, 0.021939295393226917, 0.01973505797597416, 0.01973664917591897, 0.01968596345794661, 0.019213398504037166, 0.0173554009770707, 0.020307317093891084, 0.02100404078163349, 0.01988540052204863, 0.019542829877228923, 0.016952922018571237, 0.018409204853519878, 0.01915838415574564, 0.020463347233881886, 0.020548416542314263, 0.01859793359235008, 0.019750168367845863, 0.019274062607812965, 0.017123479731651244, 0.02231418179797019, 0.018001375139415406, 0.020688635191629463, 0.020348464714217744, 0.01784459744393057, 0.018783776068150005, 0.019766346569503938, 0.01697448900668094, 0.020920248448976494, 0.02027714650356037, 0.019540560666221424, 0.017958955844537012, 0.018934398030163647, 0.02096408370343579, 0.019052007841171413, 0.01843385853068612, 0.020248753976433213, 0.02118099287211507, 0.020796528318689805, 0.01871331797330223, 0.01703766582542569, 0.02052184062342226, 0.018137071374459256, 0.0193246561669277, 0.020621859867252092, 0.02118441841969468, 0.018810592194857492, 0.016426974896474964, 0.0193995604538135, 0.020639886224365304, 0.019174425542286173, 0.01928271826593331, 0.019428407387475595, 0.02213510461847484, 0.019579200264899982, 0.02123914683780319, 0.01764080724931094, 0.019462696268650163, 0.01887625928983492, 0.019913453565555368, 0.01793462599372435, 0.018430775692844424, 0.017429193067063795, 0.018424461736909505, 0.019132647338707544, 0.018660564603294405, 0.01888716686181371, 0.020523937811379855, 0.021889551199100847, 0.018697371066856608, 0.018757125708034745, 0.02039464058774375, 0.019611426790288197, 0.019879845752365486, 0.017007188401399323, 0.019063737705063612, 0.01679687014418244, 0.02172763798350237, 0.020706335545170658, 0.020026728629178002, 0.01764716680163704, 0.019512095378609446, 0.01875937455898344, 0.020495269487834006, 0.019298492618681596, 0.02071439717837558, 0.021019799129079014, 0.016600383619317132, 0.021823016698557535, 0.01899468677805621, 0.02134819146200047, 0.01899564159255357, 0.01705620583234051, 0.019413600551352335, 0.020117187742948402, 0.017717850151776474, 0.019529188350926034, 0.019289146887209063, 0.01808582043163517, 0.020987258386175038]
    '''
    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3]
    designNames = ['Design 1', 'Design 2', 'Design 3']
    numtests = 30
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = [[] for i in range(len(designList))]
    for scenind in range(100):
        omeganum = 1
        Qest = Qlist[scenind]
        lossvec = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                                   designlist=designList, designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
        for i in range(len(designList)):
            lossveclist[i].append(lossvec[i][0])
        print('Scenario ' + str(scenind) + ' finished')
    '''
    # LOSS VECS: 13-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3']
    lossveclist = [[0.019690827482368705, 0.021939295393226917, 0.01973505797597416, 0.01973664917591897, 0.01968596345794661, 0.019213398504037166, 0.0173554009770707, 0.020307317093891084, 0.02100404078163349, 0.01988540052204863, 0.019542829877228923, 0.016952922018571237, 0.018409204853519878, 0.01915838415574564, 0.020463347233881886, 0.020548416542314263, 0.01859793359235008, 0.019750168367845863, 0.019274062607812965, 0.017123479731651244, 0.02231418179797019, 0.018001375139415406, 0.020688635191629463, 0.020348464714217744, 0.01784459744393057, 0.018783776068150005, 0.019766346569503938, 0.01697448900668094, 0.020920248448976494, 0.02027714650356037, 0.019540560666221424, 0.017958955844537012, 0.018934398030163647, 0.02096408370343579, 0.019052007841171413, 0.01843385853068612, 0.020248753976433213, 0.02118099287211507, 0.020796528318689805, 0.01871331797330223, 0.01703766582542569, 0.02052184062342226, 0.018137071374459256, 0.0193246561669277, 0.020621859867252092, 0.02118441841969468, 0.018810592194857492, 0.016426974896474964, 0.0193995604538135, 0.020639886224365304, 0.019174425542286173, 0.01928271826593331, 0.019428407387475595, 0.02213510461847484, 0.019579200264899982, 0.02123914683780319, 0.01764080724931094, 0.019462696268650163, 0.01887625928983492, 0.019913453565555368, 0.01793462599372435, 0.018430775692844424, 0.017429193067063795, 0.018424461736909505, 0.019132647338707544, 0.018660564603294405, 0.01888716686181371, 0.020523937811379855, 0.021889551199100847, 0.018697371066856608, 0.018757125708034745, 0.02039464058774375, 0.019611426790288197, 0.019879845752365486, 0.017007188401399323, 0.019063737705063612, 0.01679687014418244, 0.02172763798350237, 0.020706335545170658, 0.020026728629178002, 0.01764716680163704, 0.019512095378609446, 0.01875937455898344, 0.020495269487834006, 0.019298492618681596, 0.02071439717837558, 0.021019799129079014, 0.016600383619317132, 0.021823016698557535, 0.01899468677805621, 0.02134819146200047, 0.01899564159255357, 0.01705620583234051, 0.019413600551352335, 0.020117187742948402, 0.017717850151776474, 0.019529188350926034, 0.019289146887209063, 0.01808582043163517, 0.020987258386175038],[0.01876424448500989, 0.019384564656693887, 0.01509787098237408, 0.013694675216181685, 0.017389956435886984, 0.012704420649905165, 0.018242285246775052, 0.020752272663022577, 0.01858880421469034, 0.020446479525582997, 0.019294249853589268, 0.013653464247033176, 0.011267115760917818, 0.01693517405986635, 0.012907845922354912, 0.017429362725585235, 0.015844331573185245, 0.015324649217068588, 0.016150297145761022, 0.01781435734063786, 0.012214970093439245, 0.019439008851119717, 0.012858253624878543, 0.018765538645996272, 0.012914447246757497, 0.016290570830811712, 0.01426007567849746, 0.013969564018743424, 0.010247796235196442, 0.01303680965505668, 0.014193311492482465, 0.025394905932146578, 0.021704008165108982, 0.014625771963880771, 0.013156710463277975, 0.012545108706289403, 0.016914047658383828, 0.015036719954726769, 0.01685799223298833, 0.013938347300111821, 0.01714751467665077, 0.01714586705680331, 0.016300831322489943, 0.013179625205647555, 0.013740440845777161, 0.01611418194385282, 0.01551485630479084, 0.01870546699874107, 0.01230072900493055, 0.0146582439501738, 0.019721498655650708, 0.012754706909313561, 0.011439072237978404, 0.01452712815279264, 0.012777643774638154, 0.019224106246886037, 0.013714014569424327, 0.02185906886186993, 0.01819843706464749, 0.015881918599126636, 0.021972994008667635, 0.015067363672198427, 0.01600434644253589, 0.018571428727435252, 0.01720273012011972, 0.01730124089449872, 0.015003054830427026, 0.017872375200267514, 0.015597454241696439, 0.01570247199344865, 0.012490658337290635, 0.022164808651384017, 0.014294575950139127, 0.016710044663770993, 0.012683872551962976, 0.014772212359634836, 0.01579923529134294, 0.014881810746497455, 0.016292720318589467, 0.02097020584235558, 0.01952104158187477, 0.019602366551461105, 0.012278906778802194, 0.014527837739345897, 0.014666909583389152, 0.011874768913586829, 0.018000180297507478, 0.015257928104107052, 0.017466553313903354, 0.013559882937303362, 0.018341167936957805, 0.017442771954143257, 0.015686112730263106, 0.011703805614276395, 0.015078935465773978, 0.009274183597021363, 0.015363822038854807, 0.014828436906667334, 0.015286403754080514, 0.0173350098908816], [0.017338187296437664, 0.011996263999644624, 0.02751223641612406, 0.009010387512394623, 0.025868638679699005, 0.008803425104809132, 0.008093256100748103, 0.00931759811755569, 0.011205877792639807, 0.02076793615628927, 0.010285181618384352, 0.018349023034135218, 0.009126311832662999, 0.015014217491277381, 0.01137912198551673, 0.02027689222280233, 0.011496664298063626, 0.018121758054194113, 0.018264197724710635, 0.014887888254905375, 0.009748430866784813, 0.010907574149092651, 0.01169544756027972, 0.015112762674370448, 0.010192131432322908, 0.008333734279322932, 0.01452408405270779, 0.012207837828970256, 0.008640287303863698, 0.011218199352288342, 0.01179024080735601, 0.009046765835953706, 0.009753420000994278, 0.017423616330200033, 0.01154879966090144, 0.019459331407380518, 0.014491755480771312, 0.018065123274366903, 0.011171532851978267, 0.015037156919469143, 0.009699764666687292, 0.009675376359673561, 0.010760948289288913, 0.009508166375146428, 0.014169926520083866, 0.017941952289261754, 0.009669263667389481, 0.013268567509754437, 0.009776076429206585, 0.020981931581459435, 0.009843584283217766, 0.019476727211225054, 0.008383415674186115, 0.015554280688413736, 0.01430757223957079, 0.015618560971838152, 0.011457503604455289, 0.012123139646838404, 0.021484109113439138, 0.02675154147632687, 0.009628026457367203, 0.015289664722831416, 0.016146971830622376, 0.017624726227379664, 0.012811809601693496, 0.018649988648522835, 0.012766589829927311, 0.016747291853733328, 0.014246326572877041, 0.00885696454590718, 0.01430283772732357, 0.013093524334047944, 0.010592128340754766, 0.01626002338382248, 0.013262995173437984, 0.018635361571380276, 0.011738536977944799, 0.012906106141070009, 0.010237077447872583, 0.01584546645734631, 0.010297389477207266, 0.008737020746101045, 0.01752137959775418, 0.008956315145976529, 0.010500757153621908, 0.01760736158255033, 0.008884879348146415, 0.01115403311192902, 0.014592730941792196, 0.020454860498486695, 0.013486818636060932, 0.011537463880487863, 0.008800055876757354, 0.01892626584488564, 0.009722231827567816, 0.017588269276644444, 0.017547012768838573, 0.022042364035046322, 0.01442299341303058, 0.018031874753422265], [0.010726511131175846, 0.011346178266358486, 0.009935765453330187, 0.016671802003800352, 0.01029361178633009, 0.010016617411115609, 0.013741894561144349, 0.014426699000876522, 0.017801579790693012, 0.009919954277856916, 0.010177945766895714, 0.017909469029406364, 0.010529472739837183, 0.011714454053913744, 0.012009063689859233, 0.02482667879602944, 0.009907852153122721, 0.01054031336225788, 0.020410497606308683, 0.010291031089990405, 0.011084689727429183, 0.011297614391491339, 0.017415926365019773, 0.00953720342304, 0.009396312906268491, 0.009257891443253632, 0.009542154338942458, 0.011188553173732331, 0.011786598063388427, 0.009702612369787447, 0.009820809278506863, 0.010631762347839033, 0.01133128431479471, 0.009973993952658366, 0.01142731227932962, 0.016517937325747467, 0.021254847319722207, 0.011246830862202671, 0.012268817427427666, 0.021844268619966748, 0.011861871642527192, 0.01805768412006595, 0.018332377179823587, 0.020701553326614715, 0.009298295385283227, 0.009793513066421997, 0.016367225158725355, 0.013531447020963596, 0.01242868741001709, 0.010463817351543883, 0.02012119271124337, 0.009630992335981676, 0.018105228637089035, 0.011976594100111263, 0.020406874888652612, 0.014020765217039077, 0.015879119453974584, 0.01143192025945281, 0.019718105852585852, 0.0129412021416814, 0.022318443012363444, 0.010188240695242975, 0.01774465846620202, 0.010295417030511442, 0.00853871051266011, 0.010817386325653813, 0.012618486606296433, 0.0101840620900269, 0.01033948287345778, 0.011082129158028439, 0.010711439287346197, 0.009592235753030837, 0.01040163812437106, 0.010434099684464633, 0.015428232525948004, 0.008279268136252939, 0.012998359728623102, 0.011668849909647646, 0.009547713787598097, 0.013331735625917041, 0.01700919479237819, 0.010081543985628426, 0.014870266953092669, 0.018662907549623346, 0.009113328425683985, 0.014258280099234272, 0.021148331766458733, 0.013604572641377426, 0.012323388429136361, 0.011032202822727077, 0.011213843232019242, 0.009260109370351904, 0.013754992460326214, 0.008845404621579987, 0.010681043191548159, 0.008783620703806923, 0.011392583009988367, 0.010249954522106095, 0.010767601844524332, 0.020199899581506496]]
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$\delta=1$, $t=0.1$, $n=30$, test node selection')    
    '''

    ### type='test node', overEstWt=1., rateTarget=0.1, KNOWN Q matrix ###
    design0 = np.array([0., 0., 0.])
    design1 = np.array([0., 0., 1.])
    design2 = np.array([1 / 3, 2 / 3, 0.])
    design3 = np.array([1 / 3, 1 / 3, 1 / 3])

    # Use a "known" Q matrix
    Qest = np.array([[6, 11], [12, 6], [2, 13]])
    Qest = np.divide(Qest,np.sum(Qest,axis=1).reshape(3,1))
    Qest = np.array([[0.4,0.6],[0.7,0.3],[0.1,0.9]])

    # Get null first
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design0]
    designNames = ['Design 0']
    numtests = 0
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)
    omeganum = 100
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                               designlist=designList, designnames=designNames, numtests=numtests,
                               omeganum=omeganum, type=['test node', Qest],
                               priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                               randinds=randinds)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Design 0']
    lossvec = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    '''
    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3]
    designNames = ['Design 1', 'Design 2', 'Design 3']
    numtests = 30
    omeganum = 100
    Qest = np.array([[0.4, 0.6], [0.7, 0.3], [0.1, 0.9]])
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    omeganum = 100
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                                   designlist=designList, designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    '''
    # LOSS VECS: 19-JUL-22
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3']
    lossveclist = [[0.11988525924311791, 0.15483094799207342, 0.1691899146741856, 0.16337552836098096, 0.12836809481628542, 0.14669632630179033, 0.11673217672810883, 0.1615678558169811, 0.14639554382295497, 0.16747300564678502, 0.14332538699399622, 0.11989719619532264, 0.13829764143478954, 0.14218326930548772, 0.15349822563502824, 0.16445278397470237, 0.1832089506652259, 0.13108422019561075, 0.11942583281115773, 0.18416029888190413, 0.12522863110501536, 0.14891343846169516, 0.1533842561477168, 0.1487084063006343, 0.13809294312785853, 0.12977698758410572, 0.14713777750637713, 0.137727820322727, 0.1512064422954208, 0.14455987258226444, 0.13096217862331147, 0.1827526286573682, 0.15843136147339795, 0.15422791357276375, 0.1483308941875547, 0.13411321454187758, 0.17483195620159936, 0.13380058106005982, 0.13236207459851054, 0.16723313876854307, 0.1686069465606297, 0.14304460011047676, 0.16278760536818096, 0.17360529815423428, 0.14400894994907246, 0.13902007229591232, 0.14832192151804016, 0.19414412050055052, 0.14785250956885154, 0.1264626890714373, 0.15553236788548055, 0.17223453498510718, 0.14820319125656917, 0.13626641083425303, 0.16703073316735492, 0.15857541812356918, 0.16660503458590611, 0.13670733616977424, 0.16490982512927907, 0.177103678040694, 0.16636407459490846, 0.14087917732914293, 0.1944676077882393, 0.17271469499917236, 0.14763454351603286, 0.1306683596330204, 0.13840285734269553, 0.15312543618855268, 0.13895335993652863, 0.1812719131001662, 0.13911076069360112, 0.12444340797507475, 0.16554058039645586, 0.17207766400682561, 0.14989904898669193, 0.15797804259313003, 0.15300560570596847, 0.16957092807969978, 0.16189328120700436, 0.16898643200495722, 0.15453996652138405, 0.12261638744375906, 0.18209533408070028, 0.13077247116314, 0.13235229045141633, 0.14396276099241628, 0.12865196145085744, 0.1626837476527771, 0.13942219889640686, 0.1363365769278614, 0.16586725975413694, 0.13884082923821311, 0.16018427003013302, 0.13770159602147558, 0.1430400080337943, 0.2006619189794636, 0.15707449930030679, 0.14537944246286755, 0.12972673943470378, 0.1505421750304259], [0.1472300548065956, 0.1166861215142654, 0.10837964413442318, 0.13222163997303632, 0.1422851698340475, 0.15723467219784484, 0.10755479051169693, 0.13429086432299317, 0.1148415993667857, 0.1747650836143494, 0.14192810181089352, 0.1825508052004425, 0.1477617339675263, 0.10806877471310265, 0.1523986154590685, 0.12384735983890043, 0.16821718717198209, 0.11293576661290682, 0.14456379240126743, 0.11696360072011025, 0.11616518888669371, 0.14424696710062868, 0.17665701938461995, 0.10465809888935396, 0.13887544211294994, 0.1728664266827154, 0.11275774478794359, 0.13454765070251057, 0.11547879204754727, 0.11315755609924143, 0.19681963827602397, 0.1617768059521509, 0.12049202764735502, 0.14284270306928276, 0.1075597500399225, 0.12445566325387114, 0.18037392331054666, 0.1476608739596347, 0.11386364246223672, 0.11715656892697174, 0.16116887705052715, 0.12362525691369006, 0.13582518185284279, 0.10709266555667693, 0.1832040408522016, 0.152197398609715, 0.15804793855671476, 0.15733785548157161, 0.1426795519770526, 0.11146897862894073, 0.11061316658676637, 0.14123761594015, 0.17937084140284906, 0.11116253780752604, 0.1321008140990299, 0.1385312789179749, 0.15065611524207156, 0.1426958072721677, 0.16969187371944494, 0.1771322309232049, 0.13828179540189942, 0.11726753526948785, 0.11026330329605472, 0.11375950681928489, 0.16316498403502805, 0.1570586932737819, 0.1811777626604328, 0.18942921165342905, 0.11648596008453085, 0.1257820888405002, 0.14133969467382393, 0.12258166029943238, 0.13409511634141114, 0.11588221355255547, 0.18970678872993194, 0.17000249871328738, 0.11461822870248575, 0.12029060796313372, 0.12703042180987253, 0.11874777665997815, 0.10524593194190818, 0.11010780847488297, 0.1295515560461795, 0.10752324520317862, 0.15719604411658386, 0.1140689869639036, 0.12384747070494084, 0.10570732319680635, 0.1499155101747663, 0.15831797765230513, 0.1515263291819585, 0.1648326576258619, 0.1092201637477733, 0.11922657435543979, 0.14851321248324056, 0.14491794691101006, 0.11631680622656992, 0.17337025385689678, 0.17442578671549006, 0.13404353746738115], [0.1307363465094211, 0.11688508719765264, 0.12130739263501931, 0.1215870551317532, 0.1476101088335909, 0.11372400184364896, 0.10669130421162691, 0.14570976894850038, 0.11587960174641866, 0.11094598044314177, 0.10583793809098013, 0.11269047937035834, 0.1779377756367317, 0.12232717428593257, 0.11633710530596518, 0.162540115579796, 0.16782931908901372, 0.12933333996939733, 0.16135025295267685, 0.12227601828564516, 0.11578346884204625, 0.11779019414372596, 0.13821570910248365, 0.1417542722727634, 0.1139243044158987, 0.1457839201436141, 0.14925551102173892, 0.11450098135259963, 0.12254680029822368, 0.14468407151896012, 0.14742521687769217, 0.16450145996369187, 0.12019450442726279, 0.1605522967089975, 0.12164892700461755, 0.1262243910289254, 0.21739512865728103, 0.1300023640156209, 0.10820737008220861, 0.15678931503970353, 0.1345491418548833, 0.13847888452460141, 0.19743945517921485, 0.12120697791363812, 0.1748540524696097, 0.11429339938200792, 0.12885416319788198, 0.21961765642280445, 0.16916290844667872, 0.11710836607563879, 0.11654190857582895, 0.13707872385388806, 0.18417853131541007, 0.18787558671800758, 0.17420203310432897, 0.12151718251541625, 0.15217537166495676, 0.1193841715526868, 0.13642531589601609, 0.14516745041910248, 0.15217218086091025, 0.11411026570206607, 0.12713112603891374, 0.11803224500660064, 0.12098827735173423, 0.14009942962048225, 0.11413248957144295, 0.13101868124106564, 0.1385488767502717, 0.13850403785836002, 0.14087154944563157, 0.14179246428480008, 0.12380268614735247, 0.11875485063817576, 0.1217356206115118, 0.17930080255008238, 0.14970050019102163, 0.1353453779045258, 0.16133754601608974, 0.15066802439972699, 0.1329975195086443, 0.17731342429267136, 0.18893585534739826, 0.12214911999169656, 0.12341827668713416, 0.11445966996263032, 0.17762766546166903, 0.12585588798478242, 0.13589986129181722, 0.14073922503387518, 0.11072483922374399, 0.1042228177492027, 0.1694686794615063, 0.15594340048118013, 0.1649834821011634, 0.13135816502872374, 0.13580358285762284, 0.19893741554378325, 0.11745597812901049, 0.1104876871841372]]
    lossvec0 = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    lossveclist = lossvec0 + lossveclist
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$v=1$, $l=0.1$, $n=30$, test node selection')
    
    lossveclist = [[0.11988525924311791, 0.15483094799207342, 0.1691899146741856, 0.16337552836098096, 0.12836809481628542, 0.14669632630179033, 0.11673217672810883, 0.1615678558169811, 0.14639554382295497, 0.16747300564678502, 0.14332538699399622, 0.11989719619532264, 0.13829764143478954, 0.14218326930548772, 0.15349822563502824, 0.16445278397470237, 0.1832089506652259, 0.13108422019561075, 0.11942583281115773, 0.18416029888190413, 0.12522863110501536, 0.14891343846169516, 0.1533842561477168, 0.1487084063006343, 0.13809294312785853, 0.12977698758410572, 0.14713777750637713, 0.137727820322727, 0.1512064422954208, 0.14455987258226444, 0.13096217862331147, 0.1827526286573682, 0.15843136147339795, 0.15422791357276375, 0.1483308941875547, 0.13411321454187758, 0.17483195620159936, 0.13380058106005982, 0.13236207459851054, 0.16723313876854307, 0.1686069465606297, 0.14304460011047676, 0.16278760536818096, 0.17360529815423428, 0.14400894994907246, 0.13902007229591232, 0.14832192151804016, 0.19414412050055052, 0.14785250956885154, 0.1264626890714373, 0.15553236788548055, 0.17223453498510718, 0.14820319125656917, 0.13626641083425303, 0.16703073316735492, 0.15857541812356918, 0.16660503458590611, 0.13670733616977424, 0.16490982512927907, 0.177103678040694, 0.16636407459490846, 0.14087917732914293, 0.1944676077882393, 0.17271469499917236, 0.14763454351603286, 0.1306683596330204, 0.13840285734269553, 0.15312543618855268, 0.13895335993652863, 0.1812719131001662, 0.13911076069360112, 0.12444340797507475, 0.16554058039645586, 0.17207766400682561, 0.14989904898669193, 0.15797804259313003, 0.15300560570596847, 0.16957092807969978, 0.16189328120700436, 0.16898643200495722, 0.15453996652138405, 0.12261638744375906, 0.18209533408070028, 0.13077247116314, 0.13235229045141633, 0.14396276099241628, 0.12865196145085744, 0.1626837476527771, 0.13942219889640686, 0.1363365769278614, 0.16586725975413694, 0.13884082923821311, 0.16018427003013302, 0.13770159602147558, 0.1430400080337943, 0.2006619189794636, 0.15707449930030679, 0.14537944246286755, 0.12972673943470378, 0.1505421750304259], [0.1472300548065956, 0.1166861215142654, 0.10837964413442318, 0.13222163997303632, 0.1422851698340475, 0.15723467219784484, 0.10755479051169693, 0.13429086432299317, 0.1148415993667857, 0.1747650836143494, 0.14192810181089352, 0.1825508052004425, 0.1477617339675263, 0.10806877471310265, 0.1523986154590685, 0.12384735983890043, 0.16821718717198209, 0.11293576661290682, 0.14456379240126743, 0.11696360072011025, 0.11616518888669371, 0.14424696710062868, 0.17665701938461995, 0.10465809888935396, 0.13887544211294994, 0.1728664266827154, 0.11275774478794359, 0.13454765070251057, 0.11547879204754727, 0.11315755609924143, 0.19681963827602397, 0.1617768059521509, 0.12049202764735502, 0.14284270306928276, 0.1075597500399225, 0.12445566325387114, 0.18037392331054666, 0.1476608739596347, 0.11386364246223672, 0.11715656892697174, 0.16116887705052715, 0.12362525691369006, 0.13582518185284279, 0.10709266555667693, 0.1832040408522016, 0.152197398609715, 0.15804793855671476, 0.15733785548157161, 0.1426795519770526, 0.11146897862894073, 0.11061316658676637, 0.14123761594015, 0.17937084140284906, 0.11116253780752604, 0.1321008140990299, 0.1385312789179749, 0.15065611524207156, 0.1426958072721677, 0.16969187371944494, 0.1771322309232049, 0.13828179540189942, 0.11726753526948785, 0.11026330329605472, 0.11375950681928489, 0.16316498403502805, 0.1570586932737819, 0.1811777626604328, 0.18942921165342905, 0.11648596008453085, 0.1257820888405002, 0.14133969467382393, 0.12258166029943238, 0.13409511634141114, 0.11588221355255547, 0.18970678872993194, 0.17000249871328738, 0.11461822870248575, 0.12029060796313372, 0.12703042180987253, 0.11874777665997815, 0.10524593194190818, 0.11010780847488297, 0.1295515560461795, 0.10752324520317862, 0.15719604411658386, 0.1140689869639036, 0.12384747070494084, 0.10570732319680635, 0.1499155101747663, 0.15831797765230513, 0.1515263291819585, 0.1648326576258619, 0.1092201637477733, 0.11922657435543979, 0.14851321248324056, 0.14491794691101006, 0.11631680622656992, 0.17337025385689678, 0.17442578671549006, 0.13404353746738115], [0.1307363465094211, 0.11688508719765264, 0.12130739263501931, 0.1215870551317532, 0.1476101088335909, 0.11372400184364896, 0.10669130421162691, 0.14570976894850038, 0.11587960174641866, 0.11094598044314177, 0.10583793809098013, 0.11269047937035834, 0.1779377756367317, 0.12232717428593257, 0.11633710530596518, 0.162540115579796, 0.16782931908901372, 0.12933333996939733, 0.16135025295267685, 0.12227601828564516, 0.11578346884204625, 0.11779019414372596, 0.13821570910248365, 0.1417542722727634, 0.1139243044158987, 0.1457839201436141, 0.14925551102173892, 0.11450098135259963, 0.12254680029822368, 0.14468407151896012, 0.14742521687769217, 0.16450145996369187, 0.12019450442726279, 0.1605522967089975, 0.12164892700461755, 0.1262243910289254, 0.21739512865728103, 0.1300023640156209, 0.10820737008220861, 0.15678931503970353, 0.1345491418548833, 0.13847888452460141, 0.19743945517921485, 0.12120697791363812, 0.1748540524696097, 0.11429339938200792, 0.12885416319788198, 0.21961765642280445, 0.16916290844667872, 0.11710836607563879, 0.11654190857582895, 0.13707872385388806, 0.18417853131541007, 0.18787558671800758, 0.17420203310432897, 0.12151718251541625, 0.15217537166495676, 0.1193841715526868, 0.13642531589601609, 0.14516745041910248, 0.15217218086091025, 0.11411026570206607, 0.12713112603891374, 0.11803224500660064, 0.12098827735173423, 0.14009942962048225, 0.11413248957144295, 0.13101868124106564, 0.1385488767502717, 0.13850403785836002, 0.14087154944563157, 0.14179246428480008, 0.12380268614735247, 0.11875485063817576, 0.1217356206115118, 0.17930080255008238, 0.14970050019102163, 0.1353453779045258, 0.16133754601608974, 0.15066802439972699, 0.1329975195086443, 0.17731342429267136, 0.18893585534739826, 0.12214911999169656, 0.12341827668713416, 0.11445966996263032, 0.17762766546166903, 0.12585588798478242, 0.13589986129181722, 0.14073922503387518, 0.11072483922374399, 0.1042228177492027, 0.1694686794615063, 0.15594340048118013, 0.1649834821011634, 0.13135816502872374, 0.13580358285762284, 0.19893741554378325, 0.11745597812901049, 0.1104876871841372]]
    lossvec0 = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    
    # COMBINE test node selection WITH trace selection
    designNames = ['Null design', 'Design 1', 'Design 2', 'Design 3']
    lossveclist_testnode = [[-0.16375364323693128, -0.1598924098297443, -0.16677607930317992, -0.16262309109948725, -0.16188093947140314, -0.157417741665715, -0.15506884850824199, -0.15941718184048764, -0.15282420444100275, -0.15626366688471008, -0.15572577584185382, -0.1575433641097066, -0.15299900810028547, -0.16665926604868425, -0.15828495126999473, -0.15870871088172278, -0.15557799103217498, -0.15833930128595194, -0.16905563020309589, -0.15940674903548974, -0.1608525097363954, -0.15381043349672274, -0.15939318914529807, -0.15545569559840658, -0.15303684755918198, -0.16821064281886222, -0.16245571600502157, -0.16257840155825892, -0.15252489752501308, -0.15433072776901252, -0.16364994795323945, -0.1579890795943676, -0.16436213080867138, -0.1658702895100968, -0.153411180123921, -0.15609545273829709, -0.1618149846666891, -0.16171901079095893, -0.16759210238465078, -0.1533561507927092, -0.1657515925645132, -0.16162558063079147, -0.1655038755360929, -0.1682526500473327, -0.16340195382486064, -0.1541341551722113, -0.16277564260011654, -0.15428475127720326, -0.16089461930114343, -0.1585954843513574, -0.15759429376621722, -0.15989907503786943, -0.1536116293638464, -0.15845502564458225, -0.16052103806227147, -0.16315107870073428, -0.15460359182858768, -0.16485917974241576, -0.15889838329088424, -0.1640656379297554, -0.150144918379174, -0.16377727397633166, -0.16343048272214358, -0.15497442737408612, -0.16053657001895796, -0.1610431061141195, -0.16229444224542286, -0.15972157664991693, -0.15381414185941167, -0.15597832612019064, -0.16562458518880893, -0.15595217942040576, -0.1603847893837301, -0.1611120657905986, -0.1532714356380745, -0.16108526245136187, -0.15630493416137503, -0.15799496190185, -0.15249177037061096, -0.154395096702405, -0.163679403659234, -0.16123106071808255, -0.1566742449677942, -0.15583065139781363, -0.15371728282113395, -0.16451059480697264, -0.15965258390385972, -0.16669918989045673, -0.15856848844392735, -0.15593563711561548, -0.15945917400382678, -0.16444289413535804, -0.16144397531488, -0.16394460887977857, -0.15808940474812164, -0.15516427158986124, -0.16397906625340097, -0.16616934455334773, -0.16338488421250086, -0.16207290278862374], [-0.11988525924311791, -0.15483094799207342, -0.1691899146741856, -0.16337552836098096, -0.12836809481628542, -0.14669632630179033, -0.11673217672810883, -0.1615678558169811, -0.14639554382295497, -0.16747300564678502, -0.14332538699399622, -0.11989719619532264, -0.13829764143478954, -0.14218326930548772, -0.15349822563502824, -0.16445278397470237, -0.1832089506652259, -0.13108422019561075, -0.11942583281115773, -0.18416029888190413, -0.12522863110501536, -0.14891343846169516, -0.1533842561477168, -0.1487084063006343, -0.13809294312785853, -0.12977698758410572, -0.14713777750637713, -0.137727820322727, -0.1512064422954208, -0.14455987258226444, -0.13096217862331147, -0.1827526286573682, -0.15843136147339795, -0.15422791357276375, -0.1483308941875547, -0.13411321454187758, -0.17483195620159936, -0.13380058106005982, -0.13236207459851054, -0.16723313876854307, -0.1686069465606297, -0.14304460011047676, -0.16278760536818096, -0.17360529815423428, -0.14400894994907246, -0.13902007229591232, -0.14832192151804016, -0.19414412050055052, -0.14785250956885154, -0.1264626890714373, -0.15553236788548055, -0.17223453498510718, -0.14820319125656917, -0.13626641083425303, -0.16703073316735492, -0.15857541812356918, -0.16660503458590611, -0.13670733616977424, -0.16490982512927907, -0.177103678040694, -0.16636407459490846, -0.14087917732914293, -0.1944676077882393, -0.17271469499917236, -0.14763454351603286, -0.1306683596330204, -0.13840285734269553, -0.15312543618855268, -0.13895335993652863, -0.1812719131001662, -0.13911076069360112, -0.12444340797507475, -0.16554058039645586, -0.17207766400682561, -0.14989904898669193, -0.15797804259313003, -0.15300560570596847, -0.16957092807969978, -0.16189328120700436, -0.16898643200495722, -0.15453996652138405, -0.12261638744375906, -0.18209533408070028, -0.13077247116314, -0.13235229045141633, -0.14396276099241628, -0.12865196145085744, -0.1626837476527771, -0.13942219889640686, -0.1363365769278614, -0.16586725975413694, -0.13884082923821311, -0.16018427003013302, -0.13770159602147558, -0.1430400080337943, -0.2006619189794636, -0.15707449930030679, -0.14537944246286755, -0.12972673943470378, -0.1505421750304259], [-0.1472300548065956, -0.1166861215142654, -0.10837964413442318, -0.13222163997303632, -0.1422851698340475, -0.15723467219784484, -0.10755479051169693, -0.13429086432299317, -0.1148415993667857, -0.1747650836143494, -0.14192810181089352, -0.1825508052004425, -0.1477617339675263, -0.10806877471310265, -0.1523986154590685, -0.12384735983890043, -0.16821718717198209, -0.11293576661290682, -0.14456379240126743, -0.11696360072011025, -0.11616518888669371, -0.14424696710062868, -0.17665701938461995, -0.10465809888935396, -0.13887544211294994, -0.1728664266827154, -0.11275774478794359, -0.13454765070251057, -0.11547879204754727, -0.11315755609924143, -0.19681963827602397, -0.1617768059521509, -0.12049202764735502, -0.14284270306928276, -0.1075597500399225, -0.12445566325387114, -0.18037392331054666, -0.1476608739596347, -0.11386364246223672, -0.11715656892697174, -0.16116887705052715, -0.12362525691369006, -0.13582518185284279, -0.10709266555667693, -0.1832040408522016, -0.152197398609715, -0.15804793855671476, -0.15733785548157161, -0.1426795519770526, -0.11146897862894073, -0.11061316658676637, -0.14123761594015, -0.17937084140284906, -0.11116253780752604, -0.1321008140990299, -0.1385312789179749, -0.15065611524207156, -0.1426958072721677, -0.16969187371944494, -0.1771322309232049, -0.13828179540189942, -0.11726753526948785, -0.11026330329605472, -0.11375950681928489, -0.16316498403502805, -0.1570586932737819, -0.1811777626604328, -0.18942921165342905, -0.11648596008453085, -0.1257820888405002, -0.14133969467382393, -0.12258166029943238, -0.13409511634141114, -0.11588221355255547, -0.18970678872993194, -0.17000249871328738, -0.11461822870248575, -0.12029060796313372, -0.12703042180987253, -0.11874777665997815, -0.10524593194190818, -0.11010780847488297, -0.1295515560461795, -0.10752324520317862, -0.15719604411658386, -0.1140689869639036, -0.12384747070494084, -0.10570732319680635, -0.1499155101747663, -0.15831797765230513, -0.1515263291819585, -0.1648326576258619, -0.1092201637477733, -0.11922657435543979, -0.14851321248324056, -0.14491794691101006, -0.11631680622656992, -0.17337025385689678, -0.17442578671549006, -0.13404353746738115], [-0.1307363465094211, -0.11688508719765264, -0.12130739263501931, -0.1215870551317532, -0.1476101088335909, -0.11372400184364896, -0.10669130421162691, -0.14570976894850038, -0.11587960174641866, -0.11094598044314177, -0.10583793809098013, -0.11269047937035834, -0.1779377756367317, -0.12232717428593257, -0.11633710530596518, -0.162540115579796, -0.16782931908901372, -0.12933333996939733, -0.16135025295267685, -0.12227601828564516, -0.11578346884204625, -0.11779019414372596, -0.13821570910248365, -0.1417542722727634, -0.1139243044158987, -0.1457839201436141, -0.14925551102173892, -0.11450098135259963, -0.12254680029822368, -0.14468407151896012, -0.14742521687769217, -0.16450145996369187, -0.12019450442726279, -0.1605522967089975, -0.12164892700461755, -0.1262243910289254, -0.21739512865728103, -0.1300023640156209, -0.10820737008220861, -0.15678931503970353, -0.1345491418548833, -0.13847888452460141, -0.19743945517921485, -0.12120697791363812, -0.1748540524696097, -0.11429339938200792, -0.12885416319788198, -0.21961765642280445, -0.16916290844667872, -0.11710836607563879, -0.11654190857582895, -0.13707872385388806, -0.18417853131541007, -0.18787558671800758, -0.17420203310432897, -0.12151718251541625, -0.15217537166495676, -0.1193841715526868, -0.13642531589601609, -0.14516745041910248, -0.15217218086091025, -0.11411026570206607, -0.12713112603891374, -0.11803224500660064, -0.12098827735173423, -0.14009942962048225, -0.11413248957144295, -0.13101868124106564, -0.1385488767502717, -0.13850403785836002, -0.14087154944563157, -0.14179246428480008, -0.12380268614735247, -0.11875485063817576, -0.1217356206115118, -0.17930080255008238, -0.14970050019102163, -0.1353453779045258, -0.16133754601608974, -0.15066802439972699, -0.1329975195086443, -0.17731342429267136, -0.18893585534739826, -0.12214911999169656, -0.12341827668713416, -0.11445966996263032, -0.17762766546166903, -0.12585588798478242, -0.13589986129181722, -0.14073922503387518, -0.11072483922374399, -0.1042228177492027, -0.1694686794615063, -0.15594340048118013, -0.1649834821011634, -0.13135816502872374, -0.13580358285762284, -0.19893741554378325, -0.11745597812901049, -0.1104876871841372]]
    lossveclist_trace = [[-0.16316247614417786, -0.15720308016518392, -0.160863945888904, -0.16447283110683764, -0.1597308862650217, -0.16530244384804657, -0.16669312853832846, -0.16160074183245418, -0.16531921860847268, -0.16204418983966884, -0.15497871109482528, -0.15467411380815202, -0.16137507788563935, -0.15747074719610993, -0.15227562888307283, -0.17145553421385715, -0.1636936109540728, -0.1669252130711022, -0.16203792902518932, -0.1590776036970198, -0.15517493597181414, -0.16082428825129408, -0.15756807318592914, -0.15506083185262165, -0.1563119571699612, -0.1577098321842063, -0.1641468650148215, -0.15488810176193077, -0.15665288809662717, -0.1603004792908751, -0.16244412649356446, -0.15682117334200987, -0.16354500425841928, -0.16415919785812233, -0.15638019835364242, -0.16670010935518434, -0.15949899127054123, -0.16151886488912792, -0.15735859935171637, -0.15677491976724814, -0.1632770479674153, -0.14924292022848828, -0.15743089052516365, -0.16345503460451294, -0.16461700092997042, -0.16393482215356434, -0.1567846630229211, -0.15924311538390307, -0.15772433401103705, -0.14844073078598255, -0.14807481745813092, -0.15995264676230736, -0.1579484132093352, -0.15724138753152508, -0.16224710472251716, -0.1641735756558422, -0.15887070821169746, -0.15642966735431305, -0.15406330865539522, -0.1574801626153325, -0.16362808604206897, -0.16149986707782518, -0.15773307449644686, -0.1530540907925208, -0.1645033073394543, -0.15431738379696006, -0.1704341251141459, -0.15808855709519426, -0.16246600430741387, -0.1698498306376867, -0.1648337933683812, -0.17121651335895544, -0.1503781786512441, -0.1524599498085908, -0.15922731157919556, -0.15916234372331206, -0.15939630765108154, -0.15663433246236877, -0.1616397543298343, -0.16063162982298979, -0.1558830142365766, -0.1619674732314209, -0.1696654499763426, -0.16089161339847177, -0.15122267732630387, -0.1650651236958853, -0.16316201297091332, -0.16165031167909902, -0.16726574771516814, -0.16236019915686473, -0.1645428564195015, -0.1545329722426662, -0.15539168558736072, -0.17099218135813946, -0.16002479505594225, -0.15695387354065177, -0.15969571027275462, -0.1596724155733717, -0.15652864335844877, -0.16498385967878598], [-0.12847026958561233, -0.11986732398951072, -0.13060367191347091, -0.13456141828997675, -0.1274179951384851, -0.1395853466736562, -0.11949711627700356, -0.14222439398953382, -0.12650237999957095, -0.11742182455737671, -0.125807002876967, -0.1184952562133039, -0.11595927744994752, -0.13241341970960263, -0.1330365092362536, -0.14702475658549582, -0.12372548979744037, -0.12326210162435598, -0.11596437064058449, -0.1360079427634559, -0.13490036368964048, -0.12857099981465742, -0.12546313943515863, -0.12160934132043706, -0.1462538289015319, -0.12058229113278009, -0.1906528527577479, -0.12731827990432867, -0.15162017453679544, -0.11729449808267677, -0.1190441940260026, -0.11461052983150097, -0.12314952671527217, -0.13401586619002537, -0.11792195626961513, -0.12672867159599627, -0.13739567825608845, -0.12373221054427508, -0.1297344567932947, -0.13560544320405665, -0.19761742209602334, -0.12606856696655194, -0.1379339281846113, -0.1374334378123528, -0.1306824291013811, -0.11803407486284032, -0.12967267696704565, -0.11771991263021934, -0.1346792598792127, -0.1409915447125594, -0.12118391932460561, -0.12343177753491975, -0.12827072105544465, -0.13515099777805797, -0.1419930223266828, -0.13708165525755409, -0.12851654777366114, -0.12072503892420437, -0.13588302574565375, -0.12763095569671912, -0.11770390994278485, -0.1337648303433984, -0.1717760059155993, -0.12769012395302703, -0.14218244225977397, -0.12415284258856643, -0.12592778571793506, -0.12462257842242966, -0.14994368569109445, -0.1184717062250044, -0.127352890061241, -0.1261733842087149, -0.1553400615115116, -0.12521722674144753, -0.140173063194675, -0.17588188191245271, -0.13714986387224123, -0.1271717829247304, -0.12247977824019007, -0.145766957774525, -0.13598255520000507, -0.13351997498557475, -0.12627843146354406, -0.12668244354246871, -0.13096893060481926, -0.12175318020999325, -0.16310087594160333, -0.16095717672883847, -0.1300863114218935, -0.14288872177752412, -0.12794333127672622, -0.13113273545611268, -0.14831587955772, -0.1331221376427609, -0.12098932922272174, -0.12482044143706773, -0.15980859235266884, -0.16760616557412308, -0.12400024308665411, -0.12109142757996429], [-0.10706549287250079, -0.11575611710588574, -0.11657755694309162, -0.16261739870199468, -0.13044543811112205, -0.13597871423477614, -0.1162521924230518, -0.11451468777257316, -0.11977597197875277, -0.14706270459984383, -0.11710752464564515, -0.10042574426077899, -0.13200671674442208, -0.11956001986469626, -0.14352235169529448, -0.13941878520513282, -0.11014525523119775, -0.10043722950557356, -0.12029623451868249, -0.13085447101444728, -0.11453146422406418, -0.17624798196585864, -0.14802263895111217, -0.10563726772450745, -0.11133843244043405, -0.17849680482103586, -0.14070005356490364, -0.14096922814148977, -0.156119362323945, -0.11431832309758867, -0.1347037871678656, -0.10827995515121462, -0.12991595333241354, -0.11288800385497598, -0.1087194394506875, -0.13957184220395502, -0.11433250028736858, -0.1154339703968407, -0.13531303685378834, -0.1181845974938699, -0.1624782253808026, -0.10785906088538802, -0.11187337490987176, -0.1490282005501971, -0.16584111420698566, -0.10409255587349321, -0.1531767083995999, -0.13969790265815368, -0.15893111057070325, -0.1350896551679034, -0.11223328144029465, -0.11122693364823041, -0.156758751098658, -0.13926181585327896, -0.12928728514951857, -0.14880967338603854, -0.11426618162572089, -0.12765392949835094, -0.16174518844820734, -0.12906559110102445, -0.11659937296517346, -0.10805969683894634, -0.1124038253730161, -0.11256266423435923, -0.13337769706865218, -0.12564355984905443, -0.15759371095454633, -0.1334435348161012, -0.11424065270941168, -0.10670547781120827, -0.1340283971088839, -0.11229038996424014, -0.13919071089398244, -0.11865267981990554, -0.19434057273740335, -0.16108895386440805, -0.1339694198446523, -0.1444760773776637, -0.11576840064181515, -0.15682787631356135, -0.1333306475033713, -0.11269576857300377, -0.105196751357552, -0.14939289076638698, -0.11654199774278479, -0.10779133744224585, -0.11893456865733175, -0.11701383813184087, -0.11127528879372119, -0.16543984467098882, -0.18119717818983047, -0.11419431420662064, -0.16719167236741772, -0.11701261937403842, -0.11162983384442594, -0.11346742968022439, -0.12262265636152543, -0.1353553759373205, -0.13483725103248212, -0.10472127378800088], [-0.11678330073853264, -0.1483791506375431, -0.14301199387015806, -0.15291720046764978, -0.12932617682376016, -0.11415161831739352, -0.13594132427209848, -0.12851750912928456, -0.11248114383222577, -0.12569532953866397, -0.13116045541080357, -0.11350277061595218, -0.12389588123048184, -0.12255118084248208, -0.12284882809920945, -0.13101887036737578, -0.138084520666699, -0.1222912567850896, -0.11060620781755158, -0.13532426606855924, -0.12088575345283185, -0.1385368374689929, -0.11619970130129674, -0.12457753959628065, -0.13055800683995697, -0.13538545412131597, -0.14276802801025254, -0.1374871166073497, -0.15312490598902023, -0.1311127947083507, -0.12509808772524494, -0.12665143866605372, -0.14334383550981983, -0.13091911295528422, -0.12893982634754697, -0.11608514495001748, -0.11858905120451496, -0.1250175749211199, -0.11806106548991627, -0.15243464137467358, -0.16870203684370985, -0.12830671483036343, -0.11548252484653072, -0.1505001008801831, -0.15115493328869029, -0.11667149774132125, -0.1243792772803687, -0.1280739476470694, -0.1300164370813426, -0.12132283907291189, -0.12093929338546512, -0.12594551117214187, -0.16804669258024021, -0.15495788201033703, -0.13710339770258398, -0.12687569415258093, -0.12563536725886024, -0.1585903134223614, -0.13340856579979055, -0.13097073330511214, -0.1322598244909756, -0.12497751366881622, -0.16082242067367697, -0.13102265922097037, -0.13999650830061847, -0.12940941740665673, -0.13611910200945787, -0.13426229500361453, -0.12467430197220103, -0.1280500475944258, -0.13499429373161861, -0.12933260074498812, -0.12918639683395922, -0.14038571042123474, -0.16182826356035337, -0.17207014456170683, -0.14677207023614533, -0.1267900443293803, -0.14383984254649396, -0.14359682121981873, -0.12230830793897036, -0.11839440032337135, -0.12801523418544866, -0.12754693512342496, -0.1429154338734327, -0.12006421074473932, -0.13423051645822143, -0.13556868485588958, -0.12954861499487944, -0.12082549577064108, -0.12580973946180612, -0.12625040853445754, -0.15050355161408746, -0.12750415834131537, -0.1351781983382809, -0.13302548918098675, -0.13871047053836819, -0.15974484376388454, -0.12162680349486192, -0.11474779719424359]]
    lossveclist = lossveclist_testnode + lossveclist_trace
    plotLossVecs(lossveclist, lvecnames=designNames,plottitle='95% CIs for design utility\n$\delta$=1, $t$=0.1, $n=30$, test node and trace selection',legendlabel=['Test node selection','Trace selection'])    
    '''

    # Now use a different Q estimate; shift 30% of market share from TN leader to other supply node
    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3]
    designNames = ['Design 1', 'Design 2', 'Design 3']
    numtests = 30
    omeganum = 100
    Qest = np.array([[0.7, 0.3], [0.4, 0.6], [0.4, 0.6]])
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    omeganum = 100
    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                                   designlist=designList, designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    '''
    lossveclist =[[0.12115009438755228, 0.13461110512884492, 0.1722216130383893, 0.11960971895499706, 0.11986969880423198, 0.1387469483592486, 0.10637471497896413, 0.14075768675367248, 0.11053010265465694, 0.11898031153447819, 0.12182649253221783, 0.12546709732453665, 0.14566358794114181, 0.12291165358830142, 0.12632423629814665, 0.13844715785587744, 0.1359827150513592, 0.12300528691184191, 0.1363459160477962, 0.12265007668860892, 0.14730260046337898, 0.14104361619447311, 0.1310801356030417, 0.1453021473378001, 0.16936519076503334, 0.12549479057661622, 0.18616654691899012, 0.15237832126983022, 0.13867931039547374, 0.13912895623661575, 0.13364441502288119, 0.1651547174206939, 0.11933313530596476, 0.13892032603885546, 0.14052724967255562, 0.14289983599826683, 0.17070889282723736, 0.1271047167971126, 0.1580977315941791, 0.12792877586220888, 0.1868658019711628, 0.14806590016732527, 0.16115816484424453, 0.13301862163080286, 0.13927503970190105, 0.11127744633207685, 0.12085063969884527, 0.18536200300755812, 0.141768171091285, 0.1312310216109566, 0.11236103821661589, 0.13523545581511687, 0.11217305140599704, 0.1277586148975934, 0.13457144743540686, 0.12115891288269691, 0.15112017648553427, 0.12552508852768887, 0.1310784608389094, 0.1106546332169137, 0.14600251867579464, 0.14791863466109248, 0.1470317569602481, 0.12588421784509765, 0.1350118985577273, 0.1373283452450607, 0.11246647766318077, 0.13485269174557718, 0.14792604494600778, 0.14820424727855075, 0.11750408808897744, 0.15516998426041514, 0.17852508655511987, 0.11330770146083034, 0.1513291022967901, 0.20881039171652188, 0.12914660865934724, 0.16713397522990997, 0.11837392401015155, 0.1800579906301695, 0.11032769162757677, 0.14717431813707246, 0.12079954819996869, 0.1176592922550538, 0.15535546469963152, 0.14011632332071156, 0.13535615901393339, 0.1270167610404591, 0.15918693664718211, 0.15919348205063158, 0.10171960979395292, 0.12081638784540838, 0.2090079952235582, 0.14477125377567596, 0.14185012699735966, 0.13962534148872444, 0.15238493972399883, 0.14989487639079063, 0.12809288548959516, 0.11570351183925796], [0.1314931888519746, 0.1505300474400284, 0.11528985301854695, 0.10451556416532552, 0.14876900527362502, 0.11211052687891992, 0.13110760183986897, 0.11272461486145662, 0.1109715145085325, 0.1272576474481824, 0.10844575909476188, 0.11941814028375643, 0.10105428463004498, 0.10169346713072862, 0.12949354194146184, 0.15241920365955614, 0.1417826736994067, 0.12864311567438846, 0.21979318324998623, 0.10281915955422438, 0.1453075419961713, 0.12587524678250336, 0.15875456058830764, 0.10910289355433153, 0.11348088299451752, 0.11053648099012525, 0.13349220067792336, 0.10888626883237473, 0.1305198127309108, 0.10569937042569008, 0.17610053696939756, 0.10525542199748214, 0.13022957531580662, 0.11100263596431463, 0.10164653065250313, 0.1331595651205772, 0.13295480578684155, 0.11016142455422666, 0.12701363682116398, 0.1198758883747071, 0.1699933811126077, 0.11488898481110511, 0.14698898206227842, 0.16608957269600125, 0.19658979188591963, 0.10906670858499384, 0.1546102933330245, 0.10908478813954003, 0.17062814369015147, 0.14979189637405763, 0.10114339889835564, 0.10499322126964893, 0.10475532563280326, 0.12490861715625166, 0.14801871255468452, 0.15075830311546756, 0.1281423542616761, 0.12867633588591693, 0.12716147964505778, 0.1733326222554273, 0.10766779399202417, 0.11242084059316818, 0.12463355284543258, 0.12395229802056762, 0.17704110803411324, 0.10947157779723812, 0.17328031216481302, 0.14917821530344874, 0.15109603777884528, 0.12857014287451285, 0.16540631826151078, 0.10772871425130096, 0.10432814427881058, 0.12432940211476576, 0.11252257064858817, 0.18012880712455354, 0.11525820823438854, 0.13039103881168812, 0.1490496717498257, 0.1522142675165206, 0.1300237058345265, 0.1316735458829273, 0.10725557813477511, 0.16106942311002564, 0.11013671349995913, 0.1180819791692349, 0.12981730056948088, 0.10885305703439736, 0.14082639309240447, 0.12815741282820123, 0.15889412500120492, 0.1289178196638307, 0.1425631595157095, 0.127706112285063, 0.14695983665099996, 0.11184398686635888, 0.11750118310416592, 0.1879213051098772, 0.1676624661607494, 0.15239158347671497], [0.1889125036869928, 0.11260991061977453, 0.11446849719047707, 0.16782784569497525, 0.12900815054826337, 0.13638815850763414, 0.11410618995327353, 0.112278267189228, 0.11325723380763975, 0.1655306736087747, 0.11650187113859797, 0.10864183297055878, 0.16808755768251926, 0.10211987938047257, 0.10546861912569024, 0.1195951046852699, 0.11307446865023776, 0.11550161042471585, 0.10394546664817032, 0.10313478788212213, 0.11004319776253961, 0.12143254091035788, 0.14104043102692082, 0.11283057606806825, 0.14882709869094904, 0.13369235765178167, 0.1194390942860912, 0.12948865737703358, 0.10296332920963425, 0.10651573878412791, 0.16792826677578057, 0.13780707054017324, 0.14093896002403186, 0.12908445872666777, 0.11717581877958087, 0.12047180324056124, 0.1405452595160873, 0.11593185776694177, 0.11030412397315592, 0.10665500233737807, 0.20547851912464388, 0.1288248499849765, 0.14894056897156804, 0.154911286049414, 0.11230031111573986, 0.11226491526568062, 0.1439356950383056, 0.17195699434569825, 0.15855421172034356, 0.11638363727637273, 0.11708753628404249, 0.15118876421030128, 0.12059104329301999, 0.1289447494447829, 0.1373948554497738, 0.13888053078463536, 0.14857005772664078, 0.11604921376091433, 0.16198558365637825, 0.10267320811082346, 0.1109477925131397, 0.10593576726294643, 0.11544050100772772, 0.1084114593882065, 0.13563810981851407, 0.13592836442942313, 0.12370451661323142, 0.10985507897785665, 0.19587633334999002, 0.1304644476082767, 0.11522011286430336, 0.15579312608044452, 0.12741240161296521, 0.11080096107188679, 0.1125692088287127, 0.15832222711412716, 0.11447742529836313, 0.11022776220404057, 0.13030398527557016, 0.14654022040743023, 0.12940871021272302, 0.1106110396562316, 0.1258566368669427, 0.1320505499360573, 0.11569401968811101, 0.10042944047675217, 0.16399779196036632, 0.1494466333553447, 0.1471911499963044, 0.13221280503511085, 0.13855376259254734, 0.12026207494907633, 0.13850896620076553, 0.18393815819650733, 0.14294700441787248, 0.11632861789428603, 0.12988121731331415, 0.1681711837362325, 0.18243456552130455, 0.13347849383281346]]
    lossvec0 = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    # Now use a different Q estimate; shift 60% of market share from TN leader to other supply node
    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3]
    designNames = ['Design 1', 'Design 2', 'Design 3']
    numtests = 30
    omeganum = 100
    Qest = np.array([[1., 0.], [0.1, 0.9], [0.7, 0.3]])
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                                   designlist=designList, designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    '''
    lossveclist = [[0.12620225309764227, 0.14362722156224306, 0.13925899467834388, 0.1316839804652289, 0.1348326999751596, 0.1381360396157157, 0.12344216422421511, 0.12438054269131847, 0.13296952858371489, 0.11480363100002812, 0.12357754362888537, 0.1114857753037955, 0.15361101005350195, 0.12252274107757456, 0.12900829128995878, 0.1530776999202026, 0.12580160015380346, 0.1046801024962892, 0.10493574743898232, 0.11437992817213863, 0.1428134962008454, 0.14487572377264848, 0.12501477029477825, 0.10893314752234166, 0.15135408450585217, 0.1247011484098704, 0.12190777500990334, 0.12439589246413428, 0.14126468666015415, 0.11625846812022167, 0.1292421122250613, 0.15164242231560446, 0.12408019565555542, 0.1315852290206306, 0.11930963680102773, 0.13056029610587583, 0.14234589341052148, 0.12570378405933483, 0.13248520837940062, 0.12317146735849491, 0.14262156500215065, 0.10839215863368461, 0.12785939558690407, 0.1314484794033972, 0.1312282746365712, 0.12442867131530813, 0.12379104044144955, 0.14494668048468543, 0.13424906081823743, 0.13526186869480886, 0.12205014975520066, 0.1627080886017051, 0.156592751067117, 0.13563453643464898, 0.16800806757177741, 0.11438320507007184, 0.13230973474463972, 0.13022732671061732, 0.12880790968282174, 0.12015247877916463, 0.16926429586071853, 0.1324407396024803, 0.16375829540430392, 0.12680644633076463, 0.13322615837473514, 0.14963447690111883, 0.11934904076895093, 0.14554537010483554, 0.1458846222356688, 0.12188161530184932, 0.13204703688501981, 0.1217549658719824, 0.18900609624846487, 0.11221112575425599, 0.16055431215111374, 0.1971978539658249, 0.1356471438752369, 0.10895608157699879, 0.15236288673969317, 0.1371366374236574, 0.11911408490928342, 0.1391058601945861, 0.13168835012389943, 0.12046782399669473, 0.12334677847305803, 0.10294011457872033, 0.13305282514595979, 0.13054503183045346, 0.1215320051037103, 0.1267646154823363, 0.11960536751427922, 0.12466599945137301, 0.1751929515286762, 0.1231170186319233, 0.12615196835143935, 0.11532544649698541, 0.15663175114889225, 0.13961740666848232, 0.14046828837564104, 0.12025475236911155], [0.1418017789209135, 0.1254168145874347, 0.12276889236304836, 0.12125845141337158, 0.13941757697417528, 0.12644036638154124, 0.11010883968500863, 0.14049147169907247, 0.10956921551955029, 0.1571476962511997, 0.10941850745210498, 0.146246317148977, 0.17913167641698086, 0.10920135388974865, 0.15360047159856982, 0.12766511134151545, 0.12469251811409211, 0.10820508013465462, 0.1416215533875236, 0.1061153503038121, 0.1239291215513019, 0.10663526196327612, 0.12790027709780322, 0.11471783664938077, 0.13008366323290171, 0.11181897925787494, 0.17122302121353056, 0.1283261279363284, 0.11165275206904907, 0.1362619324074905, 0.16362883306632026, 0.12590374364636925, 0.13380358541950732, 0.10602261421566526, 0.10729983442595145, 0.1299892858058558, 0.10651833722401699, 0.11006407155306293, 0.12890701171182992, 0.10821997915423748, 0.1439058722035614, 0.12704093474381709, 0.11008206389663042, 0.1817825933202038, 0.1920559575379196, 0.10774084618500851, 0.1221782493814412, 0.13924121317970564, 0.17207835131141888, 0.1507149768235325, 0.1196587427780395, 0.12544183833578204, 0.15329367459816887, 0.1451820131569236, 0.14067644269126373, 0.10871574361218905, 0.15212262164051532, 0.12701763290805954, 0.13950581155664835, 0.12520814744025746, 0.1142953156896037, 0.11082303660326528, 0.14923280847561957, 0.1081304260981485, 0.1256007569039868, 0.11218353747127403, 0.12261460508711947, 0.1474710160474247, 0.10860525561160636, 0.11054302856246385, 0.12049796093954243, 0.1099634501291226, 0.11234600900299664, 0.11086079480947206, 0.10765255524701645, 0.1607793362017592, 0.10998272695037566, 0.11199949740800477, 0.127469342835561, 0.1292919998072768, 0.11206758398532722, 0.1086605296394935, 0.15497153194594118, 0.13651803306137955, 0.1457950808536293, 0.11234235725000248, 0.1240678150850545, 0.11032440176908707, 0.10694350221514644, 0.16051749576399743, 0.13887083078816476, 0.12713023515405392, 0.1679723088244741, 0.11125644163634951, 0.12472420793022186, 0.11877196016739867, 0.10213186234944396, 0.14554317000026717, 0.15474108428006528, 0.11153053639882014], [0.12308784339549932, 0.12902260631483958, 0.12886480049088742, 0.16712129443544255, 0.16752631761171569, 0.12228584532249157, 0.10539862316663093, 0.14978955461669663, 0.11045471809837439, 0.1762168506508236, 0.1100425541205162, 0.12752789697973185, 0.12824393931312403, 0.10971914757447457, 0.16108381538404415, 0.11033701247018474, 0.13756876023950582, 0.11241642265680366, 0.1727748916597516, 0.10861597686615163, 0.11475887809207892, 0.11209728487958061, 0.12597544459235777, 0.10395277604623983, 0.1153987705720796, 0.1307495268741258, 0.14416418669159214, 0.10422532507056981, 0.11519259316187089, 0.13163079949634346, 0.13247172891354506, 0.11707733147114531, 0.1599948379623924, 0.10952884101354053, 0.15250814319577513, 0.13770828406597113, 0.13480245820818432, 0.10950676706705496, 0.11083372575842135, 0.13254461564102588, 0.15942457179407155, 0.11056183049766352, 0.11042187133045124, 0.13184026170870275, 0.15961641155541323, 0.10657096743149784, 0.14419917440035449, 0.15560292570175824, 0.1510908949890016, 0.11386232889970446, 0.1290395741407423, 0.11536591103318139, 0.15394654078800663, 0.11471825519620822, 0.17588123320719895, 0.12944205734772146, 0.1471853288916208, 0.11567201279050267, 0.1714363512533929, 0.12765848610777558, 0.13090124253418986, 0.11480807631212026, 0.12150864392286286, 0.10567227041436929, 0.12696227035678045, 0.12354136632406046, 0.1481732828560903, 0.13271664148348106, 0.13683062689388717, 0.10695513460152432, 0.14387780252684038, 0.11375289883765065, 0.12135482951931267, 0.12361475439177617, 0.1716952616883734, 0.12986120080649619, 0.11226115336702354, 0.10463398955119964, 0.13112233323375957, 0.1565869971589932, 0.14532718775497058, 0.12068757335426322, 0.15719683349593072, 0.10627494687124903, 0.1354719466017762, 0.09541222257662813, 0.11402963426477268, 0.12150592025734142, 0.11213006697424624, 0.11144724915850399, 0.12399660891805296, 0.1106546151498917, 0.11603019474534286, 0.11440581316268267, 0.10150181158882708, 0.13292269940438164, 0.12382725092909407, 0.16117000300799345, 0.12363405312913316, 0.10387318145473569]]
    lossvec0 = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''

    # Now use a different Q estimate; shift 60% of market share from TN leader to other supply node ONLY FOR TEST NODE 2
    # 30 tests for all designs
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design1, design2, design3]
    designNames = ['Design 1', 'Design 2', 'Design 3']
    numtests = 30
    omeganum = 100
    Qest = np.array([[0.4, 0.6], [0.2, 0.8], [0.1, 0.9]])
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    lossveclist = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(),
                                   designlist=designList, designnames=designNames, numtests=numtests,
                                   omeganum=omeganum, type=['test node', Qest],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
    '''
    lossveclist = [[0.14041511622659597, 0.1331926365214835, 0.13502020467115539, 0.1600748130920711, 0.13783662439903208, 0.1690038913403125, 0.14891362007963338, 0.1753777289005296, 0.14092990661213714, 0.1533515426472005, 0.13725947445647985, 0.1388005723010352, 0.15751246194033205, 0.15567036758195751, 0.1441730345398434, 0.1464820280417062, 0.15597003415519722, 0.13973628862488652, 0.14775230428826527, 0.14840444941132694, 0.1581271854976226, 0.1313329341102158, 0.1611426411036488, 0.1265317494990795, 0.15089412018205917, 0.1440572830718544, 0.14339090454073417, 0.15691834877619046, 0.13684369361690238, 0.15652807669332394, 0.177851332905445, 0.16283023143013617, 0.1117709211655677, 0.14863917173956798, 0.12639275147269588, 0.15265925963350793, 0.1933853823599346, 0.16015370597622913, 0.1655968162702132, 0.14381568431636754, 0.15104917122292325, 0.1363656864769608, 0.17928576036297972, 0.12018994924502968, 0.13906759716823813, 0.1328123770937688, 0.13551528043713626, 0.17294691392128653, 0.14632796951864882, 0.16134016853046707, 0.13337409858869098, 0.17317570694803536, 0.15133222331936047, 0.16158592945231065, 0.1558621211244873, 0.1480934797351278, 0.1327609551674112, 0.14426854046946616, 0.14658031816349318, 0.12909463156653142, 0.17528119871729173, 0.14697456489332925, 0.1583447073552582, 0.1356680834451272, 0.13324949576284303, 0.15704529781902246, 0.14093353926886865, 0.140975054453624, 0.14697114380996057, 0.12384439031693575, 0.1288100533485225, 0.16784982045203814, 0.13957580770553993, 0.14448359032215735, 0.17941317397868864, 0.1955661814896146, 0.14447019433001745, 0.15949145294227632, 0.17821514867353208, 0.16609764481173178, 0.12671078734277572, 0.12791114473952028, 0.14849676245105692, 0.14875225527024333, 0.19128373306405705, 0.14219266293275143, 0.16633817434682066, 0.15375374994237864, 0.16201194246489284, 0.15794049747741506, 0.13894447533694892, 0.1485903381432227, 0.17533689830774626, 0.15697496446858136, 0.13439067937154867, 0.1441014860944704, 0.17294410165607324, 0.16014058702498243, 0.15766179936078892, 0.15717912036840032], [0.12163404693249581, 0.15758366930162593, 0.1077267856600821, 0.14345994728376643, 0.13913495641252274, 0.1628351435738417, 0.1237922700973976, 0.13377069828833704, 0.12553101623769694, 0.1440337246967679, 0.10463753623096175, 0.13758418983752854, 0.15590183976649183, 0.10689419060080915, 0.15261350750755723, 0.10752545876770003, 0.10766098221760219, 0.10626263361776891, 0.18084661413405886, 0.10629493173454516, 0.10848962397235426, 0.15914814241669534, 0.1397560227806085, 0.1424473039771246, 0.12884254744716497, 0.1409904350272403, 0.1581575975852327, 0.14625746589495514, 0.13576082323033795, 0.12866602555595819, 0.15693221154487713, 0.1258973966904689, 0.10287952995253892, 0.11353886346327006, 0.10977737819075713, 0.1217101499451182, 0.13819564166205603, 0.13048707997284262, 0.102906295565226, 0.10291919615606442, 0.1565396551137654, 0.11294861587414731, 0.14861998815545754, 0.14783261137504358, 0.22949059556374032, 0.11090918951864348, 0.10887026460219044, 0.11375656657136463, 0.1548863210266266, 0.10700157098286088, 0.1352553554793113, 0.1029468231621314, 0.1645855574900723, 0.15418072238061206, 0.14420566465842674, 0.10340441674438025, 0.10704680936080335, 0.1030949219810921, 0.15212971596202254, 0.1521099754994259, 0.14654876498314492, 0.11110742012548558, 0.15262328073614412, 0.10901701995163111, 0.16257899095333206, 0.13204114390458815, 0.15660246319387985, 0.12339995120698488, 0.13798535871913303, 0.12041600392859428, 0.12530079060774638, 0.12405611547993145, 0.12948427292238257, 0.11081441247298829, 0.12369633518375356, 0.22075347523010422, 0.11496350856295473, 0.13647645016993604, 0.12177442586290775, 0.10533150995827051, 0.13927196171466857, 0.12137894514213882, 0.12443735892117173, 0.12294269649879244, 0.10912303855327268, 0.09926275049661312, 0.1010198199789297, 0.11764656912840653, 0.10797965920697232, 0.1559372623004877, 0.1595231205832344, 0.11936728738183308, 0.128794247633241, 0.1236145114035947, 0.16065549934287857, 0.10659815453601128, 0.11872472506897419, 0.14281802371452865, 0.15823035383943776, 0.10960328549891803], [0.14877477425589516, 0.11311576276070683, 0.1216632820533828, 0.1642339830775653, 0.10702395033898648, 0.162787247798613, 0.13168287946312052, 0.16257784331273134, 0.13684408383945124, 0.17568999046571088, 0.10699133665260266, 0.12236343533618228, 0.15776181944278028, 0.11074551871814026, 0.15942133259707778, 0.12145819367260986, 0.15048868631904364, 0.10775163960205442, 0.16511902789690003, 0.10387717415399048, 0.13309835394548195, 0.10617595317010303, 0.12987942066034747, 0.10201645567281042, 0.126907399913905, 0.19823946107620896, 0.12176453865026302, 0.11377618476998211, 0.15597546289288905, 0.14658627913291186, 0.12668473873557837, 0.1127753852961418, 0.13515570134143493, 0.1430153571404359, 0.17427854493369252, 0.1306243457201959, 0.1584840937035551, 0.1161793697871261, 0.12252346139780003, 0.11451741368665348, 0.1654481494741256, 0.11520156397336975, 0.15830495792926375, 0.19916341516498137, 0.18394919805956436, 0.10633951766941033, 0.12354539773706827, 0.2071300520412882, 0.11837194601517449, 0.12863686352834025, 0.13649491635430058, 0.12515542417983877, 0.17142277183136337, 0.14541454363901993, 0.15533124667069542, 0.10940942182100474, 0.12048552392162369, 0.11197003752329027, 0.11151924369819952, 0.13988908786981594, 0.1337819542533619, 0.11729890747105416, 0.13970100924629544, 0.11050957537050118, 0.11284093195130512, 0.13993171562369136, 0.17277400653359148, 0.12071173308408516, 0.12154689418585238, 0.10989445450034718, 0.127278744664179, 0.12105039081557839, 0.13584387975074247, 0.12021569240143247, 0.12644026094083596, 0.15647551939739457, 0.11709013849475347, 0.10817986426940432, 0.17552882504857056, 0.12998710384240839, 0.12254607920793276, 0.16724219915030636, 0.12513365899243925, 0.148952719058311, 0.10739246677612897, 0.1100088078439537, 0.1204170735694258, 0.11044281141191195, 0.17786486428088372, 0.17388276729695681, 0.109965451256382, 0.11155466102925736, 0.1558851193644145, 0.1786979198808784, 0.1422291297201904, 0.1515958926310972, 0.1164744632229547, 0.15968805296811486, 0.22004691449652372, 0.13055913336095995]]
    lossvec0 = [[0.16375364323693128, 0.1598924098297443, 0.16677607930317992, 0.16262309109948725, 0.16188093947140314, 0.157417741665715, 0.15506884850824199, 0.15941718184048764, 0.15282420444100275, 0.15626366688471008, 0.15572577584185382, 0.1575433641097066, 0.15299900810028547, 0.16665926604868425, 0.15828495126999473, 0.15870871088172278, 0.15557799103217498, 0.15833930128595194, 0.16905563020309589, 0.15940674903548974, 0.1608525097363954, 0.15381043349672274, 0.15939318914529807, 0.15545569559840658, 0.15303684755918198, 0.16821064281886222, 0.16245571600502157, 0.16257840155825892, 0.15252489752501308, 0.15433072776901252, 0.16364994795323945, 0.1579890795943676, 0.16436213080867138, 0.1658702895100968, 0.153411180123921, 0.15609545273829709, 0.1618149846666891, 0.16171901079095893, 0.16759210238465078, 0.1533561507927092, 0.1657515925645132, 0.16162558063079147, 0.1655038755360929, 0.1682526500473327, 0.16340195382486064, 0.1541341551722113, 0.16277564260011654, 0.15428475127720326, 0.16089461930114343, 0.1585954843513574, 0.15759429376621722, 0.15989907503786943, 0.1536116293638464, 0.15845502564458225, 0.16052103806227147, 0.16315107870073428, 0.15460359182858768, 0.16485917974241576, 0.15889838329088424, 0.1640656379297554, 0.150144918379174, 0.16377727397633166, 0.16343048272214358, 0.15497442737408612, 0.16053657001895796, 0.1610431061141195, 0.16229444224542286, 0.15972157664991693, 0.15381414185941167, 0.15597832612019064, 0.16562458518880893, 0.15595217942040576, 0.1603847893837301, 0.1611120657905986, 0.1532714356380745, 0.16108526245136187, 0.15630493416137503, 0.15799496190185, 0.15249177037061096, 0.154395096702405, 0.163679403659234, 0.16123106071808255, 0.1566742449677942, 0.15583065139781363, 0.15371728282113395, 0.16451059480697264, 0.15965258390385972, 0.16669918989045673, 0.15856848844392735, 0.15593563711561548, 0.15945917400382678, 0.16444289413535804, 0.16144397531488, 0.16394460887977857, 0.15808940474812164, 0.15516427158986124, 0.16397906625340097, 0.16616934455334773, 0.16338488421250086, 0.16207290278862374]]
    nullmean = -1*np.mean(lossvec0[0])
    lossveclist = [[vec[j]*-1 for j in range(len(vec))]  for vec in lossveclist]
    CIalpha = 0.1
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist:
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (nullmean - (mn-intval))/nullmean
        hiperc = (nullmean - (mn+intval))/nullmean
        print('['+str(loperc)+', '+str(hiperc)+']')
    '''


    # FOR DESIGN 2, DIFFERENT BATCH SIZES
    # BATCH SIZES: 0,3,6,9,15,30,60,90,120
    underWt, mRisk = 1., 0.9
    t = 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design2]
    designNames = ['Design 2']
    omeganum = 100
    random.seed(35)
    randinds = random.sample(range(0, 1000), 100)

    numtestsVec = [0,6,12,24,48,96,192]
    lossveclist = []
    for numtests in numtestsVec:
        lossvec = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                   designnames=designNames, numtests=numtests, omeganum=omeganum, type=['trace'],
                                   priordraws=pickle.load(open(os.path.join(os.getcwd(), 'priordraws'), 'rb')),
                                   randinds=randinds)
        lossveclist.append(lossvec[0])
    '''
    lossveclist = [[[0.1631624760638568, 0.15720307855535465, 0.1608639458015167, 0.16447283684593733, 0.1597308858525191, 0.16530244555035933, 0.16669312810707285, 0.16160074117278947, 0.1653192236072529, 0.16204418974476908, 0.15497871429023474, 0.15467411765416555, 0.1613750771551091, 0.15747074496261462, 0.15227562871749936, 0.17145553434981564, 0.16369361082463926, 0.16692521749216743, 0.16203792928496977, 0.1590776035470591, 0.1551749348303539, 0.16082428779764713, 0.15756807299460315, 0.1550608320048446, 0.15631195454060692, 0.15770983060319332, 0.16414686544787604, 0.15488810166410838, 0.15665288807970829, 0.1603004871311405, 0.16244412648327097, 0.15682117281806454, 0.16354500356802104, 0.16415919851377875, 0.15638019764514263, 0.16670011136232835, 0.15949899115009494, 0.1615188645137574, 0.15735859905742092, 0.15677491970077437, 0.1632770477454912, 0.14924291956044927, 0.1574308890174942, 0.16345504155976637, 0.16461700092995968, 0.16393482231407522, 0.1567846630510756, 0.1592431152969494, 0.15772433382534407, 0.14844073064826993, 0.1480748185152451, 0.15995265165098485, 0.15794841277723592, 0.1572413873265836, 0.1622471046539544, 0.16417357970743476, 0.15887070770145548, 0.1564296671429403, 0.1540633086236506, 0.1574801602328406, 0.1636280978407651, 0.1614998685157631, 0.1577330744011513, 0.15305409049467894, 0.16450330767712035, 0.15431738262912842, 0.1704341250563957, 0.15808855691643203, 0.1624660034460682, 0.16984983201379783, 0.16483379350966765, 0.17121651483881745, 0.15037817832139538, 0.15245994964489948, 0.15922731238943802, 0.1591623946701067, 0.1593963075601854, 0.1566343324544281, 0.16163975965273666, 0.16063162964748812, 0.15588301419308162, 0.16196747619948323, 0.16966545510320571, 0.1608916131441504, 0.15122267730328054, 0.1650651247623661, 0.163162013176352, 0.16165030963215343, 0.16726574770151145, 0.16236020655648817, 0.16454285631917326, 0.15453297321044887, 0.15539168550866006, 0.17099218057510968, 0.1600247961031962, 0.15695387350753648, 0.15969570999392832, 0.15967241534002483, 0.15652864332227961, 0.1649838594051987]], [[0.13581187716248172, 0.18088862714115198, 0.14489153641861324, 0.1407890279233018, 0.18099237682855351, 0.15058851774690193, 0.14997399229156802, 0.13405129836319882, 0.1442052945685419, 0.13990593804879517, 0.14686913895175827, 0.13689015633381152, 0.15825833334463651, 0.1815645964096146, 0.1392312864075857, 0.15024859546964925, 0.14667756088755204, 0.14088340708901567, 0.14238954947578825, 0.14334681492939508, 0.14183410717710945, 0.14414654634113086, 0.1444406285270409, 0.13975042694172382, 0.15036432400835445, 0.16007652934248065, 0.14755226719130932, 0.14708004565686794, 0.13884124579177187, 0.14808199437738362, 0.15043919026223102, 0.1447327502571794, 0.1404101742113437, 0.14307111180657325, 0.1420086651992926, 0.15240340051086046, 0.1540685557881656, 0.15303892159022828, 0.14174721972850593, 0.15567295973710682, 0.14208117049926242, 0.13543497073953406, 0.1434290143244919, 0.14487970046389403, 0.1451692554592949, 0.14273054643408245, 0.14154632783214213, 0.1509648900603302, 0.14977910684609488, 0.15516179217901366, 0.15569239800788887, 0.13569989975283608, 0.14059720618200708, 0.15964775977376827, 0.14055351842204625, 0.14445754569705252, 0.14552435380923187, 0.15060011430885825, 0.19682336129112152, 0.1903683574375264, 0.1842772537363947, 0.15063892910522259, 0.1382294500548737, 0.15644943240778797, 0.14839469299878627, 0.13895815061869263, 0.1444095705088078, 0.13788217323762736, 0.15468210701031607, 0.14564459557778087, 0.14693029010935366, 0.14528859200546765, 0.16050427169596518, 0.1530289550094832, 0.1495148033249957, 0.213210449112839, 0.13801290826699014, 0.1397220702465254, 0.14627221488870465, 0.1486402228320335, 0.13386334453231388, 0.14637002483055592, 0.15927541239996018, 0.13909176608991983, 0.14393482580935285, 0.13604924855685532, 0.1446532141515603, 0.15002242300858432, 0.13783426467544038, 0.13613361461439094, 0.1497411624166203, 0.20920103718358576, 0.14629665588874954, 0.1422246470857519, 0.14659394524923242, 0.14394487105738138, 0.14183764842635366, 0.19323757398993724, 0.13556382099079836, 0.1451395814757909]], [[0.18250358204412992, 0.16148098124961843, 0.12839932339079688, 0.15672744084363527, 0.1236965873930104, 0.1732208782318235, 0.16444273963228168, 0.1383937539435883, 0.13461374609421037, 0.12464911699160307, 0.13380000131927153, 0.1345942646438583, 0.16222490930144065, 0.1374486203265875, 0.16924316524462518, 0.13602391077235956, 0.19670178193515164, 0.1304784903017601, 0.1855368215016094, 0.12942812562539657, 0.12579055814705958, 0.13072814535600158, 0.1288847727307339, 0.12365249220149874, 0.14475954300849617, 0.1304974813610493, 0.13163237320284552, 0.1362757588501883, 0.14821494389290768, 0.13500820823463172, 0.13529793028374304, 0.13346513967924808, 0.129413822416884, 0.1354694120103084, 0.11691750795007518, 0.14021563306086918, 0.13686511787576583, 0.13349473953440835, 0.12795460504596465, 0.13182268156110855, 0.18032903559200306, 0.13744321271789525, 0.1365412412357825, 0.1264862396557037, 0.17363579626438524, 0.12810388335802037, 0.19156492836423558, 0.1613974791338099, 0.13749925395367715, 0.16864379790131992, 0.12204610523256679, 0.13253489057588766, 0.20036361972145506, 0.18205079662820556, 0.1378226373699295, 0.1667300729686068, 0.13136362971124302, 0.13832406732540026, 0.12947892119556578, 0.13370736362099322, 0.13093123393684697, 0.13483078492074185, 0.13366181365761268, 0.1426682244255122, 0.13198976597000767, 0.13269250216552264, 0.14079333298919827, 0.1311633318368286, 0.13525013341227063, 0.14286439858609642, 0.13790607413260783, 0.12701338386215708, 0.16994924704784165, 0.12531213972928887, 0.13685080325884527, 0.13633526650814323, 0.12744034509470006, 0.17796580695259642, 0.13109099441689367, 0.13770691002294608, 0.12796634554414835, 0.1331673374439455, 0.13440078597581784, 0.18790347655597167, 0.12878761506753905, 0.12468058134705738, 0.12475278052998261, 0.12881583944100122, 0.13135572150594654, 0.17322114423383167, 0.17014296165318699, 0.14245614243153948, 0.13948090010677042, 0.13596371647110053, 0.12795486778809745, 0.13022707616928467, 0.13636115857758888, 0.19657861395814205, 0.15924553913809517, 0.1345624158289855]], [[0.13570451893533322, 0.11635223574434869, 0.1256451024333039, 0.18948313529010136, 0.11559979032588766, 0.10893972772081377, 0.11313580685054267, 0.12370476478519414, 0.13839439611233917, 0.1629628730855595, 0.11974600981702214, 0.11435542228016754, 0.16433463246018323, 0.11955706614376678, 0.16589876740269288, 0.11432966749158172, 0.11551439339645653, 0.12218630591181527, 0.11628324636211212, 0.12395470906913884, 0.11169793772837039, 0.12070611077820546, 0.15141033110468774, 0.11177276572728483, 0.15029610818865607, 0.11374903247222835, 0.162802928424843, 0.11753697183111571, 0.12216549732580197, 0.11474152470517027, 0.14179128892601683, 0.1125132748800997, 0.11973779463359568, 0.12854093452484935, 0.10714570996268372, 0.14503578536079625, 0.11587088671477333, 0.15231125963445186, 0.10973792645125388, 0.11527345640620716, 0.2025767939032954, 0.12289979638040857, 0.11464327172380251, 0.12480868160308102, 0.17674161404261826, 0.11579580157614061, 0.1386445778429723, 0.1169880707554564, 0.1427359095691076, 0.15601841020488802, 0.11772953264711931, 0.1301140698995478, 0.11753850270780004, 0.13982908912711328, 0.15346186382729518, 0.15313671656286498, 0.1197289223167537, 0.11186341731235729, 0.17318799644354838, 0.11683510128917025, 0.17146668299833043, 0.12026935830383821, 0.12232029530514908, 0.1192946894231301, 0.12109914534460886, 0.12452617803225705, 0.17241253310049087, 0.11850239600287675, 0.12293090132133262, 0.10967874322323147, 0.13903479154969348, 0.11725072481657112, 0.11766609832301213, 0.11985197737046831, 0.1221416456601214, 0.1765522951841584, 0.12129733008688068, 0.1134210161749199, 0.11602765149492833, 0.12658745249306133, 0.13762755203193308, 0.11923606665276021, 0.18087580053637842, 0.13719880695624678, 0.12272892186949456, 0.12278166400657407, 0.12403960031104742, 0.11680768902227226, 0.12055971143524773, 0.11934707321956482, 0.18391342726744792, 0.15207662697013485, 0.1451226165990153, 0.14957990099154284, 0.11862251373004483, 0.11632017196762018, 0.12527758250108947, 0.1756748507838016, 0.14211874017383444, 0.11745123129327636]], [[0.13329208393734157, 0.11583100256719034, 0.11699971047050861, 0.1389236237831767, 0.11728088296406526, 0.15927387818506378, 0.09993633454736307, 0.10145099364402332, 0.10446922146352544, 0.09976693815003991, 0.10074011894095757, 0.1530023982640726, 0.1600934263394793, 0.11820980344175945, 0.11644466279786862, 0.11683536671947423, 0.1371583067940968, 0.09479323675314252, 0.12482974726304848, 0.09809522880546265, 0.10760962428190683, 0.1135432581053243, 0.11110714474089285, 0.11372175496873044, 0.09943659885492057, 0.12086045031101444, 0.13866207035871822, 0.11118414883780167, 0.1049355213866362, 0.1054228585489571, 0.12772614946142177, 0.09920909088539452, 0.12510147034192703, 0.11190955115481835, 0.10072978700960758, 0.10157204242927649, 0.14095960695876275, 0.09999014491882113, 0.13415067509446757, 0.13510823726602264, 0.15512749732717276, 0.10165183014286679, 0.1014749537214115, 0.11709633662601626, 0.14265316415106183, 0.10089250448004243, 0.1435554100664769, 0.12085596962959352, 0.14919355764285874, 0.11971624235720744, 0.0972650158682408, 0.10259768991889323, 0.12925654597228753, 0.1199594487766792, 0.1154715265598492, 0.09775157838084517, 0.09675154712163658, 0.12116703276756423, 0.119226290440266, 0.11834869573768328, 0.11733180854795892, 0.10205633911471416, 0.10883229933309704, 0.13583286178813547, 0.10282297489104764, 0.10036882038944343, 0.1547645502041658, 0.11660641862034014, 0.09836694376418521, 0.10239956581284843, 0.1560749231336755, 0.09764611510766617, 0.12408486069106871, 0.09763579266012276, 0.1254653830370869, 0.16514701132909315, 0.1018045064109485, 0.11767443047297492, 0.12541355769670937, 0.10616690663410389, 0.11700474272034976, 0.10522482002330098, 0.15084010535997822, 0.1269140513159294, 0.12324154173248335, 0.08970446102301344, 0.12181409060420273, 0.1073828159144149, 0.10561077761860922, 0.13033592021404597, 0.11926490156097953, 0.150246045622258, 0.10027586077379336, 0.14077517937624118, 0.10568570603126527, 0.09735820773338127, 0.10190673562776277, 0.1471287405273993, 0.14992573624710748, 0.12883472543978747]], [[0.11494506208495954, 0.1337968321798901, 0.10238452347452903, 0.12906741093563373, 0.11986047171662009, 0.1330251076055999, 0.09238037937775384, 0.09197262129900947, 0.07484835963866172, 0.09845783906379947, 0.1020100305024721, 0.11712332135813398, 0.1432112074067134, 0.09344991955945123, 0.12903006658005442, 0.11242077378634843, 0.10295972836665614, 0.08335401564240826, 0.10861634028425433, 0.0814922383954625, 0.0769338126288505, 0.08986126873465908, 0.10013852060860105, 0.09154100344667224, 0.10708104718327785, 0.13192601872046023, 0.14640675020539365, 0.07536560987745247, 0.08942689698627615, 0.09915926678131923, 0.12109153048012979, 0.08085889645635173, 0.09799767945583633, 0.08354492243496325, 0.07385738354979805, 0.1175491220717664, 0.09578426632928301, 0.08589369908630308, 0.10737584960032863, 0.0849276435116206, 0.12577727317469592, 0.11038424682424505, 0.09020077019372354, 0.11345432182432931, 0.24580739531536394, 0.09603283213000918, 0.1364179160205298, 0.08164646458010737, 0.12378060221355881, 0.09888029421675641, 0.08370762321221493, 0.08214472210796538, 0.13991223466048205, 0.11361192561863581, 0.1150973532401751, 0.10257234895492394, 0.1243103446600755, 0.09448803638433781, 0.1274055810369723, 0.0783179018009859, 0.1187084192387218, 0.0958110158759459, 0.13592843047889355, 0.08579380010695789, 0.10094833173172983, 0.07826154518609332, 0.13464212297577446, 0.10529620452614691, 0.10269732943437512, 0.08581252528205399, 0.13508541617985714, 0.09291917203556142, 0.08774903884688831, 0.09093741455449755, 0.08085541876696124, 0.13233491715717366, 0.09660537882155995, 0.07967028239148777, 0.09351945922722224, 0.1408768098975076, 0.09042838899621128, 0.09121814709224821, 0.09476318126264975, 0.1354665294306039, 0.11463809058694811, 0.08036836441013294, 0.10857675617461776, 0.08341317599521254, 0.09757034021292911, 0.10480925007028068, 0.11622411897158384, 0.10774251174768286, 0.11066882418764855, 0.11249061642125523, 0.0897527495148978, 0.11358430648161802, 0.11739009394170238, 0.10523298350338137, 0.13407347454371515, 0.13511955940736783]], [[0.10890848781633254, 0.1133356485696745, 0.07064482127366399, 0.10569264630545602, 0.08922211625187597, 0.09872194453621007, 0.07514003327207945, 0.10814086666187434, 0.07236887458937012, 0.09878848504727773, 0.06441454678278218, 0.10601374491681129, 0.1229642423380818, 0.062213142296897984, 0.11827915281464987, 0.07461681670908228, 0.10198559068668574, 0.05990317094036642, 0.10287535077393598, 0.07020419147531322, 0.07312325644545985, 0.10350480256501712, 0.13796306657388527, 0.07056350151038053, 0.09919369137172204, 0.1733242705057, 0.10002466569575638, 0.07011273603387087, 0.08119330504742452, 0.08381883696467846, 0.08941098371421931, 0.14929470953629198, 0.08220918188410035, 0.08052465617742176, 0.08319065231744295, 0.08999127888027143, 0.11891600717198234, 0.1049012563842765, 0.09161638609116679, 0.08064278577583472, 0.14790011059396543, 0.07584408172234296, 0.0817764831055534, 0.11911911205850889, 0.12851511281388195, 0.07000937352672702, 0.11710772681688797, 0.14895857082688058, 0.09352571393182547, 0.09570707696287445, 0.07357864839129169, 0.10334720065864347, 0.10746693212246393, 0.07707641046478622, 0.1096184511669006, 0.09593522318773293, 0.1040381908892987, 0.06875006171291183, 0.09739883902100333, 0.1066678368657045, 0.07289987815291553, 0.08140529847146624, 0.1071444556310915, 0.0974546336187453, 0.08898324996597545, 0.06329920600418695, 0.10060997637989454, 0.12515544619502458, 0.09082929413442496, 0.08385078760708657, 0.09486932373308271, 0.06416279451985338, 0.0839713247635342, 0.08366495220202823, 0.09689250870167869, 0.13211648302883078, 0.07129381914445027, 0.10484322177744372, 0.08437180728495527, 0.12248003184078611, 0.1148488990927233, 0.06657301662364348, 0.08792659324697018, 0.1065641192011026, 0.08488387420295669, 0.08435463370326114, 0.0922770382030507, 0.0823573207197824, 0.07027300562416364, 0.09940578018224441, 0.1099781380510958, 0.1037303838266235, 0.13650593084081242, 0.09244556463801218, 0.11863693117574707, 0.06913125271764804, 0.10345161868613349, 0.11715768427160357, 0.11628658585177734, 0.08890223275966946]]]
    lossveclist = [lossveclist[i][0] for i in range(len(lossveclist))]
    lvecnames = ['0','6','12','24','48','96','192']
    plotLossVecs(lossveclist, lvecnames,plottitle='Design Utility vs. Batch Size\n$|\Omega|=100$')
    
    qts50 = [np.average(lvec)*-1 for lvec in lossveclist]
    stds = [np.std(lvec) for lvec in lossveclist]
    qts5 = [qts50[i]-1.96*stds[i]/np.sqrt(len(qts50)) for i in range(len(qts50))]
    qts95 = [qts50[i]+1.96*stds[i]/np.sqrt(len(qts50)) for i in range(len(qts50))]
    
    fig = plt.figure()
    x = numtestsVec
    y = qts50
    lowerr = [y[i]-qts5[i] for i in range(len(x))]
    upperr = [qts95[i]-y[i] for i in range(len(x))]
    err = [lowerr, upperr]
    plt.errorbar(x, y, yerr=err, capsize=4, color='orange', ecolor='black', linewidth=3, elinewidth=0.5)
    plt.ylim(-0.2,0)
    plt.xlabel('Batch size', fontsize=12)
    plt.ylabel('Design utility', fontsize=12)
    plt.suptitle('Design utility vs. batch size: Design $x_2$\n95% confidence intervals for $|\Omega|=100$', fontsize=16)
    fig.tight_layout()
    plt.show()
    '''


    return

def designUtilityCaseStudySenegal():
    '''
    Complete design utility calculations for de-identified case study data
    '''
    import os
    import pickle
    #import pandas as pd

    SCRIPT_DIR = os.path.dirname(os.path.realpath(os.path.join(os.getcwd(), os.path.expanduser(__file__))))
    filesPath = os.path.join(SCRIPT_DIR, 'MQDfiles')
    outputFileName = os.path.join(filesPath, 'pickleOutput')

    openFile = open(outputFileName, 'rb')  # Read the file
    dataDict = pickle.load(openFile)

    numPostSamps = 1000
    MCMCdict = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    meanSFPrate = dataDict['df_ALL'][dataDict['df_ALL']['Final_Test_Conclusion'] == 'Fail']['Sample_ID'].count() / \
                  dataDict['df_ALL']['Sample_ID'].count()
    priorMean = sps.logit(meanSFPrate)  # Mean SFP rate of the MQDB data
    priorVar = 1.416197468

    SEN_df = dataDict['df_SEN']
    # 7 unique Province_Name_GROUPED; 23 unique Facility_Location_GROUPED; 66 unique Facility_Name_GROUPED
    # Remove 'Missing' and 'Unknown' labels
    SEN_df_2010 = SEN_df[(SEN_df['Date_Received'] == '7/12/2010') & (SEN_df['Manufacturer_GROUPED'] != 'Unknown') & (
                SEN_df['Facility_Location_GROUPED'] != 'Missing')].copy()

    # Divide Senegal data into operational batches
    SEN_df_2010.pivot_table(index=['Date_Received'],columns=['Final_Test_Conclusion'],aggfunc='size',fill_value=0)
    '''
    Final_Test_Conclusion  Fail  Pass
    Date_Sample_Collected
    BATCH 1: 218 SAMPLES            
    6/4/2010                  0     1
    6/23/2010                 3     5
    6/24/2010                21    51
    6/25/2010                 6    44
    6/26/2010                 0    18
    6/28/2010                 3    29
    6/29/2010                 7    30
    BATCH 2: 16 SAMPLES
    7/13/2010                 0    14
    7/14/2010                 0     2
    BATCH 3: 58 SAMPLES
    9/3/2010                 11    39
    9/4/2010                  0     8
    BATCH 4: 114 SAMPLES
    9/30/2010                 7    51
    10/1/2010                15    41
    '''
    SEN_df_batch1 = SEN_df_2010[(SEN_df_2010['Date_Sample_Collected'].isin(['6/4/2010','6/23/2010','6/24/2010','6/25/2010',
                                                                            '6/26/2010','6/28/2010','6/29/2010']))].copy()
    SEN_df_batch2 = SEN_df_2010[(SEN_df_2010['Date_Sample_Collected'].isin(['7/13/2010', '7/14/2010']))].copy()
    SEN_df_batch3 = SEN_df_2010[(SEN_df_2010['Date_Sample_Collected'].isin(['9/3/2010', '9/4/2010']))].copy()
    SEN_df_batch4 = SEN_df_2010[(SEN_df_2010['Date_Sample_Collected'].isin(['9/30/2010', '10/1/2010']))].copy()

    tblBatch1 = SEN_df_batch1[
        ['Facility_Location_GROUPED', 'Manufacturer_GROUPED', 'Final_Test_Conclusion']].values.tolist()
    tblBatch2 = SEN_df_batch2[
        ['Facility_Location_GROUPED', 'Manufacturer_GROUPED', 'Final_Test_Conclusion']].values.tolist()
    tblBatch3 = SEN_df_batch3[
        ['Facility_Location_GROUPED', 'Manufacturer_GROUPED', 'Final_Test_Conclusion']].values.tolist()
    tblBatch4 = SEN_df_batch4[
        ['Facility_Location_GROUPED', 'Manufacturer_GROUPED', 'Final_Test_Conclusion']].values.tolist()
    tblBatch1 = [[i[0], i[1], 1] if i[2] == 'Fail' else [i[0], i[1], 0] for i in tblBatch1]
    tblBatch2 = [[i[0], i[1], 1] if i[2] == 'Fail' else [i[0], i[1], 0] for i in tblBatch2]
    tblBatch3 = [[i[0], i[1], 1] if i[2] == 'Fail' else [i[0], i[1], 0] for i in tblBatch3]
    tblBatch4 = [[i[0], i[1], 1] if i[2] == 'Fail' else [i[0], i[1], 0] for i in tblBatch4]

    # DEIDENTIFICATION

    # Replace Manufacturers
    orig_MANUF_lst = ['Ajanta Pharma Limited', 'Aurobindo Pharmaceuticals Ltd', 'Bliss Gvis Pharma Ltd', 'Cipla Ltd',
                      'Cupin', 'EGR pharm Ltd', 'El Nasr', 'Emcure Pharmaceuticals Ltd', 'Expharm',
                      'F.Hoffmann-La Roche Ltd', 'Gracure Pharma Ltd', 'Hetdero Drugs Limited', 'Imex Health',
                      'Innothera Chouzy', 'Ipca Laboratories', 'Lupin Limited', 'Macleods Pharmaceuticals Ltd',
                      'Matrix Laboratories Limited', 'Medico Remedies Pvt Ltd', 'Mepha Ltd', 'Novartis', 'Odypharm Ltd',
                      'Pfizer', 'Sanofi Aventis', 'Sanofi Synthelabo']
    shuf_MANUF_lst = orig_MANUF_lst.copy()
    random.seed(333)
    random.shuffle(shuf_MANUF_lst)
    # print(shuf_MANUF_lst)
    for i in range(len(shuf_MANUF_lst)):
        currName = shuf_MANUF_lst[i]
        newName = 'Mnfr. ' + str(i + 1)
        for ind, item in enumerate(tblBatch1):
            if item[1] == currName:
                tblBatch1[ind][1] = newName
        for ind, item in enumerate(tblBatch2):
            if item[1] == currName:
                tblBatch2[ind][1] = newName
        for ind, item in enumerate(tblBatch3):
            if item[1] == currName:
                tblBatch3[ind][1] = newName
        for ind, item in enumerate(tblBatch4):
            if item[1] == currName:
                tblBatch4[ind][1] = newName
    '''
    # Replace Province
    orig_PROV_lst = ['Dakar', 'Kaffrine', 'Kaolack', 'Kedougou', 'Kolda', 'Matam', 'Saint Louis']
    shuf_PROV_lst = orig_PROV_lst.copy()
    random.seed(333)
    random.shuffle(shuf_PROV_lst)
    # print(shuf_PROV_lst)
    for i in range(len(shuf_PROV_lst)):
        currName = shuf_PROV_lst[i]
        newName = 'Province ' + str(i + 1)
        for ind, item in enumerate(tbl_SEN_G1_2010):
            if item[0] == currName:
                tbl_SEN_G1_2010[ind][0] = newName
    '''
    # Replace Facility Location
    orig_LOCAT_lst = ['Dioum', 'Diourbel', 'Fann- Dakar', 'Guediawaye', 'Hann', 'Kaffrine (City)', 'Kanel',
                      'Kaolack (City)', 'Kebemer', 'Kedougou (City)', 'Kolda (City)', 'Koumpantoum', 'Matam (City)',
                      'Mbour-Thies', 'Medina', 'Ouro-Sogui', 'Richard Toll', 'Rufisque-Dakar', 'Saint Louis (City)',
                      'Tambacounda', 'Thies', 'Tivaoune', 'Velingara']
    shuf_LOCAT_lst = orig_LOCAT_lst.copy()
    random.seed(333)
    random.shuffle(shuf_LOCAT_lst)
    '''
    KEY
    for i in range(23):
        print('District '+str(i+1)+': '+shuf_LOCAT_lst[i])
    District 1: Thies
    District 2: Mbour-Thies
    District 3: Kaolack (City)
    District 4: Richard Toll
    District 5: Ouro-Sogui
    District 6: Dioum
    District 7: Diourbel
    District 8: Velingara
    District 9: Medina
    District 10: Saint Louis (City)
    District 11: Kebemer
    District 12: Kaffrine (City)
    District 13: Guediawaye
    District 14: Hann
    District 15: Tambacounda
    District 16: Kolda (City)
    District 17: Kedougou (City)
    District 18: Fann- Dakar
    District 19: Matam (City)
    District 20: Kanel
    District 21: Tivaoune
    District 22: Koumpantoum
    District 23: Rufisque-Dakar    
    '''
    # print(shuf_LOCAT_lst)
    for i in range(len(shuf_LOCAT_lst)):
        currName = shuf_LOCAT_lst[i]
        newName = 'District ' + str(i + 1)
        for ind, item in enumerate(tblBatch1):
            if item[0] == currName:
                tblBatch1[ind][0] = newName
        for ind, item in enumerate(tblBatch2):
            if item[0] == currName:
                tblBatch2[ind][0] = newName
        for ind, item in enumerate(tblBatch3):
            if item[0] == currName:
                tblBatch3[ind][0] = newName
        for ind, item in enumerate(tblBatch4):
            if item[0] == currName:
                tblBatch4[ind][0] = newName
    # Swap Districts 7 & 8
    for ind, item in enumerate(tblBatch1):
        if item[0] == 'District 7':
            tblBatch1[ind][0] = 'District 8'
        elif item[0] == 'District 8':
            tblBatch1[ind][0] = 'District 7'
    for ind, item in enumerate(tblBatch2):
        if item[0] == 'District 7':
            tblBatch1[ind][0] = 'District 8'
        elif item[0] == 'District 8':
            tblBatch1[ind][0] = 'District 7'
    for ind, item in enumerate(tblBatch3):
        if item[0] == 'District 7':
            tblBatch1[ind][0] = 'District 8'
        elif item[0] == 'District 8':
            tblBatch1[ind][0] = 'District 7'
    for ind, item in enumerate(tblBatch4):
        if item[0] == 'District 7':
            tblBatch1[ind][0] = 'District 8'
        elif item[0] == 'District 8':
            tblBatch1[ind][0] = 'District 7'
    '''
    # Replace Facility Name
    orig_NAME_lst = ['CHR', 'CTA-Fann', 'Centre Hospitalier Regional de Thies', 'Centre de Sante Diourbel',
                     'Centre de Sante Mbacke', 'Centre de Sante Ousmane Ngom', 'Centre de Sante Roi Baudouin',
                     'Centre de Sante de Dioum', 'Centre de Sante de Kanel', 'Centre de Sante de Kedougou',
                     'Centre de Sante de Kolda', 'Centre de Sante de Koumpantoum', 'Centre de Sante de Matam',
                     'Centre de Sante de Richard Toll', 'Centre de Sante de Tambacounda',
                     'Centre de Sante de Velingara',
                     'Centre de Traitement de la Tuberculose de Touba', 'District Sanitaire Touba',
                     'District Sanitaire de Mbour',
                     'District Sanitaire de Rufisque', 'District Sanitaire de Tivaoune', 'District Sud',
                     'Hopital Diourbel',
                     'Hopital Regional de Saint Louis', 'Hopital Regionale de Ouro-Sogui', 'Hopital Touba',
                     'Hopital de Dioum',
                     'Hopitale Regionale de Koda', 'Hopitale Regionale de Tambacounda', 'PNA', 'PRA', 'PRA Diourbel',
                     'PRA Thies',
                     'Pharmacie', 'Pharmacie Awa Barry', 'Pharmacie Babacar Sy', 'Pharmacie Boubakh',
                     'Pharmacie Ceikh Ousmane Mbacke', 'Pharmacie Centrale Dr A.C.', "Pharmacie Chateau d'Eau",
                     'Pharmacie Cheikh Tidiane', 'Pharmacie El Hadj Omar Tall', 'Pharmacie Fouladou',
                     'Pharmacie Kancisse',
                     'Pharmacie Keneya', 'Pharmacie Kolda', 'Pharmacie Koldoise',
                     'Pharmacie Mame Diarra Bousso Dr Y.D.D.',
                     'Pharmacie Mame Fatou Diop Yoro', 'Pharmacie Mame Ibrahima Ndour Dr A.N.', 'Pharmacie Mame Madia',
                     'Pharmacie Ndamatou Dr O.N.', 'Pharmacie Oriantale', 'Pharmacie Oumou Khairy Ndiaye',
                     'Pharmacie Ousmane',
                     "Pharmacie Regionale d' Approvisionnement de Saint Louis", 'Pharmacie Saloum', 'Pharmacie Sogui',
                     'Pharmacie Teddungal', 'Pharmacie Thiala', 'Pharmacie Thierno Mouhamadou Seydou Ba',
                     'Pharmacie Touba Mosque Dr A.M.K.', 'Pharmacie Ya Salam', 'Pharmacie du Baool Dr El-B.C.',
                     'Pharmacie du Fleuve', 'Pharmacie du Marche']
    shuf_NAME_lst = orig_NAME_lst.copy()
    random.seed(333)
    random.shuffle(shuf_NAME_lst)
    # print(shuf_NAME_lst)
    for i in range(len(shuf_NAME_lst)):
        currName = shuf_NAME_lst[i]
        newName = 'Facility ' + str(i + 1)
        for ind, item in enumerate(tbl_SEN_G3_2010):
            if item[0] == currName:
                tbl_SEN_G3_2010[ind][0] = newName
    '''

    # Summarize characteristics of each PMS batch
    batch1_Manu_Count = [0 for i in range(len(orig_MANUF_lst))]
    batch1_Dist_Count = [0 for i in range(len(orig_LOCAT_lst))]
    for samp in tblBatch1:
        batch1_Dist_Count[int(samp[0][9:])-1] += 1
        batch1_Manu_Count[int(samp[1][6:]) - 1] += 1
    batch2_Manu_Count = [0 for i in range(len(orig_MANUF_lst))]
    batch2_Dist_Count = [0 for i in range(len(orig_LOCAT_lst))]
    for samp in tblBatch2:
        batch2_Dist_Count[int(samp[0][9:]) - 1] += 1
        batch2_Manu_Count[int(samp[1][6:]) - 1] += 1
    batch3_Manu_Count = [0 for i in range(len(orig_MANUF_lst))]
    batch3_Dist_Count = [0 for i in range(len(orig_LOCAT_lst))]
    for samp in tblBatch3:
        batch3_Dist_Count[int(samp[0][9:]) - 1] += 1
        batch3_Manu_Count[int(samp[1][6:]) - 1] += 1
    batch4_Manu_Count = [0 for i in range(len(orig_MANUF_lst))]
    batch4_Dist_Count = [0 for i in range(len(orig_LOCAT_lst))]
    for samp in tblBatch4:
        batch4_Dist_Count[int(samp[0][9:]) - 1] += 1
        batch4_Manu_Count[int(samp[1][6:]) - 1] += 1

    batchNames = ["Batch 1", "Batch 2", "Batch 3", "Batch 4"]
    distNames = ['District '+str(i+1) for i in range(23)]
    manuNames = ['Mnfr. ' + str(i + 1) for i in range(25)]
    # Print batches and districts
    data = np.array([batch1_Dist_Count,batch2_Dist_Count,
                     batch3_Dist_Count,batch4_Dist_Count]).T
    row_format = "{:>15}" * (len(batchNames) + 1)
    print(row_format.format("", *batchNames)) # Header row
    for dist, row in zip(distNames, data):
        print(row_format.format(dist, *row))
    # Print manufacturers and districts
    data = np.array([batch1_Manu_Count, batch2_Manu_Count,
                     batch3_Manu_Count, batch4_Manu_Count]).T
    row_format = "{:>15}" * (len(batchNames) + 1)
    print(row_format.format("", *batchNames))  # Header row
    for manu, row in zip(manuNames, data):
        print(row_format.format(manu, *row))



    MCMCdict = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    numPostSamps = 1000
    priorMean = -2.5
    priorVar = 3.5

    lgDict = util.testresultsfiletotable(tblBatch1, csvName=False)
    lgDict.update({'diagSens': 1.0, 'diagSpec': 1.0, 'numPostSamples': numPostSamps,
                   'prior': methods.prior_laplace(mu=priorMean, scale=np.sqrt(priorVar / 2)), 'MCMCdict': MCMCdict})
    lgDict = lg.runlogistigate(lgDict)
    numSN, numTN = lgDict['importerNum'], lgDict['outletNum']


    return


def checkMCMCexpectation():
    '''Check that using the expectation of the next data set is providing the right bounds'''
    numTN, numSN = 3, 2
    # Designate testing accuracy
    s, r = 1., 1.
    # Designate the true SFP rates
    trueSFPrates = [0.5, 0.05, 0.1, 0.08, 0.02]

    # Generate a supply chain, with no testing data
    exampleDict = util.generateRandDataDict(numImp=numSN, numOut=numTN, diagSens=s, diagSpec=r, numSamples=0,
                                            dataType='Tracked', randSeed=86, trueRates=trueSFPrates)
    exampleDict[
        'diagSens'] = s  # bug from older version of logistigate that doesn't affect the data but reports s,r=0.9,0.99
    exampleDict['diagSpec'] = r
    # Update dictionary with needed summary vectors
    exampleDict = util.GetVectorForms(exampleDict)
    # Populate N and Y with numbers from paper example
    exampleDict['N'] = np.array([[6, 11], [12, 6], [2, 13]])
    exampleDict['Y'] = np.array([[3, 0], [6, 0], [0, 0]])
    # Add a prior
    exampleDict['prior'] = methods.prior_normal()
    # MCMC settings
    exampleDict['MCMCdict'] = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    exampleDict['importerNum'] = numSN
    exampleDict['outletNum'] = numTN

    # Generate posterior draws
    numdraws = 20000
    numdrawspost = 1000
    exampleDict['numPostSamples'] = numdraws
    exampleDict = methods.GeneratePostSamples(exampleDict)

    design = np.array([[0., 0.], [1., 0.], [0., 0.]])
    type = ['trace']
    numtests = 10
    sampMat = design * numtests

    omeganum = 1000

    randinds = random.sample(range(numdraws), omeganum)
    randindsold = randinds.copy()
    availrandinds = [i for i in range(numdraws) if not i in randindsold]
    randinds = random.sample(availrandinds, omeganum)

    # Specify the score, risk, market
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossDict = {'scoreFunc': score_diff, 'scoreDict': scoredict, 'riskFunc': risk_parabolic, 'riskDict': riskdict,
                'marketVec': marketvec}
    designList = [design]
    designNames = ['Design 1']

    # MCMC
    lossveclist1 = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                    designnames=designNames, numtests=numtests,
                                    omeganum=omeganum, type=['trace'], randinds=randinds, numpostdraws=numdrawspost)
    # FOR GENERATING 95% INTERVAL ON LOSS
    CIalpha = 0.05
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist1:  # FOR INTERVAL ON MEAN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (mn - intval)
        hiperc = (mn + intval)
        print('[' + str(loperc) + ', ' + str(hiperc) + ']')
    # print(lossveclist1)
    '''
    design = np.array([[0., 0.], [1., 0.], [0., 0.]])
    type = ['trace']
    numtests = 25
    underWt, t = 2., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossveclist1 = [[0.17478897520707512, 0.16708343358922592, 0.16017359950903826, 0.17763440364866198, 0.18612522673663937, 0.17019821319931183, 0.17259716939132502, 0.18498861916818107, 0.1721680367649012, 0.17373722601960379, 0.18043613592416716, 0.1935490065581854, 0.17745183559801503, 0.17193996836200248, 0.17464067607427342, 0.1906983361259786, 0.16469455305010594, 0.16859867506801282, 0.1627290402987992, 0.17372202186963645, 0.17369069189402148, 0.19631855172433765, 0.17427274038454532, 0.16158215330897768, 0.18441893193949443, 0.16991136591211692, 0.1826468213116312, 0.18225411809926975, 0.17385929673400838, 0.18598585106328758, 0.17328158422073414, 0.17743057096521142, 0.1778204636961944, 0.17816423003367282, 0.16920864937896649, 0.19314248194697353, 0.1753093222614526, 0.17050314780625764, 0.17348960596476068, 0.17574367966940707, 0.16528746582110126, 0.17605217850602942, 0.16541437603065556, 0.1753039015705461, 0.17575846366425799, 0.18614387039469338, 0.18646008137667336, 0.1907434482383348, 0.17771731680931424, 0.1824380234652812, 0.16477440262090404, 0.1924394107592297, 0.16161276668918428, 0.17251896096987684, 0.18085929595167952, 0.17168960840660197, 0.1692771291710887, 0.18771425389335678, 0.18648605398679183, 0.17591800955915088, 0.17370612912797923, 0.17842234674748775, 0.164942462166284, 0.17729333701348762, 0.17565538830435806, 0.17789487155539918, 0.17161660978362603, 0.1735985672145525, 0.17120617411654077, 0.17634457404502707, 0.17762337493975475, 0.16339709169530278, 0.18348453244388666, 0.19605749050889665, 0.18352403149179922, 0.1617331403593286, 0.17175097734155556, 0.18140679178843408, 0.17097872855145765, 0.17255484179655492, 0.16380509857450848, 0.1789297006032058, 0.1672729059726472, 0.17665146845299334, 0.16132518105157945, 0.170774851643822, 0.18252887009508054, 0.18591791676679686, 0.17300099406753686, 0.16824737147715968, 0.17093020677842832, 0.1735257422253561, 0.17662335208036795, 0.18480088871925474, 0.17058267794159612, 0.1690116575544472, 0.17292713468043658, 0.16010399136782097, 0.1678216749193966, 0.17827730680593915, 0.17008866888009735, 0.1702332263805651, 0.16877240994334197, 0.17123391588525952, 0.17058017959570324, 0.17922114656666724, 0.17823519312199823, 0.1701012038281456, 0.17690981240550166, 0.18256589673193724, 0.17689579174602196, 0.16796259133712227, 0.17220830262284717, 0.17858403372663245, 0.18332166555072282, 0.17057777894714637, 0.17514228570927468, 0.17652633175159926, 0.188031418422593, 0.1777648581090775, 0.168785370546456, 0.17561993876738838, 0.18622599166599244, 0.17567143148007663, 0.15840351975733052, 0.18281184098104056, 0.18788191026845233, 0.17529196931443422, 0.17844732997524554, 0.18711106048955903, 0.16588230381352576, 0.17257195575065692, 0.17061101774784163, 0.1796912125710871, 0.17133563843007119, 0.180542576755474, 0.17835379754830968, 0.16135155255838513, 0.17685512361240194, 0.17207459253769977, 0.1764784742356905, 0.17995301450922332, 0.18691517237203362, 0.16763704048709327, 0.18063268791071335, 0.16845319822335825, 0.17025832917406186, 0.15342654895902508, 0.1831518906909722, 0.1869521655663587, 0.16286077828397805, 0.1680871540958664, 0.18627491142968003, 0.17190629804193405, 0.17404545553736117, 0.17146891828382904, 0.1714332852272796, 0.18045679443013135, 0.17090852207965004, 0.16995578387468085, 0.179058835299655, 0.17997620445438586, 0.1629166727798137, 0.17480194648673217, 0.1611605585581672, 0.17788853806491645, 0.18927843060864818, 0.18075102239373483, 0.1754968094919827, 0.18174822224857487, 0.17039994048849924, 0.18436092926230896, 0.18185037109550423, 0.18612840586947255, 0.16523792712232463, 0.17346673334557325, 0.17431057281601262, 0.19673512402203774, 0.17594711772775207, 0.18044878546135962, 0.16948814607806437, 0.1771899271157031, 0.16725402144612223, 0.16146649806807695, 0.18133079746781045, 0.16763010703208647, 0.16880166650913508, 0.17388936344685169, 0.18505824125342346, 0.1719115936841025, 0.182811483886676, 0.16133579678744575, 0.18120206054956015, 0.16963385278487916, 0.18294083127231128, 0.17441108963156177, 0.1680677522330322, 0.19624743046982984, 0.17254455984262293, 0.16934158204019079, 0.17931344014970518, 0.17408137081420158, 0.18869588905784665, 0.17850180975880836, 0.17095697226889253, 0.15595877509996975, 0.1744689863206535, 0.1608719561590468, 0.17472889943598005, 0.1828644199797822, 0.17660433799648262, 0.16482319978355206, 0.1674077292909562, 0.17154894695837963, 0.1664890673791777, 0.16597002944656927, 0.1789946496899007, 0.17640326689072597, 0.17766933040601612, 0.18473322494861769, 0.17229299001254128, 0.18151878295418808, 0.1658721591292754, 0.16771126609364337, 0.16430932106819926, 0.18744380540640582, 0.16508431454742728, 0.18771007612303942, 0.16466222347488388, 0.17807442307397137, 0.17109121836892335, 0.17117750674484905, 0.1754887857724018, 0.17495545620211905, 0.1766060369464701, 0.16557502053167622, 0.16511525789451229, 0.17024701148734528, 0.17739127754831246, 0.1767089210133802, 0.16338343819937884, 0.1922984817494502, 0.1775504204750422, 0.19373887654761754, 0.16256480064035536, 0.16838480602080108, 0.17942684294175829, 0.17481226854468349, 0.18574311032406957, 0.1761018036368211, 0.20155762156107018, 0.1757759110933566, 0.18725905823830305, 0.1647481258821238, 0.17416107771194334, 0.1863634971149948, 0.17065200649481105, 0.17733824096325662, 0.15959576388429197, 0.17765539026096533, 0.17460757365402427, 0.17632180836198594, 0.1718910985469936, 0.15656675358412514, 0.187257772481352, 0.17209788218179514, 0.16961692889921098, 0.17781321635014097, 0.1730405868738756, 0.16557047027559607, 0.1752361001574934, 0.17396964988836958, 0.17198634791070413, 0.18000489024106084, 0.16831466404614304, 0.1765481769896628, 0.18031545742564548, 0.17172664761528533, 0.1763364415883569, 0.17145846786291472, 0.17431889732804617, 0.16808527984641078, 0.17572443104969174, 0.17874830605975892, 0.1615085466648508, 0.17884587576585145, 0.18848715024092172, 0.1789773115150821, 0.17705637030944932, 0.17019747273643943, 0.18034215859190472, 0.17349017362989003, 0.17626370851897424, 0.18397614361416384, 0.1594787379882482, 0.18210408746839424, 0.1701029760712412, 0.1673757042652016, 0.16653917116411313, 0.18980159402482635, 0.18160502089553954, 0.1787136235666546, 0.17543502952590526, 0.16221836937600992, 0.17623898191777979, 0.172482774481058, 0.1906414362706463, 0.17219617453897, 0.16810703735104146, 0.1699826079097929, 0.17251690358526436, 0.17552294502138704, 0.1699617246506306, 0.1817580791174456, 0.16288817613168302, 0.15360255984857216, 0.16642516799948037, 0.17356643300180738, 0.17124384300156245, 0.182436332139095, 0.18083228563053977, 0.17643117319940893, 0.1647661253821439, 0.1790662090511203, 0.18004201093592284, 0.17441763607802074, 0.16632012190355372, 0.168608477820961, 0.17532880648167076, 0.17032133432304383, 0.169135354295349, 0.1803301948105329, 0.1904109859064672, 0.17590206088116764, 0.17386485619044795, 0.17967369103709865, 0.17684718935382907, 0.17702752646792355, 0.17616123003402145, 0.18893854430997054, 0.16857299067710638, 0.1768815442438422, 0.17355840461677188, 0.18158899552342078, 0.2019479247378795, 0.17146523977704714, 0.19360023972302462, 0.17977314487483323, 0.16718221606222866, 0.17826796572553022, 0.16565060222685876, 0.15513410781029868, 0.16606390024303422, 0.16723274793064793, 0.171745254412792, 0.17409159903001517, 0.16782997609127653, 0.1721514652844221, 0.16970565310707145, 0.17044698717449078, 0.17953392496588605, 0.1645175630622336, 0.1662855838477503, 0.18648143537202355, 0.1739647431241033, 0.18470256607234906, 0.190443629632187, 0.18033993348973007, 0.17200911953512343, 0.16667068194867404, 0.18418022286798622, 0.17197360922521435, 0.1737689729178993, 0.17643383535826368, 0.17628834487888032, 0.16930552360130677, 0.18325001326201001, 0.1694495176146427, 0.17027151343448657, 0.18807619746419713, 0.16660542969642658, 0.18214269140352002, 0.16708311872379075, 0.16890303507943338, 0.17985156083627674, 0.18594296803998525, 0.18022763908465436, 0.16681795572724747, 0.18244299354471627, 0.16204260234298923, 0.15894601926918345, 0.1870778248733162, 0.17689358724210924, 0.1784663376372705, 0.16730647055284184, 0.18189571177796401, 0.15998304774512676, 0.17500996094257867, 0.17899620264354293, 0.17621971127011418, 0.1748037644810344, 0.1722893615345774, 0.1686813228975515, 0.17021031733892347, 0.16132824156625972, 0.1849725029458772, 0.1775614177967211, 0.18322556961204065, 0.16810180875763486, 0.17404689146726757, 0.1771293460547257, 0.16974188544312463, 0.18799358726048956, 0.1780402374543352, 0.20080680924210303, 0.16387567626761068, 0.1812727063249185, 0.17478740330494497, 0.1607609305527386, 0.18353847002261928, 0.18116029542038145, 0.1584288155904812, 0.18585739939850898, 0.1769983983304018, 0.17991790363789767, 0.171002750857757, 0.16820172299917857, 0.17270516949863934, 0.16178444424377383, 0.17546735368662567, 0.17362375089610838, 0.1799745573781648, 0.17839708698648546, 0.1910955713922686, 0.1807746648102084, 0.17355250230966632, 0.16291882902107102, 0.15521753719571924, 0.1785331426768132, 0.15975067906695334, 0.1582547077896294, 0.19068794643035708, 0.1828742965575897, 0.16228743652531416, 0.17904276482886078, 0.1713285498108599, 0.17648973639260832, 0.16982838587586233, 0.1823389392282129, 0.16780714635956345, 0.18634141011096284, 0.17591193771423536, 0.17866876377718505, 0.1911879029072369, 0.15947625608638458, 0.18306084135837797, 0.16521001693740592, 0.1800922033647937, 0.18135664414391234, 0.1753764871119222, 0.18863566213797342, 0.1757607838005683, 0.17508721705052688, 0.16445327441173593, 0.169299924721498, 0.16813407328551092, 0.18433824547043764, 0.17386402143754479, 0.1865527106925061, 0.18237254282737195, 0.17229003666873027, 0.1862018612662109, 0.1804576330512435, 0.17121041829449024, 0.1706598131760911, 0.17643629272901615, 0.1694413602408407, 0.17683043917116778, 0.1725889983413928, 0.16477201398026559, 0.17888604135613914, 0.1635926426012485, 0.17632039517789347, 0.1775718089439338, 0.17597014018716217, 0.1801722203871879, 0.18043601658584993, 0.16518931359947286, 0.17756623573704178, 0.17673525630769155, 0.17004092483921865, 0.1879405018329316, 0.16884226157694962, 0.17430138639566145, 0.16654837731957636, 0.17679802552040288, 0.17426458923268393, 0.16693614134852922, 0.15819861264214893, 0.1841160723906055,0.1710524336747628, 0.17766817258861403, 0.17584947261276224, 0.17923555638777092, 0.17559915129708722, 0.17277683728840573, 0.17799750124742, 0.1806050345823527, 0.17735199812790917, 0.16490038498882478, 0.19230976828627966, 0.173567062822859, 0.1754259826202698, 0.18275859320866095, 0.17386103983457352, 0.17775381977358284, 0.18702822591846216, 0.1799138447872059, 0.16355924708692446, 0.18015531942390997, 0.17134790611302386, 0.18545855993002974, 0.17554246186877126, 0.17284283684200596, 0.1752614748867098, 0.17707279899350553, 0.1757013022136798, 0.18438174152691245, 0.19462467957132507, 0.17080192881556655, 0.16564095716803667, 0.16401442848937564, 0.17277465825005175, 0.18125291405799573, 0.19383884707096516, 0.18795095130657635, 0.16869630458902993, 0.1912361820359299, 0.20687835767782667, 0.1668370147039467, 0.17436521543220684, 0.17934275953579748, 0.1772762845104848, 0.18360325826726961, 0.16672734596740704, 0.1845895241924417, 0.16769289898984915, 0.18310381617259727, 0.17917867841426627, 0.19385206096920252, 0.18487866127856362, 0.168779998733585, 0.20296094058579792, 0.1817473084884952, 0.1945101993690265, 0.1709293329368114, 0.18467470173540682, 0.16918761896696513, 0.18648390437778212, 0.17445287446271732, 0.1681044072924868, 0.18819173983203147, 0.17634674322255084, 0.1740120424505506, 0.17263008160348317, 0.18193887514268614, 0.1817624622808306, 0.1731731161439401, 0.1732425503806535, 0.17324952372527552, 0.15501040611898562, 0.1829289520781617, 0.15483944716586398, 0.17293042127574676, 0.1797742630118193, 0.18482329869897415, 0.15997349466542263, 0.16950179684559571, 0.18264354381596823, 0.17784195434580075, 0.1792524035596786, 0.18355944357222373, 0.18390517838460113, 0.18294361358438743, 0.17925774163691482, 0.18621816075760306, 0.18940244356718347, 0.16581728351740438, 0.16993565121104873, 0.16291225519419494, 0.18523313368635674, 0.18342378206078155, 0.1755882371033784, 0.17179735221602369, 0.1700499707516213, 0.16473144448328936, 0.17035294543091242, 0.17882924956826113, 0.20070498317516822, 0.18073457646573607, 0.18730338771432137, 0.1656601652995799, 0.1810365225400075, 0.16456943967802576, 0.17167639207162913, 0.16384384163817803, 0.19686920118589776, 0.17118093813563207, 0.17208122923845412, 0.17269399557506906, 0.18045638258314933, 0.17150484831875054, 0.17269912887232552, 0.18380363660657012, 0.17863843167984306, 0.17215137462865251, 0.1655047416037901, 0.17642059665320808, 0.18086336646512224, 0.17515935303916408, 0.1773774479053979, 0.1855006808307847, 0.18082238126342, 0.18001058684299684, 0.18029261370696806, 0.16361791532524805, 0.16330299867233142, 0.18540278654494863, 0.17860860137878165, 0.1721871258337108, 0.17765560824092483, 0.17324537137002027, 0.1631572577459688, 0.16200580332399586, 0.185489600422746, 0.18574264356057416, 0.17993289647321895, 0.18429415136149968, 0.16180363176710066, 0.17567991198284, 0.17138645914646936, 0.183687121957246, 0.1726350494766209, 0.19564576089211363, 0.16533281905422084, 0.17948540170729627, 0.17701235251670694, 0.17450391005702046, 0.17233389015512354, 0.17801470143992795, 0.174926701514022, 0.17469747022852955, 0.16200543492554445, 0.1601252439465825, 0.16078775274903684, 0.17702849957748867, 0.17910792859749053, 0.18219101329159487, 0.16831988176495047, 0.17234463584795698, 0.19356648999860682, 0.16589315541906136, 0.18208640697926096, 0.17333796571671678, 0.17530637448684178, 0.18393108232738303, 0.19422470011855514, 0.16704693952550964, 0.17631879312655077, 0.17615403550181744, 0.17611799277076864, 0.1785436968406076, 0.18741622519050335, 0.17332344155480148, 0.17922700519992524, 0.17925984940024273, 0.16650360778192186, 0.18618838732934048, 0.18318240896426774, 0.1713903663113845, 0.1562742991385781, 0.1679154136085799, 0.17356935704811538, 0.17611406591221979, 0.17268230890441083, 0.17739495072207884, 0.17706565643989616, 0.16830090971949774, 0.1610432193778967, 0.18880743195186137, 0.1811341028526564, 0.15711986767116934, 0.17805957483490958, 0.16255406198384953, 0.17104502215838047, 0.1687956491296488, 0.17328797100076804, 0.17214975463651458, 0.1746836386887935, 0.18433419195288112, 0.17846192691195423, 0.1711590113986158, 0.1639675416117778, 0.16942660137329169, 0.1700586257948279, 0.1652928597437569, 0.18799378754381335, 0.18749973705238798, 0.1688977758847746, 0.18209122900463057, 0.18100130932306904, 0.1714567151192396, 0.16121737983160925, 0.1762417966489195, 0.17601523066327512, 0.1880196452257232, 0.17119036534363946, 0.19000936983332536, 0.16856359678316793, 0.1760122026887736, 0.18309700059123382, 0.17258332585666813, 0.17375726059334806, 0.16869887645151027, 0.18408925674006574, 0.1573105648118806, 0.17914497503705687, 0.17142427383791034, 0.16833284651466826, 0.17476705187678643, 0.19397463965217737, 0.17505984259035065, 0.17145382902954306, 0.17924382469168568, 0.18146009111263553, 0.16652173113191648, 0.18352708883933017, 0.18302340150416563, 0.16785721341596696, 0.1787308269856939, 0.16851703149285224, 0.17966140108039724, 0.16928863844586423, 0.1775833011063279, 0.18945781152098645, 0.17778047661814073, 0.1703578258002318, 0.17741550238389422, 0.17936109137134942, 0.15823796342588756, 0.1875894500793932, 0.18115254059745808, 0.1765974822249645, 0.15558032117379436, 0.17256698534252038, 0.19445585824737194, 0.17984412178711726, 0.17215390447749448, 0.18398834258618046, 0.17533481754416738, 0.17663053446370494, 0.16678047777851618, 0.16784505864910476, 0.15980942246472862, 0.16859739610583363, 0.18524521437102467, 0.16250852914887529, 0.18979649474264945, 0.1685284933908294, 0.1815271513858229, 0.18111536809635884, 0.17976371844003214, 0.17651201114637494, 0.1760929930911672, 0.18026646696441828, 0.18775544654136672, 0.1802974545192525, 0.16896514442980745, 0.16034296778016882, 0.17912010220269753, 0.1730866273638073, 0.17293214957261752, 0.17959822917206694, 0.18101751156923981, 0.17482585073265033, 0.1852857501763946, 0.18159853504831272, 0.16974976165703756, 0.18524857653408053, 0.1705878938876453, 0.1764842468596479, 0.17103629835104037, 0.19529763513585024, 0.17091884868086707, 0.1809880565169177, 0.17950114552155905, 0.16780720195055276, 0.191457410633709, 0.1788945474810223, 0.18151717106086104, 0.18009644961158164, 0.17719411583643613, 0.16857284202573838, 0.18708503949197783, 0.19534092730686672, 0.17815488044253533, 0.19004416948158348, 0.16499374552304472, 0.17935172713208383, 0.16872043996003283, 0.19228136813015212, 0.17923184496134564, 0.1662487532777683, 0.17896895073562594, 0.17823145063813872, 0.1611256717860196, 0.16213776743642172, 0.1791249367981474, 0.18379895213411418, 0.1728434704730654, 0.18300906511474765, 0.16660620165717713, 0.17495531093100988, 0.1806944558403042, 0.180566056933618, 0.17351415265947145, 0.182897575463335, 0.17598071938309154, 0.1815425109985247, 0.17729465154640833, 0.17125306464507958, 0.18026690427306977, 0.17693506846688536, 0.18539583558258035, 0.18213733450043215, 0.18848629854834673, 0.18183541015465093, 0.16524849542065048, 0.1821967800572661, 0.17033067470699062, 0.1754527826965785, 0.1915322070578989, 0.16948894083013846, 0.18362873030899077, 0.19539982422849134, 0.1629633401071343, 0.1925847561865572, 0.16839527083427683, 0.1842948560404079, 0.18052762749997256, 0.16540093250545826, 0.17834363039399406, 0.17879697403159703, 0.17847429268723958, 0.17277067455778888, 0.18195196515487308, 0.18215487294353258, 0.17456992205033378, 0.17088676319153787, 0.16501195616020273, 0.15520953882894153, 0.16644888118793427, 0.17559796400402422, 0.17307019436079066, 0.19260566420123726, 0.18744051134666392, 0.16140493355814536, 0.19594120680967972, 0.18092376223347892, 0.1750209169101816, 0.17326923837710775, 0.16921809616068445, 0.16825969064517277, 0.1850735750095027, 0.16858441894901474, 0.18963657154871325, 0.1748411848125565, 0.1787209275758893, 0.1679036254236309, 0.17444970469200813, 0.170868225823292, 0.18602293588270366, 0.1765201719412969, 0.1744187573694735, 0.16843106424628626, 0.17282652055607195, 0.17355831510137426, 0.17811039933976908, 0.18322255042771146, 0.17865280740854803, 0.1734753512670305, 0.164152605407085, 0.1610959382130183, 0.18335282899432764, 0.1795096459797954, 0.17780163006751673, 0.18094372225466726, 0.18416276309266372, 0.18287198953580056, 0.18810887141548863]]
    95% CI: [0.17509563141458226, 0.1762101843303088]
    lossveclist2 = [[0.1803108446130844, 0.17312250918279118, 0.1780119880000122, 0.18031559596683086, 0.183561409392781, 0.16974825173208474, 0.17607082553279876, 0.18141897497907897, 0.1684829872025379, 0.18567775892491267, 0.1719988754094222, 0.1789747156885836, 0.17635993015474533, 0.16798201076204358, 0.16825483424353507, 0.19848166832417177, 0.17305854579331886, 0.16806590820826645, 0.1737792081606946, 0.16417669425793596, 0.1747852815435128, 0.16956149434194995, 0.17844565291126935, 0.179493212359302, 0.1844146562560593, 0.1778262429381474, 0.17788330653742862, 0.17410848801434503, 0.17592779717936602, 0.17965815134655605, 0.18175097998232173, 0.18290471329142968, 0.1775389926043475, 0.18308318345127036, 0.17805174473134275, 0.17791117082257912, 0.17318266446693747, 0.17455920771467634, 0.17934852981013966, 0.17530491356973374, 0.1694324611759745, 0.20215780071971226, 0.17627510482509942, 0.1794499867160388, 0.16857610410782375, 0.1822464309571806, 0.1941603474085748, 0.17402024172075414, 0.17222716254221138, 0.19175304264323412, 0.17604824122445661, 0.19034349883255283, 0.16489831497997276, 0.16915844687050574, 0.17591103568122587, 0.1722475696717731, 0.15675793268534002, 0.17663773910961705, 0.16785689363630588, 0.1782303057798168, 0.17022119062459679, 0.18200423393488235, 0.16587915439193443, 0.1953442387611299, 0.17083784998279528, 0.16784480567676296, 0.1709228295563493, 0.1748308383686674, 0.17679878758427167, 0.17953068261665, 0.17417708051856118, 0.17623981155698953, 0.1689811676706462, 0.17595806280846144, 0.17241093238263241, 0.17113305549366378, 0.1677272519729483, 0.17548084501445302, 0.17402389960754167, 0.1897241988331814, 0.17695048663486299, 0.18757950784835553, 0.1724203664819928, 0.17371482900810217, 0.18490029793163443, 0.1664065321218713, 0.1873212208101347, 0.1721255652962751, 0.16992627324709986, 0.1810410315250907, 0.1787047298550545, 0.17346385428551206, 0.17705113754855778, 0.17843413920388776, 0.18640175330722217, 0.1825767333902945, 0.18143046631602658, 0.17881443067995145, 0.18343573036507263, 0.1711592050857983, 0.17865498490765438, 0.16724567173876473, 0.17918626351195274, 0.16622368674957738, 0.16202205983390927, 0.19568999462044667, 0.1865219051827019, 0.17512248931081564, 0.17526308694245182, 0.18911365864146998, 0.17779347896134862, 0.1684307037165717, 0.16703865150556782, 0.16978423519789962, 0.18637479268635673, 0.16453067460760804, 0.16385699797745382, 0.18498872475849013, 0.1881566306530152, 0.17352037466271533, 0.16204457071573394, 0.16204457071573394, 0.1850880775306425, 0.18305693580313445, 0.18319122505753618, 0.16438634470009791, 0.18454054638865253, 0.17808873126095875, 0.16543194904469427, 0.18082290437127962, 0.17256632419208234, 0.18159764490896702, 0.18397506709451503, 0.1842562135071291, 0.19437968947216278, 0.1718450159812233, 0.18199014053660822, 0.1781401504103083, 0.18509461426547916, 0.16428276598497074, 0.178485697316849, 0.17754058420621022, 0.19210458893658156, 0.1636680544316483, 0.17466802572005147, 0.1720309369574394, 0.16759126737160246, 0.17000487878293266, 0.1739904401653445, 0.16885193780418553, 0.17507418803133173, 0.17981847317437086, 0.16232221334099495, 0.16472283831839862, 0.18064542431717348, 0.17101445590227354, 0.1888826149056275, 0.1702063412226413, 0.1737687096724933, 0.16670877021658562, 0.18230429846731666, 0.1744971074113708, 0.17852867014684526, 0.179463406098017, 0.17239240431831152, 0.17510366645959283, 0.1757523019064548, 0.1736275138852457, 0.17155042110022053, 0.18383901128946403, 0.17265659516897391, 0.17446903829093002, 0.18847353247749823, 0.17751803655162737, 0.17276414548004462, 0.16807676044217473, 0.16721500683353463, 0.17351785796591648, 0.1793999169315873, 0.1663393352689014, 0.1866916996650609, 0.17382614592293225, 0.1752186513917689, 0.17382477478618746, 0.17750639239123447, 0.17357457528504922, 0.17705044399374614, 0.17550954307516978, 0.17668462254159867, 0.17370219055331104, 0.18210578306140454, 0.16562810498114727, 0.18537873571731986, 0.16753671447951315, 0.1811601774751171, 0.16739352142867808, 0.1704140433652054, 0.17598211266998828, 0.1613359574816443, 0.1712895671593607, 0.16315247024710258, 0.17505629007494178, 0.1816717870957307, 0.1809983166405279, 0.16863436140262195, 0.1679601424705018, 0.1759040110122578, 0.17718901312160817, 0.17519839550392868, 0.1807300550466195, 0.16632743339465839, 0.16980094540066526, 0.18261398696500092, 0.17290322810154127, 0.15774147820634574, 0.17863386020239386, 0.18573274346932084, 0.16477454942630207, 0.1824966716269673, 0.18481392123532017, 0.17346442178125593, 0.18257728881198063, 0.17788578130103663, 0.16424489138928458, 0.17311193326290109, 0.17641266023553845, 0.1634178279324944, 0.18762864371112042, 0.18523729917461493, 0.1689409829760406, 0.18036376600479642, 0.1829127995915933, 0.1772644841748614, 0.18275587107199187, 0.17034796904216576, 0.15338696764599347, 0.17813012903482106, 0.16833656840207742, 0.1837707666658566, 0.19316204480486954, 0.18437185485572533, 0.18738557103463582, 0.1702505772339814, 0.18128664974937847, 0.17847132024598641, 0.17093205747715975, 0.17341885806510557, 0.15820000489653424, 0.17940723903805572, 0.16523424945109796, 0.18812414030328883, 0.18278810983212626, 0.18865405637329216, 0.189308142054743, 0.18162382662408416, 0.19026864947672475, 0.183510699974481, 0.17012319000672224, 0.19265343386283745, 0.16925207959221478, 0.19009047888539157, 0.1689446628707243, 0.1708403734584984, 0.16456947007336087, 0.18595011155167096, 0.18080338887599495, 0.160870001461125, 0.16475257674216964, 0.17094867607633432, 0.17498752830347017, 0.18404126174260416, 0.1708485512165421, 0.18171954971137214, 0.18372933579684733, 0.17206890925638293, 0.177694649636433, 0.18226901792470257, 0.17412543002515532, 0.16902366453195594, 0.17904208698013965, 0.17425619803917913, 0.17483729990839328, 0.17231095411860517, 0.17697038878197027, 0.16501090379342023, 0.1751469464735431, 0.18028256258999087, 0.18283506401022365, 0.1796998485334401, 0.17943683049570122, 0.17912979583394645, 0.1783729506895626, 0.17062065892378356, 0.1718636535113693, 0.1771482321660936, 0.17579281299781466, 0.17165296915609146, 0.19271746312926435, 0.17263130273186744, 0.1874945019847396, 0.18567670989189772, 0.16856499323847657, 0.18329326963775894, 0.1643920667709853, 0.1604378805484652, 0.18972989654858352, 0.18086091577288652, 0.18294414185815322, 0.16768717645192788, 0.1816374124260411, 0.1848292608881215, 0.16742963419439374, 0.17681446862424438, 0.17739438975929558, 0.1819699858527335, 0.1573010107564525, 0.1803909428813951, 0.18318055690159646, 0.16731504895147423, 0.16614880033724735, 0.1836953548433797, 0.18511548048225146, 0.18763240943335344, 0.17566448688840022, 0.17994256414614124, 0.18006806158309732, 0.18196877918968096, 0.17828683059981434, 0.16986144213098778, 0.17679486712905207, 0.16808325040192346, 0.16908687984645682, 0.17308507886397823, 0.18068324444155281, 0.17068862835129028, 0.16767005217932537, 0.17120550335185106, 0.18205621771849545, 0.18186318261818984, 0.1809508887659669, 0.18277928001646307, 0.17083576442603965, 0.1705851508151171, 0.17727448619744246, 0.1820132574586436, 0.16673444876461044, 0.18277403906468034, 0.1791680292823741, 0.1671700106650084, 0.1714904887838445, 0.17237835975988813, 0.15982493938171916, 0.17055825465157542, 0.16474100459129298, 0.1702618597582787, 0.17459425822962585, 0.16820123644949417, 0.17181130177101553, 0.17229094689823737, 0.17831685706561157, 0.1794369916690781, 0.16467238421017827, 0.17024187172440367, 0.17435808400550462, 0.1749994957601941, 0.17906557415409924, 0.16484165048084162, 0.16744025532236648, 0.17292258698167365, 0.17219100655815897, 0.18270537487714955, 0.18837844654155483, 0.16406612252619543, 0.17605285025780745, 0.1759190557998683, 0.17102024946860012, 0.19219841558008033, 0.17077342621690977, 0.1761699455324085, 0.17828427365294053, 0.172867814382441, 0.1728118846816062, 0.1739647764406308, 0.17865788768051316, 0.19250348623826088, 0.18394968259143543, 0.16884286773532606, 0.1677977013081496, 0.17235723823439963, 0.17060637565496714, 0.1690346251479, 0.17972976311157515, 0.17378351840794082, 0.17174267312158087, 0.1718592428445981, 0.1792687971673399, 0.17785111580943982, 0.17426410547017998, 0.17125448302516916, 0.17797988003952483, 0.174907381143929, 0.16857330315155225, 0.16915272150153887, 0.19316487629185183, 0.18780826184966506, 0.18573689802466997, 0.17898642181273455, 0.18541193902162842, 0.16893035170577003, 0.1848636078594202, 0.18513571250635985, 0.1705843857792778, 0.16560215755593657, 0.18926425958188686, 0.17722251837993697, 0.17659900065722334, 0.1761627657779624, 0.17157706586588303, 0.1615656376945573, 0.17551933078359663, 0.1774687464205912, 0.1735254847756782, 0.18311653541302134, 0.18920412356971594, 0.1804330798417347, 0.16422870046189156, 0.18783719347641945, 0.18865351184856352, 0.1705916094275045, 0.17792439860116327, 0.18859254180973653, 0.1692085177940481, 0.1827563782725807, 0.18260554927324898, 0.17092636248996917, 0.1738829712883823, 0.17416423512472248, 0.16638551586941847, 0.19128978624408127, 0.17684228841986158, 0.17429385941187234, 0.18014280305061478, 0.19026605401502247, 0.15978012451228427, 0.18183378091387178, 0.17847623755531278, 0.18003444481077438, 0.1703524714096313, 0.1820556490817027, 0.18060793112251683, 0.18223622152553043, 0.16487758437511327, 0.1770949313369457, 0.18797249254866638, 0.17230676340961515, 0.17636380696272336, 0.16477627725353464, 0.17105730293613558, 0.171426653060421, 0.18752712122963938, 0.1776480869068309, 0.17369123633355235, 0.17744704410789222, 0.17782586639428086, 0.1707334075023324, 0.16334741018636878, 0.18285060953544496, 0.19317257336807833, 0.1800207991363361, 0.1881286367624471, 0.17559389215397117, 0.16942216721777353, 0.16996384728901817, 0.1812580622093901, 0.1805845482630746, 0.17655136961618922, 0.1807793019415952, 0.1655421070903925, 0.17857525627955856, 0.1698902780332646, 0.1668135714822074, 0.16855428001765094, 0.17116876766473738, 0.17974009912069885, 0.174099135739103, 0.17396906611174964, 0.1801054386159195, 0.17806657623419858, 0.1676174347377515, 0.19535779353017002, 0.16962183651633397, 0.17671428609115558, 0.17312868412054053, 0.17199736748474512, 0.1721553018386921, 0.16863870055087402, 0.1694153244059132, 0.17573002989042666, 0.17997583021939909, 0.17908176529169265, 0.18186072928847047, 0.18228587481437777, 0.16120592914721693, 0.16784265253189004, 0.18545635165990176, 0.16558390577230953, 0.1806882902425928, 0.18285015492414988, 0.17130619410323444, 0.17603668647629842, 0.1708928113014574, 0.16752095995541308, 0.17681774030734773, 0.19086221432958414, 0.16962715808076306, 0.19013005216081647, 0.17466033943352857, 0.17687541841324678, 0.16532016419625545, 0.19444213143203282, 0.17451931552645553, 0.17506210848114925, 0.18704487888784643, 0.184275840733084, 0.16736121279583382, 0.19114004340428267, 0.19645560541569096, 0.176533746571335, 0.17574407778856857, 0.17240945578287595, 0.15731382580202508, 0.16728817285522726, 0.16421984849362692, 0.17988146725235704, 0.17449587701708882, 0.18235378880867525, 0.16812540529541198, 0.19809707729333786, 0.17593367016199646, 0.17313943868838333, 0.1818603642510086, 0.18324197836932934, 0.18676463260209172, 0.17842210692872126, 0.16915937060332806, 0.18166922088456056, 0.16406024557555357, 0.17187326720455834, 0.1751155076507147, 0.18912616432251134, 0.17058108868779162, 0.17692107828151193, 0.18559147963320033, 0.17716540303416148, 0.16829598482556626, 0.15521330651590984, 0.17699104371874977, 0.16597161324116427, 0.1787528728335843, 0.1758031660968657, 0.16874758852748903, 0.17182020378568016, 0.1690496242137196, 0.17486462722142215, 0.18030098537413006, 0.18641086337662416, 0.1873557943168466, 0.1684855786506083, 0.18694714620346758, 0.17433685765051382, 0.1782968322157994, 0.1788182364979389, 0.17415816377029908, 0.1701448307332478, 0.17292243996777534, 0.1824012160179148, 0.16936486562530328, 0.18609116537036494, 0.1693665036532475, 0.18247042250286316, 0.17154658340688544, 0.1697054294361039, 0.18258824902952583, 0.18600413835557122, 0.17333766307243983, 0.18139652061827935, 0.18109634709212488, 0.1858387321637565, 0.1705278182868215, 0.18510373007436687, 0.17148284504723688, 0.17418364980964893, 0.1741246870111348, 0.17687474737088096, 0.17244219431773494, 0.1711540817367655, 0.16893348297432365, 0.1841994355436083, 0.17796986782689755, 0.17636905295924477, 0.1792290160651938, 0.1833284847945405, 0.1636603172928403, 0.18068209970139848, 0.1935847960876629, 0.18377885898930982, 0.1771165763921887, 0.1854793787392086, 0.1721366308413443, 0.1781522918180977, 0.17302238241007326, 0.17542947773856607, 0.17657196315085788, 0.17797138459923878, 0.1784710242849738, 0.17154592305807592, 0.16808084621137845, 0.19464216317570546, 0.16486225334338137, 0.18028055202658236, 0.17669085705343346, 0.17902931266172722, 0.18230567461636865, 0.18268448555074346, 0.17506427595509316, 0.18014432891515864, 0.17698712690398224, 0.1829176601273743, 0.17445726751180432, 0.17995897857786108, 0.17296998149053597, 0.17372793640953266, 0.17807654360573064, 0.1638605816013306, 0.16614826227282523, 0.17261755415756713, 0.1677294979088937, 0.17312466679216518, 0.1558235527454223, 0.16520525693382832, 0.16914900990869783, 0.17964551409893703, 0.17146919071914493, 0.19902321730793943, 0.17400012668023887, 0.16682843862015995, 0.1687230658381482, 0.16942367155003565, 0.17280372013965672, 0.1712332708676809, 0.16992201632396545, 0.17288264477393742, 0.16902391912111672, 0.1752776007835248, 0.16612457071896564, 0.18883524679114572, 0.18592287678303085, 0.17888139696991906, 0.1688656069416448, 0.17287073618173676, 0.18225085289918785, 0.1794331973082863, 0.17103152799842775, 0.17859688515536074, 0.1728725585584095, 0.17086703040070958, 0.18094960301309235, 0.166908557867228, 0.17066705130575618, 0.1772253900263553, 0.16996521179748417, 0.1762817562495611, 0.19001689755428883, 0.1705074217535779, 0.17310569529799336, 0.16856335408127635, 0.17792972712687719, 0.17313903496823727, 0.17669654818283714, 0.17868180855728052, 0.1640369256850049, 0.17971572682639003, 0.1776609340803019, 0.17865443383058943, 0.1669447583234133, 0.18744310323549687, 0.17635294436777546, 0.16872195089713882, 0.17435897561367025, 0.1778730439562697, 0.18430196429927134, 0.17392281086214714, 0.17985666828176713, 0.17679469536906742, 0.1618159798164631, 0.1819545083783046, 0.16815853325633023, 0.17435005643880466, 0.17560091919677118, 0.18002656775996667, 0.1637629424631523, 0.1782932187971519, 0.17556019468348907, 0.1719106787452632, 0.17939096715305833, 0.18430498453904004, 0.17781121192862692, 0.17858405331607674, 0.1628040350882254, 0.1780711264162252, 0.1707143768839645, 0.17636771247506894, 0.18390236295296358, 0.16809342113153183, 0.18606682925866055, 0.18288880400385832, 0.17261165497530104, 0.17826098634317228, 0.17098949915284092, 0.17998514131310936, 0.17876340618046707, 0.16237147025175214, 0.17590339482134715, 0.16519793898027887, 0.17366619540040368, 0.16760251802608395, 0.17229286784480724, 0.1654541414618499, 0.1697698202802833, 0.19231056580755854, 0.1932014551985128, 0.17636791625860743, 0.17420641971299577, 0.17988960258917888, 0.17464945798858733, 0.16646862350602565, 0.17511762537397838, 0.18245560011654616, 0.16808294709857824, 0.16916567035891486, 0.17203614625712366, 0.1758359771907728, 0.18017627503473813, 0.18000276839922802, 0.1806727394417852, 0.18817304603193885, 0.1823899024610281, 0.17397296597517337, 0.1590183810382466, 0.16459000891808814, 0.18703378486271635, 0.17920024349977848, 0.18431635643441216, 0.1610263409367323, 0.18393693573838846, 0.17612586565991667, 0.1735545852883954, 0.17148611809214132, 0.18294117233254747, 0.18605562825333943, 0.18221989735230815, 0.17356323453727326, 0.1773524609011892, 0.16732021321565077, 0.17035433536897218, 0.17302323753198995, 0.17082218483963715, 0.18409235750356906, 0.17643910120200682, 0.18569273822867008, 0.17114811318696277, 0.1877379088514768, 0.17415656113928188, 0.17429293410503935, 0.18469291765341622, 0.16818907948454004, 0.17772949853980755, 0.18223646374043398, 0.17618541625654413, 0.1706299362351589, 0.17725739458288148, 0.16866901136821805, 0.1766452268132426, 0.1859835160309745, 0.1670656469856031, 0.19553071183982265, 0.167717903308636, 0.1698383307265613, 0.1769444775640914, 0.1692806324805704, 0.19420453272907026, 0.18265008826121973, 0.19238073259025373, 0.1890981733882145, 0.17689992121271986, 0.183628237786967, 0.18118199741783006, 0.1715839677187899, 0.16347759655886088, 0.17511524551614496, 0.1784388966850192, 0.17681032923053006, 0.15946546599123093, 0.16882946653066067, 0.18346369125066853, 0.18055339717521662, 0.18209462383483588, 0.17923826518922512, 0.16690984809470602, 0.17169147925557457, 0.17743074482988344, 0.18872877237862729, 0.17427132990961355, 0.18026973245208133, 0.1757297658413234, 0.16445155626811964, 0.17267036069358163, 0.17120185964077086, 0.1764498124215547, 0.1783329630870615, 0.17052336553106276, 0.17592736589566277, 0.16275492119909118, 0.1692683111095433, 0.17159710972660072, 0.17105802936767991, 0.17394776653905225, 0.1722377046617272, 0.1765162823506499, 0.1907595223333655, 0.1682683542495847, 0.17611196810220017, 0.17044859444753932, 0.18855674159116573, 0.1842528508329355, 0.1798972323253962, 0.18019076262689762, 0.19034593271890948, 0.18732493169314682, 0.16737678475237033, 0.17192737999891464, 0.1762724801900677, 0.17582468264057644, 0.17633749354515493, 0.18590646403968833, 0.16695284719412232, 0.1728548147507093, 0.1888811009357806, 0.17358478056317053, 0.18166809743819334, 0.16081023976665412, 0.1728952383710692, 0.17151275899423876, 0.17716185600473372, 0.184243969692396, 0.1673700026484108, 0.18372108245391008, 0.1634914961272759, 0.18878638673482734, 0.16531898957595884, 0.16343646093147793, 0.17666855073728302, 0.19865273558962546, 0.17672510321443463, 0.18905812194595498, 0.18418758475084882, 0.17303543125647633, 0.17252900207867056, 0.18044265035678886, 0.16589024532367042, 0.17085926759588002, 0.17176701175379372, 0.18251960958039048, 0.16892832947482384, 0.16586893026613062, 0.17188376510847955, 0.17721010006679722, 0.17712372669792512, 0.1887407336244444, 0.18009678323246917, 0.17981794471707638, 0.1832212467410029, 0.18584925502672042, 0.17385503962917814, 0.16828285824858613, 0.17911908956487563, 0.15822611129656103, 0.1861873995246743, 0.17684113944447716, 0.17458236369186494, 0.16288084078209106, 0.1839125181360584, 0.16263529454080974, 0.17282457128531525, 0.16853994943300268, 0.17095559984343844, 0.18510307165607043, 0.1782785160696454, 0.1852751358954774, 0.16464393357361465]]
    95% CI: [0.17554819626038604, 0.17656226534126807]

    design = np.array([[0., 0.], [1., 0.], [0., 0.]])
    type = ['trace']
    numtests = 10
    underWt, t = 1., 0.1
    scoredict = {'name': 'AbsDiff', 'underEstWt': underWt}
    riskdict = {'threshold': t}
    marketvec = np.ones(5)
    lossveclist1 = [[0.14569831093518176, 0.15141243819737987, 0.15263406313432154, 0.15306395131241343, 0.15258367276036552, 0.15480545590140937, 0.16926954826179869, 0.148590111389018, 0.15188023264754158, 0.1512637161328664, 0.15083503777599958, 0.15319726226308242, 0.14250102421072278, 0.15590773585314266, 0.1495508614433647, 0.15239816842978862, 0.1605326619117468, 0.13906313161468442, 0.14770462605168344, 0.14821810122609191, 0.15133491312520508, 0.14478109572165984, 0.14956966808454392, 0.1556404223693784, 0.14591398076084122, 0.1620826977454037, 0.16257578624709437, 0.15387008172678732, 0.14852211911203525, 0.1577397603641584, 0.151795514192045, 0.15068119855363338, 0.1582103201711663, 0.1530754940536564, 0.15195281319562454, 0.1559327265884932, 0.1525571741153522, 0.1538576368921155, 0.15994011851892803, 0.17015621754116134, 0.13787617248958453, 0.1404073011928146, 0.1500940474667674, 0.16215281536679738, 0.14909493950118827, 0.15369912099824382, 0.14233654376548296, 0.14910339523163074, 0.15149667295777966, 0.14660256653365988, 0.14808362918148674, 0.15292888654301404, 0.15789096439763384, 0.15462775570055595, 0.15321424750977658, 0.14236149389673652, 0.14455506653731381, 0.1530074745875051, 0.14401962553287856, 0.1467370269801018, 0.16118731503415265, 0.1517866884114435, 0.1512230058739357, 0.15640278991331125, 0.14353533311937106, 0.14704250018907072, 0.15456277073490407, 0.14698229376336536, 0.14143496162819252, 0.1561999123352945, 0.14503697992688638, 0.1492540783994305, 0.15374347525689613, 0.15367960298853334, 0.16082975414515766, 0.1475565067389573, 0.1514521826741259, 0.16134153705036072, 0.1513597250729103, 0.14908364441082997, 0.1584367469924668, 0.151669795263639, 0.1608956707466485, 0.15418649732747286, 0.14783858799152502, 0.14881660531731813, 0.14807446478494193, 0.15237069820050456, 0.15195803016674, 0.15151014708151214, 0.14114960107726207, 0.14572402087682534, 0.14231567985175997, 0.14046802496769917, 0.15230513279075666, 0.15101909308535374, 0.15770052769016435, 0.14701356351783917, 0.15649630437343476, 0.14281086337666446, 0.15011296049073158, 0.15135455413656537, 0.14112136661080188, 0.15206741756524036, 0.1560593615475478, 0.14970256627218437, 0.14486295533721075, 0.15301925339708788, 0.1587873619625404, 0.1500669729841626, 0.17006414104805617, 0.1589799783517872, 0.1466462917123654, 0.14716465392532588, 0.15311371283911526, 0.15612464154008485, 0.15419424737487114, 0.1482532807920151, 0.14574262468218868, 0.1695387473207709, 0.149365187903937, 0.15528422350835502, 0.15268770633435133, 0.14373366798045747, 0.14670529590548204, 0.158428909525973, 0.15300214120463138, 0.1425517782562156, 0.15525060172072794, 0.1568848245878084, 0.1522927384688738, 0.14454638939100262, 0.1552463012995824, 0.14604357660372078, 0.15016281215330426, 0.14605068840102564, 0.15089359764029114, 0.15151878812611666, 0.14869554750131717, 0.16156288346459735, 0.15604076121626453, 0.1600773222824689, 0.1472851549428304, 0.1359520133573433, 0.14944088564861885, 0.14970899369244375, 0.15685100568393326, 0.14674373567789253, 0.14610249468699937, 0.15285622601248963, 0.1514209186081637, 0.14720945695066515, 0.17075886751339303, 0.1500509583949196, 0.1502212535574294, 0.1514928204346778, 0.14206261821212304, 0.15572402836201404, 0.15370030964753814, 0.15421683940702233, 0.14691949419845274, 0.14623021542289422, 0.14593326456088387, 0.15864048811509826, 0.15112865281512192, 0.15085042614949387, 0.1363184935371765, 0.1456940254842878, 0.14872141641940131, 0.1486972943483676, 0.16079619579808496, 0.15278813245929646, 0.1482502120395343, 0.15223637456980882, 0.16189161161349835, 0.15982701469528232, 0.15613168632920701, 0.15104037421855898, 0.1523053672424733, 0.14066088541713262, 0.15671647616053241, 0.1477656478224851, 0.1476448869177104, 0.1528758073405508, 0.15338067389947288, 0.1384336021511807, 0.1526631728881926, 0.14646568004120314, 0.15050540491885755, 0.14794788888860944, 0.15305867833069373, 0.1613771450794928, 0.14707397479388767, 0.14868314112685116, 0.14965542475635085, 0.14896509046967057, 0.15365609114695072, 0.142693288352425, 0.15002959790842768, 0.14838397084665214, 0.1504849433653141, 0.1443387334058128, 0.1470666507571295, 0.1483295482645403, 0.15195475850501602, 0.15256988431351726, 0.14541371948917511, 0.15512344384277635, 0.15420259325838234, 0.15631210751904598, 0.14187428655096332, 0.1743133470030728, 0.14449032211422735, 0.14492088495889507, 0.15508193912132848, 0.15180082875496287, 0.15891130384316998, 0.142478540209136, 0.14835475676172263, 0.1447602275286261, 0.15234088352927563, 0.14852618327780912, 0.14947372801023745, 0.16020616427031717, 0.15292225423487862, 0.15611043707640154, 0.14218642408056545, 0.14550738520667053, 0.14913183905835514, 0.14976388563155538, 0.1420466429860469, 0.15836906773102663, 0.1580188710792859, 0.14991457736043864, 0.16054273518179915, 0.15828320623976985, 0.15236384653468857, 0.15148931007220767, 0.14520382046093097, 0.1512486481367462, 0.15620891439658252, 0.15138352167913444, 0.1552954038291232, 0.16123704607301542, 0.15581456457701506, 0.1469070652957371, 0.15242034976363558, 0.1499009263263978, 0.14658226090072804, 0.14643218124328528, 0.14759366327880638, 0.1522908987501938, 0.14711273632109817, 0.1463090567640207, 0.1556807312347868, 0.15108014309500012, 0.14759962930791085, 0.1545401672089125, 0.15397372474631307, 0.1578864366462721, 0.15115573463813656, 0.14567673630043892, 0.1488972995489002, 0.14846060515664314, 0.14559543073979284, 0.14955114051662394, 0.1423343275052389, 0.15419915183237157, 0.14575974839005246, 0.14675974882005943, 0.15477821195340707, 0.1495863810932962, 0.1539319983854452, 0.15000843015232013, 0.15247042431012015, 0.15566876683320124, 0.16062181235818035, 0.1535118052888365, 0.14314654985538167, 0.1548477921940256, 0.1500919940834729, 0.15047216006206188, 0.14352090060597372, 0.153034644437829, 0.14881733943974365, 0.16570737366145594, 0.15297710057965874, 0.14940176267257513, 0.15961843273139606, 0.1540788417182976, 0.1412703516620947, 0.15603105608563236, 0.15008849180833242, 0.15623548737089696, 0.14826256689640924, 0.14639174571508168, 0.1584010740347405, 0.15340657981086764, 0.14835025872178492, 0.1641215579904728, 0.15442908943636124, 0.15887955970241957, 0.14586152953825965, 0.15854673568960562, 0.14059620580381788, 0.1467014609510626, 0.14108548242028282, 0.15779381712298166, 0.15998149594915673, 0.1464343910572472, 0.14987597113014445, 0.15396820184423016, 0.15322415998532132, 0.1456951091534776, 0.15022963907575568, 0.15384127873802608, 0.14334439941464164, 0.15502338091532314, 0.1500166369175261, 0.14793970993776062, 0.16170091921293428, 0.1473948070438314, 0.15440387763331886, 0.14906850176108113, 0.15621195893347395, 0.14635328173533618, 0.14885301665696335, 0.14940890198677173, 0.14939556804827483, 0.15146449341548807, 0.15870424311872025, 0.15157879032448482, 0.14730775245507818, 0.14629043209807677, 0.137789693579731, 0.15418084313800587, 0.15581131988674832, 0.14667607116546866, 0.14772559874378177, 0.14772410644315628, 0.15764413735553, 0.16442320373369781, 0.15621975581624734, 0.14097157681044728, 0.15360720894354243, 0.14425625702761255, 0.15473703164512007, 0.15267309302989837, 0.1435160963009461, 0.14558084872351568, 0.15198614824080886, 0.1402327883529619, 0.15449677765426845, 0.15663018820316504, 0.146902583544428, 0.14332180353351748, 0.14548030736536097, 0.15385774859330878, 0.1589971971140662, 0.15015163858803807, 0.14574019875314878, 0.15271877690313942, 0.16477820477747, 0.15541050029983303, 0.15090278981074842, 0.14978540466398554, 0.15095079108721962, 0.15863621559397748, 0.1478784238277965, 0.14524340538193892, 0.15193034300597577, 0.14604249496609362, 0.14201276708794727, 0.15489838025756622, 0.14844017225142359, 0.15522932153769586, 0.1512590657044669, 0.1530747489311492, 0.1607057685035168, 0.15246767516497017, 0.15555356695129144, 0.15804359548786173, 0.1488332168005478, 0.15624181899520675, 0.15010903532825914, 0.1442389253794978, 0.14990207633437067, 0.14489262616073975, 0.15345293763308687, 0.14766655546760044, 0.16055367400422027, 0.13976747731584416, 0.1553537500620973, 0.15681652871581303, 0.1574321574708903, 0.14026673568672587, 0.1555918884308081, 0.15298706706919668, 0.14587420987497696, 0.14694489651000187, 0.15419986085351342, 0.14334346831490175, 0.14652158695380663, 0.15461615711229076, 0.14695017933090435, 0.14543998795872337, 0.14676680139575085, 0.16251984841371644, 0.15172373772621983, 0.14976083192608555, 0.15511112127927343, 0.15203549872587874, 0.15689653788651506, 0.15283245049297936, 0.15771455615243382, 0.15599282980525697, 0.15114042698866234, 0.15374893071260795, 0.15074065482866086, 0.14486493699913203, 0.1463230093424572, 0.15386007946237618, 0.15508925400893467, 0.15273916946968252, 0.15023725805599217, 0.15115475930430042, 0.15157962344055656, 0.15432144112168142, 0.1552533776277713, 0.14643145613666678, 0.1451226197485258, 0.1500615103119267, 0.1617992079669943, 0.1549243426750696, 0.15258403695049771, 0.1534351748190437, 0.1488579538545592, 0.1494826435610453, 0.15266546031942882, 0.1578978962257022, 0.15882157309125652, 0.14684971270412486, 0.1516304639935235, 0.14782332313572846, 0.15653952333341808, 0.13784337396336255, 0.15505960295419136, 0.1571794810550029, 0.1478642182804277, 0.15367307183570214, 0.1505660106186155, 0.14706217911801142, 0.14877733395089873, 0.15254154854940535, 0.14997996360501448, 0.1425002721085212, 0.14813763553767734, 0.14600207906995072, 0.15511884358412642, 0.15064872903806406, 0.15460713858540928, 0.1538261248391843, 0.15012231086290498, 0.1514681065936284, 0.15794553212757076, 0.1492689342066005, 0.15727035262330294, 0.1667294335700655, 0.14849902599620407, 0.14986757622570207, 0.14767866817202477, 0.1519089716566269, 0.1553528585852329, 0.15559900204831256, 0.15062800787156094, 0.15574562820011906, 0.1403817628307865, 0.14543031488905825, 0.14841553144799943, 0.15051417057107974, 0.16193534168232046, 0.1479949772035572, 0.14718063437463583, 0.15471155851307303, 0.14529133556351717, 0.15254560979721518, 0.141485553593449, 0.15153419750294178, 0.1485395764608829, 0.1533520103242543, 0.1525894646876932, 0.1490746097944325, 0.15460144269726758, 0.14458146418969814, 0.14190581943410668, 0.14946045202969868, 0.14962382795718, 0.15340707205800097, 0.14919414962689148, 0.15444277069755194, 0.15096271356339017, 0.15140426293366696, 0.1413466242651067, 0.16158215585467717, 0.15079018944725525, 0.14817816269975753, 0.1483939959949686, 0.14865417638464243, 0.14851820310749841, 0.14801882880320286, 0.15187714490753282, 0.15019526853839488, 0.1498217828398538, 0.14724467989185017, 0.15050460074829386, 0.15572138820925055, 0.15375935469973856, 0.1545947111573003, 0.1448685405785475, 0.1472621320922281, 0.1408827227441441, 0.15324748186753134, 0.1543119714438861, 0.15207170820149657, 0.15362002483436302, 0.14857952533106583, 0.15720316883815513, 0.15938421423729432, 0.1562494712214456, 0.15789034919082232, 0.15436778660561218, 0.1441909036809763, 0.15403163592563335, 0.1388636667333871, 0.1560194648744429, 0.14296462342887478, 0.15299847103356332, 0.15470130057928255, 0.15538411064668808, 0.1483939453412843, 0.15036089617591208, 0.1464147661033102, 0.14930044371382067, 0.14655207439553355, 0.1587134813999085, 0.15499277354339125, 0.14622948016645387, 0.1594006302272157, 0.14834176774613567, 0.1453370804862947, 0.14606472804952222, 0.14715243564764804, 0.14994192807478493, 0.15645862562542345, 0.15063995354485557, 0.14585873857485207, 0.16100565086131272, 0.1530214930632812, 0.14377109112162467, 0.15255737905204156, 0.14207639140706235, 0.1512296513411434, 0.15158414479143734, 0.15338568795301333, 0.15074287048839463, 0.14693823686448504, 0.1413772272407418, 0.15418537945829075, 0.15076734319467827, 0.15195139156486637, 0.15391478604382147, 0.1464038802032172, 0.14686892768894386, 0.15974650057224676, 0.14563711840179042, 0.15778692756233242, 0.15079177703749638, 0.14134262591878638, 0.1507147053419439, 0.14743679491452108, 0.14949082094395222, 0.15059698654866494, 0.14782433801852848, 0.14803909237506063, 0.15227941709998202, 0.15112394500071422, 0.16252228970635357, 0.15890428245866586, 0.1512150589939701, 0.15552848307901376, 0.16118080556282569, 0.15228890098215542, 0.14790693995944093, 0.15018103030989274, 0.14970307603800387, 0.1609741704703433, 0.15224158808859645, 0.1483344497069498, 0.1595830534076807, 0.15831317196484226, 0.14737023655536108, 0.16168042141899738, 0.1644553232503035, 0.14855968728146918, 0.14610162965208562, 0.148344332285438, 0.1509278734841446, 0.15650971845537914, 0.15367268136392329, 0.15753335610958322, 0.1497885126025023, 0.1500972599511598, 0.15379835733932112, 0.1544138669251505, 0.14622259236693574, 0.15543690012211656, 0.14729094700017104, 0.15926341843053865, 0.1534225024488196, 0.1512485520497859, 0.15065186970874977, 0.15489266289709552, 0.1539529210351956, 0.1474711329007691, 0.1577489104720313, 0.14978710060710382, 0.13947032843381213, 0.1501698303506713, 0.15571368088072798, 0.14103812950440114, 0.14337450757777648, 0.14820096893449014, 0.15902186435094237, 0.15397469612424072, 0.14710707942437187, 0.14229485583846038, 0.1498116862146427, 0.15155334188148148, 0.1473975405741538, 0.1436408829673144, 0.15136944232362107, 0.15320411741095402, 0.1476923570753227, 0.14600681841519103, 0.1420175256030038, 0.14508516959452894, 0.14597290138476302, 0.15274591315349825, 0.1523568448105959, 0.15360837565778185, 0.15341607425669754, 0.14893444190383065, 0.1461298839142694, 0.1593416407018751, 0.14568974379178992, 0.14342545293714634, 0.144341679442688, 0.15271991244012972, 0.14091167625279122, 0.1482805281798022, 0.14762486999111915, 0.15158804745308144, 0.14507041334073162, 0.14840709417793027, 0.15997742483567165, 0.13688331461266479, 0.15117890685049062, 0.15387160879432596, 0.16026503583719112, 0.16149361375285587, 0.15295025611952606, 0.15568511745233052, 0.15335394429404467, 0.14401898950662786, 0.15224283910736178, 0.15068444720982574, 0.15906790157506207, 0.14620074783673392, 0.1437363609094446, 0.1516389656642782, 0.16045930020070462, 0.16044967428743442, 0.15314703409688946, 0.15428603881801017, 0.15031890593223055, 0.15747883863947018, 0.15228942617392577, 0.14690110421835853, 0.1487329336502797, 0.14890748168500334, 0.154702769977841, 0.14799728779721721, 0.14593080132447075, 0.1557458242808996, 0.14696194360709994, 0.1389371383589166, 0.1518378683270529, 0.15053277023310233, 0.15040979113452668, 0.14599134129584132, 0.14833390691497364, 0.15152988994868996, 0.153260051924747, 0.1723131442286888, 0.15548939912157655, 0.1557247372854344, 0.15018621493303763, 0.15071057192751947, 0.15131379287015087, 0.14914891784224688, 0.14885532151217692, 0.15782321679912978, 0.15300938994660343, 0.14946412401769302, 0.15766633778667025, 0.14882319203155242, 0.15843352868074226, 0.15236515683647628, 0.14270609160279477, 0.14654212339609907, 0.14213829355609608, 0.15191183083033286, 0.14777059542005913, 0.15304963947843486, 0.1502533067384491, 0.15675159020767818, 0.15214395628916125, 0.1527495869691102, 0.14705801569523924, 0.15093780227044473, 0.1455207899651742, 0.15208524041186086, 0.15491089549791973, 0.14628812779432399, 0.14442602158691156, 0.15701988403193085, 0.1614046891069822, 0.1434849267721725, 0.1519301440816349, 0.1502177339053602, 0.14922238242686756, 0.14993879757150838, 0.15396247054257692, 0.14240923852617568, 0.1647804040212473, 0.14335116017770297, 0.15572073162862338, 0.14928019266730672, 0.15276063917946087, 0.14468304018175449, 0.15036616132858108, 0.15291952499551642, 0.15520944469780648, 0.15439102501106092, 0.14513262215069675, 0.14636572360832353, 0.14719895369709224, 0.1528176317213514, 0.13872932167310928, 0.1444231791118739, 0.14930071220775348, 0.1628038180849759, 0.15437273908324758, 0.15233406920918338, 0.14603521557955262, 0.16651151085944638, 0.14762168893997546, 0.14930498029202308, 0.14783159637938792, 0.16104227054126244, 0.15417550791517715, 0.142928939781172, 0.15335594549454024, 0.1499973227887363, 0.1553943934209655, 0.14895076691388115, 0.15171854941546503, 0.15789342394318523, 0.14954385433250664, 0.15739828755686683, 0.15305995029742595, 0.15030949426593412, 0.149367917892737, 0.15270739170427614, 0.15164697226876075, 0.1452348855798176, 0.15197275234898563, 0.15252284260179688, 0.15672281751523967, 0.15328173362885078, 0.15339047779121728, 0.1584284408637009, 0.1500092775579038, 0.15946266573177006, 0.14686905006401485, 0.1480548678476212, 0.14858962447537466, 0.15664890990537797, 0.1499159685405856, 0.16143747280404425, 0.1452358068411856, 0.15383150027357922, 0.14886448741944225, 0.14266761400141031, 0.15461650934060647, 0.14691852082745957, 0.1441569090752751, 0.15509331876336382, 0.1539568244030212, 0.14840821115185313, 0.1526191781417423, 0.1624489497400562, 0.14739118078587987, 0.1531545566410134, 0.15010232292658443, 0.1423342486992544, 0.13535908517431172, 0.1536767260116008, 0.15424722356299, 0.15593452401906707, 0.13808387316268816, 0.16033760335489308, 0.1608813819820779, 0.17202140017432976, 0.14221213292911047, 0.1630985040061682, 0.14063363879002547, 0.15708005273887377, 0.15284721784166985, 0.14477284958159042, 0.14655328914851284, 0.15478585516152696, 0.14905293720315807, 0.1524568973751547, 0.14485356186622772, 0.15699258621463089, 0.15654987896866995, 0.14704476196598476, 0.15329309079906014, 0.15833510784042776, 0.1477021672913241, 0.16085979138575132, 0.1533168274032852, 0.15898113385458718, 0.15072200582238374, 0.15279984085253517, 0.16219192454608644, 0.14955289828377977, 0.15253718769736035, 0.1516537455349811, 0.14996275746847046, 0.14705146900055974, 0.1492707788775597, 0.14480871189264544, 0.13808650336617206, 0.1581834680853513, 0.14986848166893083, 0.15128766463453855, 0.14674721782155442, 0.1413634158587554, 0.15231936997677342, 0.13992533973853075, 0.14305270694554614, 0.158163977991849, 0.1496751893864671, 0.15056091437882504, 0.15129053164689057, 0.16150310189027675, 0.1447023113418553, 0.13879969754642768, 0.14768440091036605, 0.15846692185800457, 0.15143994083649642, 0.1629450878617637, 0.1450697555688025, 0.13088165959821352, 0.15318575138538934, 0.15952416120583413, 0.14895358961468166, 0.14824539564815314, 0.1539125891999192, 0.1617249048402829, 0.15290034206470682, 0.1517793520186282, 0.14213360682084816, 0.16232525584799404, 0.14476432533865985, 0.1709626167812052, 0.15650872038792424, 0.15504321936186582, 0.14845786574549666, 0.16037113238751569, 0.14652792112031238, 0.14842681271414773, 0.1404028465504063, 0.1482761298324058, 0.1567445848680441, 0.14250340965375885, 0.15493486656678473, 0.1508588295315951, 0.15488033860635944, 0.15150267302770926, 0.1505729939617068, 0.15430035246306362, 0.1556596183265976, 0.15879069177807809, 0.1580607265517994, 0.15333320324185448, 0.14657960517579527, 0.14047758373243688, 0.1585243126965317, 0.1607112956707178, 0.15964312919832294, 0.15676416129384982, 0.15490989167084948, 0.15173418481941117, 0.15514322688831536, 0.151586712778684, 0.1553061976800264, 0.15737115077932406, 0.1451319155820197, 0.1412074112003951, 0.14812530848478142, 0.1468017555646551, 0.143941607889617, 0.15717634366218156, 0.14723243419353463, 0.14416747261725063, 0.1542385814686848, 0.15028240723894112, 0.14480483821824175, 0.15605381456792075, 0.15006356514082886, 0.14994849543420966, 0.1419500925556314, 0.15395837870185672, 0.15702216095648153, 0.1404650548520662, 0.16080886802135083, 0.1515034502484147, 0.15927552681658305, 0.15785055381994414, 0.15311753972382477, 0.1580168856067139, 0.16192248171942678, 0.14759280677390538, 0.14475429043645752, 0.15332001560157713, 0.15655478944763726, 0.15374224667690517, 0.14785164136079426, 0.1443193444591529, 0.15794545950886615, 0.16077159001681793, 0.15471148486408268, 0.15101252862721593, 0.15083725215138516, 0.15087763381453956, 0.15499961472663912, 0.14159679010452533, 0.14176842999050696, 0.14930099111141198, 0.14362709076517344, 0.14415101999568355, 0.15549767619043198, 0.14364442646041986, 0.1588298996520975, 0.15183659770023694, 0.15354132600486523, 0.13596148560629195, 0.14722022741734347, 0.1502974414441171, 0.14996678924202145, 0.15119432838429422, 0.14743591760799313, 0.15886508425681253, 0.15048932467043424, 0.14756308021262238, 0.1614150271512456, 0.15731443978861884, 0.1416764523890469, 0.14954437480651328, 0.1449322630915202, 0.14619860941942264, 0.15571746948906795, 0.15586138345882852, 0.1526942674488034, 0.15139364397491972, 0.14609984720264776, 0.15231457037836968, 0.14433668124908924, 0.14690316684614574, 0.14859190966712627, 0.14846732947729402, 0.1463190391478544, 0.14681484539511783, 0.15696267849190731, 0.15897171014233605, 0.1583499323239546, 0.15558640730963083]]
    95% CI: [0.1508590261575976, 0.15158185452017897]
    lossveclist2 = [[0.1510172249187519, 0.15784140211886807, 0.14913824850844376, 0.14361532727314494, 0.15414922143104548, 0.14931291895393936, 0.15349280566552143, 0.14663745851218332, 0.14839646728834394, 0.1548134604648665, 0.15445155672748515, 0.15222726750517088, 0.1482084602996494, 0.14807485804400786, 0.1483742423639356, 0.15288447673747396, 0.15253134144120464, 0.1430622515880808, 0.1477875699874268, 0.1516790210467493, 0.15362121479258942, 0.14934754861719193, 0.15003820528916184, 0.15504853417058514, 0.14614785162981891, 0.14298293854623803, 0.15392988921990505, 0.1538734088094474, 0.1482912904520399, 0.14536935284642372, 0.14337378238162626, 0.15691109906000988, 0.15722243567005037, 0.1514237052516515, 0.14810111793684136, 0.1554698152528317, 0.14094294116908, 0.15473368968395293, 0.15649921007353187, 0.1542670687755772, 0.1473374384934522, 0.1520030435893359, 0.1531126445993387, 0.1545800983872269, 0.15048895745581684, 0.15400824828191445, 0.16569345340072694, 0.15288331896631746, 0.14868465800816877, 0.1483140404174663, 0.14471956496176974, 0.1574411800445795, 0.15699127243523606, 0.15214636023093436, 0.14884475765785543, 0.15798147800172554, 0.1529661431058791, 0.16306048848038376, 0.15619920793634726, 0.14793209673329316, 0.14592819388433173, 0.14444830260866248, 0.1509396571996547, 0.1516677378778901, 0.14465705225184308, 0.15050926048498062, 0.15406065407942293, 0.15526203572128117, 0.1466321858907937, 0.14779486901887073, 0.15740138216794314, 0.15215751631409116, 0.14393351543251262, 0.15188978378304635, 0.14855144564312245, 0.1512332440738341, 0.15049212627257785, 0.1522526052363672, 0.15787124709584716, 0.15431886432155043, 0.1517096510916179, 0.14546910552093312, 0.15498472771024976, 0.1542785162864995, 0.15461277387456848, 0.1395165371101616, 0.15163164444598468, 0.14413274704805898, 0.15795764134033868, 0.15523340951537853, 0.1421950614592551, 0.14492617424848064, 0.1555708087168105, 0.15536309971915574, 0.16596699351092836, 0.15292065700085408, 0.15442836290793874, 0.15184285344335938, 0.15634164751692758, 0.15246482732497718, 0.1550589639815589, 0.14335274976790158, 0.14739273953790932, 0.14532953580899619, 0.15034922452050972, 0.14760781381977767, 0.1567870837305782, 0.1497453233499366, 0.14880552595651153, 0.15376668006643984, 0.15619685711893636, 0.15509328394320168, 0.15072105708609257, 0.16612489127161653, 0.13820379972493863, 0.14135743551203955, 0.1543394194780055, 0.163221462419494, 0.1536524692250953, 0.15475694493067463, 0.1444977760141151, 0.15041423698882184, 0.15178565795399926, 0.15034636730362386, 0.14246162911083501, 0.15095560439575859, 0.14951601654838614, 0.15235266643308046, 0.15722565287067936, 0.15238096058296247, 0.14399060298439495, 0.14899452072799804, 0.1505149882626663, 0.14457944850238694, 0.15648836221561896, 0.14984412193888008, 0.15957719871626416, 0.15160798717781804, 0.14682058408644763, 0.1485464110814521, 0.15055642857385565, 0.14668705332377605, 0.14888805498501836, 0.15236764949319143, 0.1458421543683771, 0.1462831671723277, 0.15156876561353316, 0.1568827553229753, 0.15299856816850832, 0.15130397096422218, 0.15507507298432816, 0.15514940117598255, 0.1455971254123897, 0.1477807758065302, 0.15013947942528605, 0.1496196009708965, 0.1512491980122052, 0.14971455749963125, 0.15032662092736748, 0.15615476497381459, 0.15605423134415056, 0.15197069859895024, 0.15185563551543943, 0.14783153095904314, 0.15532211157883632, 0.14870217770157348, 0.15115221006361979, 0.14665510346381394, 0.15784794044606926, 0.15610110377523712, 0.14470664772951303, 0.15256029504153767, 0.15392834026556362, 0.15726001565288017, 0.15837409288078635, 0.15786406193501573, 0.15500759977559755, 0.15319998777844876, 0.1500545321325828, 0.14837491347310808, 0.15026719011334447, 0.1448013196485817, 0.15653284832088382, 0.14640112628191265, 0.14067449783711866, 0.14761663778196502, 0.1623395169299276, 0.14289522775363983, 0.15504282221377794, 0.1583441582278468, 0.14885575092253675, 0.13696377160018036, 0.15277921595763447, 0.16100990915283248, 0.15361164692512025, 0.14882085527389013, 0.15500365848587622, 0.1368677397134845, 0.15221487673915396, 0.14116465701322423, 0.1435883575062691, 0.15844799959811112, 0.15423086952736545, 0.15176079886765043, 0.14592493379024418, 0.15383464603741898, 0.1527816507552873, 0.15627635393365483, 0.15257825251215948, 0.14679730269043617, 0.1464618527111107, 0.15101789024660275, 0.14114743094511936, 0.1535424761328616, 0.15467012643616085, 0.14830413573159873, 0.14113812574891818, 0.1467021454277896, 0.15549854911471708, 0.16094614427134502, 0.14566823386275402, 0.15199114388218093, 0.15403476767542684, 0.14873201005660602, 0.15801597524283376, 0.14277755376484375, 0.15268845694712377, 0.1386455114948255, 0.14632044379003237, 0.1604130614925816, 0.14649965703323667, 0.14755579499327146, 0.1447969762977525, 0.15122764588528026, 0.1567642146146637, 0.1442873216450115, 0.15669080362302523, 0.15737633412353016, 0.1546779934576212, 0.162191260293751, 0.13948561933099618, 0.15096466711331813, 0.15228044686368633, 0.14845751101050392, 0.1503639641517215, 0.14381719517416308, 0.15386705905855377, 0.149968197135516, 0.15004467240899272, 0.15111719069858875, 0.1403197997191715, 0.1553898247839097, 0.15025029231483383, 0.1516566294432969, 0.14245918799237958, 0.15022653198985425, 0.14684121901192254, 0.15272759210278053, 0.1506230777291918, 0.15119097389352665, 0.15320921013882788, 0.15075218942808008, 0.14838605041103065, 0.1513242599035189, 0.15222270331010881, 0.14873419155068368, 0.15119531621151625, 0.14855551064585865, 0.1466704764720909, 0.1514596066324492, 0.14952077816861598, 0.14903727224496588, 0.15195505670623527, 0.15095037346762025, 0.1515922457440059, 0.1554772396660777, 0.15532107002010465, 0.14677525748748982, 0.15400970221797777, 0.1546304300202022, 0.14925161692247807, 0.14606323364910978, 0.15004976879320553, 0.15570528260987743, 0.15255336998946747, 0.15546325228272842, 0.14539451517215177, 0.15140436054620354, 0.1591729469615784, 0.1563423652752327, 0.15360658953394507, 0.15310236278512904, 0.16142141504312468, 0.1477296048975051, 0.15106734349913573, 0.1463074418942255, 0.1507331111413395, 0.14929336017649977, 0.14121647091404788, 0.1588614290379982, 0.14499881830313033, 0.1490775227217778, 0.1578115372119416, 0.15034714853492828, 0.15024407110574364, 0.15061808843872254, 0.1541855832708683, 0.14810881387592553, 0.15473903846305442, 0.14662997628498614, 0.16070895743174995, 0.16035320462760144, 0.15041524641538026, 0.1541743604899889, 0.15056458490860475, 0.14386342123899973, 0.14517200314822523, 0.15545091336317765, 0.1534769483168961, 0.14577301439542587, 0.14484402269133598, 0.1622424485805067, 0.15081548776142348, 0.1425265347234284, 0.14751036254060212, 0.14628621503607672, 0.16253286392208716, 0.14672195020913012, 0.14525303190694064, 0.15568491774774373, 0.14256155435946596, 0.15644358976551023, 0.14962502305761022, 0.1444722614790749, 0.1535736714010173, 0.16012114726649584, 0.14771749032457565, 0.16268913255788645, 0.1534450938461839, 0.15516626649413653, 0.1460493359929901, 0.15803353552255672, 0.16027407516882414, 0.15273067643423266, 0.14511324676966456, 0.14215338213754475, 0.15013992496546572, 0.14925267123370844, 0.15201454707640635, 0.15449975007992292, 0.14446649332778655, 0.1465102352285297, 0.15680597494027493, 0.15605073668087813, 0.15348165636738662, 0.15390134990499543, 0.1491123043995106, 0.1566063137553523, 0.15895358148180103, 0.14797133482427804, 0.15376888531094682, 0.14584179553773047, 0.14879826781423036, 0.17653798439928342, 0.1481477294884328, 0.15635606054137513, 0.1491619445643885, 0.14436256286012206, 0.14873157256772573, 0.15169401248288028, 0.15530908010588718, 0.1400253252852209, 0.14570514422709938, 0.152217133202893, 0.15527880961029078, 0.15742419254759274, 0.15106524076337136, 0.15343329946577908, 0.15026023573571923, 0.1539804027515278, 0.1544368249660842, 0.1468966330960733, 0.14448827072691828, 0.14727908937871087, 0.15320859450498384, 0.1412005518541027, 0.1525737312132711, 0.14961550578765767, 0.15116316715814163, 0.1510292288297741, 0.15550292626105033, 0.14310865579999224, 0.14243864539332496, 0.14885011576964025, 0.15692513212392248, 0.14673815676192922, 0.15359031883424287, 0.151779524885469, 0.15655076413946262, 0.15912910039999317, 0.14899743674554958, 0.14881745212120345, 0.157329524752248, 0.1413991666597584, 0.14081715383836363, 0.15800006844892647, 0.15139652796797773, 0.15192700008352727, 0.1438389852557735, 0.1407976013508037, 0.15804751692557653, 0.1522391869246996, 0.1514044671874849, 0.1511294396280741, 0.15756234996495636, 0.1492074010779187, 0.14622545653674882, 0.1572756776855729, 0.14861570638116703, 0.14273681898767787, 0.15939329611339997, 0.1440742798707832, 0.1450353466886935, 0.15257483002471034, 0.16639903727533317, 0.1472358651417736, 0.14798079158872207, 0.14875479552099105, 0.14735754638234855, 0.148507129096658, 0.15560560541390023, 0.1501663037502771, 0.14654035617094194, 0.1432779971815578, 0.15433610732062233, 0.15720495744372348, 0.13990049440728825, 0.1447143615771755, 0.14920848646858897, 0.15856555750113085, 0.15014021397452065, 0.15675672491690645, 0.15689959128281042, 0.15093599120631826, 0.14605621207794822, 0.1494905272606829, 0.15476300168882134, 0.14824881156828146, 0.15396822924075323, 0.153360941803429, 0.15136171324460052, 0.15184815031243057, 0.1591123338930641, 0.15118666806135536, 0.13907963795356826, 0.15003172266670595, 0.14055352526912468, 0.15296331220634393, 0.15346700235439242, 0.15117579835688225, 0.15187509169649188, 0.15810886296004859, 0.14765138231705077, 0.15831568412745328, 0.13942301552756853, 0.15296563348047193, 0.15907451250455892, 0.15088396438462617, 0.14155356962957816, 0.16019870373160786, 0.15424848806514246, 0.14988079328873735, 0.15034135632455464, 0.15131297355524173, 0.1497574293827853, 0.1458217614299096, 0.15304181041340364, 0.15752330912850762, 0.16461278204210908, 0.14220562990015861, 0.15356414911775113, 0.15188896124984771, 0.14857988563257019, 0.15298193221585119, 0.15448659069854961, 0.15688479978384776, 0.15026144593954907, 0.1502840418904261, 0.14306896268721161, 0.15233881475376188, 0.1489302783915819, 0.14402899490368604, 0.15588228665526022, 0.15331536746062926, 0.15053794032900733, 0.15515085582174243, 0.15010872738799827, 0.1362899714829469, 0.16042447436693183, 0.15003890441108222, 0.15285021364333778, 0.15107162494764473, 0.15176927277448898, 0.1566375008258758, 0.150480015910532, 0.14854693860565582, 0.14685236434576546, 0.16093832588115842, 0.1423849043815775, 0.15263264537161195, 0.14708912827200277, 0.14786666830419187, 0.1423893086855822, 0.16154101992165, 0.15606096501380787, 0.15307010582332767, 0.14657216509601703, 0.1484857952508889, 0.15541044634899565, 0.15332762596343763, 0.1514598408502035, 0.15526095111555274, 0.14935683276488299, 0.1516602122290716, 0.15650023922020634, 0.15484880829279604, 0.15131316522149063, 0.1528368388190857, 0.15138526126648943, 0.1585985501040794, 0.1521790389353593, 0.15196302661891462, 0.14571863976628183, 0.14926558744299465, 0.14718897522317517, 0.14453774429379465, 0.14259141557462257, 0.1569773729577407, 0.15071943901066315, 0.14440944197707725, 0.1475469998618231, 0.1491614074036052, 0.16831426131359212, 0.15368881560222244, 0.1583201179540896, 0.15145296627534133, 0.14201422667965294, 0.15061440566051132, 0.1435445447772212, 0.155648923137747, 0.15417489094125125, 0.15330689333415662, 0.14795706326645827, 0.15078107811093514, 0.14679799095998272, 0.14954532354562303, 0.15422615486398766, 0.14803082959844588, 0.15271268509955557, 0.14535399723298623, 0.13854382107330565, 0.15845393875583108, 0.15522521691651547, 0.15956774345262806, 0.1512952249254933, 0.1544941729097243, 0.15059150668119753, 0.15195314699865853, 0.15096962316504658, 0.15094849946371064, 0.15275625729021253, 0.14440309230870843, 0.1564183631791449, 0.14763652994324084, 0.14110524252097148, 0.1467455754772445, 0.15058320273383116, 0.15823090452116143, 0.14769137906648155, 0.15045177905251209, 0.15062763778651325, 0.15661684808985735, 0.15973245955441318, 0.14650785191985158, 0.15179707843056597, 0.15461145149859618, 0.1570818676149339, 0.15670283151844078, 0.14360109078255112, 0.14948933335237571, 0.1437934841093563, 0.15348572570359223, 0.14445598167841678, 0.14930535412783275, 0.14808469966324614, 0.1529300816628755, 0.15949145741507656, 0.14387154735120553, 0.15049813556096583, 0.14847984696336922, 0.1468001074572209, 0.15678880060053155, 0.14643933309373575, 0.14796347826929304, 0.14358356868392597, 0.151874935775987, 0.15878073194347628, 0.15000563225088318, 0.1574637261924057, 0.14733957643195003, 0.15800136194581113, 0.14728303648856084, 0.156004125218144, 0.15141268875498795, 0.15160036547126496, 0.1500780844486252, 0.17178487083794342, 0.15146087240586334, 0.14732112784667845, 0.14303399365404432, 0.15383898920952171, 0.15180796134238395, 0.15364235139109805, 0.1607829471500214, 0.1537814676147646, 0.15033308000142864, 0.14696643127916534, 0.15504109000467498, 0.15855703505093163, 0.14677163449650174, 0.15397102034024554, 0.1454357032255379, 0.15298334509999822, 0.15889039788892817, 0.14551972100288074, 0.1500448541982532, 0.15370223629371482, 0.15681610945379437, 0.15855768138469384, 0.1558870116567005, 0.15299257086186593, 0.15028679877992276, 0.14758570989158268, 0.14808628757064393, 0.1577635427295904, 0.15597662363506795, 0.1511802726634183, 0.1509064164322147, 0.15530745516444952, 0.16175489207757807, 0.15617375991165686, 0.15147278636562722, 0.14856818622893503, 0.15295008469834154, 0.15802490064107652, 0.1481641105702482, 0.15640262761931725, 0.15919006022018725, 0.15137043471827039, 0.1480687774509334, 0.1397735641757216, 0.14896895731240672, 0.16050046719150438, 0.15090049446833523, 0.15369929787731795, 0.1475751199026074, 0.14659463733020056, 0.1573237846968317, 0.1541221428894019, 0.1490356953112508, 0.14499172167400903, 0.14624781609771936, 0.1571980750041458, 0.13954836793194986, 0.1468112141244213, 0.15425592880572703, 0.15017291251846734, 0.15305205698174268, 0.15552452419044463, 0.14782992537781484, 0.153178391996323, 0.14649359705073278, 0.14488478924991763, 0.15258151802616976, 0.14871152383534073, 0.15173305225624317, 0.15478900641543972, 0.14552457374194114, 0.16062165437381026, 0.1486893279270273, 0.16040869105340877, 0.15495081751171863, 0.15345530596339763, 0.14333733197847381, 0.15859002506967554, 0.15153871444490571, 0.154391526127755, 0.1483692255790392, 0.14375722189975737, 0.14788944856361583, 0.14754793343388525, 0.16032981255989906, 0.16153142008635013, 0.15406414981030242, 0.14621874022725667, 0.14897567942121323, 0.1672771497163332, 0.15710736158961908, 0.15628239656787435, 0.1516914437971792, 0.15460403731691552, 0.15292938738955555, 0.14843470302157868, 0.1554736165736137, 0.16233154798080449, 0.15013222000701473, 0.1488639074832112, 0.14487645564919005, 0.1580930194412308, 0.1517096452724458, 0.15089990918700014, 0.1499730127877422, 0.15100831863329242, 0.15155239823064878, 0.15630474265153388, 0.14512662780671484, 0.15861404819087968, 0.14496314365711604, 0.14176407485649048, 0.14763382433402, 0.14953747083322777, 0.14612521096474215, 0.15215086457789148, 0.1571944660674445, 0.15551738621624775, 0.14765688488580875, 0.15841871937450205, 0.1466177564270508, 0.14635980872615578, 0.15060331231571758, 0.14666815620481985, 0.1442145382558319, 0.15406136511635607, 0.1443108434822166, 0.14827853318052114, 0.15101883930771404, 0.15668484699416826, 0.15482299336737923, 0.1529464094987321, 0.14707542607450455, 0.14288421325671455, 0.15752057704960945, 0.14875505934014452, 0.14824871421799202, 0.13876208304508672, 0.1544903803838217, 0.15170064430128688, 0.15693148070768007, 0.15461467804963466, 0.14923612442045134, 0.14826676472301228, 0.14744834919025915, 0.1514801078659668, 0.14994449631369483, 0.1586510854656534, 0.16348629143371465, 0.15743555375666302, 0.15919824871547592, 0.14559192213369898, 0.14957073003478474, 0.15465652713289924, 0.15126080490076488, 0.14945553269663778, 0.15971208883487, 0.15129273695509787, 0.14983980466695893, 0.1530904186581511, 0.1496012399140087, 0.14804171801418306, 0.1530487513767841, 0.1593168308267484, 0.1467333361120316, 0.15282283638059205, 0.14829721543945407, 0.15891872227643708, 0.1593427369455411, 0.1495436357353926, 0.1531470802352025, 0.15088854560043813, 0.16825619458694888, 0.149760432051446, 0.15112105529658276, 0.14246358253096653, 0.14903327624900267, 0.1547234120660679, 0.1550761957267354, 0.14942136149986515, 0.1463140459978009, 0.1500260968670169, 0.15481517259366, 0.14716930711991083, 0.15954867249197438, 0.14309915262219317, 0.14272263073596256, 0.15854505264379024, 0.14750216405259617, 0.15767671540174696, 0.1441297827876031, 0.15589565449591336, 0.16206364394715334, 0.1573192354679479, 0.15329725118392695, 0.15405642828444993, 0.14395863393157218, 0.15344432847372974, 0.16543590040927, 0.15842629292831958, 0.154735002356383, 0.1468516063744478, 0.1629430411451836, 0.14154981657273302, 0.15576606206065352, 0.14538691095198175, 0.15349896649471031, 0.15133003193337247, 0.157004056115995, 0.15629435320148713, 0.1513907517762599, 0.15106837093560996, 0.1486674967434607, 0.1524102403333548, 0.1561200973499371, 0.14197303472021858, 0.15684473162882404, 0.15867654212366117, 0.1492616362155116, 0.14578012715809724, 0.1531148872984485, 0.164288409918754, 0.1463886923132682, 0.15246281883163984, 0.15353606552965737, 0.14996316721737066, 0.14474473498783189, 0.14659835702644797, 0.16050904966925103, 0.15434368398701925, 0.1516956744670237, 0.1513178766414819, 0.14118956484640277, 0.14752598511126275, 0.14907563176667224, 0.14958700590939403, 0.15892184303953047, 0.1626224176897715, 0.1515243717572763, 0.1481807320761175, 0.15283899452205407, 0.14910164287653793, 0.14418094012147967, 0.14939805882066254, 0.15474672123552174, 0.14540151583499553, 0.15615457544514533, 0.15100919730321793, 0.15256360565800622, 0.15256606209403115, 0.15369861440045327, 0.14570221172758058, 0.15028485449028414, 0.1528961881749257, 0.14616661983007298, 0.14557901058036649, 0.15643915310031667, 0.1561471179488482, 0.1571967242046278, 0.15209915450697745, 0.16185124261000908, 0.1487210270404336, 0.15635824535376125, 0.14924673695807106, 0.1449349862176633, 0.1451202689589645, 0.15261175558967005, 0.13604159343146008, 0.15034129366006627, 0.16201765464542184, 0.15461178133368825, 0.154969158641223, 0.1538499961161293, 0.15648027517519572, 0.146742126818432, 0.1461975470722311, 0.14651399168470253, 0.1535669758961899, 0.14914916177914025, 0.14541307304625398, 0.14602236850977174, 0.16245057404166904, 0.1525929144441096, 0.15429766770333914, 0.15036844515645403, 0.15105079420832215, 0.1595530989158414, 0.15551538601620019, 0.1464897964166791, 0.14519779864914054, 0.1462314268273229, 0.1603842891615992, 0.14561704119098848, 0.1620091913225356, 0.1618951237950567, 0.16179733301665986, 0.14653581451391479, 0.14928033979326086, 0.14656481118544237, 0.14856397815503053, 0.15527378987846044, 0.14829009568722773, 0.15051950403475406, 0.14829090415978713, 0.1463246503163498, 0.15517653526126907, 0.15136707087638046, 0.15111585249848902, 0.14844635752116225, 0.1468097655354977, 0.15257368215264858, 0.14851150351915435, 0.15749121212619124, 0.14762458568047426, 0.15396391637138956, 0.15565759738235035, 0.15626962127725946, 0.1582858665135038, 0.1462238519901734, 0.14342890466425579, 0.15449190140804117, 0.15542275411931614, 0.14811158556988024, 0.13510206916267153, 0.15124991672522412, 0.15352724014657615, 0.14934053565424976, 0.14793645701619135, 0.16176831043757436, 0.1597644236324412, 0.14997074949146194, 0.1570270591649046, 0.14871087580761128, 0.14280250692244276, 0.14706973213258695, 0.1549459923854138, 0.1468014588824541, 0.14585716570123416, 0.15668937433512267, 0.15359584973156853, 0.1605216380299116, 0.14684222143558895, 0.14768104166551926, 0.14197203599118136, 0.14538997349970104, 0.15054505927134185, 0.15606750083472287, 0.16030512229522884, 0.14339557846382275, 0.1557098919664751, 0.1507035834255781, 0.1547832648704013, 0.15520991968522724, 0.15681579076465765, 0.15344483369151016, 0.1545583091769068, 0.15123620344355193, 0.1491593139848718, 0.14919404606532313, 0.15710998372870907, 0.14672662515973314, 0.147791971805554, 0.1541656798639346, 0.14919725365720202, 0.14186332011408911, 0.1563516998324075, 0.15260442969524743, 0.1436670682013846, 0.15702377947788043, 0.14799410678329286, 0.14845325615570126, 0.15797309637559928, 0.14387219335915766, 0.16072605227956385, 0.15451054491398583, 0.15470595864256223, 0.15145583861627682, 0.1508572779085943, 0.14996754580136792, 0.142897895617698, 0.15389785059535285, 0.1487267994904609, 0.14845225431678485]]
    95% CI: [0.15100307416678901, 0.15167494462601158]
    '''
    # MCMCexpect
    lossveclist2 = getDesignUtility(priordatadict=exampleDict.copy(), lossdict=lossDict.copy(), designlist=designList,
                                    designnames=designNames, numtests=numtests,
                                    omeganum=omeganum, type=['trace'], randinds=randinds, method='MCMCexpect',
                                    numpostdraws=numdrawspost)
    # print(lossveclist2)
    # FOR GENERATING 95% INTERVAL ON LOSS
    CIalpha = 0.05
    z = spstat.norm.ppf(1 - (CIalpha / 2))
    for lst in lossveclist2:  # FOR INTERVAL ON MEAN
        mn = np.mean(lst)
        sd = np.std(lst)
        intval = z * (sd) / np.sqrt(len(lst))
        loperc = (mn - intval)
        hiperc = (mn + intval)
        print('[' + str(loperc) + ', ' + str(hiperc) + ']')

    return

def checkDistsAlign():
    numTN, numSN = 3, 2
    # Designate testing accuracy
    s, r = 1., 1.
    # Designate the true SFP rates
    trueSFPrates = [0.5, 0.05, 0.1, 0.08, 0.02]

    # Generate a supply chain, with no testing data
    exampleDict = util.generateRandDataDict(numImp=numSN, numOut=numTN, diagSens=s, diagSpec=r, numSamples=0,
                                            dataType='Tracked', randSeed=86, trueRates=trueSFPrates)
    exampleDict[
        'diagSens'] = s  # bug from older version of logistigate that doesn't affect the data but reports s,r=0.9,0.99
    exampleDict['diagSpec'] = r
    # Update dictionary with needed summary vectors
    exampleDict = util.GetVectorForms(exampleDict)
    # Populate N and Y with numbers from paper example
    exampleDict['N'] = np.array([[6, 11], [12, 6], [2, 13]])
    exampleDict['Y'] = np.array([[3, 0], [6, 0], [0, 0]])
    # Add a prior
    exampleDict['prior'] = methods.prior_normal()
    # MCMC settings
    exampleDict['MCMCdict'] = {'MCMCtype': 'NUTS', 'Madapt': 5000, 'delta': 0.4}
    exampleDict['importerNum'] = numSN
    exampleDict['outletNum'] = numTN

    # Generate posterior draws
    numdraws = 20000
    numdrawspost = 1000
    exampleDict['numPostSamples'] = numdraws
    exampleDict = methods.GeneratePostSamples(exampleDict)

    design = np.array([[0., 0.], [1., 0.], [0., 0.]])
    type = ['trace']
    numtests = 25
    sampMat = design * numtests
    omeganum = 200
    randinds = random.sample(range(numdraws), omeganum)

    # Use MCMC to get omeganum scenarios
    sampsArr = np.zeros(shape=(omeganum, numdrawspost, numTN + numSN))
    for drawnum, currpriordraw in enumerate(exampleDict['postSamples'][randinds]):

        # Initialize Ntilde and Ytilde
        Ntilde = sampMat.copy()
        Ytilde = np.zeros(shape=exampleDict['N'].shape)

        for currTN in range(numTN):
            for currSN in range(numSN):
                currzProb = zProbTr(currTN, currSN, numSN, currpriordraw, exampleDict['diagSens'],
                                    exampleDict['diagSpec'])
                if type[0] == 'trace':
                    currTerm = sampMat[currTN][currSN] * currzProb
                elif type[0] == 'test node':
                    currTerm = sampMat[currTN] * type[1][currTN][currSN] * currzProb
                Ytilde[currTN][currSN] = currTerm

        # We have a new set of data d_tilde
        Nomega = exampleDict['N'] + Ntilde
        Yomega = exampleDict['Y'] + Ytilde

        postdatadict = exampleDict.copy()
        postdatadict['N'] = Nomega
        postdatadict['Y'] = Yomega

        # Writes over previous MCMC draws
        postdatadict.update({'numPostSamples': numdrawspost})
        postdatadict = methods.GeneratePostSamples(postdatadict)
        sampsArr[drawnum] = postdatadict['postSamples']

    # We now have MCMC draws; get draws from weights
    postDensWts = []  # Initialize our weights for each vector of SFP rates
    for currdraw in exampleDict['postSamples']:  # Iterate through each prior draw
        currWt = 0
        '''
        for currTN in range(numTN):
            for currSN in range(numSN):
                currzProb = zProbTr(currTN, currSN, numSN, currdraw, exampleDict['diagSens'],
                                    exampleDict['diagSpec'])
                currzTerm = (currzProb ** currzProb) * ((1 - currzProb) ** (1 - currzProb))
                if type[0] == 'trace':
                    currTerm = currzTerm ** (sampMat[currTN][currSN])
                elif type[0] == 'test node':
                    currTerm = currzTerm ** (sampMat[currTN] * type[1][currTN][currSN])
                currWt = currWt * currTerm

        '''
        '''
        for currTN in range(numTN):
            for currSN in range(numSN):
                currN = int(sampMat[currTN][currSN])
                currzProb = zProbTr(currTN, currSN, numSN, currdraw, exampleDict['diagSens'],
                                    exampleDict['diagSpec'])
                for currY in range(currN+1):
                    currTerm = (((currzProb ** currY) * ((1 - currzProb) ** (currN - currY)) )  * comb(int(currN),
                        int(currY)))** 2
                    currWt += currTerm

                currY = currzProb * currN
                currYflr, currYceil = math.floor(currY), math.ceil(currY)
                if currYceil > 0:
                    yRem = currY - currYflr
                    flrTerm = (currzProb ** currYflr) * ((1 - currzProb) ** (currN - currYflr)) * comb(int(currN), currYflr)
                    ceilTerm = (currzProb ** currYceil) * ((1 - currzProb) ** (currN - currYceil)) * comb(int(currN),
                                                                                                      currYceil)
                    currTerm = (1 - yRem) * flrTerm + (yRem) * ceilTerm
                else:
                    currTerm = 1
                '''

        postDensWts.append((currWt))
    # Normalize the weights to sum to the number of prior draws
    postWtsSum = np.sum(postDensWts)
    postDensWts = [postDensWts[i] * (len(exampleDict['postSamples']) / postWtsSum) for i in range(len(postDensWts))]

    ###### Generate histograms of MCMC and weight methods
    intrange = np.arange(0., 1., 0.01)
    priorMat = np.zeros(shape=(numTN + numSN, len(intrange)))
    mcmcMat = np.zeros(shape=(omeganum, numTN + numSN, len(intrange)))
    sampsArrComb = sampsArr.reshape((-1, sampsArr.shape[-1]))
    mcmcCombMat = np.zeros(shape=(numTN + numSN, len(intrange)))
    wtMat = np.zeros(shape=(numTN + numSN, len(intrange)))
    for cellind, cell_lo in enumerate(intrange):  # Iterate through each histogram bin
        cell_hi = cell_lo + 0.01
        for draw in exampleDict['postSamples']:
            for nodeind in range(numTN + numSN):
                if (draw[nodeind] >= cell_lo) and (draw[nodeind] < cell_hi):
                    priorMat[nodeind][cellind] += 1
        for omega in range(omeganum):
            for draw in sampsArr[omega]:
                for nodeind in range(numTN + numSN):
                    if (draw[nodeind] >= cell_lo) and (draw[nodeind] < cell_hi):
                        mcmcMat[omega][nodeind][cellind] += 1 * numdraws / numdrawspost
        for draw in sampsArrComb:  # All combined posterior MCMC draws
            for nodeind in range(numTN + numSN):
                if (draw[nodeind] >= cell_lo) and (draw[nodeind] < cell_hi):
                    mcmcCombMat[nodeind][cellind] += 1 * numdraws / (omeganum * numdrawspost)
        for drawind, draw in enumerate(exampleDict['postSamples']):  # The posterior weights
            for nodeind in range(numTN + numSN):
                if (draw[nodeind] >= cell_lo) and (draw[nodeind] < cell_hi):
                    wtMat[nodeind][cellind] += postDensWts[drawind]

    for i in range(numTN + numSN):
        for omega in range(omeganum):
            plt.plot(intrange, mcmcMat[omega][i], color='blue', linewidth=0.05)
        plt.plot(intrange, mcmcCombMat[i], color='darkblue', linewidth=3)
        # plt.plot(intrange,wtMat[i],color='orange',linewidth=3)
        plt.plot(intrange, priorMat[i], color='black', linewidth=2)
        plt.show()

    return


'''
# Put loss value data as vectors below; this will generate a set of histograms
# FOR 3 TESTS WITH ALIGNED PRIOR DRAWS
lvec1 = [0.13047196168170846, 0.1276038264408392, 0.12449235844276779, 0.13217349422523322, 0.1354759528148989, 0.1360142621802269, 0.12939067614673927, 0.1286761730177714, 0.14169743569010873, 0.12778910630973087, 0.12480889050669584, 0.1349795282762828, 0.12707302246784827, 0.1302957948436728, 0.13157428686120592, 0.14644515788152665, 0.1256991893306132, 0.13194174128845973, 0.12540158735569396, 0.1306203436741542, 0.14261781696505488, 0.150280893284013, 0.14041038641070372, 0.12348282614396186, 0.125911845549212, 0.13469509047043055, 0.135752134309431, 0.13662644692994802, 0.1254239544910863, 0.12405392996605177, 0.1479332529407039, 0.1301525637862641, 0.13497285555377378, 0.15006052733905945, 0.13569726059359477, 0.1522005031687532, 0.13404841406693055, 0.14696558817453664, 0.12978124744622593, 0.1441451377717851, 0.13625775638361956, 0.12837295653070918, 0.12838887495178292, 0.12764654396269842, 0.1300896357023657, 0.12890125184470347, 0.1324589416735074, 0.1324589416735074, 0.15617817508483378, 0.13305267644520485, 0.13021117513543903, 0.1252221764041104, 0.12971953381482387, 0.13302782557514592, 0.1292101726489508, 0.12944675178905107, 0.13495145483950105, 0.1454534859133748, 0.12993801064495875, 0.12462455689054089, 0.137885930960764, 0.12927953773801315, 0.14186420034657476, 0.12448797474967636, 0.14424700849684968, 0.13377822799246095, 0.12956186433758862, 0.1298119199754846, 0.14365063236204537, 0.1433258367246212, 0.14166468096134932, 0.14329245911306435, 0.13570369538569574, 0.1345784605734944, 0.13115039046122184, 0.13679824568726018, 0.13533205174111768, 0.13462419117133795, 0.1287867130550015, 0.13988172816736003, 0.1369139316205147, 0.12329925549938892, 0.13813520486908826, 0.12443559097337117, 0.13126097231720898, 0.14009128941725005, 0.14122534946237164, 0.13287131388033596, 0.11888576012907849, 0.12684374243485486, 0.13216098467054446, 0.12408401197129885, 0.1469222731480437, 0.15100287401554233, 0.1383834377262981, 0.1508454309423051, 0.13058567424510278, 0.1449475078236815, 0.1493445085993241, 0.12616948030359015]
lvec2 = [0.12754209193762045, 0.14031219720978916, 0.13010100439884947, 0.1327246470991515, 0.1332488070741414, 0.17785684814211353, 0.12842574463210446, 0.13181677560053628, 0.1343499195285006, 0.1323374633661742, 0.12836862511602445, 0.13001859567488736, 0.1365527321797588, 0.12775634414907083, 0.14580346329980734, 0.1640785189966381, 0.1311423007944489, 0.13223061726192142, 0.12767395998354436, 0.12429207661021083, 0.1265604764724026, 0.13072937443355737, 0.15671777269777182, 0.12514181892215678, 0.13168644644057526, 0.16274530137939722, 0.16654474484115633, 0.1316258004074624, 0.12731853589008554, 0.13304878913448515, 0.16877064424013738, 0.14011507180814017, 0.13192862095566837, 0.13519505789846187, 0.13002509201899204, 0.13168205990715817, 0.12994389799319672, 0.13038181706740126, 0.13431882708195128, 0.13746970899234498, 0.13539540264916458, 0.13487973988967866, 0.12997782849544973, 0.13673316854940076, 0.1307450174830862, 0.1371005133585724, 0.13924090501043032, 0.13838798514314493, 0.134923406337216, 0.12614519075546998, 0.133023593322859, 0.12576895927705714, 0.13105501260078514, 0.130107013636262, 0.12582858636922473, 0.17248682902645737, 0.1325208788030812, 0.14588921081877704, 0.13541096684538162, 0.1342599964292524, 0.13001699237686787, 0.12756441777691874, 0.13031295552831842, 0.13244792060846697, 0.13228096472940035, 0.12502263561973484, 0.17986885944768705, 0.13162725440466186, 0.13752168808162005, 0.1331347506159003, 0.12797199847337623, 0.1434561233452652, 0.12900276797441673, 0.12992678684060696, 0.1408798044821269, 0.13503855240312046, 0.13693097439732002, 0.12402673487666072, 0.130582714215785, 0.12063979073675954, 0.13055935152289774, 0.13478958511820552, 0.13278513683197604, 0.13339851346118609, 0.13348580758961437, 0.13039165311990222, 0.13077245124761644, 0.13943728199506442, 0.16571263533012898, 0.16363749427459032, 0.1643298773941419, 0.13035993493446266, 0.13451805163720365, 0.12891800101853534, 0.1673501251232175, 0.1319185405640334, 0.14611467424401084, 0.13875906340601532, 0.14211957771532613, 0.14369715743805525]
lvec3 = [0.13697764582012645, 0.12675526883520252, 0.1308251030754902, 0.1408067592248919, 0.12597841552729494, 0.13353369491755498, 0.12429832403437134, 0.13709863103925737, 0.13141996233451253, 0.13085683801927164, 0.131841415917466, 0.13173386238128823, 0.1401340965206679, 0.13324231403453868, 0.13936384861638426, 0.12560101659332082, 0.13580229493907667, 0.133666761503803, 0.12943125269234088, 0.13207189228981028, 0.13642282124061, 0.13462831586183321, 0.127763082680329, 0.13511421110192526, 0.1361333002340311, 0.13597872713804882, 0.14593994372250554, 0.15183977649734026, 0.13044317617938794, 0.134250313662532, 0.13835344794064533, 0.14409107773328075, 0.14061087861520152, 0.12354667007835678, 0.13079558927052282, 0.13009358252378478, 0.13288300606106693, 0.13288300606106693, 0.1337398123298732, 0.13817381445437968, 0.1267033116857319, 0.13501292647925223, 0.145885252133139, 0.12907969312912632, 0.13110323976246913, 0.12761127506408187, 0.11948756266658803, 0.13229452870205766, 0.13646942055844247, 0.13120594005088243, 0.12920145379022513, 0.1351595719685953, 0.14063366039188874, 0.1308125333038432, 0.1519291067594185, 0.1482402111817438, 0.12844284976192133, 0.12929512895939857, 0.12444294177057715, 0.13797803707748096, 0.14169078361098578, 0.12765417575956856, 0.12374824898093927, 0.13663097521203463, 0.13621719862915177, 0.13814639573711598, 0.13318106231629007, 0.1519677075463462, 0.13822681273026283, 0.13469370661433747, 0.14196219996850246, 0.142127274583187, 0.1410232360463834, 0.12847845669028682, 0.13431374906200821, 0.14252571697309935, 0.14481582602784168, 0.12689537302651258, 0.12226290284133942, 0.1443536892393676, 0.1254594853135468, 0.14117895600672078, 0.13256151218842954, 0.1268591399355791, 0.14448117338334976, 0.12930964020146546, 0.1328649287609819, 0.14108330586916737, 0.12993659975971897, 0.13038081242281513, 0.12263687279953689, 0.12906569669579687, 0.13197722926338046, 0.13142804989471524, 0.1272496162487525, 0.13990288456384065, 0.13490202565031886, 0.12521477015095855, 0.12639177772762686, 0.13212715475633424]
lvec4 = [0.13786484978656838, 0.13737504032389106, 0.13655960150728405, 0.13863506287719363, 0.1390705581703513, 0.13977357195661486, 0.13907779150128435, 0.14154022665594576, 0.1341428958677076, 0.14274229913887965, 0.135153287130241, 0.13105271863771872, 0.14252757080839124, 0.13738626083669195, 0.13692611022857448, 0.14374513437638084, 0.14483457186159396, 0.14155897391354638, 0.1359188473783265, 0.13706101460831738, 0.13979885002825704, 0.1415448141063927, 0.1313137305255705, 0.15089531512472276, 0.14429036742745727, 0.1422959481561467, 0.13881377708645065, 0.14029047321001678, 0.13663518876925432, 0.13590736367712508, 0.13677835712305578, 0.13793841714606353, 0.13944242873000565, 0.14007611697718456, 0.1403639882260881, 0.14252672568755467, 0.1353562891255248, 0.14171960127549904, 0.1293170272823765, 0.1346095532222456, 0.13931966248063582, 0.14410737993848613, 0.14382654677774667, 0.14309952551247734, 0.14324284516840627, 0.1365172388969145, 0.14693616687805508, 0.1414564994448689, 0.13876599367433967, 0.13672233725027796, 0.13487708835001072, 0.1445853558104675, 0.13404210108078896, 0.141401212149338, 0.14729279447728044, 0.14872641605297127, 0.1350632140860931, 0.13647976400541914, 0.14088595875175142, 0.13318518358188056, 0.16420408628338357, 0.1348311628333333, 0.14355908259605457, 0.13879174555266596, 0.13764593885442333, 0.14494549026829537, 0.13372496095454733, 0.13925238276068996, 0.13650616726144724, 0.14729058860536992, 0.13443419227721867, 0.14140015437626002, 0.1302318793690348, 0.13556130371659977, 0.1399566138881258, 0.13641516955200297, 0.13717972701081507, 0.1571722438889038, 0.14797517506393126, 0.1319165765189502, 0.1398382095139937, 0.13512441449526305, 0.14837752413841238, 0.13551783243615612, 0.1513266725791105, 0.13797378141194655, 0.141447393548898, 0.1424173974230253, 0.1424173974230253, 0.13861080825626898, 0.1369953352796346, 0.1410452656391854, 0.13453307065354014, 0.14136567133337186, 0.14829498270715696, 0.1369190196918488, 0.14002214895370355, 0.1437387639043145, 0.13225607654813218, 0.13527140622812006]


bins = np.linspace(0.05, 0.2, 100)
fig, axs = plt.subplots(4,figsize=(5,9))
plt.rcParams["figure.autolayout"] = True
axs[0].hist(lvec1, bins, alpha=0.5, color='red', label='Design 1')
axs[1].hist(lvec2, bins, alpha=0.5, color='green', label='Design 2')
axs[2].hist(lvec3, bins, alpha=0.5, color='blue', label='Design 3')
axs[3].hist(lvec4, bins, alpha=0.5, color='gray', label='Design 4')
axs[0].set_title('Design 1')
axs[1].set_title('Design 2')
axs[2].set_title('Design 3')
axs[3].set_title('Design 4')
for i in range(4):
    axs[i].set_ylim([0,20])
fig.tight_layout()
fig.suptitle('Bayesian loss: 3 tests, Omega=100',fontsize=14)
plt.show()

'''

'''
# Put loss value data as vectors below; this will generate a set of histograms
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS
lvec0 = [0.14335674740847668, 0.13563245422451242, 0.1415963480854923, 0.14477842127227447, 0.1403673820567332, 0.14422281864161265, 0.14329261560423487, 0.1420062342037913, 0.14433295208263913, 0.1403238089040552, 0.13622023914021908, 0.1331215477563341, 0.13985955261052357, 0.13625107480023418, 0.13278830969158803, 0.15104810337007638, 0.1432066934207097, 0.14654590113820598, 0.14155140609144773, 0.13852272271124094, 0.13445127898827322, 0.13908978650635498, 0.1360373375312127, 0.13526163120094575, 0.13351511475872638, 0.1392834993888565, 0.14217784089826874, 0.1377067146937541, 0.13608336613577093, 0.13836213835655492, 0.1425563771081175, 0.13701890404704872, 0.14275701547310093, 0.14037446661784928, 0.135899731846271, 0.14472193099297048, 0.14004487852829342, 0.14100806934369722, 0.13803489989603657, 0.13771365713309786, 0.14139179718653286, 0.13087720270484154, 0.13903043764659487, 0.1451529118187262, 0.14357323831263982, 0.14277614431056324, 0.13806245145666834, 0.1390161454589516, 0.13787407260580362, 0.1298548333936015, 0.1286585066046738, 0.13813220094369869, 0.13870075098025772, 0.134798114071913, 0.14181892280318806, 0.14415150594437046, 0.1401707511122268, 0.13713175719384266, 0.13294292602440483, 0.13685260067190896, 0.14083582503649433, 0.14136240031126082, 0.137865717839781, 0.13393002615490654, 0.1427531689634655, 0.13538762826838718, 0.1496264644252375, 0.13540613334631685, 0.14101331288050714, 0.14671835743546532, 0.14478887242738706, 0.14931950638902403, 0.13283790393728137, 0.12970826512223263, 0.13796919743108113, 0.138645518281725, 0.1376171622310323, 0.13691141612588123, 0.14049677187086496, 0.13977659698381142, 0.13564191745044885, 0.13998212469718388, 0.14584815842274426, 0.14039224867696098, 0.13309154841127116, 0.1440026953609819, 0.1417341702439205, 0.14080983152552431, 0.14814505856180918, 0.1409467537003577, 0.1427572188544298, 0.13285891774806471, 0.13551388876899503, 0.15248278741427487, 0.1405290826335275, 0.13718595570106867, 0.13974116032513081, 0.13990250040610652, 0.1365994485550459, 0.1423325398989005]
lvec1 = [0.10634961174656275, 0.10302512056824153, 0.10573264203096888, 0.10940710352094114, 0.1079996198537457, 0.11386740538578519, 0.10339574572939116, 0.11705737348112238, 0.1046042481657203, 0.09925637880479482, 0.10425024005195677, 0.10352373313627466, 0.10063670495558483, 0.10799571446493482, 0.10836126822711473, 0.12051487450224642, 0.1045375314987425, 0.10439329799781122, 0.10268174950658925, 0.11234612369685851, 0.11234612369685851, 0.11800333845717682, 0.10418129588512696, 0.09703525486762068, 0.11616352612463957, 0.107728523136265, 0.11633564096686878, 0.14649054407733408, 0.10344308352390195, 0.10115707730680844, 0.10282231132299667, 0.10199820867319392, 0.11032410876508615, 0.10706950609289534, 0.10585915421202698, 0.1021843099315789, 0.10141639972518424, 0.10633943015662597, 0.1221172424682917, 0.10957372366455317, 0.13957032579483666, 0.10611496993096368, 0.10990296947641609, 0.11629037552378135, 0.10612435791561563, 0.10242963152014234, 0.10585724486168423, 0.09904601046902506, 0.10417078282127863, 0.11948214224211381, 0.1022160665374903, 0.1003382119019552, 0.12185635853549258, 0.10433125333239412, 0.10762830180763937, 0.1077274211549446, 0.10323979689185256, 0.10958942997651802, 0.10744930711459766, 0.10439667181367551, 0.10586832207215371, 0.10450362736603448, 0.1071311510626874, 0.10542673990664103, 0.10303039852242575, 0.10603698598299861, 0.1106886958276474, 0.11195802212106028, 0.11213153776026705, 0.10369695483929618, 0.09954381801274868, 0.12097884178410417, 0.12277409961119393, 0.09990737564843913, 0.11338768289126687, 0.15036613871870752, 0.10582848369463524, 0.10609097453062596, 0.12057525824788429, 0.127423256991933, 0.09972793858494255, 0.10598418649068067, 0.10864586614576892, 0.09884469447717312, 0.10904726369610386, 0.10290399590203675, 0.12341221567552675, 0.11093605699657906, 0.10921650225520371, 0.10144867949049492, 0.10277198535904514, 0.10424750829055592, 0.1632766996357331, 0.10662150026302795, 0.11551713425926377, 0.10258832038145932, 0.12703072288637893, 0.13534176208647325, 0.10638320675903544, 0.11408565414293617]
lvec2 = [0.08846907100334117, 0.12204653405437324, 0.11134160642351906, 0.138984542650809, 0.1337369860752422, 0.1371240842789891, 0.0971554324870248, 0.09958346985577195, 0.10070951154512953, 0.1303105442447949, 0.09523713865503293, 0.10023565081432302, 0.13808120389705528, 0.09258572338941401, 0.09535686158262739, 0.0989405020611249, 0.0977509560559939, 0.09233369659043171, 0.09186502887081881, 0.10229916568694297, 0.10446139081607504, 0.09833252948729544, 0.09370073654768755, 0.10118830212537351, 0.10323801562791826, 0.09571028646088366, 0.11641418219671133, 0.1001482614667568, 0.0970847128224121, 0.1214891701670199, 0.133204534038947, 0.09815319755985254, 0.1002936933775179, 0.11256089490548762, 0.09745801905562622, 0.11601971501035156, 0.10962601346989359, 0.0933793220288433, 0.09331437554207622, 0.09077959285606141, 0.15245414818948413, 0.09419395594480588, 0.09706474617576887, 0.10008984062064338, 0.14960513112981558, 0.0951139581791243, 0.09516114169655121, 0.09495360874139615, 0.14297128761257477, 0.11420523895286804, 0.09338834414834506, 0.09487621972156311, 0.1503284823843334, 0.09709529172952934, 0.13974139242667244, 0.11358824745871843, 0.09634722324888377, 0.09585720856835372, 0.12350946577094911, 0.11036323660636903, 0.1060997456805723, 0.10028146661742278, 0.09501072192079588, 0.09744867882438121, 0.08642881123426427, 0.0958143651785655, 0.10959436859020148, 0.09085354258311089, 0.09891157466466459, 0.10923513897563925, 0.110797370644161, 0.0971066933944853, 0.09544757522873497, 0.09315381629647514, 0.10715618252977116, 0.1432884402439888, 0.10187255512044427, 0.09537034747487716, 0.11201339933751868, 0.09471477295529196, 0.1017373734719954, 0.09404799962512932, 0.09740298340522555, 0.1067236592961917, 0.1205748753679981, 0.09882357772764515, 0.10667669622767387, 0.09924358806975918, 0.0990024738621961, 0.12995829286857116, 0.11779277896907878, 0.12233044145918576, 0.11989642326551032, 0.0952712402594451, 0.09815837555355965, 0.10329483010975068, 0.09749041083852679, 0.10662786973651314, 0.11014263299374114, 0.09905529546390655]
lvec3 = [0.11098974193332863, 0.10125051232420816, 0.11315345875479645, 0.14824849585948016, 0.12366359215833488, 0.11542909714969321, 0.10183381102989159, 0.10263148538154584, 0.11148631710088726, 0.1084937101564695, 0.10550927756678886, 0.09857013666010819, 0.11347462151166492, 0.11638102843486009, 0.14953441205466078, 0.16984221819246018, 0.16984221819246018, 0.11434691923912824, 0.11744327488708049, 0.12382928134932471, 0.10135108238722856, 0.10646095088922433, 0.11267174450693104, 0.10452698377828328, 0.09998643667474148, 0.10841215679858358, 0.11654286146832589, 0.11325844282086751, 0.12314719169286412, 0.09956359434182292, 0.11888835431978494, 0.10188299816254247, 0.10582320905400318, 0.1043406496092699, 0.10044141640207754, 0.10077252305876916, 0.10049698796349667, 0.09740979559291969, 0.10236601308361748, 0.10659814250463902, 0.15247726856568197, 0.09919174837610781, 0.10163849402694841, 0.11481432724190282, 0.10856790094035465, 0.1114748956445173, 0.10352971388114812, 0.10858561442707555, 0.12329119948704052, 0.11064231694477107, 0.1027685207630217, 0.11217936643228103, 0.11234530737792149, 0.09478842508698913, 0.10700042430667996, 0.11645010937684662, 0.12705002168750693, 0.10700045503345265, 0.11048688365719368, 0.1090621431847006, 0.10319468604112218, 0.1043909446429444, 0.1173314403933393, 0.11883522071079118, 0.10665173334224833, 0.10028275085055974, 0.1372634290037096, 0.11168466708454744, 0.10517656102771333, 0.12288115764386295, 0.11296476127238188, 0.09948237746650039, 0.12040098137010717, 0.09620255719752412, 0.1270244262138782, 0.134629257064983, 0.11153118939648016, 0.10603054028747022, 0.1024523685893314, 0.10412519688945349, 0.10922092562882185, 0.10514128052629228, 0.10603737019736942, 0.09567766033447421, 0.14466657664118415, 0.0984397089939447, 0.10132508254875486, 0.09823073295612572, 0.09847154149921909, 0.1410335938381654, 0.114412858617555, 0.11721596504756412, 0.15588738400060143, 0.16126500233961147, 0.10722058087143405, 0.1121644342687555, 0.10912254820238977, 0.11219291217967348, 0.10065879564721798, 0.0999875760494058]
lvec4 = [0.12755901234498981, 0.1272227641499066, 0.14367923011504508, 0.13053818512938012, 0.1354029707310704, 0.1298842528575228, 0.13556599561283753, 0.12882711757260126, 0.14423171736957027, 0.13096163052233253, 0.12770621594889955, 0.14030751852218828, 0.14035633491785288, 0.13114531238772126, 0.1331719733120443, 0.13567356195481461, 0.1490404304901742, 0.13030520418802785, 0.1387610294589461, 0.13984289095763378, 0.1324402782954368, 0.13172723443993992, 0.14829909361158036, 0.1434638988868053, 0.1307147339895076, 0.13369199138321494, 0.133805303387655, 0.1383671861895898, 0.13434287759205907, 0.13730766604181655, 0.14429296983483866, 0.13605026543510354, 0.1315971516370006, 0.1309955346472841, 0.14759889104242496, 0.14452508582904147, 0.13526105980782366, 0.13459903984755756, 0.13308721478508762, 0.12985762534582457, 0.13359981880406804, 0.1359209175245402, 0.1613232629588759, 0.13690079860486462, 0.1314831574048473, 0.12316615196930092, 0.14862233986449594, 0.15655375795732152, 0.12901679406343564, 0.13698481978942473, 0.140619462714984, 0.15621959699396687, 0.1367373979078948, 0.12862551496544217, 0.16393360638409954, 0.13296180368367813, 0.13551929876600186, 0.1319101905379993, 0.1333090316949643, 0.1489557019224573, 0.151405705927449, 0.1368362163670803, 0.14177224765357524, 0.13495369419410597, 0.13724089638363848, 0.1375429022727169, 0.13085983171046475, 0.14667167570411083, 0.1346887937588043, 0.13636792320858407, 0.1377412890786604, 0.13678690279274874, 0.14591363070804125, 0.1318799000890781, 0.13758805370578153, 0.13658942810948965, 0.126719276404252, 0.13889627014267408, 0.13908027432291317, 0.133998590509244, 0.13302006419665927, 0.13568733437844036, 0.15309171523905088, 0.14100265369227072, 0.14557212187220828, 0.13155229476946237, 0.13532644119538736, 0.1356997400631096, 0.1350185897368059, 0.13340735298659911, 0.1398879561759618, 0.1339859736836097, 0.14178053620692835, 0.1367110914095266, 0.1312977225589154, 0.1337349635710877, 0.13611726994672274, 0.13501726106424652, 0.13501726106424652, 0.1319575215552926]
lvec5 = [0.11872067099237227, 0.09895610022411544, 0.12700099599815784, 0.14712753354401087, 0.11158375608561251, 0.11267349844254829, 0.09931441224344452, 0.10231163474251982, 0.10306619335638965, 0.10099577917947894, 0.11572799753549973, 0.10255876177670847, 0.10673511299827146, 0.13731973208662265, 0.10331814587105605, 0.10188916831876102, 0.16064175940593564, 0.09036995882241274, 0.09936437775189623, 0.10039510988705937, 0.09345788779838007, 0.1061605729270244, 0.11216472246393407, 0.09295858514935548, 0.10425903565388886, 0.11320245050879844, 0.09885332535012906, 0.09944933637837676, 0.09755014875915358, 0.10577022110669429, 0.10975530386113794, 0.12787169722465172, 0.0966744814494863, 0.09609214275403467, 0.09963931425718413, 0.11235135519038737, 0.12064670871724047, 0.10448797341750722, 0.11592521939236976, 0.10407222291503355, 0.13872101618646057, 0.10933240840091268, 0.10512085013757809, 0.1057435988078292, 0.15708449311431877, 0.09485791554512941, 0.11961449525661479, 0.10805094412936338, 0.1008577328853939, 0.13062694148703327, 0.096394872433107, 0.13105596659546428, 0.12956350034806083, 0.11671796988575642, 0.11198920589797214, 0.11068534067187476, 0.12902022041504776, 0.09650605309560743, 0.09596308040247982, 0.12399148621033187, 0.09682917632894236, 0.09945931377364503, 0.11423569062031608, 0.09404760905783782, 0.09847638050056214, 0.11399995739878951, 0.11253401166176878, 0.10320521706938912, 0.09923486172922912, 0.09489160886285936, 0.13907691821162393, 0.1298500910681893, 0.1286073957830775, 0.10263102977204602, 0.1393161170796016, 0.10103989004690013, 0.10280911968074244, 0.1251268249167473, 0.10323530034160695, 0.15214569293930086, 0.10210234396340204, 0.11986066685833294, 0.1048705957725252, 0.14739161595801714, 0.1100903364369919, 0.09428409200279214, 0.09368788764765923, 0.09700318360426592, 0.10614703698983995, 0.1748170688456017, 0.09412375915458952, 0.09538892910733575, 0.09691684176437285, 0.10252822631874349, 0.10726494815620999, 0.0998073001146943, 0.12903506611103932, 0.10898517723745178, 0.12284656046167128, 0.09417709346893337]
lvec6 = [0.09541564947521758, 0.09161902400008325, 0.10235312530707762, 0.09196206240301862, 0.11007526916394288, 0.09253809853804217, 0.0963968081617305, 0.12362163157925166, 0.0922002845907695, 0.10011569470162285, 0.0987552794995027, 0.08976087068464958, 0.11403595385932902, 0.10958919838728497, 0.11032949404631254, 0.1282774491404776, 0.09452485791782178, 0.09213612011490224, 0.12373675733661055, 0.09657141137271266, 0.09369052700203956, 0.11090551809572999, 0.11337577335963916, 0.09423018746000868, 0.10836593603574535, 0.10507098982063674, 0.11966476897350929, 0.09901478925076553, 0.09070335475937656, 0.11196600454576192, 0.125784942576603, 0.09871736285803594, 0.10885636635208487, 0.09243560680582175, 0.09419036701536816, 0.11561744259515228, 0.12714140592169795, 0.09530016693014884, 0.11355024241171885, 0.09401870391743036, 0.15237683720437578, 0.09501893825150261, 0.10343186992976844, 0.11697049810711516, 0.12867076376935277, 0.09369108793836634, 0.08899365388340466, 0.12929060317480318, 0.12262646070672541, 0.10388430332113206, 0.10929495142548187, 0.09466134999595967, 0.13835925726861634, 0.10712674793981844, 0.15747969250172375, 0.13196193542933668, 0.10742359164501694, 0.0911802033912603, 0.11058051068252643, 0.11415236858654586, 0.10767405768400462, 0.10091163748684234, 0.0938177029906322, 0.09195897130041346, 0.09516862356230849, 0.09595288540103072, 0.13984680061505844, 0.09380151307572963, 0.10006534992504172, 0.10604599531979718, 0.09676664479157412, 0.09702179161039555, 0.13755747080698374, 0.10724671787683766, 0.12579572620768223, 0.15023990510487326, 0.09493300525336293, 0.09432462069399948, 0.09495493481987206, 0.0965080425191013, 0.12786737657270744, 0.09429621824266661, 0.1293549734753557, 0.11414116960734043, 0.10835370372919054, 0.09507806911628845, 0.09743645090611554, 0.09343463153806665, 0.09329779989943472, 0.09199857782098182, 0.10757097949806908, 0.1333866607252839, 0.09569078323873571, 0.09352157936457388, 0.132738775489415, 0.12447522814337839, 0.09361941567024173, 0.10865075352101125, 0.10757557812860262, 0.09596880980813018]

lveclist = [lvec0, lvec1, lvec2, lvec3, lvec4, lvec5, lvec6]
lvecnames = ['No more data', 'Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6']

plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests\nOmega=100')
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests\nOmega=100',type='hist')
'''

'''
# Put loss value data as vectors below; this will generate a set of histograms
# FOR 6 TESTS WITH ALIGNED PRIOR DRAWS
lvec0 = [0.14335674740847668, 0.13563245422451242, 0.1415963480854923, 0.14477842127227447, 0.1403673820567332, 0.14422281864161265, 0.14329261560423487, 0.1420062342037913, 0.14433295208263913, 0.1403238089040552, 0.13622023914021908, 0.1331215477563341, 0.13985955261052357, 0.13625107480023418, 0.13278830969158803, 0.15104810337007638, 0.1432066934207097, 0.14654590113820598, 0.14155140609144773, 0.13852272271124094, 0.13445127898827322, 0.13908978650635498, 0.1360373375312127, 0.13526163120094575, 0.13351511475872638, 0.1392834993888565, 0.14217784089826874, 0.1377067146937541, 0.13608336613577093, 0.13836213835655492, 0.1425563771081175, 0.13701890404704872, 0.14275701547310093, 0.14037446661784928, 0.135899731846271, 0.14472193099297048, 0.14004487852829342, 0.14100806934369722, 0.13803489989603657, 0.13771365713309786, 0.14139179718653286, 0.13087720270484154, 0.13903043764659487, 0.1451529118187262, 0.14357323831263982, 0.14277614431056324, 0.13806245145666834, 0.1390161454589516, 0.13787407260580362, 0.1298548333936015, 0.1286585066046738, 0.13813220094369869, 0.13870075098025772, 0.134798114071913, 0.14181892280318806, 0.14415150594437046, 0.1401707511122268, 0.13713175719384266, 0.13294292602440483, 0.13685260067190896, 0.14083582503649433, 0.14136240031126082, 0.137865717839781, 0.13393002615490654, 0.1427531689634655, 0.13538762826838718, 0.1496264644252375, 0.13540613334631685, 0.14101331288050714, 0.14671835743546532, 0.14478887242738706, 0.14931950638902403, 0.13283790393728137, 0.12970826512223263, 0.13796919743108113, 0.138645518281725, 0.1376171622310323, 0.13691141612588123, 0.14049677187086496, 0.13977659698381142, 0.13564191745044885, 0.13998212469718388, 0.14584815842274426, 0.14039224867696098, 0.13309154841127116, 0.1440026953609819, 0.1417341702439205, 0.14080983152552431, 0.14814505856180918, 0.1409467537003577, 0.1427572188544298, 0.13285891774806471, 0.13551388876899503, 0.15248278741427487, 0.1405290826335275, 0.13718595570106867, 0.13974116032513081, 0.13990250040610652, 0.1365994485550459, 0.1423325398989005]
lvec1 = [0.12201050841773795, 0.12043612929780032, 0.13073931438352507, 0.1364518894400282, 0.126623022019832, 0.12129034295509719, 0.1232672454634404, 0.12829647617332493, 0.1204383656377655, 0.12010396716036557, 0.12708881433791652, 0.12059223579432472, 0.12640641713012227, 0.12043747160548378, 0.1317713280271366, 0.13858549031033934, 0.13040661796428832, 0.12372466444805368, 0.12215449081690144, 0.1172009306470824, 0.12802623225846077, 0.1207461516663038, 0.12235892887452496, 0.1237439078162338, 0.14725564258748042, 0.13006245686750906, 0.14111960898512146, 0.17052348372877876, 0.1190717430571908, 0.12839190136479653, 0.1215378659762556, 0.13000799753778808, 0.14087523828697612, 0.12178319944876939, 0.11944931473707801, 0.13614838354520106, 0.1310193249361005, 0.13912347347964416, 0.13463403735188875, 0.12185038633366564, 0.13740933280689316, 0.12913455703853216, 0.1188198890500554, 0.12938061803611323, 0.13219144179335499, 0.1209876416531576, 0.13139604212837558, 0.13945216905042135, 0.12512858752159517, 0.12818879468468689, 0.13252466861777462, 0.12574018916451998, 0.12203959568330597, 0.13923442145341772, 0.12246806165101219, 0.12011562841490274, 0.12643323707555493, 0.118186357124321, 0.12935168572901068, 0.12191470565635104, 0.13134511716605102, 0.1311317978540064, 0.12207860410895834, 0.124199649707826, 0.11923683773905948, 0.11854576204531829, 0.11753594477762297, 0.12656098087414308, 0.1724834600715802, 0.12438430951545777, 0.1229256028188119, 0.11795059660489447, 0.13636488838672947, 0.1254482273206744, 0.12947143515380027, 0.16600685694908843, 0.13088972029296908, 0.11564403011841372, 0.13671181841978577, 0.13171782578024416, 0.12896629513125607, 0.1362756683234587, 0.11843610117102911, 0.12863906985263984, 0.12339918133715126, 0.12634457005632155, 0.12313895622846809, 0.14260811473494, 0.13626616465233088, 0.15372332948843448, 0.1434845627302847, 0.1230299628340709, 0.13176708856049998, 0.1395751781776649, 0.11975090088573094, 0.12361396890224147, 0.13871207590032084, 0.1297945249169143, 0.12117548483589585, 0.12975781998413966]
lvec2 = [0.15238542474736136, 0.12416000145102413, 0.11856185872093881, 0.12545129368105196, 0.11800066341138132, 0.1310749103727152, 0.1215110780178015, 0.11857074405567126, 0.12389455875043998, 0.1530164510573582, 0.12161702328986287, 0.12992232214863692, 0.1252833347448361, 0.12503413557512796, 0.13030466064318882, 0.12301603919333307, 0.12767357715731098, 0.12187376486069143, 0.12839519369532118, 0.12187149680502116, 0.1316911872028336, 0.1670777138626097, 0.12697005698390443, 0.1251608812969274, 0.12321194714345672, 0.12805819638937815, 0.12347895706959296, 0.12187385208205766, 0.13936980037679325, 0.12666746805772217, 0.15235565088686923, 0.1613461530037538, 0.12236035538670618, 0.12684132758695707, 0.1220728161552606, 0.1300059913518878, 0.11716093367861431, 0.13402676288917956, 0.12241962555165883, 0.12264167358758132, 0.16281436208884878, 0.12056146931995634, 0.12290217673851227, 0.16651647434137162, 0.16927325019045486, 0.12944508905261645, 0.12988904262008888, 0.12294224674448281, 0.12110165082456244, 0.13357607455910664, 0.12594857767702744, 0.1269027483049385, 0.12415627402620194, 0.12128567177768446, 0.12737086085310634, 0.1180265010822364, 0.17344564060968254, 0.1293714295644241, 0.12223619639782239, 0.16405124427145734, 0.17084447347450293, 0.12974806157984156, 0.12178804449372693, 0.12604369300039517, 0.12453163835779633, 0.12654454158871623, 0.17713094005456867, 0.1681364617228342, 0.13314289818336425, 0.1281644397708753, 0.12327975016436318, 0.12924059040596117, 0.12164580144421144, 0.11804350443733692, 0.12106292848486871, 0.15226808411335116, 0.12460647669956389, 0.12384383655708565, 0.12061655988946357, 0.1682564257436373, 0.11849829654882289, 0.1237931111023102, 0.12896236813406728, 0.15294569683681017, 0.12456469764409682, 0.11731549903908756, 0.11962179433370436, 0.12643206776930294, 0.1290755183982052, 0.12578900407133392, 0.13417482822356114, 0.12750336687043978, 0.13200614014992354, 0.1301742209724923, 0.11938304339372552, 0.16029317773572618, 0.12203338206476552, 0.12061844773010158, 0.1192011085902017, 0.1168882509688956]
lvec3 = [0.11968945017493399, 0.1325436932290337, 0.14304805439947274, 0.1372543418415863, 0.12290613305555953, 0.14695010942380696, 0.13031555945168918, 0.13531654564770476, 0.1158741789601965, 0.1498587069417706, 0.11779397998017582, 0.1283547211242966, 0.1621151804519011, 0.1257006999953918, 0.11991742811824019, 0.1268546045454344, 0.12394170573349639, 0.12477126178978204, 0.1190782946526823, 0.131038995226777, 0.1324838410920371, 0.126966483959189, 0.1284249126060708, 0.12168406900888132, 0.14376143438692746, 0.13869800542490932, 0.1333019924968027, 0.1208481573363508, 0.13149910016599742, 0.12454346804251852, 0.12416419154401838, 0.13750454604372964, 0.1286813686370034, 0.14028810905728298, 0.1213177352332298, 0.12695929573630096, 0.1433875629602553, 0.13470849533432652, 0.12817395763370265, 0.12285242535964941, 0.13870021451858744, 0.13600244849094315, 0.1270527995828381, 0.12280415161590945, 0.12637045713291722, 0.12141924277310306, 0.1246896370512028, 0.12269154918042903, 0.1287737374226314, 0.12985925749546925, 0.13354916306914855, 0.13795245908487103, 0.14769512635074547, 0.1397037543205498, 0.12308134046357264, 0.14974958664483456, 0.1356718864457288, 0.1253954947931722, 0.11834632002053354, 0.13763653544765558, 0.13683202603444303, 0.13328576005594758, 0.12057438649922828, 0.12482051629691142, 0.12192516990834829, 0.13580861906678587, 0.12071682867720668, 0.13550846627877247, 0.13588277684680278, 0.16369077088013323, 0.1227169568278283, 0.1271825432585842, 0.12522762416783856, 0.1612926181934334, 0.13727307213520676, 0.12942489580816072, 0.13026549173333488, 0.11983336499477812, 0.15224764991568943, 0.13337120600716007, 0.1403182666152804, 0.13139788948796524, 0.13166045104960175, 0.11710496883564678, 0.13108140747205071, 0.1277556031748408, 0.1250926460932209, 0.143131392246206, 0.12396595753727355, 0.13399058931192548, 0.1236393191280366, 0.12780745696316256, 0.13155860738370817, 0.12861567393236803, 0.1415479851588361, 0.12999045002741, 0.1359923098261614, 0.12383469845050561, 0.12866916743505388, 0.12401132881977579]
lvec4 = [0.1352845722566932, 0.14676481273608546, 0.13617179930790266, 0.13111194193337558, 0.13261705480888214, 0.14324954913507976, 0.1407156988441613, 0.13071409341375467, 0.14584916511227436, 0.13904442195739236, 0.13942570538761256, 0.13511782995813032, 0.15741384910797232, 0.14134527072950878, 0.12797589612112317, 0.13240076164430448, 0.14603277628727662, 0.1376266746261868, 0.1372023821870774, 0.13541094989804836, 0.13625487761142846, 0.12447453708396672, 0.1382351680678216, 0.14058101846783105, 0.13389382651385662, 0.13990347747294574, 0.14488860174608864, 0.13856687175919022, 0.137353958602558, 0.13642015110993586, 0.12974855792662338, 0.15408758414245627, 0.13821155691532525, 0.1352709133185309, 0.14170062250351748, 0.1437968978433749, 0.17244173701141183, 0.14552508931270425, 0.13218146746173376, 0.13266303015402042, 0.13564130945252847, 0.1422149899212039, 0.13829300075938372, 0.13900973201268413, 0.13511936285008339, 0.1375824488642537, 0.1383253584553228, 0.14913740132579442, 0.14284340702935014, 0.13451574855649923, 0.14023960229927757, 0.13775515057865548, 0.13927640226181268, 0.1344168495096326, 0.13242825560538227, 0.13468672644975974, 0.15844834745132955, 0.13216370070921776, 0.13943167205203777, 0.14228292777709944, 0.1481298745263082, 0.147229085242329, 0.13826794796438865, 0.14071736778976537, 0.14069831017179463, 0.13987957907623527, 0.13491992218038842, 0.13618380638845887, 0.13677340694471815, 0.13919032228806608, 0.13304153436570285, 0.13973684718318358, 0.1364626444003569, 0.13624335520653014, 0.14040138286659196, 0.15014057228145838, 0.14720994690273764, 0.1386719505841382, 0.1513947884882519, 0.12698156752057949, 0.1400097948280201, 0.13075318688227747, 0.13973938301337638, 0.13814820260866645, 0.1431025063507889, 0.13628003172330858, 0.14455007373473877, 0.1352750432016824, 0.1538728424402952, 0.13659639179914215, 0.13566048995416258, 0.14170515913794587, 0.12987367555904136, 0.13447526430042245, 0.1420619370668284, 0.14273022667987856, 0.13441731071875734, 0.15467886772404668, 0.13124039492598313, 0.13286578526945192]
lvec5 = [0.12191093611978823, 0.12708169743205974, 0.1272636312739816, 0.14103361731286418, 0.12693632576654, 0.13304107664810577, 0.1302975872196582, 0.13256094255129988, 0.12692322287558372, 0.13375235591878326, 0.12025968972902515, 0.1261516981892684, 0.11986502410706971, 0.12138320768684153, 0.1813892352356074, 0.13401682206709115, 0.12669158506368067, 0.11985349037923573, 0.13056358656370937, 0.1356342482734177, 0.1204218168262275, 0.1400747526297201, 0.13675755106631982, 0.11831008430642476, 0.12755393808507823, 0.1593038250647806, 0.13996987224224056, 0.11820675748145908, 0.1271468449259773, 0.12454090031023654, 0.13368031785519457, 0.12007752130071597, 0.13371587422897344, 0.1556396335987057, 0.14523760438506442, 0.13065697246909883, 0.12386942982227049, 0.12402642437575141, 0.12672499429565415, 0.1336400508810701, 0.12390288782713436, 0.12859661542374207, 0.13479812592240617, 0.17728763842220086, 0.20271175247286882, 0.13920968054911512, 0.15309643997132688, 0.12929922262035645, 0.12252606771695293, 0.12115454015934378, 0.12557714817101553, 0.1278999587941183, 0.12612818896832934, 0.1276101793657718, 0.13605125188246692, 0.13625655288186111, 0.13459521031844301, 0.12622357697921396, 0.12130178930914494, 0.11879710682753364, 0.13272920273747954, 0.12233040767844738, 0.13050155418693982, 0.13652882039658154, 0.1393903112484995, 0.14264696944389513, 0.1502599102044462, 0.12708582344193506, 0.1300382126825252, 0.12279958314682231, 0.13570107823705985, 0.1300847399161663, 0.12260123442009686, 0.13061035828398823, 0.13595355056167482, 0.17303456461845537, 0.1214447900240019, 0.13132902212166903, 0.12526856532784453, 0.1340549121066598, 0.12531155098269606, 0.13925232204956975, 0.12837818778151572, 0.13301024305047923, 0.12084300032357848, 0.128619300598818, 0.12478666049535385, 0.12305730026092342, 0.11869881179935267, 0.127185191242855, 0.12459116032053631, 0.12994807480650994, 0.12953497159669972, 0.12205133545614338, 0.11504257424981326, 0.16083365841896502, 0.13833483629434748, 0.13910363830732322, 0.1364123941028384, 0.12807200355649667]
lvec6 = [0.12475497644583944, 0.1386321013935679, 0.1208753412297372, 0.15688250291805805, 0.12083183071126759, 0.13526962263083997, 0.12232458042947052, 0.12346772862205556, 0.12158596803391417, 0.12664952090823417, 0.12522970006424913, 0.123706420361703, 0.11880015458354379, 0.12699231530005928, 0.12262686596504813, 0.13390241032968137, 0.13652605835439396, 0.13769186591432675, 0.11953670579205597, 0.12533318635500146, 0.12902414968714826, 0.12540601949868774, 0.17509188604238196, 0.12225868156154623, 0.16574629330625992, 0.12300936403903032, 0.13494763088967124, 0.12245246666274992, 0.12233289331802301, 0.12839150207297131, 0.1282060877504529, 0.1393682809834952, 0.1254239380523154, 0.11927829024952745, 0.11928392423297908, 0.11902723275230272, 0.12059340731748759, 0.12318861995192346, 0.11368321155184725, 0.11951662661787217, 0.1566939652890786, 0.11728135703106865, 0.15889529838957087, 0.12348039186301266, 0.16512875522579423, 0.12201270489254022, 0.13639955005658538, 0.12211946993422265, 0.1415225617063233, 0.15610802663623036, 0.15573151959997997, 0.1457790620797599, 0.1624898882941196, 0.13090985481725606, 0.12818600780594733, 0.12088855446536372, 0.14437680332888114, 0.1269528795501376, 0.12897512661472918, 0.1473558509233415, 0.13247059623426952, 0.13093752438623257, 0.13341472064259094, 0.11939492882664672, 0.1300606838149642, 0.13321853915165002, 0.15559933860002736, 0.1271223345548175, 0.12601001137643358, 0.12256722591761975, 0.13689565112612762, 0.12844436814336876, 0.17247821767148042, 0.12516487317262992, 0.11908008607474001, 0.13973670445627687, 0.12182055570553972, 0.12582761103969578, 0.13268530311862492, 0.15307261770021477, 0.12349380649330256, 0.1373215278132167, 0.14381270185270073, 0.13777692661572863, 0.12018275758883668, 0.1199307398555828, 0.13016881811720543, 0.12777285283597695, 0.12039360857817911, 0.12713943788777454, 0.15336069214878204, 0.11942313948012324, 0.12416908300280852, 0.14013886517298757, 0.12807446768004763, 0.12032389718180138, 0.12210820075054835, 0.13204462579092932, 0.11645497995108763, 0.1366719345439779]

lveclist = [ lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']

plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests\nOmega=100')
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests\nOmega=100',type='hist')
'''

'''
# FOR DESIGN 2, DIFFERENT BATCH SIZES
# BATCH SIZES: 1,3,6,9,15,30,60,90,120
lvec1 = [0.1382851174053969, 0.14001812171109226, 0.13754892582641817, 0.14319284601145926, 0.13795392990717406, 0.1268831860393539, 0.13223600103532054, 0.1306233249995498, 0.13924652706958165, 0.1283945989188211, 0.14368256557434433, 0.14191766456895744, 0.1469925728560264, 0.1321289876524692, 0.1366371934135474, 0.13468753456757593, 0.13767272693538932, 0.1345128702034592, 0.13505360014551546, 0.13446371958911923, 0.13613065468488791, 0.13894723230325975, 0.13451775636662905, 0.13809931962925306, 0.13714559659227157, 0.13947953429030577, 0.13479306133454735, 0.13489609132095903, 0.1385013978833726, 0.1284548491658115, 0.13836339154918326, 0.12867732693672904, 0.13355659960520164, 0.14104482065648566, 0.14060719555447607, 0.14029681962736493, 0.1429691018617521, 0.1433579493697108, 0.1465888643820997, 0.13954572028655488, 0.1315151451873408, 0.1322133905511833, 0.13677325648827102, 0.13132738129063065, 0.1396219057072618, 0.13282353388666626, 0.14464659775400643, 0.13157413090798625, 0.14290500938721792, 0.13606377714180506, 0.1426863986668447, 0.13815023052139153, 0.1435340749717443, 0.14521104266817897, 0.13825193544202158, 0.14142513625986158, 0.13561307269020076, 0.1377560986712839, 0.13509712322728037, 0.14260994232825824, 0.13385919339080263, 0.1335819901588062, 0.1411477138695957, 0.1335391487542657, 0.14064709078284116, 0.1375111864366289, 0.13436689317995523, 0.1411841349361796, 0.1395267256791663, 0.13203486765745825, 0.14753671004614638, 0.14122911369888672, 0.1353850587486798, 0.13473873721520968, 0.13127212453049972, 0.14660675813920687, 0.13659467867713088, 0.13930576268556452, 0.13780771828542085, 0.14398843148160873, 0.13565742247492057, 0.13034283855672554, 0.14594461044332185, 0.13383305039379773, 0.13924848542633433, 0.13981329678561827, 0.13373203977455253, 0.14400246518386972, 0.1322207240959983, 0.13896453774977602, 0.1344915972060527, 0.12712028508556686, 0.1347847239791129, 0.14007453553053947, 0.13904568927790434, 0.14696243171282175, 0.13874487494336493, 0.1398263250716958, 0.13621489140825105, 0.1412404923181527]
lvec3 = [0.12754209193762045, 0.14031219720978916, 0.13010100439884947, 0.1327246470991515, 0.1332488070741414, 0.17785684814211353, 0.12842574463210446, 0.13181677560053628, 0.1343499195285006, 0.1323374633661742, 0.12836862511602445, 0.13001859567488736, 0.1365527321797588, 0.12775634414907083, 0.14580346329980734, 0.1640785189966381, 0.1311423007944489, 0.13223061726192142, 0.12767395998354436, 0.12429207661021083, 0.1265604764724026, 0.13072937443355737, 0.15671777269777182, 0.12514181892215678, 0.13168644644057526, 0.16274530137939722, 0.16654474484115633, 0.1316258004074624, 0.12731853589008554, 0.13304878913448515, 0.16877064424013738, 0.14011507180814017, 0.13192862095566837, 0.13519505789846187, 0.13002509201899204, 0.13168205990715817, 0.12994389799319672, 0.13038181706740126, 0.13431882708195128, 0.13746970899234498, 0.13539540264916458, 0.13187656307255322, 0.12431849400498717, 0.1359421820996568, 0.1402045525933901, 0.13004588835054184, 0.15541791834086593, 0.14064162552679338, 0.14398776681161168, 0.13098598869805433, 0.13149320194788397, 0.12466650137227676, 0.12558509385287775, 0.12866038302659563, 0.12276005085403116, 0.14072567557070134, 0.1352397865128543, 0.12754968146727946, 0.13486722902716416, 0.13812067525789604, 0.13077164978460684, 0.12421614836506772, 0.13053932787578845, 0.1424602422968631, 0.1356655009144377, 0.12336190397019592, 0.1763291581758909, 0.13485437977146017, 0.13710596579031564, 0.13536365402373685, 0.13468122921665523, 0.12917129059795848, 0.1276483697656916, 0.1323977545839571, 0.12551400367921778, 0.12857307122660724, 0.14361415551003537, 0.1308466649890505, 0.12804604661716115, 0.13949772094922838, 0.13469768774136429, 0.13439317572192727, 0.139571936534967, 0.16138343349345874, 0.1337429322374952, 0.1264559037967682, 0.13287607049071282, 0.12886536830391265, 0.1289458592389802, 0.13972577268180966, 0.16357485389183302, 0.13183066178615818, 0.1286594029985115, 0.14251296512081071, 0.12992524663842345, 0.1276910317582295, 0.13177232012817194, 0.13286285454203875, 0.1286328856645646, 0.1275233927771327]
lvec6 = [0.12433754182667398, 0.12194348461317742, 0.12590870824370903, 0.1650612399274014, 0.11660323939954799, 0.1550012255757987, 0.11851821551745177, 0.11300075272196147, 0.12603735603038183, 0.12759422397869968, 0.12675597702853525, 0.12765058383753056, 0.17304937455387537, 0.12331365028903303, 0.17084474441074896, 0.12217704660509349, 0.12769327218933202, 0.12361541210417527, 0.14987209412511546, 0.12220345346118416, 0.11618055556088235, 0.12317396772104953, 0.1591241772708671, 0.1287501426036278, 0.15999209455379718, 0.13352134588142314, 0.12439835851025323, 0.12552404198207331, 0.15391190905161137, 0.12668131788743184, 0.1276905388836984, 0.13164493503925964, 0.12139037365842506, 0.12346584630474629, 0.11538089543509918, 0.1269439931616859, 0.12959254877434268, 0.12463013733521121, 0.12690442778291264, 0.12770915563434942, 0.11834668515457407, 0.12203489790679796, 0.12464968358416198, 0.16547713090274027, 0.15345171719285375, 0.12843650892478584, 0.15134025143850063, 0.12183171900321203, 0.12896614137077153, 0.12545796647542629, 0.11748932973867503, 0.12102198277823914, 0.13605490663819864, 0.1640974269439278, 0.1315371940008381, 0.13593019290635003, 0.12403400849140193, 0.12558254177597689, 0.13432269089487242, 0.1366098321735959, 0.15287600805506404, 0.12135458181026205, 0.13251252045351086, 0.12120736337653858, 0.12345252567843581, 0.11849174293757815, 0.13204872903719025, 0.12510997166087223, 0.14710924898264116, 0.1218828264663268, 0.13573031596717167, 0.12424194248911892, 0.11933529870096257, 0.13109162013822578, 0.12332355525620181, 0.17477530317815923, 0.12731653315765565, 0.12550689364421475, 0.12427427991209355, 0.1244676977894243, 0.12438542288414496, 0.11158700451513842, 0.12452126100538356, 0.1649556065840589, 0.12188870584145282, 0.12295867250656625, 0.12321345616520511, 0.12934543660444442, 0.1315598952043253, 0.12538777884538446, 0.11930110198822327, 0.12534049573460468, 0.12703960437205986, 0.11903414221469213, 0.12323933245863394, 0.13339834224559424, 0.12633232565946675, 0.13161595636186946, 0.12377157689127248, 0.13250428442928405]
lvec9 = [0.11748928506343179, 0.1460863128067855, 0.11407049155926802, 0.14705880300764398, 0.12019339581428685, 0.14210327984212776, 0.12117708711947142, 0.12542446337237548, 0.11635515037930713, 0.11614602839185952, 0.11640537681412763, 0.11948710527913581, 0.12672512842236047, 0.12027594834758522, 0.11705752492854495, 0.11829839088786694, 0.12770860287185318, 0.11481091575689541, 0.13903419072907655, 0.12287821308478383, 0.11455699727596148, 0.12357160001157354, 0.11801431451229694, 0.11454853602837017, 0.13967124212883272, 0.11892421015290852, 0.12364663673751937, 0.12185928791064343, 0.12067624768201367, 0.13283581858905597, 0.16726099216099857, 0.11755217273047704, 0.14720833212286794, 0.12169006857340385, 0.11577554762326946, 0.11652966139310228, 0.12227003280416099, 0.11482485195643105, 0.12498824916690547, 0.11414833926185687, 0.1183123444337524, 0.12057774564826762, 0.11964287688468388, 0.11321416081404848, 0.15739559050652757, 0.11953752087497012, 0.1456830208414179, 0.13248242768669363, 0.1256804870640552, 0.11644150462784875, 0.11701223929813914, 0.11925410843088004, 0.1193887271700322, 0.115374179889621, 0.1132558823810791, 0.16474111020751955, 0.14172310426915524, 0.11295236029146725, 0.13004867989595828, 0.11892065446918297, 0.12156572679687239, 0.11310809279177945, 0.1266641514065548, 0.11136726069602494, 0.11582608654479677, 0.11432925475383054, 0.11038295993953608, 0.11588890045679161, 0.1175709630608052, 0.12297917702100528, 0.12200921563828447, 0.11054971963042483, 0.1177305128860591, 0.13006524081993515, 0.11355679160189475, 0.1429608734920779, 0.11905624638155204, 0.11758549914063446, 0.14570046523085747, 0.12983117175492204, 0.12968948231215896, 0.1563702202141075, 0.13119106517259513, 0.12087327379758385, 0.11934216184420274, 0.11976654118547068, 0.11945053103727771, 0.12207708728938135, 0.12332228707172388, 0.14519247897275556, 0.1224920596426375, 0.12345624895108928, 0.11308087526474427, 0.1614900264608201, 0.1189529714552026, 0.1291038916022557, 0.12288951505524218, 0.11768090294824644, 0.14288249779541481, 0.12397805969293298]
lvec15 = [0.10772478949943735, 0.1498507501744442, 0.1120621733680482, 0.10393691698361628, 0.14836324690102073, 0.11384881647721916, 0.11134826713307305, 0.11162919692818385, 0.11666161585555063, 0.11303350927438531, 0.11140029928216179, 0.1358503558361647, 0.13068748292009127, 0.10629089004511434, 0.10862315885177481, 0.12957732083492318, 0.11228436236995433, 0.10886980114612207, 0.14722326660750482, 0.1064256403365992, 0.12038824757306509, 0.11427986638346274, 0.12713180293456697, 0.1413560206095047, 0.11139004397950053, 0.12762017441179146, 0.10956181229457412, 0.11053867109786883, 0.14524277006532368, 0.12428461881270848, 0.1412736536245981, 0.10953583434435428, 0.10888655300857414, 0.1088157622125833, 0.1093780440664395, 0.11379711733714785, 0.10930230385659931, 0.11046984222802575, 0.10616130108308247, 0.10914549335823213, 0.14955344324507286, 0.11484662806051446, 0.1181139854545459, 0.15410666170358003, 0.12749821651902288, 0.10909345408557734, 0.1403900068618267, 0.13039691069183443, 0.11432218847207008, 0.10997710131041034, 0.12009474720513151, 0.11422940871410302, 0.12188868155583975, 0.13166315302103518, 0.11923694728001845, 0.10867509079116396, 0.11179738933833926, 0.10975372404295407, 0.13591472634708132, 0.13844275703400163, 0.10848363468677705, 0.11215978383138335, 0.11776186929455223, 0.11015375612190173, 0.12833496487193213, 0.10771053270319808, 0.11304545256153277, 0.13406870027461323, 0.11055141065491172, 0.11566370780744131, 0.11119169159180312, 0.1017007437522097, 0.11803544641620836, 0.1122338898252369, 0.12998943183384984, 0.11287519157212027, 0.1108729984570672, 0.11102059228128512, 0.10910316894403732, 0.12623072355592566, 0.11192255556231677, 0.11053286199953882, 0.12414822036295545, 0.15933744541648798, 0.10813235156385653, 0.10721525819607955, 0.10800105793489968, 0.11303524374950856, 0.1150222414513403, 0.10599061529364426, 0.16621265062982146, 0.15197571932315018, 0.13838379295738407, 0.11403939233615723, 0.1075852100523573, 0.14422958779273082, 0.10922799107389135, 0.11225120578831836, 0.14987536847998922, 0.10900247560295566]
lvec30 = [0.08846907100334117, 0.12204653405437324, 0.11134160642351906, 0.138984542650809, 0.1337369860752422, 0.1371240842789891, 0.0971554324870248, 0.09958346985577195, 0.10070951154512953, 0.1303105442447949, 0.09523713865503293, 0.10023565081432302, 0.13808120389705528, 0.09258572338941401, 0.09535686158262739, 0.0989405020611249, 0.0977509560559939, 0.09233369659043171, 0.09186502887081881, 0.10229916568694297, 0.09769014380636622, 0.12441076071797716, 0.09562348292796775, 0.09894755161291612, 0.09076242632907182, 0.09900120031296175, 0.13508711227563935, 0.09688104831321939, 0.09303130639370566, 0.1002730850489025, 0.11704432618757596, 0.11086064850067875, 0.11421642464999045, 0.11224903432021985, 0.09658854889089168, 0.10155154091477625, 0.11313264385350051, 0.09646812107430189, 0.09448469219696544, 0.09590993358904992, 0.12666938714568207, 0.09323041161282601, 0.10004484549198316, 0.14708347169241295, 0.14215420667058778, 0.09993896998058542, 0.09085638171360762, 0.11144424407429102, 0.13331743110719665, 0.12653346231874676, 0.09625144190427022, 0.09443517157971194, 0.11538233583839862, 0.0942886572545733, 0.15040811652722275, 0.11104973161721125, 0.09544084724554917, 0.09615039404118614, 0.10951213864735798, 0.11443597658031189, 0.09281425125597206, 0.09353004646616962, 0.09189846418203722, 0.09255347949067606, 0.1126293928990595, 0.1020612492075022, 0.11397077467297453, 0.140034614394453, 0.09840195929636918, 0.09249003219794374, 0.09493236263693262, 0.0933496237858881, 0.09543991117379502, 0.09507212307818294, 0.09589540182851948, 0.12808578174114948, 0.09549844612906512, 0.09483262615764278, 0.09136296034539965, 0.10445110774280575, 0.10312559378396463, 0.13468756731500348, 0.09357601173632477, 0.11304264128209, 0.11433368758616862, 0.09403031746493874, 0.0924365093129436, 0.09163430929134851, 0.09714978624654719, 0.11045773385909953, 0.0972889114280848, 0.09245112879973207, 0.12393192749152888, 0.1318607692995051, 0.11037202091156127, 0.11092581456281522, 0.09532457750938307, 0.09564834367807871, 0.09638682641661762, 0.09801396237029503]
lvec60 = [0.11076886244999712, 0.10794217446131417, 0.0779743949369317, 0.11533592014254658, 0.1109052491749487, 0.08308703921016056, 0.08242476592046877, 0.08664817952957622, 0.08063578335260638, 0.10420814412588059, 0.0867210685321189, 0.0880846381993211, 0.10077269105839189, 0.07830684078532081, 0.11322583047002449, 0.10031053487635354, 0.09548000632534111, 0.08295739335098928, 0.1027765095428521, 0.07562388462366086, 0.08318731564822239, 0.08998925134456452, 0.11227434244092038, 0.0844274367853152, 0.08831850308147177, 0.10917756335357795, 0.09884294763886052, 0.08522253349077377, 0.09940397036416689, 0.09011537863787258, 0.12036363234211818, 0.08230636677883602, 0.09443114397439027, 0.07804064987883635, 0.09083367594126371, 0.08435028981000703, 0.08807987920810456, 0.0920598927385618, 0.07770968162666687, 0.07552247977778644, 0.11263165179052372, 0.07756459489367531, 0.0960402832440519, 0.0942223754572371, 0.11580369724967163, 0.08002319293815537, 0.08668627118882896, 0.0890062011203958, 0.09975712313150716, 0.0940727794991163, 0.08406929438162697, 0.08643114961596503, 0.11834969849522493, 0.11414912758461597, 0.11668570979213341, 0.0882518858108295, 0.09124150531180471, 0.09008539969888303, 0.10905194066004607, 0.10050495382148243, 0.08506121635756948, 0.08033997804445821, 0.0879259935958305, 0.10520819416911927, 0.08440209667029251, 0.0805532629897463, 0.11988429052691865, 0.10234225083468755, 0.0992750625243562, 0.09187226918705657, 0.10944106860933689, 0.07701657889480565, 0.07894308660158779, 0.0808844244563463, 0.1191735579746127, 0.10897726990538247, 0.08988844853033495, 0.09236332663015252, 0.0842971371345316, 0.10663824475883597, 0.08261787637620276, 0.07946034114488736, 0.0870167233260839, 0.10662534110960648, 0.08752585706977371, 0.10363996469326044, 0.07925684587221332, 0.08539647031155141, 0.08023070823046631, 0.1356437311947647, 0.10419347107397983, 0.10984757857034978, 0.08542406125519479, 0.08591897094310902, 0.09229280142242025, 0.0964064023564696, 0.07710067717294909, 0.10741884459466787, 0.08536781359745918, 0.1004933307999278]
lvec90 = [0.09642721988155334, 0.10403541227205243, 0.0730133192495076, 0.09145252478484514, 0.08538464089042226, 0.10645872028860473, 0.07598832426694897, 0.06991109749613915, 0.0809250937507537, 0.09962626871849246, 0.0774859475580143, 0.09291977527122923, 0.12193659128651799, 0.08313734871675238, 0.08349192405771613, 0.08233108825516103, 0.08724545180308027, 0.07861120894627445, 0.09882234380662476, 0.07319976682162924, 0.06612385011473994, 0.09180114556146639, 0.1034930884702895, 0.08574279161504825, 0.08997179196047868, 0.07580362503942022, 0.0960375064388277, 0.0782144109123736, 0.07469658701526963, 0.08450800756131763, 0.08162684210491385, 0.09283642613843474, 0.09466209280141015, 0.07051150516229036, 0.07466146217292059, 0.09245888192626373, 0.08650772286603611, 0.07317861463139835, 0.08673948288704378, 0.07843332177090222, 0.10998877413582642, 0.07604552070619229, 0.08664569021110281, 0.10601531128988319, 0.11238235719913221, 0.07548813902813917, 0.08804272409424477, 0.08504537600743395, 0.11128178480225559, 0.07796959313318363, 0.0681705338003573, 0.07369603911074335, 0.10587698706446375, 0.1109514757127799, 0.11223556068322021, 0.08517945682074983, 0.0865974941123515, 0.07819719965926138, 0.10002460175071821, 0.10621134262993664, 0.07528635919493602, 0.08331661757506943, 0.09105838516897896, 0.06866481988328262, 0.08394142524969156, 0.07082295768764296, 0.11569474582189962, 0.10509086052657826, 0.07919763144385919, 0.07714976252864704, 0.08892158234356963, 0.07040217005785754, 0.08717196694431203, 0.07543511483805644, 0.08493036434540689, 0.08890668125478991, 0.08769676241542582, 0.07364444491528684, 0.07942904546957699, 0.08307536983810253, 0.08614151537944313, 0.08155134304624946, 0.08167350968014725, 0.10680910171542128, 0.07913480374635684, 0.07012822699392124, 0.07778821460229014, 0.06971972806210365, 0.07945058979178352, 0.09488802647216683, 0.08394358889555315, 0.10395771769054366, 0.0703614954629504, 0.08327987440648023, 0.08213222251764787, 0.0785126324135433, 0.07756043050559559, 0.07142501334557441, 0.10390080885133889, 0.0814705951512844]
lvec120 = [0.09326514516455957, 0.11729139796395839, 0.06312146197313785, 0.08291708194253167, 0.08881036988449643, 0.07461142748671286, 0.06907526621358095, 0.08857449218721601, 0.06464610946317406, 0.09361255979304942, 0.08143458173948649, 0.09304987304536197, 0.11126974256448698, 0.07311375220065432, 0.08633246218515617, 0.08078307135229243, 0.08000884325611742, 0.06573575876582188, 0.0967110462890727, 0.06752645192483127, 0.061682593190973606, 0.07795380133523934, 0.08068226969750578, 0.06890771994513761, 0.08493247259935836, 0.08128640610566762, 0.07973259998026623, 0.06642605550463118, 0.08079590335268938, 0.07172342278983723, 0.07975693652429418, 0.09604150941179804, 0.070072148542247, 0.08015605869980669, 0.07243994150538886, 0.06441375936386962, 0.07259167110552081, 0.06574406518144081, 0.07862991689056165, 0.08274412646368748, 0.0973568724652092, 0.06598653670774755, 0.07931605438556313, 0.09039866038313019, 0.10813527619973, 0.061530549428849994, 0.09575175214498256, 0.07105241723109902, 0.09152957674966612, 0.0874170224242956, 0.08236575191292138, 0.08304330194665331, 0.09957622664057147, 0.09705973256384544, 0.08683141734514865, 0.07241906107013056, 0.07931192773604237, 0.09478077095855744, 0.08799863477977289, 0.09421569353448485, 0.08096712096995085, 0.06546350420863585, 0.062167275901520415, 0.07004522579413078, 0.07843061715962041, 0.06787180095889336, 0.09101042358785802, 0.07673806160516985, 0.06762351915677993, 0.09348929737377554, 0.10470844368146894, 0.05863126952650698, 0.06561959987448183, 0.073287707950743, 0.10293106203381078, 0.10606658095318984, 0.07184176563636407, 0.07681670982990271, 0.06671801805031552, 0.08827554314813656, 0.07531794357412919, 0.06283790410435862, 0.09091603630183206, 0.09865371701379161, 0.08990505684123234, 0.08507659154918575, 0.10006425781258366, 0.07622774443166253, 0.06946565404574782, 0.0846896194393638, 0.0815911632541146, 0.09244538661698533, 0.05872400220473437, 0.0720257463720226, 0.08694384395185407, 0.07266736831484687, 0.08245955490726943, 0.0798797592810179, 0.09910998340909383, 0.08406730406346817]

lveclist = [lvec1,lvec3, lvec6,lvec9,lvec15,lvec30, lvec60,lvec90,lvec120]
lvecnames = ['1','3','6','9','15','30','60','90','120']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian Loss vs. Batch Size\nOmega=100')

qts50 = [np.average(lvec1), np.average(lvec3), np.average(lvec6), np.average(lvec9),np.average(lvec15), 
           np.average(lvec30), np.average(lvec60), np.average(lvec90), np.average(lvec120)]
stds = [np.std(lvec1), np.std(lvec3), np.std(lvec6), np.std(lvec9),np.std(lvec15), 
           np.std(lvec30), np.std(lvec60), np.std(lvec90), np.std(lvec120)]
qts5 = [qts50[i]-1.96*stds[i]/10 for i in range(9)]
qts95 = [qts50[i]+1.96*stds[i]/10 for i in range(9)]

fig = plt.figure()
x = [1,3,6,9,15,30,60,90,120]
y = qts50
lowerr = [y[i]-qts5[i] for i in range(len(x))]
upperr = [qts95[i]-y[i] for i in range(len(x))]
err = [lowerr, upperr]
plt.errorbar(x, y, yerr=err, capsize=4, color='orange', ecolor='black', linewidth=3, elinewidth=0.5)
plt.ylim(0,0.2)
plt.xlabel('Batch size', fontsize=12)
plt.ylabel('Bayesian loss', fontsize=12)
plt.suptitle('Bayesian risk vs. batch size: Design 2\n95% confidence intervals for risk', fontsize=16)
plt.show()
'''

'''
# FOR 6 TESTS WITH ALIGNED PRIOR DRAWS, USING CLASSIFICATION LOSS W/ t=10%
lvec0 = [0.372, 0.38, 0.372, 0.375, 0.334, 0.394, 0.394, 0.397, 0.344, 0.364, 0.372, 0.413, 0.434, 0.358, 0.365, 0.417, 0.411, 0.43, 0.37, 0.42, 0.43, 0.413, 0.372, 0.407, 0.407, 0.361, 0.382, 0.4, 0.403, 0.357, 0.357, 0.361, 0.377, 0.363, 0.379, 0.37, 0.357, 0.437, 0.407, 0.373, 0.356, 0.399, 0.403, 0.414, 0.356, 0.417, 0.357, 0.394, 0.414, 0.406, 0.412, 0.376, 0.351, 0.406, 0.377, 0.396, 0.39, 0.392, 0.404, 0.413, 0.393, 0.409, 0.373, 0.356, 0.389, 0.383, 0.366, 0.362, 0.417, 0.428, 0.374, 0.343, 0.411, 0.361, 0.386, 0.389, 0.333, 0.38, 0.368, 0.365, 0.443, 0.326, 0.399, 0.399, 0.357, 0.394, 0.384, 0.37, 0.419, 0.386, 0.345, 0.384, 0.389, 0.369, 0.4, 0.377, 0.402, 0.419, 0.458, 0.357]
lvec1 = [0.34, 0.373, 0.394, 0.46, 0.348, 0.37, 0.299, 0.366, 0.284, 0.329, 0.362, 0.3, 0.308, 0.321, 0.385, 0.441, 0.404, 0.322, 0.313, 0.309, 0.367, 0.327, 0.329, 0.309, 0.543, 0.372, 0.519, 0.806, 0.335, 0.371, 0.321, 0.37, 0.481, 0.329, 0.3, 0.463, 0.389, 0.483, 0.437, 0.34, 0.441, 0.356, 0.308, 0.396, 0.434, 0.326, 0.384, 0.411, 0.367, 0.393, 0.468, 0.339, 0.31, 0.474, 0.302, 0.317, 0.375, 0.308, 0.351, 0.347, 0.41, 0.411, 0.317, 0.35, 0.323, 0.296, 0.29, 0.335, 0.745, 0.343, 0.323, 0.268, 0.417, 0.355, 0.404, 0.728, 0.382, 0.3, 0.439, 0.403, 0.396, 0.389, 0.321, 0.321, 0.312, 0.331, 0.365, 0.43, 0.432, 0.642, 0.456, 0.299, 0.436, 0.457, 0.295, 0.304, 0.471, 0.389, 0.313, 0.352]
lvec2 = [0.681, 0.293, 0.277, 0.375, 0.284, 0.351, 0.305, 0.293, 0.305, 0.611, 0.301, 0.336, 0.358, 0.318, 0.328, 0.29, 0.348, 0.305, 0.284, 0.289, 0.321, 0.603, 0.312, 0.307, 0.344, 0.353, 0.348, 0.266, 0.573, 0.316, 0.617, 0.679, 0.292, 0.345, 0.293, 0.331, 0.274, 0.376, 0.28, 0.261, 0.635, 0.261, 0.315, 0.681, 0.593, 0.313, 0.335, 0.348, 0.308, 0.344, 0.315, 0.303, 0.317, 0.281, 0.39, 0.259, 0.62, 0.393, 0.3, 0.666, 0.378, 0.363, 0.295, 0.314, 0.29, 0.292, 0.488, 0.652, 0.405, 0.325, 0.27, 0.349, 0.314, 0.25, 0.269, 0.7, 0.352, 0.275, 0.305, 0.653, 0.295, 0.301, 0.378, 0.675, 0.316, 0.271, 0.281, 0.313, 0.327, 0.317, 0.378, 0.355, 0.394, 0.323, 0.293, 0.585, 0.337, 0.3, 0.284, 0.266]
lvec3 = [0.344, 0.393, 0.464, 0.506, 0.318, 0.471, 0.344, 0.442, 0.288, 0.489, 0.308, 0.365, 0.612, 0.338, 0.312, 0.389, 0.336, 0.315, 0.311, 0.381, 0.439, 0.406, 0.405, 0.291, 0.472, 0.386, 0.421, 0.295, 0.411, 0.342, 0.296, 0.486, 0.327, 0.461, 0.322, 0.306, 0.474, 0.406, 0.392, 0.351, 0.522, 0.412, 0.356, 0.32, 0.362, 0.297, 0.355, 0.365, 0.358, 0.381, 0.356, 0.482, 0.487, 0.414, 0.339, 0.486, 0.429, 0.36, 0.316, 0.397, 0.397, 0.372, 0.313, 0.361, 0.365, 0.389, 0.368, 0.431, 0.404, 0.551, 0.318, 0.446, 0.38, 0.585, 0.458, 0.424, 0.35, 0.307, 0.545, 0.446, 0.443, 0.432, 0.385, 0.318, 0.417, 0.365, 0.334, 0.446, 0.312, 0.423, 0.328, 0.352, 0.408, 0.373, 0.496, 0.354, 0.394, 0.332, 0.38, 0.362]
lvec4 = [0.345, 0.417, 0.364, 0.339, 0.365, 0.461, 0.363, 0.355, 0.373, 0.376, 0.361, 0.304, 0.63, 0.388, 0.343, 0.374, 0.389, 0.367, 0.384, 0.353, 0.348, 0.304, 0.346, 0.427, 0.353, 0.395, 0.384, 0.36, 0.319, 0.37, 0.359, 0.581, 0.363, 0.34, 0.372, 0.397, 0.883, 0.371, 0.35, 0.333, 0.33, 0.387, 0.336, 0.374, 0.343, 0.352, 0.367, 0.486, 0.386, 0.342, 0.376, 0.399, 0.392, 0.338, 0.348, 0.328, 0.64, 0.335, 0.387, 0.372, 0.401, 0.478, 0.37, 0.402, 0.321, 0.407, 0.334, 0.377, 0.381, 0.356, 0.345, 0.371, 0.355, 0.333, 0.455, 0.642, 0.41, 0.343, 0.466, 0.319, 0.438, 0.326, 0.338, 0.356, 0.391, 0.349, 0.382, 0.305, 0.621, 0.361, 0.391, 0.405, 0.306, 0.342, 0.386, 0.356, 0.355, 0.496, 0.318, 0.304]
lvec5 = [0.332, 0.306, 0.339, 0.394, 0.336, 0.353, 0.363, 0.341, 0.282, 0.385, 0.291, 0.31, 0.269, 0.298, 0.661, 0.427, 0.303, 0.266, 0.316, 0.377, 0.279, 0.529, 0.428, 0.231, 0.363, 0.555, 0.65, 0.231, 0.345, 0.339, 0.335, 0.297, 0.363, 0.662, 0.54, 0.334, 0.318, 0.286, 0.304, 0.36, 0.301, 0.346, 0.468, 0.526, 0.953, 0.576, 0.613, 0.355, 0.306, 0.292, 0.321, 0.352, 0.308, 0.32, 0.474, 0.41, 0.504, 0.335, 0.308, 0.257, 0.406, 0.258, 0.329, 0.359, 0.418, 0.425, 0.639, 0.304, 0.365, 0.269, 0.332, 0.344, 0.337, 0.355, 0.367, 0.796, 0.324, 0.322, 0.355, 0.344, 0.316, 0.406, 0.423, 0.375, 0.28, 0.318, 0.324, 0.306, 0.261, 0.332, 0.296, 0.324, 0.343, 0.273, 0.258, 0.565, 0.396, 0.374, 0.393, 0.335]
lvec6 = [0.297, 0.475, 0.317, 0.537, 0.266, 0.398, 0.33, 0.318, 0.292, 0.351, 0.327, 0.294, 0.272, 0.317, 0.328, 0.372, 0.463, 0.529, 0.294, 0.303, 0.334, 0.346, 0.784, 0.295, 0.658, 0.325, 0.406, 0.331, 0.311, 0.359, 0.334, 0.538, 0.307, 0.299, 0.259, 0.316, 0.28, 0.318, 0.249, 0.227, 0.543, 0.287, 0.716, 0.309, 0.599, 0.283, 0.517, 0.329, 0.435, 0.583, 0.648, 0.575, 0.567, 0.388, 0.373, 0.337, 0.462, 0.339, 0.35, 0.628, 0.372, 0.436, 0.384, 0.285, 0.318, 0.471, 0.57, 0.31, 0.315, 0.308, 0.409, 0.343, 0.784, 0.351, 0.298, 0.444, 0.319, 0.346, 0.377, 0.638, 0.298, 0.433, 0.474, 0.482, 0.304, 0.296, 0.368, 0.339, 0.282, 0.393, 0.616, 0.263, 0.365, 0.53, 0.38, 0.283, 0.278, 0.34, 0.248, 0.52]

lveclist = [ lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests, Omega=100\nClassification Loss, t=10%')
'''

'''
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS, USING CLASSIFICATION LOSS W/ t=10%
lvec0 = [0.372, 0.38, 0.372, 0.375, 0.334, 0.394, 0.394, 0.397, 0.344, 0.364, 0.372, 0.413, 0.434, 0.358, 0.365, 0.417, 0.411, 0.43, 0.37, 0.42, 0.43, 0.413, 0.372, 0.407, 0.407, 0.361, 0.382, 0.4, 0.403, 0.357, 0.357, 0.361, 0.377, 0.363, 0.379, 0.37, 0.357, 0.437, 0.407, 0.373, 0.356, 0.399, 0.403, 0.414, 0.356, 0.417, 0.357, 0.394, 0.414, 0.406, 0.412, 0.376, 0.351, 0.406, 0.377, 0.396, 0.39, 0.392, 0.404, 0.413, 0.393, 0.409, 0.373, 0.356, 0.389, 0.383, 0.366, 0.362, 0.417, 0.428, 0.374, 0.343, 0.411, 0.361, 0.386, 0.389, 0.333, 0.38, 0.368, 0.365, 0.443, 0.326, 0.399, 0.399, 0.357, 0.394, 0.384, 0.37, 0.419, 0.386, 0.345, 0.384, 0.389, 0.369, 0.4, 0.377, 0.402, 0.419, 0.458, 0.357]
lvec1 = [0.342, 0.289, 0.357, 0.363, 0.324, 0.4, 0.33, 0.387, 0.328, 0.327, 0.308, 0.257, 0.261, 0.355, 0.383, 0.489, 0.28, 0.338, 0.283, 0.368, 0.327, 0.33, 0.316, 0.352, 0.459, 0.272, 0.94, 0.355, 0.497, 0.272, 0.318, 0.256, 0.298, 0.354, 0.285, 0.328, 0.374, 0.296, 0.329, 0.356, 0.985, 0.296, 0.416, 0.435, 0.334, 0.265, 0.325, 0.257, 0.38, 0.412, 0.297, 0.303, 0.344, 0.357, 0.448, 0.402, 0.312, 0.281, 0.372, 0.342, 0.275, 0.365, 0.74, 0.323, 0.478, 0.343, 0.338, 0.282, 0.457, 0.299, 0.357, 0.325, 0.621, 0.308, 0.415, 0.822, 0.391, 0.281, 0.327, 0.484, 0.365, 0.368, 0.323, 0.32, 0.336, 0.318, 0.623, 0.725, 0.346, 0.404, 0.32, 0.376, 0.504, 0.371, 0.316, 0.319, 0.538, 0.719, 0.307, 0.294]
lvec2 = [0.168, 0.606, 0.405, 0.436, 0.578, 0.494, 0.215, 0.236, 0.241, 0.65, 0.187, 0.202, 0.646, 0.175, 0.21, 0.248, 0.202, 0.17, 0.179, 0.237, 0.242, 0.476, 0.174, 0.214, 0.206, 0.211, 0.662, 0.175, 0.189, 0.227, 0.416, 0.35, 0.399, 0.389, 0.194, 0.241, 0.395, 0.225, 0.195, 0.179, 0.769, 0.168, 0.188, 0.458, 0.357, 0.227, 0.173, 0.406, 0.513, 0.618, 0.185, 0.206, 0.426, 0.228, 0.359, 0.366, 0.191, 0.23, 0.358, 0.414, 0.174, 0.197, 0.254, 0.162, 0.335, 0.235, 0.419, 0.567, 0.212, 0.182, 0.191, 0.22, 0.212, 0.199, 0.192, 0.785, 0.229, 0.186, 0.154, 0.269, 0.233, 0.589, 0.18, 0.352, 0.441, 0.169, 0.211, 0.161, 0.21, 0.39, 0.206, 0.175, 0.593, 0.552, 0.354, 0.333, 0.235, 0.223, 0.176, 0.195]
lvec3 = [0.382, 0.304, 0.409, 0.636, 0.483, 0.391, 0.291, 0.325, 0.34, 0.347, 0.35, 0.258, 0.404, 0.405, 0.592, 0.893, 0.278, 0.445, 0.326, 0.443, 0.561, 0.432, 0.307, 0.303, 0.365, 0.389, 0.634, 0.316, 0.387, 0.307, 0.306, 0.416, 0.578, 0.341, 0.301, 0.276, 0.34, 0.486, 0.278, 0.262, 0.386, 0.222, 0.372, 0.449, 0.513, 0.311, 0.362, 0.4, 0.348, 0.276, 0.271, 0.311, 0.397, 0.333, 0.281, 0.284, 0.348, 0.418, 0.297, 0.345, 0.264, 0.327, 0.447, 0.39, 0.395, 0.318, 0.365, 0.396, 0.358, 0.298, 0.347, 0.352, 0.326, 0.306, 0.437, 0.6, 0.455, 0.304, 0.367, 0.321, 0.344, 0.515, 0.408, 0.256, 0.608, 0.286, 0.405, 0.355, 0.355, 0.322, 0.407, 0.33, 0.611, 0.472, 0.361, 0.436, 0.475, 0.396, 0.419, 0.332]
lvec4 = [0.271, 0.287, 0.366, 0.34, 0.341, 0.338, 0.322, 0.312, 0.374, 0.336, 0.307, 0.378, 0.347, 0.305, 0.338, 0.363, 0.69, 0.297, 0.388, 0.387, 0.326, 0.343, 0.441, 0.438, 0.342, 0.341, 0.332, 0.361, 0.322, 0.326, 0.457, 0.34, 0.357, 0.342, 0.461, 0.352, 0.412, 0.322, 0.353, 0.296, 0.316, 0.38, 0.753, 0.354, 0.308, 0.277, 0.561, 0.851, 0.309, 0.334, 0.402, 0.472, 0.354, 0.321, 0.796, 0.296, 0.348, 0.352, 0.322, 0.413, 0.842, 0.297, 0.379, 0.344, 0.353, 0.31, 0.322, 0.456, 0.328, 0.378, 0.328, 0.342, 0.422, 0.314, 0.423, 0.364, 0.304, 0.46, 0.401, 0.313, 0.319, 0.358, 0.614, 0.349, 0.367, 0.29, 0.315, 0.355, 0.368, 0.359, 0.384, 0.352, 0.387, 0.329, 0.298, 0.348, 0.354, 0.35, 0.372, 0.33]
lvec5 = [0.415, 0.19, 0.57, 0.475, 0.307, 0.362, 0.155, 0.256, 0.215, 0.196, 0.363, 0.223, 0.308, 0.545, 0.228, 0.255, 0.349, 0.142, 0.207, 0.319, 0.159, 0.301, 0.357, 0.134, 0.226, 0.387, 0.156, 0.182, 0.208, 0.305, 0.32, 0.477, 0.179, 0.18, 0.177, 0.325, 0.489, 0.279, 0.356, 0.29, 0.216, 0.284, 0.294, 0.236, 0.653, 0.147, 0.47, 0.331, 0.169, 0.588, 0.157, 0.63, 0.555, 0.424, 0.347, 0.422, 0.537, 0.145, 0.163, 0.547, 0.18, 0.196, 0.402, 0.178, 0.205, 0.354, 0.432, 0.294, 0.188, 0.189, 0.56, 0.49, 0.653, 0.223, 0.89, 0.339, 0.278, 0.446, 0.234, 0.841, 0.215, 0.425, 0.249, 0.158, 0.323, 0.154, 0.158, 0.256, 0.292, 0.677, 0.126, 0.182, 0.173, 0.22, 0.33, 0.22, 0.698, 0.325, 0.463, 0.165]
lvec6 = [0.179, 0.175, 0.376, 0.4, 0.662, 0.809, 0.509, 0.197, 0.181, 0.49, 0.204, 0.186, 0.395, 0.182, 0.493, 0.188, 0.433, 0.16, 0.673, 0.181, 0.433, 0.2, 0.664, 0.165, 0.252, 0.444, 0.698, 0.185, 0.414, 0.333, 0.358, 0.203, 0.406, 0.275, 0.171, 0.202, 0.623, 0.198, 0.217, 0.185, 0.787, 0.206, 0.173, 0.484, 0.198, 0.156, 0.399, 0.205, 0.612, 0.206, 0.216, 0.158, 0.549, 0.698, 0.495, 0.369, 0.34, 0.227, 0.409, 0.211, 0.188, 0.203, 0.281, 0.16, 0.197, 0.173, 0.412, 0.354, 0.371, 0.413, 0.463, 0.216, 0.226, 0.195, 0.19, 0.339, 0.322, 0.226, 0.178, 0.459, 0.208, 0.395, 0.186, 0.614, 0.16, 0.154, 0.261, 0.57, 0.322, 0.213, 0.362, 0.225, 0.679, 0.273, 0.478, 0.207, 0.566, 0.24, 0.585, 0.481]

lveclist = [ lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests, Omega=100\nClassification Loss, t=10%')
'''

'''
# FOR 6 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=20%, overEstWt=1.
lvec0 = [0.01728729014931321, 0.018471918342130782, 0.015683815599280424, 0.015655644941699742, 0.01815963047507897, 0.016801844559582856, 0.015629703051773167, 0.018667554884051873, 0.01694482368386538, 0.014746901954150772, 0.014511976508500144, 0.014327385602907217, 0.015125668584179587, 0.015636987332666597, 0.01729784455744154, 0.014158589944664316, 0.015345482843518337, 0.017517073677329714, 0.015236045719924433, 0.01574874721197197, 0.014811074533242265, 0.016513239471657427, 0.01756957743712494, 0.016526385939271814, 0.014498931361412379, 0.014686115574308909, 0.01814130256363459, 0.013196227539490535, 0.01614853257782514, 0.01464580171145139, 0.016588128618273617, 0.014708487192838866, 0.015229236043196096, 0.015655408973299, 0.01423463657893135, 0.016900325200930457, 0.01526207375456269, 0.017025407848797334, 0.015949368022818693, 0.01672967442520684, 0.015566220069113713, 0.014877788396696788, 0.016532683527538256, 0.01489299676941007, 0.018434805569295786, 0.015626388941818416, 0.018462144367519907, 0.016088292887917178, 0.01598556700861214, 0.01813060697236665, 0.01748285230383631, 0.015952081074120245, 0.015934857447889937, 0.01631107875631688, 0.014395901572940437, 0.016774226164355033, 0.015774822741543643, 0.014651481249148833, 0.015169218184766922, 0.015561234349167211, 0.014852819791934993, 0.015986662328284423, 0.013707709221989365, 0.01432375288443756, 0.017330994747413498, 0.017588973428084402, 0.015934202622139536, 0.017325621081784794, 0.01727693418743328, 0.01958756003914346, 0.0155956147322963, 0.014714654850202928, 0.01515572234174987, 0.015026373261513477, 0.013666265862091635, 0.01641067308567396, 0.01764512718171291, 0.016824135324949682, 0.01604824804692429, 0.014521177936402773, 0.015465804772273165, 0.013949171357429966, 0.016500671732389262, 0.014426041088188981, 0.016149849135599137, 0.016658025535992094, 0.01591683065513411, 0.01393257519035395, 0.016294422425590684, 0.01632693554201407, 0.014330754019540577, 0.014089032583448605, 0.015464704287658384, 0.01474551726808667, 0.016421839985492837, 0.015885368682801344, 0.017222461901998685, 0.01686571720413538, 0.016491702089873047, 0.016079065150581707]
lvec1 = [0.013034480236624683, 0.010953998166691183, 0.011123884891243047, 0.011757754102354454, 0.013139327946536428, 0.010483725254045107, 0.011634906806121285, 0.016776202783798898, 0.01156027966108425, 0.011022063866750515, 0.010144939823046508, 0.01151509882846369, 0.01304972934155684, 0.014352570489641453, 0.011622109175230764, 0.01294899310804929, 0.012884173702605643, 0.012231918957611226, 0.010997726147219045, 0.011079600864542634, 0.019975273042624222, 0.013226173371428146, 0.010664235723483803, 0.011223729789472033, 0.021707843359204726, 0.011716492652959133, 0.016640160180345455, 0.015045967662713225, 0.013026788170032182, 0.01088422986868269, 0.011679938600325894, 0.014684112728179984, 0.010820985671387305, 0.013545626758142106, 0.012858817382362761, 0.013472542733002397, 0.012219639722780213, 0.015850191555103504, 0.012103508580257386, 0.016888081192376853, 0.016758964210055835, 0.014648062938180507, 0.012554820583218189, 0.01298781236171401, 0.011867182451878401, 0.012044830249327818, 0.01301261518538804, 0.010992314213950305, 0.013293625069894312, 0.01397526536233909, 0.011347434324800098, 0.014343810441584337, 0.01544149836150512, 0.013521034366019253, 0.012277037791411056, 0.010400847170174893, 0.011594689199191705, 0.012183401675848013, 0.014452598630496033, 0.011806405981041239, 0.011564060950833488, 0.012567299081328502, 0.015785217485214227, 0.011558058708616805, 0.011729794875411672, 0.010901772374518705, 0.011602656720312595, 0.011372465336086116, 0.011813882831929736, 0.011542960002805474, 0.01054755980242685, 0.01542619033352268, 0.015964970162901524, 0.010751540862297843, 0.012333455388719505, 0.020750728609546056, 0.01479535434301874, 0.012383355360284252, 0.013836372121271633, 0.019031121624159868, 0.014748947617062438, 0.01148771659895242, 0.012332158693198736, 0.012732664444232697, 0.015138186869928119, 0.013707947046563713, 0.0126898049816628, 0.015805296870503513, 0.012177615944060026, 0.011695336575255138, 0.011088022384428952, 0.01652937186835279, 0.020051469262727408, 0.0154430934816399, 0.010829790621178784, 0.016822249529247185, 0.012714180221634822, 0.016585392444701717, 0.011630284315492774, 0.010556027456683612]
lvec2 = [0.01842663237826679, 0.011746266545902186, 0.010802451863965017, 0.012762511299364997, 0.011550506124007678, 0.014009031477793213, 0.011808604051031681, 0.011239345610471569, 0.011776739716958758, 0.017738498152465084, 0.011607247502396072, 0.01318498995858116, 0.012499376759001722, 0.012054109481393821, 0.014051518992704272, 0.011725978218873043, 0.012912681939906351, 0.01178206874457996, 0.012680431935162812, 0.012015652590246286, 0.014297461663807791, 0.020775154554184144, 0.01268843689826071, 0.012475363040803484, 0.012505480727698965, 0.013199879386752416, 0.012403939266593271, 0.011789737300041311, 0.014860754877382814, 0.013569906296234025, 0.017959959966860745, 0.020188568653366216, 0.01218558605225435, 0.013222299289584202, 0.011461682635521492, 0.01442752079960425, 0.01093473273448946, 0.015451667154500338, 0.011737329430542948, 0.01173113293332023, 0.020541429168093903, 0.011548481132740502, 0.011871949196154922, 0.021348051631750707, 0.022374234598915885, 0.013052578522616409, 0.012758453617428788, 0.012900706553134723, 0.011992458337750637, 0.014162585264797113, 0.012414650464678652, 0.012694174070907201, 0.012782567642446379, 0.011399955901956147, 0.01356651634059893, 0.010966367199669052, 0.02226788907542851, 0.014119803392899217, 0.011781219964836585, 0.02076610827166373, 0.021408901567924785, 0.013939128361637411, 0.011831971713537911, 0.01227280417232738, 0.012092897263895267, 0.012949363200981995, 0.023269658004295143, 0.022933858178506922, 0.014516920892992481, 0.013041435496434725, 0.011249533220172515, 0.013401055078899852, 0.011656853808060636, 0.01105147611355686, 0.01225599462290827, 0.018362880504295846, 0.012861928906346047, 0.01206641561463537, 0.01151148130882256, 0.02239212347048722, 0.011331814579607037, 0.012185914866858303, 0.013586644835574578, 0.018402541406202504, 0.011968951140327361, 0.011010060016781256, 0.011503684878074271, 0.013548558671163264, 0.013561370071929995, 0.01222224682244928, 0.014373057889708215, 0.013688563707902123, 0.01471779245111908, 0.013071773223054028, 0.010957099193783569, 0.01960764019457382, 0.011714599552540493, 0.011579869305124972, 0.011099316655742764, 0.010769481129360046]
lvec3 = [0.011840072466162088, 0.014816512031806083, 0.016978498620477227, 0.01544792281737961, 0.01217257117362004, 0.017961607453183183, 0.013445596327839164, 0.01493035866083257, 0.010569165229396407, 0.019331688007710963, 0.011157075908981556, 0.013618674675530271, 0.02180367057078664, 0.012790638075683942, 0.011580054150365393, 0.013054830542030013, 0.011978829149625954, 0.012520315952172663, 0.010780769834936973, 0.013758894845697669, 0.014221104685455656, 0.013390819519575764, 0.013186966621788823, 0.011271368936001051, 0.017159737225563403, 0.015722167995238144, 0.014851788417750086, 0.011839415889042838, 0.014508348627829503, 0.01142254803025384, 0.01221164336406308, 0.01561850698782542, 0.013055864493469245, 0.016463848275918045, 0.011292327605230041, 0.012744857069828459, 0.01728621009283507, 0.01471936846988834, 0.012693723464765418, 0.01244805481082687, 0.016252276330026096, 0.015350246997081924, 0.012603469738636857, 0.011548157546493708, 0.012738334870607517, 0.010903363470515041, 0.012148842260262773, 0.012301280926294615, 0.012683165072514975, 0.013676666885230976, 0.014227495199742634, 0.015530190520629497, 0.018265184162592995, 0.01596098067764406, 0.011946673075555735, 0.019138712930228233, 0.015521605526039874, 0.012603624712193699, 0.010913594565398003, 0.015655945929950097, 0.015512295776918015, 0.013494350357897039, 0.011550824890390311, 0.013399863997497633, 0.012363250119647052, 0.014477520008769068, 0.01137110144800542, 0.01483238103560378, 0.015279016487991924, 0.022484134870721425, 0.011415147882155167, 0.013323903494037795, 0.012511166297490724, 0.021384590943424125, 0.01650080315499638, 0.014434119192735918, 0.013511057378887838, 0.011906198068044011, 0.019139479702679298, 0.014427749774672935, 0.016100166292107806, 0.013482292670601716, 0.013977388571280119, 0.011072250815006424, 0.014425265555371316, 0.013156726258062523, 0.012269608340838565, 0.017295829441875653, 0.012389809570972696, 0.015009691992227656, 0.011967326725698347, 0.013500483530878928, 0.014421005853054674, 0.013825463360917053, 0.016745175259829118, 0.013614736140540658, 0.015632102978024982, 0.012278505839326806, 0.013456740696280382, 0.012328654445365034]
lvec4 = [0.014653666885825868, 0.017723782484209433, 0.014563567787515061, 0.014177141348867443, 0.014451733523992365, 0.01674841408371463, 0.016589013611760833, 0.013498326940678375, 0.018242855556574917, 0.01541009041242396, 0.015186265709122236, 0.01468907440403314, 0.019179243668891482, 0.01591786336182918, 0.013122840930205248, 0.013834482397736828, 0.017797019997617885, 0.015720437761413082, 0.015373177432953659, 0.01513854448401331, 0.015241618962605208, 0.012376592412731677, 0.01616025966655757, 0.016052455392367923, 0.014130430142557979, 0.015239639646248207, 0.01717589088298545, 0.015748358753269933, 0.01513535780658735, 0.014864078848694772, 0.013725826565854348, 0.01843042438846535, 0.015259065968100618, 0.014868205793189069, 0.016191678547699002, 0.01644313676398759, 0.02303802056462083, 0.017546288327829604, 0.014315711980450884, 0.014012759885095984, 0.015442345249930288, 0.016594861295207673, 0.015110411242629632, 0.015571846390458933, 0.014955973522600311, 0.014948367917418756, 0.015201984627985141, 0.017317906556095098, 0.01721664948987128, 0.014236285710067824, 0.016312161915105174, 0.015863171729884894, 0.015815673353019193, 0.014777586840800805, 0.014404708466823714, 0.014775676755352648, 0.018777937514335916, 0.01444944141095575, 0.015394873799298542, 0.01636791849586822, 0.017286353335451712, 0.016977926653255548, 0.015724601565290118, 0.015834363849894194, 0.01615361087982374, 0.015923684738554315, 0.01444924581747224, 0.015556575163000654, 0.015172150759645134, 0.015832178794099736, 0.014418534124851584, 0.015748993031535957, 0.015243041273502903, 0.015022454964309753, 0.015674379966891486, 0.017353551727413673, 0.017971597367822948, 0.015544820703962774, 0.017613392695351136, 0.01278065989175209, 0.015672917755442353, 0.014183957360100726, 0.015418072856654112, 0.01499952017726786, 0.016958109981539186, 0.014908774182529382, 0.01698105188156532, 0.014700281277020097, 0.017493683252976365, 0.015189088890335847, 0.014522995639046616, 0.01690875023386191, 0.01360518990041971, 0.014602973155272349, 0.015917365551647408, 0.01593269126851686, 0.014673705462087246, 0.01954167692888731, 0.013674111777081673, 0.014555280288967147]
lvec5 = [0.011380331105046741, 0.013018077835728331, 0.012794821034931233, 0.01620764018153669, 0.013241139963084642, 0.013967675986167457, 0.014087590098720177, 0.014157143219883678, 0.012221127897060105, 0.014790145526645357, 0.011531140300951537, 0.012552452361360808, 0.011706157021424532, 0.012021920616742435, 0.024684811597508072, 0.015621668715520315, 0.01209554587033104, 0.011423410804992717, 0.013121563490638706, 0.015191882634118333, 0.011635512592825045, 0.014830363311387656, 0.013971088894521762, 0.010991727260015717, 0.012848465710703742, 0.019313918397348095, 0.01556497434814627, 0.011137269095541233, 0.013363998967839252, 0.012718264457420636, 0.015439536622513534, 0.01144041202083957, 0.014764354418311757, 0.018724173246204637, 0.01684062757002458, 0.01354245938794612, 0.01224086624022257, 0.011887034791871389, 0.013159420459701537, 0.014362585591362642, 0.012660121422882323, 0.01326981884576271, 0.013951088268230999, 0.023711845380078648, 0.030422175261672093, 0.0156433380330372, 0.01813273766452835, 0.014046035543083313, 0.011727137476210577, 0.011167026628819451, 0.012155620018249883, 0.012980116206303701, 0.012148870012760377, 0.012913680993246619, 0.014253902761609533, 0.01552323947436067, 0.013698701696581689, 0.012399461805375817, 0.011940845653321422, 0.011116486208144295, 0.013628067666562925, 0.011790514907544845, 0.013984035061295608, 0.015377916336013328, 0.015990291441581792, 0.016601217606062, 0.017424657903304865, 0.012556722212749892, 0.013727038133647269, 0.011119137122903296, 0.015158759196205686, 0.01404533571540001, 0.012434576334314263, 0.01334413946999605, 0.015426599995726526, 0.02345599321868283, 0.01144960145611521, 0.013497839367950466, 0.01277061233360752, 0.013658206123188863, 0.012711614297362797, 0.015825371003821434, 0.012668462832031985, 0.0144246739666844, 0.011385788493908273, 0.01258747471321936, 0.013379083879962334, 0.012210982167600283, 0.010667396522802288, 0.012908199568333016, 0.011807280297636266, 0.01412386275112247, 0.01341817450270147, 0.01147813981815324, 0.010792005907863922, 0.01984912347870992, 0.0156663508385845, 0.015660601349452626, 0.015291658068382454, 0.013049595455748592]
lvec6 = [0.012427907483870064, 0.015627856915497625, 0.011726751528111085, 0.018776494657626677, 0.010726039786221537, 0.01494756545198907, 0.011667739491830425, 0.01225025611066988, 0.011958468749490402, 0.013254086327401205, 0.01167102392429653, 0.012127620981749562, 0.010864955321642231, 0.012993987729093357, 0.011699548613261217, 0.01427319563105918, 0.015862487216497204, 0.014416920776469912, 0.010803871734900663, 0.012496518624241152, 0.013423671993034316, 0.012701237259252582, 0.024927126111048352, 0.011591051195413688, 0.021056979874069074, 0.01193425425625555, 0.015504437553152091, 0.012494686299226326, 0.011938174818505589, 0.013398174141948393, 0.012933829319294527, 0.014542476075554644, 0.012083266392658462, 0.011063310659992722, 0.01090439990704538, 0.011421249616821947, 0.01096251640933731, 0.011894882686971918, 0.009768087135547039, 0.011015260700964128, 0.018418689798966627, 0.010704159077263808, 0.02010257214229351, 0.012605358295959216, 0.020374409535590523, 0.011339134501660488, 0.014580035681454287, 0.011610504727863303, 0.016821110770761115, 0.01900791361201496, 0.01904963917637377, 0.016679835917927904, 0.0204036231471656, 0.013700119064206309, 0.013274539432319116, 0.012438324446595402, 0.0175264220912001, 0.012768432103812549, 0.013186070728792127, 0.01642513164053339, 0.014419392385988284, 0.014490070834783556, 0.015143448325255042, 0.011226887423304507, 0.01367822678824436, 0.013973109309659093, 0.018558770208775388, 0.01256062255004907, 0.012918504076128877, 0.012411084222627024, 0.015549904868063054, 0.013339863447517813, 0.02340171605388548, 0.012278275531137084, 0.011295572144824895, 0.016280558103398138, 0.011092671990496553, 0.011757949612825681, 0.01459221042311207, 0.018232669404723026, 0.012329497884488115, 0.0162582132383625, 0.01787119645448067, 0.016009342106249397, 0.011387651968382163, 0.010644322991564816, 0.01362441294323945, 0.013051652253270993, 0.01126686248992041, 0.012977071540151429, 0.018411334394022937, 0.0107528497829377, 0.012637554448119459, 0.015044764025355416, 0.013024743068976255, 0.011006594078399509, 0.011554468219525375, 0.013931832896941066, 0.010495446101322263, 0.01419518996811685]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests, Omega=100\nPMS Loss, t=20%, overWtFact=1.')
'''

'''
# FOR 6 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=20%, overEstWt=2.
lvec0 = [0.05340890492585494, 0.05820017119639504, 0.055159621028566225, 0.057705218754149135, 0.05008418734353597, 0.05068222583887698, 0.057256353483709194, 0.04838922623195669, 0.05505163393021836, 0.04829490878044514, 0.04856237371039545, 0.04964113804040521, 0.04821105712194246, 0.047369563952574585, 0.05033829135671399, 0.04837618067469676, 0.05395620043017826, 0.0518434439862483, 0.04680935095027758, 0.04973823308765938, 0.042744926637013556, 0.047825986245281796, 0.04457737798883909, 0.05837179903976296, 0.05299601352220734, 0.047155128271289225, 0.048430817248152846, 0.04951043748671617, 0.05234970762388437, 0.04797153964804197, 0.0511053293087705, 0.05162329325350428, 0.056260694752954504, 0.05147112632544638, 0.04874362138960874, 0.04798347863133063, 0.05108102226137571, 0.06119594659728703, 0.05746380616998718, 0.04734862832927931, 0.05401004213011451, 0.04834687639581981, 0.04152618042916643, 0.04864473653732238, 0.042832424883722305, 0.04733849160331509, 0.05087200969562211, 0.04789446748363723, 0.047818418549174777, 0.04985226336769546, 0.056070022179740484, 0.05520464712180312, 0.04826654900750391, 0.0466577144913161, 0.05034870650359856, 0.05148843739044203, 0.04856768137903386, 0.05468481697643511, 0.047834368298967665, 0.04998374266698511, 0.053775292611699915, 0.044461189309672564, 0.05508323711599948, 0.05042060321776053, 0.05378292732268146, 0.05010994539330754, 0.054864269768104504, 0.048141195855994856, 0.0505201182421093, 0.0565111008072209, 0.050674275121562244, 0.0481058889203885, 0.04772936082272347, 0.04810618988776218, 0.04926513014834792, 0.050936820825523275, 0.05328159174537579, 0.05370889365640707, 0.04832891056845242, 0.051301142318596754, 0.046423711369078, 0.044768906827016404, 0.05041247529558998, 0.04674170581523738, 0.04722664864183755, 0.04589364535246836, 0.04412781155810311, 0.0592162443718002, 0.04607663271768663, 0.05133990997345871, 0.04644193000252004, 0.048587047189224464, 0.04714104542673156, 0.04924516293205036, 0.050729552613539446, 0.04787657656906362, 0.04737779650534382, 0.05545101147544792, 0.04722627325878679, 0.04720880100712451]
lvec1 = [0.03494769683349942, 0.03745438203815055, 0.040710738497247496, 0.053314131953118425, 0.05894483059631831, 0.03501585338462428, 0.03933147773196014, 0.041523089002673, 0.041249820712234035, 0.032744563382978174, 0.04200106965877783, 0.036314735149929944, 0.038959559994164984, 0.0496799310113728, 0.04891170129851833, 0.05254226175165654, 0.05330271689280021, 0.03876560306859897, 0.037726768794083945, 0.05467699702569495, 0.06049557510832722, 0.03243228269112335, 0.04098449036959284, 0.033061818052368845, 0.07903755753157576, 0.03627893549344813, 0.04079101008093126, 0.05188239822153069, 0.0345613585744, 0.038666759608234395, 0.05563143091822059, 0.05390118757446328, 0.045426953532569404, 0.04761204313557038, 0.03305353239122871, 0.03533494257158972, 0.04494540093684156, 0.04310423751424735, 0.03724774634905296, 0.04375447812632395, 0.07391004569395966, 0.03748579140136254, 0.04832542713849167, 0.04032596372645441, 0.05057526916798324, 0.039450572794416605, 0.05098523196613792, 0.0400083412761557, 0.040255158478315144, 0.05900679079778623, 0.03431369935248452, 0.03914259320501822, 0.04741559921482621, 0.030885027190201374, 0.03377257345947926, 0.04556288968634495, 0.04981670784695863, 0.04708535067348992, 0.04375505975841678, 0.037868380636981384, 0.034158151908512624, 0.04313817231485883, 0.033016311287658466, 0.04833618486628397, 0.05035647847756361, 0.03683751928458122, 0.03680811747698635, 0.05679940528353108, 0.05180498091057472, 0.03553712533342519, 0.039983384377681556, 0.04160961150588258, 0.042038226184856683, 0.037243743320742026, 0.05208006300687969, 0.05846683233293117, 0.03521447043384348, 0.03230020641166026, 0.03838261488934957, 0.041904735426430535, 0.04708996198151014, 0.043444599042363495, 0.04385262572955327, 0.04011888165013633, 0.05332017689218975, 0.03723097832401891, 0.040254762520207765, 0.05011585996082748, 0.032730117846033524, 0.037874881434982674, 0.035091550728689136, 0.04911962509337156, 0.05344330012882448, 0.08261448596254796, 0.04485246220034679, 0.043737098007715795, 0.07112545792702955, 0.04563145452257108, 0.07080281328555078, 0.03769764697548434]
lvec2 = [0.03395928008462964, 0.037375915772218694, 0.04588491750491526, 0.03546586272381919, 0.041566274920528785, 0.03802182939769537, 0.04000182727970592, 0.04520824832089842, 0.03234594156436888, 0.032531027432591494, 0.030575651223613005, 0.034634784928100966, 0.03687567475976428, 0.037486744428566254, 0.0684238549077612, 0.03926418439637033, 0.05984920465686762, 0.03519846002477123, 0.03865528624833866, 0.04099451487956695, 0.046863205554288245, 0.036793992913347076, 0.03855917321027414, 0.03166909219971128, 0.06409518400660905, 0.04062648189578011, 0.04127081609066754, 0.037333529676928906, 0.04082612160275242, 0.038618445280672126, 0.034019422121170734, 0.046144201479188844, 0.06882766959258335, 0.04465878231393889, 0.03955048779351943, 0.03483669205853499, 0.0370399897991862, 0.04058027149615809, 0.03649813853090995, 0.04282323859338426, 0.04362711744004486, 0.04286250774598303, 0.038317636512369774, 0.06952001746439218, 0.06943804032662344, 0.0399128417105514, 0.06513966976031058, 0.06529873281619684, 0.044755404391990224, 0.037211272529323776, 0.03266725292521658, 0.03266898887772676, 0.044133869501389, 0.03984988259241432, 0.07536129161515641, 0.04892009889749406, 0.041731151615749126, 0.04046044566933281, 0.0687047724138105, 0.03643551865325991, 0.0369570845829331, 0.0355372302015021, 0.03856337722792037, 0.06324310386791474, 0.04500862303539867, 0.0327161457240251, 0.04323368253313723, 0.03647246476346305, 0.04597836337488415, 0.03842239108213041, 0.042125059117941115, 0.04068931096257856, 0.03981236592162457, 0.039530481076291236, 0.03551829679951213, 0.06888619745825925, 0.03481008181536198, 0.04020523227318419, 0.04159514307659981, 0.03479107563861297, 0.04424722388241151, 0.036569360694581714, 0.03565028720889981, 0.04261506509736115, 0.04134316680284589, 0.04353695457424124, 0.035676928998181826, 0.03879275074965914, 0.04037868993756251, 0.03196774402192244, 0.056742058274222205, 0.06359786809285801, 0.048862235273666337, 0.03819251349180327, 0.03719420463804332, 0.0357853561725558, 0.04131028116265232, 0.06881619860233266, 0.06194601011781141, 0.039078549347914084]
lvec3 = [0.0398274030259982, 0.03651567994106405, 0.036737634889325306, 0.046148048140754724, 0.051107633087718866, 0.05729534970309558, 0.04391799226358912, 0.041744436274928874, 0.06488715478480331, 0.046266441058573145, 0.03437402707908194, 0.04411917678854586, 0.04684034035196654, 0.03452181655195653, 0.043942657424234775, 0.03667425803580897, 0.04665213962754894, 0.04255716375440338, 0.03593548345705218, 0.04194803916344403, 0.04070750684015816, 0.03564101837574478, 0.03611222207313737, 0.03288323830244062, 0.03484458400809616, 0.04046207604938026, 0.03934616666165705, 0.06261783332818853, 0.04088048438934017, 0.04261279720145329, 0.049775508105818364, 0.03440986774419665, 0.04325973522956164, 0.04527333118266067, 0.040805642312755144, 0.05104271395889017, 0.03655217422159469, 0.05781809438274064, 0.04708664543874973, 0.038350583684325, 0.05256959295717973, 0.035570702362710815, 0.05606963770161768, 0.04427097753428657, 0.04368835364850891, 0.043388898770255105, 0.03881298523603689, 0.03907310869926654, 0.031554642039875166, 0.0638455724881529, 0.038436553378067256, 0.044907349941184574, 0.035184023335806995, 0.05083337992451656, 0.04239331649912493, 0.04007057327796457, 0.04219202092707529, 0.03912461454754136, 0.036298990004237516, 0.05588227769915165, 0.04491619267691245, 0.065179124014771, 0.052016099805644034, 0.04867069630399252, 0.04492131877279973, 0.04694937091236743, 0.03988661738190981, 0.046740236898508085, 0.04605714794972209, 0.036547810437320895, 0.044309616428521194, 0.05262688216872877, 0.05391627854870361, 0.03778231482816336, 0.04242533999232818, 0.05566191327776755, 0.042445663853622397, 0.04671154508350938, 0.04801688985985094, 0.0649643035288746, 0.043162876887347816, 0.039109208921127944, 0.038860208378998395, 0.037722264603691345, 0.04186173847177135, 0.0382009097050975, 0.04969935946165572, 0.03841708185642139, 0.04590453205341582, 0.0445615603947439, 0.03770496184992898, 0.03458852355940126, 0.059080365887912836, 0.03660924778889276, 0.04693923152164218, 0.0346291802081886, 0.04850403680085445, 0.03874326981874562, 0.04501913076377568, 0.047815557682627324]
lvec4 = [0.05026580138948399, 0.0485154213571466, 0.043991411368278326, 0.05956474120972691, 0.04859224016216311, 0.053875217052579444, 0.044617551146006046, 0.04746149445301199, 0.04808111281822892, 0.0435000766434218, 0.04648897037340307, 0.04703556406458549, 0.0660361377339512, 0.04427158821795016, 0.04629515508903221, 0.04160454146093861, 0.05045513074264752, 0.048533643871781385, 0.047207208718925385, 0.05077403175342812, 0.05248863422243117, 0.05472303894387443, 0.04946426158981122, 0.04959449765852329, 0.04506573540391792, 0.04480320774633114, 0.04859700142799836, 0.054401107416670154, 0.04638686332803192, 0.04523522090698108, 0.04686906730994533, 0.060282531616497215, 0.0453925644115271, 0.05312053338677412, 0.062057117716469865, 0.048229940512627016, 0.053290722152527205, 0.043025186537196225, 0.05068643125358991, 0.04973627715158236, 0.05413502559816161, 0.0496465740936197, 0.05639447736302812, 0.047599284952506135, 0.04350869046189704, 0.046588745895967794, 0.04486339141539145, 0.05278541785170391, 0.05998687821596576, 0.0431390887513294, 0.05265617551714308, 0.058901192604827964, 0.04018401234682565, 0.049317351063510595, 0.06143593006921431, 0.044490279296841864, 0.045458981752639994, 0.04849749581244092, 0.044836320963383754, 0.045643344089685164, 0.057032407608137235, 0.0503317775692559, 0.05022696024272455, 0.05618444738303047, 0.043471464827225165, 0.04865481327936503, 0.05026575842296338, 0.048986026491297005, 0.044904852471177883, 0.04903942304902857, 0.048956161198160354, 0.04715415595173396, 0.04821386249039574, 0.04442686043937709, 0.043661937768971926, 0.05273163797808048, 0.051462198974356596, 0.041923331808042946, 0.04739265132339634, 0.04789040870772539, 0.044642010405985595, 0.04052433494159179, 0.049497758247332324, 0.048653031897057525, 0.049884626276357216, 0.04614606872004078, 0.054906153789833025, 0.05586232628015512, 0.04839508400652035, 0.04844064596466927, 0.052178542786719746, 0.049230387529856263, 0.051303406837490684, 0.05029774704666407, 0.04438861695042488, 0.0435151151373389, 0.04541041234842678, 0.05116193168404803, 0.04486492909426088, 0.04877343462145681]
lvec5 = [0.05361740635126253, 0.03522507437086625, 0.03869230298287396, 0.05020746540869431, 0.036190582733741386, 0.08672060281959451, 0.03959914401936986, 0.060351426759659536, 0.03960966355376376, 0.06376223392833819, 0.03767114815512938, 0.08947749516571511, 0.03615055696367145, 0.035051911097391864, 0.04535947917137964, 0.07170036477123379, 0.03733782000234458, 0.039960493085615945, 0.03776486025099615, 0.03684020825655132, 0.03457115359589625, 0.045179214042246986, 0.05248454818759891, 0.03626745730183964, 0.03650250355483327, 0.04024073036301285, 0.04777502984671591, 0.05722975474941356, 0.04056970859628775, 0.03981920483359978, 0.06101557381468298, 0.04419757569737313, 0.04082590558035236, 0.03622195638023414, 0.038794985381695624, 0.03309118040382049, 0.03651466280658323, 0.04211334069088557, 0.04031010281523161, 0.03793510159592768, 0.04673802526942076, 0.037238640341038305, 0.03661224702072944, 0.05178654283466254, 0.04884507430779682, 0.029935851358304212, 0.05752988951423174, 0.04904536654533896, 0.0734926241143845, 0.048795933906090175, 0.04163341081112232, 0.03890511651809334, 0.042686875272816414, 0.04623214217862153, 0.06660810953415545, 0.052406790023900834, 0.046654120955112156, 0.047114945230559487, 0.04162073323404789, 0.06356896820355326, 0.04150382057481144, 0.04343806426565282, 0.045472196384339025, 0.04495923940803673, 0.0540192496478883, 0.03509188838148686, 0.035269754243040116, 0.03456909743424706, 0.04081091608261342, 0.04409009722592921, 0.046397874623378875, 0.04444500499448258, 0.061972074042336775, 0.05570589688739792, 0.04488655806810836, 0.07830109934297642, 0.03359548210951414, 0.056574953512972787, 0.03757122453476126, 0.03587855839980185, 0.05690714720301266, 0.03499825641234976, 0.04669183229407319, 0.03867149356091891, 0.04294825284208301, 0.03489419127377095, 0.031582269969316366, 0.042624982516411516, 0.06300214605586679, 0.08242550754213963, 0.03655662181230273, 0.033290955414321165, 0.07431852545665019, 0.0648720974578948, 0.044456092813642614, 0.04984434418937966, 0.04619224989328076, 0.04525634907061931, 0.040018593171920705, 0.03736945577153175]
lvec6 = [0.038855305852582046, 0.05242844740663353, 0.037635097505142316, 0.06282867132062175, 0.032522843351928614, 0.04955447065606831, 0.0362719739297409, 0.03899744514624648, 0.03769368864812251, 0.04257234008772245, 0.03524331710371971, 0.03824054721495672, 0.0326144416660778, 0.04103239342599198, 0.03645592970582175, 0.04626007268032683, 0.05247031560780232, 0.046746302900782945, 0.03368917155342115, 0.03861989348367033, 0.04332079840760135, 0.0412844598148396, 0.0848684093812848, 0.03630646812063554, 0.07071425282923066, 0.037790375710528915, 0.05284987436622104, 0.04070160023313682, 0.038205393422087425, 0.04324823524072468, 0.041031066935650264, 0.04667156924422306, 0.03864138471777243, 0.03555968104173664, 0.033798199833229695, 0.0371094078106881, 0.03341186099205563, 0.03634809825987585, 0.029703312291153763, 0.032901596691561716, 0.06047116353243433, 0.03318516609373084, 0.06865844927420295, 0.04020459026432551, 0.06702538950145423, 0.03478548812175413, 0.046943941858103765, 0.036220585568958207, 0.05550953419056129, 0.06291070807347247, 0.06431047157661085, 0.05592604419471292, 0.06770394127806097, 0.04483020523293156, 0.042999322249694535, 0.04023462321315526, 0.06021631241974339, 0.041267968046780706, 0.041811673557397566, 0.052193617622387986, 0.04677640218104074, 0.04854043378198273, 0.050564749331803126, 0.0354720766794601, 0.044070709986506265, 0.04523897953637904, 0.06107939721027637, 0.039657796427926516, 0.04219574332157082, 0.0408167404517981, 0.05196721638301223, 0.04328356677981461, 0.08133468191390415, 0.038962916089567694, 0.035517829921336, 0.05577691807284322, 0.03391646528054871, 0.03625227818282389, 0.046998928164292936, 0.059855919775582404, 0.039981988344404466, 0.055060547188628725, 0.061764245648384584, 0.05406778349745168, 0.03599418758734163, 0.032761947719629314, 0.044293595294180456, 0.042601632768382074, 0.035647285423761964, 0.04183724459984069, 0.06069852483626367, 0.033039358163757936, 0.041234068153682614, 0.0491937223481964, 0.04200362244948738, 0.03323484672140339, 0.035751346548288966, 0.04518367971518367, 0.032353984975958185, 0.04553383497956681]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests, Omega=100\nPMS Loss, t=20%, overWtFact=2.')
'''

'''
# FOR 6 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=10%, overEstWt=1.
lvec0 = [0.020035734024549143, 0.02005656193917887, 0.019838639397240693, 0.017560466794934275, 0.021504543036655437, 0.023045427101543486, 0.01783876632503485, 0.01896114458360438, 0.018148308452504765, 0.01963240728159441, 0.019437764398729344, 0.017202316947839073, 0.019047276505884163, 0.01826058953041846, 0.021427059181959928, 0.020474495082370373, 0.02103253767716469, 0.021718029337606387, 0.019182769482559096, 0.019256041164082176, 0.02040860715328469, 0.02123261856392162, 0.01836102089666982, 0.01938819977525935, 0.017732299338895287, 0.018401177570401255, 0.021922651726948527, 0.02039555172621135, 0.018288139900648533, 0.019629707278157757, 0.021256252285283737, 0.019408451058677927, 0.02007780661290464, 0.02014467336854861, 0.019440264377966768, 0.01810461007136605, 0.02035530294271441, 0.019248428049639596, 0.018282830023999743, 0.01889048323953737, 0.0192682091696877, 0.017536671339772544, 0.020161186528483206, 0.018385904065852176, 0.017657366236783396, 0.020255316044950865, 0.021895317593223832, 0.01864019231876829, 0.02016251321309696, 0.021809316111135808, 0.01801960090756191, 0.01837153858434028, 0.01911530737382263, 0.021912200765645033, 0.016983764317013428, 0.020267887124186954, 0.020597627204944603, 0.019572475441050164, 0.01916220548828678, 0.019495534378778538, 0.020925062818310747, 0.01658070169752567, 0.01767826378093967, 0.017581383937292642, 0.018939540599909536, 0.020577395944041788, 0.01714086899063931, 0.019978643118733954, 0.018174670430843993, 0.018805658611580758, 0.0194408322151454, 0.01797371697395821, 0.018329733961094673, 0.0193077393438492, 0.02069589460486727, 0.018841317783546554, 0.018864414940786323, 0.017391695459093456, 0.019490471057075003, 0.02038581575736658, 0.019203295962442177, 0.01694219697199376, 0.01797028438264967, 0.01862586508419463, 0.01821309648265841, 0.02075518930781996, 0.02100968342758268, 0.018052621537725237, 0.01902979324457343, 0.01894675053102696, 0.021930170704035627, 0.019159289358949783, 0.02014448767409621, 0.018070907785676098, 0.018345294639116848, 0.019717700690903058, 0.02218420872743696, 0.01987790855749312, 0.01657476371821114, 0.019748632608619445]
lvec1 = [0.01368838461069973, 0.015520153481345798, 0.014833797680378014, 0.027676201963905432, 0.016531611869346163, 0.016320279132625078, 0.015914934814638525, 0.018372857399674907, 0.013967645325569076, 0.014305640974732097, 0.015352162542109615, 0.012280584837981228, 0.01381203996953617, 0.015574121285586768, 0.013440961934703653, 0.013889572424670711, 0.028529711428171994, 0.015048787073206966, 0.013503939297520745, 0.016097877987227338, 0.014590586299313639, 0.016450080784319646, 0.016791216088824536, 0.013181793482402178, 0.016278337348575866, 0.015826971499953917, 0.015498869853498775, 0.020295996970788953, 0.018379537826323494, 0.015022660488228957, 0.013168336803228847, 0.013142874238793373, 0.016156256046081105, 0.016297662937377298, 0.017232497606036203, 0.019818152516988544, 0.014551647957193882, 0.016645247929158138, 0.01395901672517691, 0.015072166040435384, 0.019925389422003528, 0.01733520367234442, 0.01673854957551999, 0.01517537237507535, 0.01997949058641607, 0.016808956180249236, 0.014522381622222936, 0.014536662801471591, 0.015330388926253146, 0.013841923844351879, 0.01610329062904896, 0.01473474549151482, 0.018775920477540127, 0.02586407695284894, 0.0182869282309497, 0.017075221615269406, 0.014347517495510088, 0.013655978601968093, 0.01836719529015865, 0.01727933529914039, 0.014870488478760626, 0.01859979670767046, 0.014388482550044643, 0.01527275042795832, 0.021823830782746897, 0.01708796878327965, 0.015431486378637425, 0.01609790609658345, 0.017247267692915774, 0.014559040125088804, 0.015317905996461325, 0.01852186619817134, 0.02613548971463588, 0.014344305518089807, 0.019285894083636762, 0.02401352760980135, 0.014584407344231394, 0.019636238926763944, 0.016883489977587308, 0.018541556312965522, 0.01634723900660405, 0.016244016562826168, 0.01657081933970586, 0.014156391729551212, 0.013501309779126128, 0.013744003806776647, 0.017700493824159887, 0.016605259232669336, 0.014506274672045587, 0.014388276541704633, 0.013763875313915128, 0.016976377964521255, 0.02089815311485899, 0.01706732204619577, 0.014564510294124968, 0.0140630922035727, 0.015236457474730266, 0.01681573127653516, 0.01398780675294714, 0.016264707590544582]
lvec2 = [0.024766853278696033, 0.01454198002445993, 0.0161458885139843, 0.016908590726111974, 0.025279700066027474, 0.0175232636207084, 0.016239189364312775, 0.01691502733720573, 0.014579417495716255, 0.014958766018097917, 0.019658791476916217, 0.013579406150684193, 0.02181846855079514, 0.014416824255679644, 0.017533594456837005, 0.01487585183144262, 0.028028886154187405, 0.01685507493642507, 0.014816505818540472, 0.014717772414096116, 0.0152654342835879, 0.0178319089894688, 0.01597177225394316, 0.013042690606654249, 0.019084722101154354, 0.016915857473045304, 0.02060579253854856, 0.018107431799050687, 0.018905117283442286, 0.01441307578885918, 0.015228006914473173, 0.013828226720648394, 0.025609856534886195, 0.01653387017503252, 0.015315754493280547, 0.013066266348003506, 0.015874651989106897, 0.014512939819398487, 0.01609903519607435, 0.015496725103361836, 0.017179510336826652, 0.014965317697111076, 0.014158923204647523, 0.014962064382520188, 0.022232125645825784, 0.016607324479914896, 0.026472365169436414, 0.015701967371705976, 0.015208805909970272, 0.015067699758516658, 0.018428266987087393, 0.016469588391343496, 0.014491671474673097, 0.016691671070986062, 0.01635655406687778, 0.015355392117071601, 0.014592052256620558, 0.016227873664195463, 0.016637088198021604, 0.013569417681883942, 0.01535138966811449, 0.016304515569218726, 0.015850404316867888, 0.015304003677333583, 0.016837597965476136, 0.015849441831984296, 0.01556951610599422, 0.017834765172636893, 0.018286739135325907, 0.01605728544811477, 0.013238323387749875, 0.016266413195633114, 0.01576160319688049, 0.014107041143565742, 0.016441434703794843, 0.021831210896933535, 0.01371392322181837, 0.014761190570606396, 0.017488549554315377, 0.013200920265686263, 0.02616819476831859, 0.016206043263939967, 0.015085535642169027, 0.017988531761294155, 0.015982797007586598, 0.016101304443830365, 0.014714062194647107, 0.014870891081581147, 0.014744957721266076, 0.014797086799666355, 0.014038659515161974, 0.01471815197415115, 0.02698202980487384, 0.014896877304976897, 0.015038064008621128, 0.013973594238386617, 0.018628316377312017, 0.015514385319896592, 0.024708578573507285, 0.014216675177939226]
lvec3 = [0.016459230134232422, 0.014287070613821961, 0.021825050406159365, 0.01815185930008465, 0.014607486842332512, 0.015484190524736043, 0.015821838267261756, 0.015424575990898219, 0.021887690668935044, 0.019015050944321446, 0.013370796955304107, 0.01700799196371329, 0.018820811276503546, 0.01565746235321584, 0.01720520601210335, 0.01835381522159586, 0.013540991984582683, 0.019105972604164693, 0.013106530650273878, 0.015344914757145901, 0.015220790778377888, 0.0154046455828251, 0.019204383775764066, 0.01376637869198713, 0.02455575358100589, 0.01333580680815884, 0.01715999824507916, 0.015190946709242285, 0.022487170387715166, 0.01684430723821976, 0.018245452164076564, 0.015818316162331023, 0.014530043555980345, 0.014104684843861274, 0.014877635245291732, 0.01597366705012942, 0.014195697069316946, 0.015094564249371462, 0.014503165412274399, 0.020356626868590032, 0.01716282723724501, 0.01472519035492352, 0.013868433657901878, 0.014354166935914061, 0.014643165555588825, 0.017098737074502768, 0.015847476826497033, 0.014077134369415252, 0.019532952628637672, 0.021736521698789996, 0.015437630223566671, 0.016601616290311455, 0.017055644881562873, 0.015033105758020367, 0.014695826023711783, 0.020578261225451266, 0.026080614777859144, 0.016207573824929825, 0.013405849980065639, 0.017107527183092823, 0.014483583461587205, 0.016570665089906345, 0.014596322414085249, 0.015764470214075926, 0.015577367385806758, 0.017003078104815092, 0.014210240062481493, 0.014968787564255603, 0.019170797448213164, 0.014079870724386658, 0.019161072017522252, 0.02010241275915394, 0.017796110311646633, 0.020728308144928865, 0.019582402922643075, 0.023373108749443833, 0.016716285864002752, 0.016807189199673906, 0.019170427167093204, 0.01712898433137234, 0.018895598653581706, 0.016437401574634993, 0.014633200269608708, 0.013473354206186438, 0.023770397813563583, 0.013830632749182581, 0.01921755302563948, 0.027168211341788852, 0.015884700286558067, 0.020663317335320366, 0.013489346510451795, 0.01439497089579836, 0.01895813457074343, 0.015232029861189461, 0.014524809525038082, 0.014589349241216128, 0.022089212969029097, 0.019482951860347673, 0.012878966920961443, 0.018427238264868317]
lvec4 = [0.021182408918629398, 0.01832445507318579, 0.01806786118509929, 0.018794453584366287, 0.02024792091830905, 0.018755201084612268, 0.018421702601463506, 0.020595096149644106, 0.019751333571858282, 0.018524790966781588, 0.018545410785263967, 0.019531164100154094, 0.022122691294826087, 0.017495789292451217, 0.020432380841905164, 0.02080369472369352, 0.017929292936005474, 0.019722796597231064, 0.021195874476694295, 0.01795091872658417, 0.018187945918339932, 0.0203114499112587, 0.019465336685766874, 0.01965095792222035, 0.018948535716893103, 0.0180595922197832, 0.017750410473951067, 0.02017766269312228, 0.0190690209582989, 0.018378173495447306, 0.02022123869011454, 0.02050229156295585, 0.020808333140097463, 0.017609397349447626, 0.020814116675301395, 0.018812092201099424, 0.01646423827616787, 0.018262452362930278, 0.01888068123804456, 0.01775585229562266, 0.017819532255556488, 0.01773349345936528, 0.024210996056503797, 0.019756458917665864, 0.017566094279035063, 0.019641229384664168, 0.0183035516778828, 0.021409288633579465, 0.01719796696524052, 0.020186404448030347, 0.01843167929181166, 0.01991393763637761, 0.018659044440893325, 0.018934693028550907, 0.020243991868448507, 0.018457179977491134, 0.021972903319364447, 0.019136139794685612, 0.019938969123752703, 0.01631240142259806, 0.02263144790610495, 0.019699955823627588, 0.021976613975280283, 0.017077464789697367, 0.01806639528874181, 0.01955829787184, 0.018969815660721718, 0.02184584005658448, 0.01897005341116264, 0.018656660599434306, 0.020639283468887035, 0.01947657325682779, 0.019513283118715655, 0.01892513499623692, 0.01816955429641798, 0.017373209663096367, 0.01748214740908714, 0.019184296241283906, 0.017479167864527703, 0.020399134864694763, 0.019212958465399874, 0.01882043498410312, 0.019340008654006497, 0.019790731517372696, 0.0195264997354922, 0.018157334429094844, 0.02054678508732044, 0.018018947082017484, 0.019900159288903378, 0.01669610715715738, 0.019916102153026492, 0.01802096442465314, 0.018488086227508162, 0.01820882979414472, 0.016947508818987902, 0.02091333154408282, 0.018674538575119637, 0.01981674735594602, 0.019755918059097387, 0.018046593772559176]
lvec5 = [0.020576021995382054, 0.014125970160034963, 0.015289198749006257, 0.0188508757976798, 0.014464601884719258, 0.0317511270490917, 0.01597939064754661, 0.02260594191911052, 0.015836198839109306, 0.024134014540861035, 0.014692787882409932, 0.03291671076053293, 0.014301716521285753, 0.014069426539921838, 0.017326391676754854, 0.026410143366564384, 0.014863035860250088, 0.015951806039137595, 0.014895916946232657, 0.01517373751864449, 0.013800600808681155, 0.0171412112433313, 0.01984262350163895, 0.014610173267061146, 0.014081591048333985, 0.015549164690397426, 0.018028168563151082, 0.021439814192121105, 0.01578783828957672, 0.01566038717865255, 0.023401930138330616, 0.016720752063125836, 0.015773999619183382, 0.014761302071763802, 0.015090816682818252, 0.013150110676658921, 0.01475655298306671, 0.016237839860145153, 0.0158897729701401, 0.01559363146781761, 0.017955583737826224, 0.014739828005287507, 0.014762103266121198, 0.019478833828565297, 0.018056986424977314, 0.012552298235827637, 0.021982752259170353, 0.018724305124088785, 0.027150818792069962, 0.017953302776190592, 0.016238097393324463, 0.015470680490619252, 0.016482472971264372, 0.017731504536871914, 0.025262848188978587, 0.019632922146437585, 0.017569239640018258, 0.018270158950241314, 0.016555438369582023, 0.023804672247615805, 0.016481218910417213, 0.017143484737621936, 0.017306932164804053, 0.017322467605761598, 0.020650472041818347, 0.014101343799039004, 0.014481252074032135, 0.013718475949077387, 0.01652453294401741, 0.016823820395598002, 0.01803956748982207, 0.016861010067475084, 0.02256822886570356, 0.02060237598686598, 0.016610935663578925, 0.02822604773961096, 0.013481506237182318, 0.021610115022253816, 0.015286912665586972, 0.014525692988662877, 0.02118802935710763, 0.014115087133164506, 0.01785554957287843, 0.015281116504722164, 0.01705604900460368, 0.0137232223434176, 0.012866197609341315, 0.017069334758243463, 0.02401144335656192, 0.03010902277251383, 0.014335739405538329, 0.013078554150529852, 0.027717585180725715, 0.023730850827713885, 0.01686373175359898, 0.018852002289910068, 0.017587170075941884, 0.017183907701630138, 0.015603945172650121, 0.01527037706697287]
lvec6 = [0.015311423497859588, 0.019326402509575936, 0.014472075075513137, 0.02306713396691687, 0.013156374508323198, 0.018445434020652768, 0.014368572212225175, 0.015102577083132085, 0.014714582286761644, 0.01637026486934384, 0.014323113746705855, 0.014943190074989069, 0.013370825128371382, 0.016002956265069417, 0.014435064981260265, 0.017589754366837507, 0.01959212153925876, 0.017757661957508806, 0.013275615993986923, 0.015386089819434108, 0.0165203651120322, 0.015677188368064282, 0.03075113819972513, 0.014204901085615996, 0.02589057330671301, 0.014716845114405004, 0.019127197615383805, 0.015421463928714097, 0.014753505640364881, 0.01653405415566765, 0.01591629819555193, 0.017912116042776146, 0.01485814100785891, 0.013631762743681004, 0.013402469092263489, 0.014086119814376625, 0.01347523693567273, 0.014632142251223897, 0.011998242654708738, 0.013511338686500058, 0.022666591567698537, 0.01316528078057544, 0.024837024883442003, 0.015551119469020857, 0.02509442724059841, 0.01395179077041428, 0.018029827968850522, 0.014297979485258473, 0.020789551661234206, 0.023358007132500334, 0.023392157154228512, 0.020622029536310756, 0.025080337363939283, 0.016919059317657636, 0.016401953760981455, 0.015355013802754086, 0.02164346771710618, 0.015767302743583747, 0.0162382251367808, 0.02022376155450981, 0.01782145888865995, 0.017923627048444288, 0.018721699435938547, 0.013829128496394325, 0.016835893330841442, 0.017270438236623734, 0.022848575086123955, 0.015456721625877747, 0.015930152812510964, 0.015318393796307589, 0.019209900032497406, 0.01643362012140531, 0.028934819302786196, 0.015174591523403709, 0.0139043560352741, 0.020109286141789705, 0.013647411639143679, 0.014461229672117373, 0.018014307560828675, 0.022440185769296905, 0.015206163603804121, 0.020094787914433823, 0.022028533517128204, 0.019822391228408835, 0.014045393964715727, 0.013059188903063386, 0.016818261603918548, 0.016108470116375295, 0.013863256049214671, 0.01605785876208328, 0.022644096896228903, 0.013173079032773446, 0.015616731117924275, 0.018551976709485486, 0.016065111257250308, 0.013537859570659918, 0.014223157713231415, 0.01717862648320927, 0.012882349771956469, 0.01750816750111687]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 6 tests, Omega=100\nPMS Loss, t=10%, overWtFact=1.')
'''

'''
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=20%, overEstWt=1.
lvec0 = [0.01728729014931321, 0.018471918342130782, 0.015683815599280424, 0.015655644941699742, 0.01815963047507897, 0.016801844559582856, 0.015629703051773167, 0.018667554884051873, 0.01694482368386538, 0.014746901954150772, 0.014511976508500144, 0.014327385602907217, 0.015125668584179587, 0.015636987332666597, 0.01729784455744154, 0.014158589944664316, 0.015345482843518337, 0.017517073677329714, 0.015236045719924433, 0.01574874721197197, 0.014811074533242265, 0.016513239471657427, 0.01756957743712494, 0.016526385939271814, 0.014498931361412379, 0.014686115574308909, 0.01814130256363459, 0.013196227539490535, 0.01614853257782514, 0.01464580171145139, 0.016588128618273617, 0.014708487192838866, 0.015229236043196096, 0.015655408973299, 0.01423463657893135, 0.016900325200930457, 0.01526207375456269, 0.017025407848797334, 0.015949368022818693, 0.01672967442520684, 0.015566220069113713, 0.014877788396696788, 0.016532683527538256, 0.01489299676941007, 0.018434805569295786, 0.015626388941818416, 0.018462144367519907, 0.016088292887917178, 0.01598556700861214, 0.01813060697236665, 0.01748285230383631, 0.015952081074120245, 0.015934857447889937, 0.01631107875631688, 0.014395901572940437, 0.016774226164355033, 0.015774822741543643, 0.014651481249148833, 0.015169218184766922, 0.015561234349167211, 0.014852819791934993, 0.015986662328284423, 0.013707709221989365, 0.01432375288443756, 0.017330994747413498, 0.017588973428084402, 0.015934202622139536, 0.017325621081784794, 0.01727693418743328, 0.01958756003914346, 0.0155956147322963, 0.014714654850202928, 0.01515572234174987, 0.015026373261513477, 0.013666265862091635, 0.01641067308567396, 0.01764512718171291, 0.016824135324949682, 0.01604824804692429, 0.014521177936402773, 0.015465804772273165, 0.013949171357429966, 0.016500671732389262, 0.014426041088188981, 0.016149849135599137, 0.016658025535992094, 0.01591683065513411, 0.01393257519035395, 0.016294422425590684, 0.01632693554201407, 0.014330754019540577, 0.014089032583448605, 0.015464704287658384, 0.01474551726808667, 0.016421839985492837, 0.015885368682801344, 0.017222461901998685, 0.01686571720413538, 0.016491702089873047, 0.016079065150581707]
lvec1 = [0.008391605533154727, 0.008867692915398762, 0.01235347981023735, 0.010520755527905148, 0.009824725643581507, 0.009113627443215816, 0.008578931729146044, 0.009823466749820842, 0.008015610018936258, 0.009120035356041136, 0.009592994799732604, 0.008680463500052285, 0.009140487276852686, 0.0094363492144605, 0.011836668971563593, 0.009926257193627148, 0.007926548140718404, 0.008352776802650773, 0.007653444452899067, 0.009493109524987504, 0.015862656916880685, 0.009417167373324984, 0.00824375891232307, 0.00820770494929278, 0.01533634552964456, 0.009994384983732039, 0.010884056214420039, 0.009538434170745047, 0.011278067911927685, 0.007468704164020146, 0.00845515665626566, 0.007674533259566625, 0.008870481715271127, 0.009501868434742903, 0.007941711140138998, 0.010703082453916374, 0.010470585186558799, 0.008877269395963321, 0.009004273659678206, 0.011442294922740437, 0.01839170933567517, 0.010011384431986922, 0.009096872815985367, 0.009049021475586507, 0.010631267520059112, 0.008269763355271496, 0.00794868580003554, 0.009158371964665695, 0.008067848730983505, 0.009261430739131224, 0.008774431742415777, 0.009695582478327771, 0.010296565748753185, 0.009501144944291839, 0.010023676194523082, 0.008724919157155848, 0.012035844880253886, 0.010547398407099883, 0.010170407763814284, 0.008174037000176501, 0.009990503781937181, 0.01010148895801915, 0.010408880727384301, 0.011270746506613668, 0.009825759825816589, 0.01120519222445761, 0.007808293877560399, 0.00935853500490824, 0.011617221435826382, 0.0086646115880574, 0.008192402550540734, 0.012025934780471977, 0.017932431042901154, 0.007857337607931239, 0.011710561599298609, 0.018474289040025425, 0.00976246957440904, 0.0096915640358833, 0.010400271487859337, 0.01035172564081102, 0.01008009918012806, 0.009371665494509442, 0.00899337512887673, 0.007801515168438731, 0.009444581258841915, 0.0073973128907510646, 0.011451528071379712, 0.00893154344871807, 0.009715070114127443, 0.009191359230868931, 0.008499607726698907, 0.01030806034170421, 0.014594004520618984, 0.014184825812449795, 0.00940949487397833, 0.012130709579070954, 0.012068315042730433, 0.011161172795762037, 0.00897840649878541, 0.008269550560804943]
lvec2 = [0.006877109316637901, 0.013179602135788001, 0.008465837483962589, 0.013334031837735726, 0.012380130334511054, 0.006424857015871693, 0.006979901529813544, 0.007221924188637552, 0.00903907946240148, 0.006740854286361001, 0.009623908230803186, 0.00688444756921271, 0.008654704169185989, 0.0087906201380175, 0.00737406135537556, 0.010444701696707814, 0.007259024212425955, 0.00676215110591187, 0.01312638167080718, 0.007797016914678759, 0.007842157135745926, 0.009460379450298083, 0.008770116148335488, 0.0070956501102529814, 0.011202585140558876, 0.007249944824907526, 0.010468430697202413, 0.009712189955263835, 0.00732574374864788, 0.011047962315702589, 0.009980564055608862, 0.007051479114819041, 0.008657603018467545, 0.007212499044832867, 0.008755711392075453, 0.007328399624187246, 0.007779422197257905, 0.007466867964075837, 0.010279332197531693, 0.007730996433097717, 0.019425089277929294, 0.007065668451254058, 0.006521945651238206, 0.010215525780199144, 0.012209754204385099, 0.007692383188208813, 0.013497180723962077, 0.012123451896550735, 0.01000439767894141, 0.0076102198813320105, 0.00975779193160731, 0.007101060701625442, 0.009892336401060516, 0.010097513034372391, 0.011109246013397259, 0.010125960267903418, 0.013925664609214012, 0.014244227669805602, 0.012401274421436107, 0.009341695812635534, 0.008750120801769408, 0.006812160002525217, 0.008072493973671775, 0.0072879633858621545, 0.0077001649300828204, 0.0071767483712794206, 0.011092870990126364, 0.007225181789956158, 0.009187633254617295, 0.007662831054673267, 0.011127290247996283, 0.0070631400158141285, 0.007647658001407184, 0.00755339417266755, 0.006718757691364237, 0.009411649995888853, 0.008256513657986924, 0.007996736000209769, 0.00659288037472716, 0.006866160214167135, 0.007889048624701073, 0.007633293695562305, 0.007587803661882176, 0.012554742563830702, 0.011179584951055808, 0.006505618930586171, 0.007225490985040163, 0.00719013380714886, 0.009690571074134551, 0.006697696187556011, 0.007507124040207948, 0.010489478419691277, 0.008761902951026987, 0.007770791622781221, 0.0068097237249886465, 0.008480773691495273, 0.00795942259197447, 0.010984380155486187, 0.014297675874621133, 0.007486985706885072]
lvec3 = [0.008704894299401219, 0.01251608269536652, 0.019969957480827687, 0.008778850406670643, 0.009270050870622071, 0.007638237731191134, 0.009291096169706522, 0.00790597784131658, 0.011909779066634051, 0.013296665360002444, 0.010641374583595691, 0.007919257479208222, 0.011525301292040277, 0.00823666114438279, 0.013036094873758725, 0.012803373610898484, 0.013735749570152396, 0.010877454706844779, 0.007507172492005733, 0.008944514796438836, 0.010722656555888319, 0.009316113248517237, 0.01079262636450678, 0.00979851082712124, 0.009579699072138795, 0.009794932623813733, 0.012109986243450374, 0.008651274161838987, 0.011990293668341133, 0.009135991273147471, 0.009004921396594898, 0.008501910548631784, 0.013697873689539218, 0.010877328624590621, 0.0072528519199907965, 0.008467480347943644, 0.008098207376223047, 0.013480682712185457, 0.010296930560991078, 0.012851214186690746, 0.013187967789639066, 0.011945035847889831, 0.00844323728249091, 0.00837854671131469, 0.013915422955621965, 0.010068827418127617, 0.00961942506447852, 0.009922439506294348, 0.012137900546964762, 0.009203930745882077, 0.008952757593012462, 0.00929396917113039, 0.00967053531959739, 0.010800098295205047, 0.00817463663652617, 0.01035299111072568, 0.007831017462838753, 0.011690616891453889, 0.00928384612510225, 0.011151722534301297, 0.010375499016057185, 0.0095534280184862, 0.012242204555721089, 0.01236603647930396, 0.010596893726302719, 0.00889629358529137, 0.017736917308214827, 0.009090368144728734, 0.013765343360646491, 0.008348238362082773, 0.01117401581261992, 0.011652109273629972, 0.00868412029854486, 0.013436721136965916, 0.009017248800378441, 0.011310156727563447, 0.008968495752270478, 0.008473871610713403, 0.008418897069356428, 0.021598628248068807, 0.010554733477448541, 0.011589237058074195, 0.008662204338243234, 0.009824745228104574, 0.008953206733102, 0.00816571203394725, 0.011166177761758206, 0.009245831994019493, 0.014461832363124861, 0.0079838045239295, 0.010182264415239275, 0.011833515899512561, 0.009146934663475239, 0.0073656870546474655, 0.011448910099155307, 0.007323524457746214, 0.010418893420791513, 0.010125904927763173, 0.009176641595467105, 0.009253891435318767]
lvec4 = [0.01313728434194406, 0.014209787254099623, 0.013582828229842366, 0.016564622364124676, 0.015456649476796654, 0.015234020710421245, 0.014952765606946925, 0.014047163435387927, 0.01316697323831591, 0.013257194978201704, 0.015431073311758435, 0.014914270989156512, 0.014082693491683182, 0.0141812355344424, 0.014290286330093006, 0.015490954090449111, 0.015211553907963528, 0.013353555795092825, 0.013726416989302636, 0.015630208555056497, 0.016084208878214136, 0.015157649244095683, 0.015180944740514582, 0.015031592585199127, 0.014902577540531, 0.014805077647729764, 0.014216146590376465, 0.01399274406323584, 0.014672269088150088, 0.014402756948679851, 0.015527670456972101, 0.016554892841454463, 0.014121675799494488, 0.014458014026406696, 0.01702621003154555, 0.013525856417398396, 0.01612805197647894, 0.014411585448695311, 0.01771761436772946, 0.014029471067672043, 0.014888669658395023, 0.017843862396196317, 0.018840947181238216, 0.015067070654116213, 0.015547297232460459, 0.013509689875926425, 0.016671001822966134, 0.014850645073740091, 0.01447972084071085, 0.014113163706208165, 0.014063862801915716, 0.02056055341250483, 0.017970852368287275, 0.014565212228337837, 0.01458190771211449, 0.013835272196040806, 0.015964797850263657, 0.014395312308500833, 0.015680330958318205, 0.013500048369105466, 0.017517398887550974, 0.014297610905285267, 0.017166520545467565, 0.01276366706852271, 0.016290713087804887, 0.013928197895845054, 0.014213149685924471, 0.016482870380946018, 0.01410778555523349, 0.01541303363486504, 0.014589514081010837, 0.014861932524754604, 0.01694524294398754, 0.013704503855824491, 0.015354771191925692, 0.015572137962320109, 0.014877444301922473, 0.019754825816910012, 0.014876646477063365, 0.017312818009530582, 0.014972840796842923, 0.015671687742587634, 0.017951728687843005, 0.014142248949609712, 0.015002684031329507, 0.015174460913228984, 0.013771326037521996, 0.012298346959153012, 0.01666415443308102, 0.014945269534251519, 0.01438888283019336, 0.012846572711658864, 0.01593516146793305, 0.015266855642109074, 0.014568620113549358, 0.016083686042984126, 0.013859416710623388, 0.014024420095223648, 0.015993993059609857, 0.016436923478425423]
lvec5 = [0.00705897684385838, 0.008583453863977963, 0.00822673299724233, 0.013565984375809716, 0.007635229614938759, 0.006627506503580114, 0.008050343841311026, 0.015717895703363814, 0.007668898512021309, 0.006757898166454954, 0.006537134755125903, 0.010379883135560163, 0.011602619512971188, 0.008833023521846192, 0.007499090336239253, 0.007031684562320429, 0.01546869155058592, 0.006532197360706497, 0.006923154848783764, 0.007653255043206677, 0.008002099829339467, 0.008200091411120042, 0.008006254855676293, 0.00866599740593845, 0.008522696752559133, 0.007779704398812774, 0.013492878622622174, 0.009658038393727376, 0.006798213021634036, 0.008249646010089918, 0.006689761579354938, 0.011272128191378067, 0.009893875820582453, 0.011701509065043332, 0.007720302358216688, 0.0075781464610286614, 0.02188643328942683, 0.009746023447111443, 0.010136129134250242, 0.006589866931495101, 0.008186705455559547, 0.007480513245487152, 0.008383728384335922, 0.012999806922719015, 0.0074844594626065275, 0.0067657051041183375, 0.007791249987940374, 0.015335129942218315, 0.006860903399606504, 0.007526655442220837, 0.00807603078412193, 0.00946083008057908, 0.01126426885281429, 0.008570797641190982, 0.01290100908996034, 0.007090188696605776, 0.008563576946991995, 0.007593046875917991, 0.006553798643705189, 0.008186632417566366, 0.012691379480342317, 0.01144015797044641, 0.011604717567808311, 0.009556810696312635, 0.00802904322793259, 0.008260724777120443, 0.01031818806917972, 0.009352448158637507, 0.014411963467581609, 0.01089833223202352, 0.006670608758788378, 0.008582313328165916, 0.008968743547936586, 0.008204952236707136, 0.014578698084179855, 0.018250643782040714, 0.008711604890481787, 0.006828019069561203, 0.013842474416691768, 0.014200446263629832, 0.009310380807646932, 0.008713365874981938, 0.006998674093556041, 0.01177610059054582, 0.009902918055217865, 0.006483253740461586, 0.006481818642548819, 0.00694752163034347, 0.009851756663543139, 0.012470157453592763, 0.007308162545278951, 0.011598709614056239, 0.011274448738389583, 0.007312734266171595, 0.014871822012607113, 0.008845513382996249, 0.010449702431151151, 0.009387735325017682, 0.012061951784188478, 0.007999544005310852]
lvec6 = [0.007042059630777488, 0.006822614175573789, 0.009695667694790305, 0.009606716671986572, 0.012544471884818905, 0.014946429853576535, 0.0117123643967494, 0.007425356472852058, 0.007403685205447895, 0.012678415510981703, 0.0072122060779232725, 0.00658494420153568, 0.009242523396988792, 0.007083215977486052, 0.010813935894511666, 0.006974617189987063, 0.00935244930227681, 0.006197986326767704, 0.011954158119290709, 0.007353492091119611, 0.009771829478679255, 0.0071805800624448616, 0.012943212770799715, 0.006368757074100224, 0.008360774344183957, 0.010191432540216296, 0.015628514483336707, 0.006975359325896849, 0.009886964351849957, 0.007903344910441444, 0.009031556128687003, 0.006650675462109655, 0.009632990757033062, 0.00780917019668244, 0.006223364260086694, 0.006966982817250484, 0.013843129151467952, 0.007175515986372118, 0.006632229075960022, 0.006495751398786483, 0.016210460714369934, 0.0071179629535057624, 0.006848579276602457, 0.011169786871059078, 0.007096464567273727, 0.0066407390887585046, 0.009663798688972491, 0.007425148215050655, 0.01072751477918369, 0.007507504072422916, 0.00756509003769649, 0.007171557330010366, 0.012102929756980324, 0.01217839333326704, 0.010908914253772254, 0.010265167467251105, 0.008969243863090986, 0.007601956558299698, 0.009789930580015073, 0.007314381504218152, 0.0074790932273756695, 0.0077749018446602435, 0.008093106322705981, 0.007186142540498965, 0.006994495615730398, 0.00746825535086623, 0.014581838929754624, 0.009047996147329885, 0.008672352257142538, 0.010714850395392677, 0.014368805749173909, 0.00739991251117953, 0.007569250350530316, 0.006965266680498088, 0.0070491954111052855, 0.008995720503849359, 0.008737801672075454, 0.0076205051587823845, 0.006304549108367185, 0.009937219142699323, 0.007137731268679045, 0.009333364433423749, 0.007324076552893495, 0.012459924025041695, 0.006981335267440186, 0.006015499517350092, 0.007490081457927423, 0.011500405035150424, 0.008341740109078686, 0.013480684573196, 0.009059275227627105, 0.007962494342602823, 0.0126927628597253, 0.008128467958722442, 0.011342648830491247, 0.007228812093276274, 0.010259101596250248, 0.007918634601128217, 0.011556653549985809, 0.010771856392940087]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests, Omega=100\nPMS Loss, t=20%, overWtFact=1.')
'''

'''
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=20%, overEstWt=2.
lvec0 = [0.05340890492585494, 0.05820017119639504, 0.055159621028566225, 0.057705218754149135, 0.05008418734353597, 0.05068222583887698, 0.057256353483709194, 0.04838922623195669, 0.05505163393021836, 0.04829490878044514, 0.04856237371039545, 0.04964113804040521, 0.04821105712194246, 0.047369563952574585, 0.05033829135671399, 0.04837618067469676, 0.05395620043017826, 0.0518434439862483, 0.04680935095027758, 0.04973823308765938, 0.042744926637013556, 0.047825986245281796, 0.04457737798883909, 0.05837179903976296, 0.05299601352220734, 0.047155128271289225, 0.048430817248152846, 0.04951043748671617, 0.05234970762388437, 0.04797153964804197, 0.0511053293087705, 0.05162329325350428, 0.056260694752954504, 0.05147112632544638, 0.04874362138960874, 0.04798347863133063, 0.05108102226137571, 0.06119594659728703, 0.05746380616998718, 0.04734862832927931, 0.05401004213011451, 0.04834687639581981, 0.04152618042916643, 0.04864473653732238, 0.042832424883722305, 0.04733849160331509, 0.05087200969562211, 0.04789446748363723, 0.047818418549174777, 0.04985226336769546, 0.056070022179740484, 0.05520464712180312, 0.04826654900750391, 0.0466577144913161, 0.05034870650359856, 0.05148843739044203, 0.04856768137903386, 0.05468481697643511, 0.047834368298967665, 0.04998374266698511, 0.053775292611699915, 0.044461189309672564, 0.05508323711599948, 0.05042060321776053, 0.05378292732268146, 0.05010994539330754, 0.054864269768104504, 0.048141195855994856, 0.0505201182421093, 0.0565111008072209, 0.050674275121562244, 0.0481058889203885, 0.04772936082272347, 0.04810618988776218, 0.04926513014834792, 0.050936820825523275, 0.05328159174537579, 0.05370889365640707, 0.04832891056845242, 0.051301142318596754, 0.046423711369078, 0.044768906827016404, 0.05041247529558998, 0.04674170581523738, 0.04722664864183755, 0.04589364535246836, 0.04412781155810311, 0.0592162443718002, 0.04607663271768663, 0.05133990997345871, 0.04644193000252004, 0.048587047189224464, 0.04714104542673156, 0.04924516293205036, 0.050729552613539446, 0.04787657656906362, 0.04737779650534382, 0.05545101147544792, 0.04722627325878679, 0.04720880100712451]
lvec1 = [0.03094612835315418, 0.030257605877113687, 0.03480553077335599, 0.0380699548362595, 0.034680389566741625, 0.03892570926088197, 0.025335643305804095, 0.028379607989158073, 0.02511955277840401, 0.02688871664779657, 0.039966243486302164, 0.02742863189997424, 0.0327002999620347, 0.0327536338899513, 0.034365378502693465, 0.04244398168502166, 0.033950945301795044, 0.026651925108567367, 0.02626621578862567, 0.035336136101455654, 0.04750984547008351, 0.031911380539757464, 0.02578800748956454, 0.027649995031152903, 0.0471072297329486, 0.03079018957826006, 0.046922512636985, 0.034208523940849965, 0.03886079257836491, 0.03160124961608294, 0.02469613423514184, 0.03365193146166961, 0.03041247494728862, 0.040901515272158184, 0.02547118968522499, 0.0383388876990225, 0.027083714905809672, 0.03176289459230625, 0.03414738833535266, 0.043043153460287586, 0.06138850464847105, 0.03080588243613144, 0.028795059976046377, 0.031675469206856155, 0.04078695806395677, 0.026371152351685793, 0.027192532778686506, 0.028272381301327268, 0.034118719519769414, 0.04099201572851942, 0.03017749477019045, 0.03153752368747238, 0.03609205514628215, 0.03885028021554662, 0.03821302270648234, 0.02897749982997016, 0.03663174266205006, 0.03014145997306539, 0.030779846989158303, 0.0336788674832844, 0.029186010008385072, 0.03438210828707668, 0.044756610651206126, 0.039156149258411106, 0.04288663999534419, 0.030911909496838797, 0.03486907593782982, 0.025153918281819145, 0.04271447157930096, 0.033191827901596145, 0.02890654743562173, 0.05354584543221313, 0.038311934632009874, 0.02962817735661353, 0.03846079104334207, 0.06203780072193532, 0.03406943541511674, 0.028861898764463084, 0.029558152175233672, 0.03677302163647404, 0.037200397728578576, 0.03253483424600359, 0.03379234927412845, 0.03131557094585859, 0.03049691870026881, 0.02510315025680552, 0.04058299541547555, 0.03725894421265139, 0.03488511528061093, 0.03779207628631054, 0.028670156777577834, 0.033497125990465344, 0.05368841357897461, 0.03898363678328693, 0.03179975735370762, 0.03331926646132423, 0.03539111456193399, 0.07266950438748382, 0.027659942995514372, 0.02949830549381525]
lvec2 = [0.044473024192391596, 0.026270161123936774, 0.026571349963975383, 0.0473354269687873, 0.03709193264061455, 0.0288581383515424, 0.02139519955323484, 0.0240611286730907, 0.02377454362086177, 0.038182873951706504, 0.029707530870694516, 0.029901704269522898, 0.02848618750781632, 0.02195776530801455, 0.04744113045674639, 0.02921238750335341, 0.02911903124708006, 0.027016752170503994, 0.03474457159924231, 0.024102439960541427, 0.024408900757754187, 0.030965400358435737, 0.0421925434589638, 0.02093823296818666, 0.02430905652478868, 0.02245912920085211, 0.05479603596134192, 0.035987754365959294, 0.02327859511237957, 0.02887366740225795, 0.04170994627526647, 0.02319685872749705, 0.030541105453570506, 0.028472832381510126, 0.025022056675751633, 0.025346655347548416, 0.02233685652483131, 0.021972848689024535, 0.03122498157941839, 0.02615666600576044, 0.04245848159633734, 0.024807055649670232, 0.03302794002110626, 0.03091436468369191, 0.061598021453863956, 0.03124936524691525, 0.040363408607823247, 0.0318253460514068, 0.024176250537131315, 0.03345652490449575, 0.020450330835195044, 0.022128177062263974, 0.04591309011104436, 0.03561728848248467, 0.04033643559223796, 0.02137376793398877, 0.022796250149145585, 0.03980940797255285, 0.029710631117934476, 0.030432077656512173, 0.024738194249388147, 0.025638239835467234, 0.031429186165666236, 0.03639181754201111, 0.03795304389756812, 0.02200502369529581, 0.050992067688180015, 0.04547579938272329, 0.02323053346195974, 0.01875744814597118, 0.043685969010156714, 0.03621951691150437, 0.03672750655022714, 0.021580752968800288, 0.04278842111393421, 0.03757127586578734, 0.02573523107032383, 0.024722176113965152, 0.04666737080368104, 0.029589228052944925, 0.04296315925913225, 0.033561627359547014, 0.0436116633551935, 0.03525058972352138, 0.02319702722422079, 0.022533305645178546, 0.023400962947590486, 0.022924063812889403, 0.029602355374513126, 0.0439649382179108, 0.03967294708007135, 0.022999057638463927, 0.03234978180313585, 0.02327617176542571, 0.026716507986075083, 0.02613082099751597, 0.04912615583171179, 0.03482252278030555, 0.029983941091874487, 0.030287080079792857]
lvec3 = [0.03433816660405013, 0.0362956023959572, 0.03226846094121976, 0.02939335681570376, 0.0506824977132847, 0.03428759058980326, 0.040720600371290126, 0.028304341445502444, 0.028642851501753126, 0.031712554413840514, 0.026501649036022604, 0.026026383667764486, 0.025085375089780638, 0.03282374093992602, 0.0325814823022389, 0.02694126151946941, 0.03542453166193582, 0.030542582731412058, 0.03148858701532841, 0.0298944828069608, 0.03305614634441167, 0.03708411891937548, 0.04160478749389184, 0.02536697902787464, 0.027310216150442813, 0.03881259372391596, 0.03111547595114105, 0.027592006023762914, 0.06253824603315326, 0.03254247542906669, 0.03291244874805076, 0.025598615602011782, 0.02690853755509903, 0.036569867797944584, 0.026944873734638462, 0.025714057312926843, 0.03784230787171411, 0.03083841602172276, 0.030625711194457263, 0.030075928305301702, 0.04300799450411001, 0.03029164833410612, 0.03369292840229123, 0.038207354940619956, 0.04839138464765889, 0.0387051641419906, 0.029116708956822935, 0.029247031091477572, 0.06316910137523152, 0.026815210266601445, 0.027785702772533907, 0.02854173489377515, 0.0494011619407984, 0.04278929331425377, 0.02833794004443708, 0.027724863106140224, 0.036646135038302774, 0.02831180198827037, 0.03899566424744029, 0.0280415511950528, 0.034349604094312425, 0.03844812786714566, 0.03044562019104477, 0.025085236376715652, 0.03139415072079574, 0.02949097562680032, 0.08757169224683328, 0.03279749687117172, 0.06321082758457548, 0.03224469981938111, 0.038669637295341217, 0.035709898936562304, 0.030134995566322303, 0.051946077076087255, 0.031802204786563586, 0.07969314230049994, 0.025885788825280635, 0.02922666256224963, 0.03144394274112948, 0.038359529644468836, 0.03451070383965132, 0.027021801816584007, 0.03654259052879759, 0.038711231975959826, 0.04903174596616006, 0.027370257208948395, 0.03191554097317989, 0.029091134026932596, 0.03086330508231974, 0.03294689338055566, 0.03163125480385242, 0.03202347815787701, 0.06641511928754558, 0.05179913572457603, 0.029174286714215666, 0.033764549488031426, 0.03779378163654503, 0.05977521750433493, 0.029811994867374413, 0.0264178081507404]
lvec4 = [0.04675498012097751, 0.045806620476635494, 0.04681399596332623, 0.04937683916127961, 0.04680452933651166, 0.04861116552162853, 0.03926372929600427, 0.05079962467031455, 0.04714192051567956, 0.046652264269953385, 0.05385900108766862, 0.03995579282288011, 0.05401564464458795, 0.05040213784084813, 0.04462205580431971, 0.05067336261057559, 0.051991744729103485, 0.04428323735169167, 0.046834339278649655, 0.042973145115758636, 0.047544575402863505, 0.04818518396652716, 0.049724239840735714, 0.051468603929282625, 0.04749434110345636, 0.04899869104157339, 0.045922477222516404, 0.050636031735313225, 0.04808216594041665, 0.05157478979873349, 0.05654727647708807, 0.05197893205275613, 0.04488678215542313, 0.05047336807663794, 0.051105382423273574, 0.04558096710052999, 0.054042064928197, 0.04689312318692302, 0.04550627957429474, 0.04287025160142625, 0.05255586562798485, 0.06145644112619753, 0.05924917015504491, 0.051380932251782245, 0.04356313317964632, 0.04535839181459483, 0.0480259305777795, 0.05370052767806906, 0.04662279394399309, 0.04480009031506934, 0.0481379823228119, 0.04739758394188109, 0.05363083512137488, 0.055452662344538405, 0.05151547106290569, 0.0408520062283841, 0.05182648417586335, 0.04833317680600467, 0.05295067143400464, 0.05282650417090576, 0.056642266549299686, 0.042002770678151814, 0.04677920733297405, 0.04302253007257966, 0.045378726768707627, 0.04153979040320583, 0.04619316281626949, 0.06163460213902131, 0.04667948236246934, 0.054602373288829116, 0.04303148218530421, 0.0488191754248535, 0.051885583997373946, 0.04944164334939023, 0.05244525901516973, 0.050115547878546794, 0.04963227569060555, 0.04811408109899148, 0.048560056143374504, 0.04960921067335613, 0.0480974460956228, 0.04523152624716832, 0.04564212177046784, 0.046521252818547666, 0.04401273551904816, 0.04638668083374129, 0.048370685382226906, 0.044819615737278495, 0.05746052677432293, 0.04993582170025563, 0.04494662737357145, 0.050895451931209354, 0.044300522383970246, 0.049795216749271724, 0.056247256932143816, 0.04915208870954231, 0.04217722961454786, 0.043980860862712655, 0.054087836638843145, 0.045092061379667404]
lvec5 = [0.03290514329649738, 0.037069699734511984, 0.04538826657176474, 0.02729948656737812, 0.030161809222469454, 0.03773243990221078, 0.021024956757439935, 0.05012039930721904, 0.03262670746021611, 0.03563511827704842, 0.020636044275035015, 0.032212728678938506, 0.04760453127723202, 0.021012051814351784, 0.022229053656891696, 0.027642146535808, 0.024266193019010014, 0.02029323716125311, 0.022156307909854744, 0.022060918577354986, 0.02602220914748021, 0.02681871060785103, 0.03066778688070986, 0.019081654057232285, 0.0214544767800819, 0.031121935520260123, 0.04431461333888248, 0.027067297908216065, 0.02926527360459585, 0.02567088824416127, 0.03532928421739828, 0.024164403204495363, 0.025557513025302177, 0.021791464201117588, 0.03828810935095676, 0.0377578749651461, 0.029269527333803756, 0.024299047507482758, 0.05561391161439286, 0.03223161146262972, 0.06356255891176202, 0.025213466407581035, 0.02426613547373158, 0.030668209645638544, 0.06498531643770712, 0.021763435398520742, 0.031992322116304615, 0.02506409998078589, 0.039243212841626886, 0.023220505137086164, 0.025419134900758013, 0.030904871970183528, 0.052886787079166706, 0.026979987785827924, 0.04836290610740696, 0.02329466832665679, 0.022641587789771767, 0.032904965454555554, 0.030268541068914856, 0.041021258164745285, 0.05499613172713657, 0.023301922758528288, 0.025749199537249034, 0.038764589919399475, 0.0341777435758973, 0.027540703470262176, 0.04701681942870271, 0.03765668385424077, 0.03250163968010967, 0.022310368225932565, 0.04446495241477422, 0.02096393715896556, 0.026422864867788425, 0.03164268199278583, 0.029513653514399642, 0.05592620056773317, 0.03203644349124246, 0.032205709407876135, 0.02486941985519047, 0.024261906706886223, 0.038288377401785284, 0.03780997178266264, 0.046596625023343684, 0.030746986420074732, 0.030079778174779262, 0.022836552355112012, 0.02907171972798814, 0.029192042758475763, 0.03798754832954012, 0.029960063598900695, 0.0340948306376529, 0.03285568428350849, 0.05157638341334381, 0.032040116540517624, 0.05168450266599155, 0.023736791076975936, 0.03123105725978803, 0.03109560903865346, 0.04226442964434008, 0.021030479596285335]
lvec6 = [0.029804793424867606, 0.040641706957793795, 0.024244179422277093, 0.04651174738297737, 0.032428812363150594, 0.023459536491797064, 0.025366075280974586, 0.02578695058843841, 0.029599927111125995, 0.027567879679599814, 0.02054312507897707, 0.030211867578733224, 0.02189178142201914, 0.020548901459528434, 0.03145435989051667, 0.027950631071738705, 0.038250308851017475, 0.020434625748569565, 0.04897936772858365, 0.03489191786124935, 0.026045382494145685, 0.02604381776971005, 0.03264352891317386, 0.020061654028469506, 0.04614441910588079, 0.026506990423620837, 0.044142002105194006, 0.02185066946555683, 0.031392935345536305, 0.021771385418308902, 0.03130583859969011, 0.02181005718273604, 0.02565406824940755, 0.025638416377937817, 0.018402196652529273, 0.024214882572145914, 0.04555925311285528, 0.022997043346115492, 0.02954114552414229, 0.024358005578194165, 0.045652365251731324, 0.02740287095504684, 0.02777618376417831, 0.03338693382506874, 0.04857507916216406, 0.023866734536414348, 0.02770450010423948, 0.03495134636745285, 0.05510999042435775, 0.022873605450128037, 0.02191129522742106, 0.02339231724103373, 0.03932792413018525, 0.025547282329682824, 0.0376284472016498, 0.027904345624662857, 0.025649426103666197, 0.0225082077552041, 0.02949735643565646, 0.029237695861739882, 0.04993529898248347, 0.02279946789878314, 0.026166721014173916, 0.02377147971472904, 0.049209645949620864, 0.02080721932415891, 0.030320310241489463, 0.031887070871894, 0.02096028881315225, 0.023386171254537715, 0.02703711137770229, 0.025764012824661224, 0.023356015425569365, 0.022501096967773696, 0.02430656877779669, 0.04685181586775565, 0.018749589317671327, 0.02100716930522016, 0.027037494202994908, 0.023425876868243708, 0.019891479612049668, 0.03277896750408836, 0.02129327547872387, 0.039458589224535184, 0.02815999511444214, 0.018781224177517396, 0.02202212701552719, 0.019852140511552128, 0.032076193682865725, 0.029052303524138658, 0.0402624613725448, 0.034995419175426645, 0.034600337448944564, 0.034841659384959874, 0.01926692000508125, 0.028770447980100044, 0.030770242181674227, 0.05100224045149868, 0.0666664465633771, 0.021101965768194116]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests, Omega=100\nPMS Loss, t=20%, overWtFact=2.')
'''

'''
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=10%, overEstWt=1.
lvec0 = [0.020035734024549143, 0.02005656193917887, 0.019838639397240693, 0.017560466794934275, 0.021504543036655437, 0.023045427101543486, 0.01783876632503485, 0.01896114458360438, 0.018148308452504765, 0.01963240728159441, 0.019437764398729344, 0.017202316947839073, 0.019047276505884163, 0.01826058953041846, 0.021427059181959928, 0.020474495082370373, 0.02103253767716469, 0.021718029337606387, 0.019182769482559096, 0.019256041164082176, 0.02040860715328469, 0.02123261856392162, 0.01836102089666982, 0.01938819977525935, 0.017732299338895287, 0.018401177570401255, 0.021922651726948527, 0.02039555172621135, 0.018288139900648533, 0.019629707278157757, 0.021256252285283737, 0.019408451058677927, 0.02007780661290464, 0.02014467336854861, 0.019440264377966768, 0.01810461007136605, 0.02035530294271441, 0.019248428049639596, 0.018282830023999743, 0.01889048323953737, 0.0192682091696877, 0.017536671339772544, 0.020161186528483206, 0.018385904065852176, 0.017657366236783396, 0.020255316044950865, 0.021895317593223832, 0.01864019231876829, 0.02016251321309696, 0.021809316111135808, 0.01801960090756191, 0.01837153858434028, 0.01911530737382263, 0.021912200765645033, 0.016983764317013428, 0.020267887124186954, 0.020597627204944603, 0.019572475441050164, 0.01916220548828678, 0.019495534378778538, 0.020925062818310747, 0.01658070169752567, 0.01767826378093967, 0.017581383937292642, 0.018939540599909536, 0.020577395944041788, 0.01714086899063931, 0.019978643118733954, 0.018174670430843993, 0.018805658611580758, 0.0194408322151454, 0.01797371697395821, 0.018329733961094673, 0.0193077393438492, 0.02069589460486727, 0.018841317783546554, 0.018864414940786323, 0.017391695459093456, 0.019490471057075003, 0.02038581575736658, 0.019203295962442177, 0.01694219697199376, 0.01797028438264967, 0.01862586508419463, 0.01821309648265841, 0.02075518930781996, 0.02100968342758268, 0.018052621537725237, 0.01902979324457343, 0.01894675053102696, 0.021930170704035627, 0.019159289358949783, 0.02014448767409621, 0.018070907785676098, 0.018345294639116848, 0.019717700690903058, 0.02218420872743696, 0.01987790855749312, 0.01657476371821114, 0.019748632608619445]
lvec1 = [0.010016073800143636, 0.011508161435565288, 0.013940627365080997, 0.012514951648693682, 0.012071271475310267, 0.01112651529942219, 0.010116607857084695, 0.009774169172447805, 0.011053766638821095, 0.010830757383794283, 0.011587401404601756, 0.01063009445259199, 0.010086131092423886, 0.009730403333284171, 0.012499479185751014, 0.014375317821796128, 0.00947979651611557, 0.01014267517140476, 0.009507149633490896, 0.011426928134174069, 0.012511170907152312, 0.010606252083298939, 0.010467045195644299, 0.008658087693242065, 0.015745365757557188, 0.010154007314476788, 0.016728030839945743, 0.012871522815809281, 0.01668888377164307, 0.008846898002570184, 0.010817360142306913, 0.010817543071249706, 0.014320310228814446, 0.012386247005465563, 0.010374279910081146, 0.010648248098706643, 0.01293355694831459, 0.010893263829301475, 0.012433054432857277, 0.009956339313649268, 0.022477077197052928, 0.011106099352765748, 0.011267987347594415, 0.011804167793013038, 0.013396851150250114, 0.012059891296268797, 0.012797530537928724, 0.01163277986442971, 0.010753816116369457, 0.012392582467036062, 0.012589098276084473, 0.014500455943025955, 0.012453208042998666, 0.015392107796640712, 0.013418583565041067, 0.01001073490664175, 0.011551071594375599, 0.011754148833425177, 0.010291075333551133, 0.010517737369376647, 0.010066261410804866, 0.010311094755177703, 0.017664038150555755, 0.010015797054841975, 0.011784777228652508, 0.010429943241499956, 0.015057104776761289, 0.011149454074317215, 0.012834387128007375, 0.011626183141136769, 0.0124197063860229, 0.014792917663054088, 0.012381290910707657, 0.013916571872491082, 0.01497685133975123, 0.026245134124371086, 0.013730712444529251, 0.009614715700350999, 0.011789542588556409, 0.013854003526426423, 0.012951845784526588, 0.011488357674734726, 0.010362428354145537, 0.011238306222242728, 0.011526328999633748, 0.010829424957715215, 0.016119720102060548, 0.013477306098756747, 0.010927735744866789, 0.011537031362779166, 0.010512378437378171, 0.011227561948892881, 0.02642609520179407, 0.01322651960484264, 0.01014462422010825, 0.013098195135797132, 0.02332106998081298, 0.021192312593246963, 0.011247471040993025, 0.011273613830537618]
lvec2 = [0.012579604963203034, 0.015921222901186673, 0.009060076295530291, 0.01504870384162766, 0.009124969429081219, 0.02079823299544849, 0.00845122881975187, 0.00969208844106237, 0.008539276130621928, 0.01509465680910332, 0.008703880168119554, 0.010178668169614258, 0.0207599099675618, 0.008213174350290805, 0.016967247608430935, 0.008850609175966603, 0.009562771731828543, 0.008697294666186054, 0.008925961139882433, 0.00938307418530345, 0.011337802040956243, 0.009784752661024347, 0.00814108510347397, 0.008299420306381488, 0.011531943204382928, 0.012065543904558771, 0.016554374529218624, 0.00915762715983497, 0.00876633496985161, 0.014163508841057368, 0.00890955326788669, 0.00815509984654655, 0.009196485784734651, 0.008694457253011012, 0.010566030396703991, 0.009894908658340753, 0.00958880609968029, 0.009240848812277215, 0.0087377396374058, 0.009501110585020898, 0.019172928197153955, 0.008909646126854008, 0.007985493531540008, 0.009484866144740778, 0.020371276218902154, 0.008658835560116443, 0.00957830309380146, 0.00957634992245578, 0.011799403826079117, 0.009069669441219962, 0.009325889296704613, 0.009363070288976752, 0.0193559486061297, 0.00990409996201096, 0.01916583504493119, 0.009189664941470973, 0.01179263062587594, 0.009823082185606123, 0.015382379703343862, 0.012022398702181093, 0.017454617171854186, 0.013485144130929452, 0.008403974972734983, 0.009507924857430452, 0.00988238906950615, 0.008271118876969814, 0.015379108335158228, 0.011749512906134947, 0.009155691854894723, 0.0087783155251325, 0.011240868480746966, 0.008578013130824996, 0.011634858825029426, 0.009703166056677152, 0.01105700876477559, 0.014219339180055407, 0.020633378180931746, 0.009220753824113262, 0.008930742115360085, 0.008704566538946207, 0.008816598256186409, 0.010045085401055132, 0.014231614453420019, 0.015211750275700328, 0.009983165932991941, 0.009910360458408131, 0.011756588735576896, 0.008480372341154839, 0.009551060904482335, 0.01233974777828955, 0.014755314772810496, 0.011557502479678542, 0.012281898643823818, 0.009790083910178193, 0.01112200648105468, 0.011869157321600168, 0.008787926278800946, 0.01685169053244565, 0.015267772505314848, 0.01047200689412384]
lvec3 = [0.012246813118123138, 0.01060467200471821, 0.011865596645024451, 0.014722742737133409, 0.014550741819438722, 0.014262809436821861, 0.012640263818168813, 0.012186850585844629, 0.013200116716706732, 0.01356576277245196, 0.00996001145862872, 0.010209753910833173, 0.009724130895703986, 0.01041558766447232, 0.0171752027661443, 0.011719273764851853, 0.009964567637260474, 0.01332766475707077, 0.009740084312971917, 0.010085236628720153, 0.011679189119291196, 0.012970361475288563, 0.010203366803373757, 0.010837841192021892, 0.02177443724082126, 0.010049554474636607, 0.01734202541127044, 0.014972197946473594, 0.015468954758673447, 0.012132593875633951, 0.012661336476384817, 0.01205896204845188, 0.01167374657149127, 0.015720466043550686, 0.01045782128580403, 0.009555176803351969, 0.01212220095345542, 0.020118529000051368, 0.012833520122332572, 0.01217396097510505, 0.02721184062180769, 0.011253885195793211, 0.010672480973403327, 0.010674004976842679, 0.030677207061772637, 0.01273322180355246, 0.01088466838322733, 0.012818318956236363, 0.012228829809494223, 0.012266610624628412, 0.01275424738248505, 0.01035618772055188, 0.012080236713386854, 0.019480354157118615, 0.011101845145924803, 0.013166817860054511, 0.010378045048724707, 0.016002952892319053, 0.00919458461509923, 0.01231708808884319, 0.01033329507129698, 0.010439389989607768, 0.016308967567984688, 0.011330913436972139, 0.015043773791922996, 0.012475791396047506, 0.014692605811941675, 0.014133614045352703, 0.015701095557350744, 0.011468652769250841, 0.013718242126952633, 0.016781065583127776, 0.010993211352953, 0.018864887820786543, 0.0164224037830075, 0.016508634391513306, 0.014273202042001651, 0.012305192268181471, 0.010025728639045241, 0.009222634036777743, 0.011152725528592998, 0.016165836050234215, 0.009872923195864422, 0.009467117729623945, 0.01354708546892886, 0.008541951835831164, 0.010464904669599396, 0.017467237669553985, 0.00933348139574465, 0.01098491245039878, 0.012870577370334613, 0.011327390801110808, 0.012003881826564144, 0.015183921466230736, 0.013002919793215063, 0.009875359539414787, 0.015211350103831204, 0.020950336176140186, 0.010055235115033187, 0.016434797984210266]
lvec4 = [0.01999278286486788, 0.019083798078262867, 0.019706499261853035, 0.01952919913639884, 0.018034459526188065, 0.017884238299004984, 0.018318855692049992, 0.019462137008092864, 0.01660213492360213, 0.01838255876004346, 0.01872827154802623, 0.017385256338055027, 0.01947066270612214, 0.01837090381917555, 0.017413296743930124, 0.019311575752357726, 0.022901956316146964, 0.01943587720327217, 0.02151316491599071, 0.01924992622707404, 0.017903984190488317, 0.016727905477386607, 0.021440186547703483, 0.018892240508060758, 0.01859619460177928, 0.0182720283078221, 0.017431023362636366, 0.017844435063185313, 0.01819811246365481, 0.01909588410719992, 0.01813076142463464, 0.018410368438977576, 0.01815650510653358, 0.019084361093454297, 0.019514503743092017, 0.019372645566016315, 0.02463494749509261, 0.020303606547472625, 0.016332727137099354, 0.01547824177015977, 0.01906841819677867, 0.02008736394496971, 0.02205344859750358, 0.01852900250170278, 0.01880116067635374, 0.020968393853230273, 0.019401274131541413, 0.021442089169067972, 0.018134131883758408, 0.015479179275228225, 0.018107370373751853, 0.01677515676831282, 0.019010143561792855, 0.020160972923201355, 0.018939463528385766, 0.018852056958361226, 0.016972677680658594, 0.01865577298437917, 0.02266784231453154, 0.01541836615887482, 0.023344814192809003, 0.018971308861835418, 0.01615014639349904, 0.0182551103931628, 0.01813721373333956, 0.016109223691246018, 0.02002345272712874, 0.01794382097627479, 0.016682466201326563, 0.018038530991024496, 0.02100167067316983, 0.018794269710948133, 0.017966593020039175, 0.01810256263117074, 0.01912515483344946, 0.020665820345122828, 0.02148991318339171, 0.01924200433733279, 0.018409979806208867, 0.016889270682439703, 0.016932647074970098, 0.016379786064932258, 0.019249735186890292, 0.018932774505027707, 0.018397303029376862, 0.019368518266195168, 0.016888693473584702, 0.016133578705113626, 0.018208332544546568, 0.020704940776654905, 0.017951326365003215, 0.01904886331227918, 0.016600009177212046, 0.02046543373411971, 0.020163870461073576, 0.021446066700157234, 0.01834995409361374, 0.016122951231530007, 0.02114357189763284, 0.01857768416831926]
lvec5 = [0.012326724224266079, 0.008365693717299809, 0.0097024532860604, 0.011504408737352572, 0.01027353295064233, 0.011514499380379944, 0.007405835548262324, 0.0099948560359188, 0.013584347321240139, 0.017171733160703164, 0.009141175149507253, 0.010355960163023002, 0.01621571226840786, 0.012299638759596457, 0.01854554642500501, 0.01715254031182523, 0.010198768249057499, 0.009625077135323496, 0.010897639203673168, 0.011698923680358577, 0.01385582752755707, 0.01125506148922694, 0.01132505719337472, 0.007616644974990777, 0.016677528407379728, 0.01039562044367271, 0.012839320056387465, 0.009644897704333914, 0.010190079043812394, 0.01363481498103959, 0.01730840822054368, 0.010569037804322523, 0.010821493644333765, 0.011425333836071588, 0.008496710997460279, 0.008413780503185855, 0.01544671709073149, 0.009723651145014417, 0.00874332785505736, 0.008901933568898623, 0.022199850884473182, 0.00971049166964856, 0.009462777510275943, 0.008404006303179412, 0.016223485076889844, 0.009187884301805019, 0.012105912239695024, 0.010389807926313645, 0.010647970717530004, 0.011803191243426629, 0.01581407346507672, 0.01078106079298247, 0.016206015075002137, 0.009512383483641458, 0.016463351797312026, 0.009308821335821397, 0.014715433017755016, 0.007857387537171521, 0.013050853116234908, 0.01202808748253597, 0.0147303404410592, 0.008426976300691233, 0.009446013393541395, 0.010748192586632963, 0.012286776767423672, 0.012518112627581152, 0.014260380476328978, 0.011172939935094014, 0.009210493291710769, 0.008929581078162802, 0.009156711982530976, 0.012123857687981812, 0.010311681338394298, 0.0098797723776242, 0.008953007382186741, 0.02372622165253826, 0.019844988522734294, 0.009209290928564448, 0.009056672787132243, 0.021934922539318284, 0.022995132415111044, 0.00843736115827256, 0.018114338914516828, 0.01203030389090643, 0.012873235906777985, 0.008494824669361476, 0.012402190163414872, 0.010192057318666277, 0.013508406853156971, 0.012041440139053157, 0.015881863669187295, 0.008810555381063106, 0.008693180152492994, 0.00823699954136897, 0.014391696779671791, 0.00880075163664719, 0.012425264912857857, 0.02273240412418872, 0.011199003322403228, 0.008632579971957481]
lvec6 = [0.014210671887976345, 0.010862005963470702, 0.008013879957378118, 0.016935106699515676, 0.010496664844157955, 0.0141828193712911, 0.009491566891128267, 0.013228054102427117, 0.008843229806115778, 0.008813526237725385, 0.010244011469147789, 0.01495160280954488, 0.022989807553937733, 0.009206505362780103, 0.008714835517420617, 0.018163534260873852, 0.011974686887210527, 0.008503003549859143, 0.015416397454177295, 0.008647306263660745, 0.008676245004704233, 0.013374413359173424, 0.01216328589507565, 0.008104523109880399, 0.01036909543379751, 0.014949267453673002, 0.009771608520824558, 0.014621822598457306, 0.010176884859068045, 0.00813776969898174, 0.00849746959899357, 0.00912911498747846, 0.008548743234397617, 0.008535358364377183, 0.008339782463688172, 0.00863645764953551, 0.008944748736341506, 0.009758968309959652, 0.010209058901283853, 0.01268432492821186, 0.026132028656063355, 0.00866919066043909, 0.009416602198846732, 0.008045662305372766, 0.013132477193078631, 0.009518669333344654, 0.014263012889104938, 0.00874938498584976, 0.014675666104472239, 0.010539192741943369, 0.00955783162983652, 0.009587917245789484, 0.009454881816146688, 0.01210256595299364, 0.011767165862885662, 0.008453795353106084, 0.015897406957432424, 0.008826130351449319, 0.009277576549775525, 0.010486210259952305, 0.015300116867131942, 0.010342905401140122, 0.008155828592855498, 0.009912194597459938, 0.008463813607398183, 0.012572461092467221, 0.014941904963081792, 0.00852352076710191, 0.009400076148043484, 0.010170336855833689, 0.010868634007052378, 0.008539241065088776, 0.009204515769260308, 0.0085318653067294, 0.00860820512785058, 0.016284782724157936, 0.010283654117980096, 0.008509097101142166, 0.010877970808326528, 0.010766902612330662, 0.013548532951659725, 0.015974607677076598, 0.008970822548870154, 0.02502191890384869, 0.007991854609305115, 0.007962917930619956, 0.009044576994359756, 0.008447516276296894, 0.01101706133524662, 0.009580457621849819, 0.009192419348115238, 0.014013534801657788, 0.014584046455764306, 0.009020287959069262, 0.011412434089409656, 0.014864093761427343, 0.012717211692869119, 0.013967058171047216, 0.01747616080666172, 0.010736564589807719]

lveclist = [lvec1, lvec2, lvec3, lvec4, lvec5, lvec6, lvec0]
lvecnames = ['Design 1','Design 2','Design 3','Design 4','Design 5', 'Design 6', 'No more data']
plotLossVecs(lveclist, lvecnames,plottitle='Bayesian loss for 30 tests, Omega=100\nPMS Loss, t=10%, overWtFact=1.')
'''

'''
# SCRATCH FOR LOOKING AT LOSSES VIA HISTOGRAM
# FOR 30 TESTS WITH ALIGNED PRIOR DRAWS, USING PMS LOSS W/ t=20%, overEstWt=1.
lvec0 = [0.01728729014931321, 0.018471918342130782, 0.015683815599280424, 0.015655644941699742, 0.01815963047507897, 0.016801844559582856, 0.015629703051773167, 0.018667554884051873, 0.01694482368386538, 0.014746901954150772, 0.014511976508500144, 0.014327385602907217, 0.015125668584179587, 0.015636987332666597, 0.01729784455744154, 0.014158589944664316, 0.015345482843518337, 0.017517073677329714, 0.015236045719924433, 0.01574874721197197, 0.014811074533242265, 0.016513239471657427, 0.01756957743712494, 0.016526385939271814, 0.014498931361412379, 0.014686115574308909, 0.01814130256363459, 0.013196227539490535, 0.01614853257782514, 0.01464580171145139, 0.016588128618273617, 0.014708487192838866, 0.015229236043196096, 0.015655408973299, 0.01423463657893135, 0.016900325200930457, 0.01526207375456269, 0.017025407848797334, 0.015949368022818693, 0.01672967442520684, 0.015566220069113713, 0.014877788396696788, 0.016532683527538256, 0.01489299676941007, 0.018434805569295786, 0.015626388941818416, 0.018462144367519907, 0.016088292887917178, 0.01598556700861214, 0.01813060697236665, 0.01748285230383631, 0.015952081074120245, 0.015934857447889937, 0.01631107875631688, 0.014395901572940437, 0.016774226164355033, 0.015774822741543643, 0.014651481249148833, 0.015169218184766922, 0.015561234349167211, 0.014852819791934993, 0.015986662328284423, 0.013707709221989365, 0.01432375288443756, 0.017330994747413498, 0.017588973428084402, 0.015934202622139536, 0.017325621081784794, 0.01727693418743328, 0.01958756003914346, 0.0155956147322963, 0.014714654850202928, 0.01515572234174987, 0.015026373261513477, 0.013666265862091635, 0.01641067308567396, 0.01764512718171291, 0.016824135324949682, 0.01604824804692429, 0.014521177936402773, 0.015465804772273165, 0.013949171357429966, 0.016500671732389262, 0.014426041088188981, 0.016149849135599137, 0.016658025535992094, 0.01591683065513411, 0.01393257519035395, 0.016294422425590684, 0.01632693554201407, 0.014330754019540577, 0.014089032583448605, 0.015464704287658384, 0.01474551726808667, 0.016421839985492837, 0.015885368682801344, 0.017222461901998685, 0.01686571720413538, 0.016491702089873047, 0.016079065150581707]
lvec1 = [0.008391605533154727, 0.008867692915398762, 0.01235347981023735, 0.010520755527905148, 0.009824725643581507, 0.009113627443215816, 0.008578931729146044, 0.009823466749820842, 0.008015610018936258, 0.009120035356041136, 0.009592994799732604, 0.008680463500052285, 0.009140487276852686, 0.0094363492144605, 0.011836668971563593, 0.009926257193627148, 0.007926548140718404, 0.008352776802650773, 0.007653444452899067, 0.009493109524987504, 0.015862656916880685, 0.009417167373324984, 0.00824375891232307, 0.00820770494929278, 0.01533634552964456, 0.009994384983732039, 0.010884056214420039, 0.009538434170745047, 0.011278067911927685, 0.007468704164020146, 0.00845515665626566, 0.007674533259566625, 0.008870481715271127, 0.009501868434742903, 0.007941711140138998, 0.010703082453916374, 0.010470585186558799, 0.008877269395963321, 0.009004273659678206, 0.011442294922740437, 0.01839170933567517, 0.010011384431986922, 0.009096872815985367, 0.009049021475586507, 0.010631267520059112, 0.008269763355271496, 0.00794868580003554, 0.009158371964665695, 0.008067848730983505, 0.009261430739131224, 0.008774431742415777, 0.009695582478327771, 0.010296565748753185, 0.009501144944291839, 0.010023676194523082, 0.008724919157155848, 0.012035844880253886, 0.010547398407099883, 0.010170407763814284, 0.008174037000176501, 0.009990503781937181, 0.01010148895801915, 0.010408880727384301, 0.011270746506613668, 0.009825759825816589, 0.01120519222445761, 0.007808293877560399, 0.00935853500490824, 0.011617221435826382, 0.0086646115880574, 0.008192402550540734, 0.012025934780471977, 0.017932431042901154, 0.007857337607931239, 0.011710561599298609, 0.018474289040025425, 0.00976246957440904, 0.0096915640358833, 0.010400271487859337, 0.01035172564081102, 0.01008009918012806, 0.009371665494509442, 0.00899337512887673, 0.007801515168438731, 0.009444581258841915, 0.0073973128907510646, 0.011451528071379712, 0.00893154344871807, 0.009715070114127443, 0.009191359230868931, 0.008499607726698907, 0.01030806034170421, 0.014594004520618984, 0.014184825812449795, 0.00940949487397833, 0.012130709579070954, 0.012068315042730433, 0.011161172795762037, 0.00897840649878541, 0.008269550560804943]
lvec2 = [0.006877109316637901, 0.013179602135788001, 0.008465837483962589, 0.013334031837735726, 0.012380130334511054, 0.006424857015871693, 0.006979901529813544, 0.007221924188637552, 0.00903907946240148, 0.006740854286361001, 0.009623908230803186, 0.00688444756921271, 0.008654704169185989, 0.0087906201380175, 0.00737406135537556, 0.010444701696707814, 0.007259024212425955, 0.00676215110591187, 0.01312638167080718, 0.007797016914678759, 0.007842157135745926, 0.009460379450298083, 0.008770116148335488, 0.0070956501102529814, 0.011202585140558876, 0.007249944824907526, 0.010468430697202413, 0.009712189955263835, 0.00732574374864788, 0.011047962315702589, 0.009980564055608862, 0.007051479114819041, 0.008657603018467545, 0.007212499044832867, 0.008755711392075453, 0.007328399624187246, 0.007779422197257905, 0.007466867964075837, 0.010279332197531693, 0.007730996433097717, 0.019425089277929294, 0.007065668451254058, 0.006521945651238206, 0.010215525780199144, 0.012209754204385099, 0.007692383188208813, 0.013497180723962077, 0.012123451896550735, 0.01000439767894141, 0.0076102198813320105, 0.00975779193160731, 0.007101060701625442, 0.009892336401060516, 0.010097513034372391, 0.011109246013397259, 0.010125960267903418, 0.013925664609214012, 0.014244227669805602, 0.012401274421436107, 0.009341695812635534, 0.008750120801769408, 0.006812160002525217, 0.008072493973671775, 0.0072879633858621545, 0.0077001649300828204, 0.0071767483712794206, 0.011092870990126364, 0.007225181789956158, 0.009187633254617295, 0.007662831054673267, 0.011127290247996283, 0.0070631400158141285, 0.007647658001407184, 0.00755339417266755, 0.006718757691364237, 0.009411649995888853, 0.008256513657986924, 0.007996736000209769, 0.00659288037472716, 0.006866160214167135, 0.007889048624701073, 0.007633293695562305, 0.007587803661882176, 0.012554742563830702, 0.011179584951055808, 0.006505618930586171, 0.007225490985040163, 0.00719013380714886, 0.009690571074134551, 0.006697696187556011, 0.007507124040207948, 0.010489478419691277, 0.008761902951026987, 0.007770791622781221, 0.0068097237249886465, 0.008480773691495273, 0.00795942259197447, 0.010984380155486187, 0.014297675874621133, 0.007486985706885072]
lvec3 = [0.008704894299401219, 0.01251608269536652, 0.019969957480827687, 0.008778850406670643, 0.009270050870622071, 0.007638237731191134, 0.009291096169706522, 0.00790597784131658, 0.011909779066634051, 0.013296665360002444, 0.010641374583595691, 0.007919257479208222, 0.011525301292040277, 0.00823666114438279, 0.013036094873758725, 0.012803373610898484, 0.013735749570152396, 0.010877454706844779, 0.007507172492005733, 0.008944514796438836, 0.010722656555888319, 0.009316113248517237, 0.01079262636450678, 0.00979851082712124, 0.009579699072138795, 0.009794932623813733, 0.012109986243450374, 0.008651274161838987, 0.011990293668341133, 0.009135991273147471, 0.009004921396594898, 0.008501910548631784, 0.013697873689539218, 0.010877328624590621, 0.0072528519199907965, 0.008467480347943644, 0.008098207376223047, 0.013480682712185457, 0.010296930560991078, 0.012851214186690746, 0.013187967789639066, 0.011945035847889831, 0.00844323728249091, 0.00837854671131469, 0.013915422955621965, 0.010068827418127617, 0.00961942506447852, 0.009922439506294348, 0.012137900546964762, 0.009203930745882077, 0.008952757593012462, 0.00929396917113039, 0.00967053531959739, 0.010800098295205047, 0.00817463663652617, 0.01035299111072568, 0.007831017462838753, 0.011690616891453889, 0.00928384612510225, 0.011151722534301297, 0.010375499016057185, 0.0095534280184862, 0.012242204555721089, 0.01236603647930396, 0.010596893726302719, 0.00889629358529137, 0.017736917308214827, 0.009090368144728734, 0.013765343360646491, 0.008348238362082773, 0.01117401581261992, 0.011652109273629972, 0.00868412029854486, 0.013436721136965916, 0.009017248800378441, 0.011310156727563447, 0.008968495752270478, 0.008473871610713403, 0.008418897069356428, 0.021598628248068807, 0.010554733477448541, 0.011589237058074195, 0.008662204338243234, 0.009824745228104574, 0.008953206733102, 0.00816571203394725, 0.011166177761758206, 0.009245831994019493, 0.014461832363124861, 0.0079838045239295, 0.010182264415239275, 0.011833515899512561, 0.009146934663475239, 0.0073656870546474655, 0.011448910099155307, 0.007323524457746214, 0.010418893420791513, 0.010125904927763173, 0.009176641595467105, 0.009253891435318767]
lvec4 = [0.01313728434194406, 0.014209787254099623, 0.013582828229842366, 0.016564622364124676, 0.015456649476796654, 0.015234020710421245, 0.014952765606946925, 0.014047163435387927, 0.01316697323831591, 0.013257194978201704, 0.015431073311758435, 0.014914270989156512, 0.014082693491683182, 0.0141812355344424, 0.014290286330093006, 0.015490954090449111, 0.015211553907963528, 0.013353555795092825, 0.013726416989302636, 0.015630208555056497, 0.016084208878214136, 0.015157649244095683, 0.015180944740514582, 0.015031592585199127, 0.014902577540531, 0.014805077647729764, 0.014216146590376465, 0.01399274406323584, 0.014672269088150088, 0.014402756948679851, 0.015527670456972101, 0.016554892841454463, 0.014121675799494488, 0.014458014026406696, 0.01702621003154555, 0.013525856417398396, 0.01612805197647894, 0.014411585448695311, 0.01771761436772946, 0.014029471067672043, 0.014888669658395023, 0.017843862396196317, 0.018840947181238216, 0.015067070654116213, 0.015547297232460459, 0.013509689875926425, 0.016671001822966134, 0.014850645073740091, 0.01447972084071085, 0.014113163706208165, 0.014063862801915716, 0.02056055341250483, 0.017970852368287275, 0.014565212228337837, 0.01458190771211449, 0.013835272196040806, 0.015964797850263657, 0.014395312308500833, 0.015680330958318205, 0.013500048369105466, 0.017517398887550974, 0.014297610905285267, 0.017166520545467565, 0.01276366706852271, 0.016290713087804887, 0.013928197895845054, 0.014213149685924471, 0.016482870380946018, 0.01410778555523349, 0.01541303363486504, 0.014589514081010837, 0.014861932524754604, 0.01694524294398754, 0.013704503855824491, 0.015354771191925692, 0.015572137962320109, 0.014877444301922473, 0.019754825816910012, 0.014876646477063365, 0.017312818009530582, 0.014972840796842923, 0.015671687742587634, 0.017951728687843005, 0.014142248949609712, 0.015002684031329507, 0.015174460913228984, 0.013771326037521996, 0.012298346959153012, 0.01666415443308102, 0.014945269534251519, 0.01438888283019336, 0.012846572711658864, 0.01593516146793305, 0.015266855642109074, 0.014568620113549358, 0.016083686042984126, 0.013859416710623388, 0.014024420095223648, 0.015993993059609857, 0.016436923478425423]
lvec5 = [0.00705897684385838, 0.008583453863977963, 0.00822673299724233, 0.013565984375809716, 0.007635229614938759, 0.006627506503580114, 0.008050343841311026, 0.015717895703363814, 0.007668898512021309, 0.006757898166454954, 0.006537134755125903, 0.010379883135560163, 0.011602619512971188, 0.008833023521846192, 0.007499090336239253, 0.007031684562320429, 0.01546869155058592, 0.006532197360706497, 0.006923154848783764, 0.007653255043206677, 0.008002099829339467, 0.008200091411120042, 0.008006254855676293, 0.00866599740593845, 0.008522696752559133, 0.007779704398812774, 0.013492878622622174, 0.009658038393727376, 0.006798213021634036, 0.008249646010089918, 0.006689761579354938, 0.011272128191378067, 0.009893875820582453, 0.011701509065043332, 0.007720302358216688, 0.0075781464610286614, 0.02188643328942683, 0.009746023447111443, 0.010136129134250242, 0.006589866931495101, 0.008186705455559547, 0.007480513245487152, 0.008383728384335922, 0.012999806922719015, 0.0074844594626065275, 0.0067657051041183375, 0.007791249987940374, 0.015335129942218315, 0.006860903399606504, 0.007526655442220837, 0.00807603078412193, 0.00946083008057908, 0.01126426885281429, 0.008570797641190982, 0.01290100908996034, 0.007090188696605776, 0.008563576946991995, 0.007593046875917991, 0.006553798643705189, 0.008186632417566366, 0.012691379480342317, 0.01144015797044641, 0.011604717567808311, 0.009556810696312635, 0.00802904322793259, 0.008260724777120443, 0.01031818806917972, 0.009352448158637507, 0.014411963467581609, 0.01089833223202352, 0.006670608758788378, 0.008582313328165916, 0.008968743547936586, 0.008204952236707136, 0.014578698084179855, 0.018250643782040714, 0.008711604890481787, 0.006828019069561203, 0.013842474416691768, 0.014200446263629832, 0.009310380807646932, 0.008713365874981938, 0.006998674093556041, 0.01177610059054582, 0.009902918055217865, 0.006483253740461586, 0.006481818642548819, 0.00694752163034347, 0.009851756663543139, 0.012470157453592763, 0.007308162545278951, 0.011598709614056239, 0.011274448738389583, 0.007312734266171595, 0.014871822012607113, 0.008845513382996249, 0.010449702431151151, 0.009387735325017682, 0.012061951784188478, 0.007999544005310852]
lvec6 = [0.007042059630777488, 0.006822614175573789, 0.009695667694790305, 0.009606716671986572, 0.012544471884818905, 0.014946429853576535, 0.0117123643967494, 0.007425356472852058, 0.007403685205447895, 0.012678415510981703, 0.0072122060779232725, 0.00658494420153568, 0.009242523396988792, 0.007083215977486052, 0.010813935894511666, 0.006974617189987063, 0.00935244930227681, 0.006197986326767704, 0.011954158119290709, 0.007353492091119611, 0.009771829478679255, 0.0071805800624448616, 0.012943212770799715, 0.006368757074100224, 0.008360774344183957, 0.010191432540216296, 0.015628514483336707, 0.006975359325896849, 0.009886964351849957, 0.007903344910441444, 0.009031556128687003, 0.006650675462109655, 0.009632990757033062, 0.00780917019668244, 0.006223364260086694, 0.006966982817250484, 0.013843129151467952, 0.007175515986372118, 0.006632229075960022, 0.006495751398786483, 0.016210460714369934, 0.0071179629535057624, 0.006848579276602457, 0.011169786871059078, 0.007096464567273727, 0.0066407390887585046, 0.009663798688972491, 0.007425148215050655, 0.01072751477918369, 0.007507504072422916, 0.00756509003769649, 0.007171557330010366, 0.012102929756980324, 0.01217839333326704, 0.010908914253772254, 0.010265167467251105, 0.008969243863090986, 0.007601956558299698, 0.009789930580015073, 0.007314381504218152, 0.0074790932273756695, 0.0077749018446602435, 0.008093106322705981, 0.007186142540498965, 0.006994495615730398, 0.00746825535086623, 0.014581838929754624, 0.009047996147329885, 0.008672352257142538, 0.010714850395392677, 0.014368805749173909, 0.00739991251117953, 0.007569250350530316, 0.006965266680498088, 0.0070491954111052855, 0.008995720503849359, 0.008737801672075454, 0.0076205051587823845, 0.006304549108367185, 0.009937219142699323, 0.007137731268679045, 0.009333364433423749, 0.007324076552893495, 0.012459924025041695, 0.006981335267440186, 0.006015499517350092, 0.007490081457927423, 0.011500405035150424, 0.008341740109078686, 0.013480684573196, 0.009059275227627105, 0.007962494342602823, 0.0126927628597253, 0.008128467958722442, 0.011342648830491247, 0.007228812093276274, 0.010259101596250248, 0.007918634601128217, 0.011556653549985809, 0.010771856392940087]

bins = np.linspace(0.001, 0.03, 100) 
fig, axs = plt.subplots(7,figsize=(6,12))
plt.rcParams["figure.autolayout"] = True
axs[0].hist(lvec1, bins, alpha=0.5, color='red', label='Design 1')
axs[1].hist(lvec2, bins, alpha=0.5, color='green', label='Design 2')
axs[2].hist(lvec3, bins, alpha=0.5, color='blue', label='Design 3')
axs[3].hist(lvec4, bins, alpha=0.5, color='gray', label='Design 4')
axs[4].hist(lvec5, bins, alpha=0.5, color='orange', label='Design 5')
axs[5].hist(lvec6, bins, alpha=0.5, color='purple', label='Design 6')
axs[6].hist(lvec0, bins, alpha=0.5, color='black', label='No Additional Data')
axs[0].set_title('Design 1')
axs[1].set_title('Design 2')
axs[2].set_title('Design 3')
axs[3].set_title('Design 4')
axs[4].set_title('Design 5')
axs[5].set_title('Design 6')
axs[6].set_title('No Additional Data')
for i in range(7):
    axs[i].set_ylim([0,20])
fig.suptitle('Bayesian loss: 30 tests, Omega=100, PMS(1.,0.2)',fontsize=16)
fig.tight_layout()
plt.show()
'''